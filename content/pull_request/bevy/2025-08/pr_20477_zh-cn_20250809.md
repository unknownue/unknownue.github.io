+++
title = "#20477 Use bevy::camera in examples instead of bevy::render::camera re-export"
date = "2025-08-09T00:00:00"
draft = false
template = "pull_request_page.html"
in_search_index = false

[extra]
current_language = "zh-cn"
available_languages = {"en" = { name = "English", url = "/pull_request/bevy/2025-08/pr-20477-en-20250809" }, "zh-cn" = { name = "中文", url = "/pull_request/bevy/2025-08/pr-20477-zh-cn-20250809" }}
labels = ["A-Rendering"]
+++

# Use bevy::camera in examples instead of bevy::render::camera re-export

## Basic Information
- **Title**: Use bevy::camera in examples instead of bevy::render::camera re-export
- **PR Link**: https://github.com/bevyengine/bevy/pull/20477
- **Author**: atlv24
- **Status**: MERGED
- **Labels**: A-Rendering, S-Ready-For-Final-Review
- **Created**: 2025-08-09T20:21:33Z
- **Merged**: 2025-08-09T21:28:44Z
- **Merged By**: alice-i-cecile

## Description Translation
# Objective

- 为移除重新导出(re-exports)做准备

## Solution

- 修改示例中的导入路径

## Testing

- cargo check --examples

## The Story of This Pull Request

### 问题与背景
Bevy引擎内部正在进行模块结构优化，计划逐步移除渲染模块的重新导出(re-exports)。在PR #20477之前，许多示例代码直接使用了`bevy::render::camera`路径下的类型，比如`Viewport`、`RenderTarget`和`RenderLayers`。这些类型实际上是通过`bevy::camera`模块重新导出的公共API。直接使用内部渲染路径存在两个问题：首先，它暴露了内部实现细节，违反了封装原则；其次，当未来移除这些重新导出时，会导致示例代码编译失败。这个问题影响了36个示例文件和1个测试文件，需要统一修正导入路径以保持代码的长期稳定性。

### 解决方案与实现
解决方案是系统性地将所有示例中的`bevy::render::camera`导入替换为`bevy::camera`的公共路径。这个修改不涉及功能变更，纯粹是导入路径的调整。实现过程包括两个关键方面：

1. **直接路径替换**：对于简单导入，直接修改use语句。例如在`2d_viewport_to_world.rs`中：
```diff
 use bevy::{
+    camera::Viewport,
     color::palettes::{
         basic::WHITE,
         css::{GREEN, RED},
     },
     math::ops::powf,
     prelude::*,
-    render::camera::Viewport,
 };
```

2. **子模块结构调整**：当类型被移动到`bevy::camera`子模块时，同步调整导入路径。例如`RenderLayers`类型从`render::view`移动到`camera::visibility`：
```diff
 use bevy::{
+    camera::visibility::RenderLayers,
     color::palettes::css::{BLUE, GREEN, RED},
     core_pipeline::oit::OrderIndependentTransparencySettings,
     prelude::*,
-    render::view::RenderLayers,
 };
```

### 技术洞察
这个PR展示了几个重要的工程实践：
- **公共API边界**：始终通过公共模块(`bevy::camera`)而非内部模块(`bevy::render::camera`)访问功能，保证代码的稳定性和可维护性
- **批量重构模式**：使用自动化工具进行全局替换（如`sed`或IDE的重构功能），确保36个文件的修改保持一致性
- **编译验证**：通过`cargo check --examples`验证修改没有破坏示例编译，这是纯路径修改PR的标准验证方式

### 影响与收益
修改后所有示例都使用规范的公共API路径：
1. 消除了未来移除重新导出时的编译中断风险
2. 提高了示例代码的示范价值，引导用户使用正确的公共API
3. 减少了内部实现细节的暴露，保持模块边界的清晰性
4. 为后续渲染模块的重构铺平道路，解除了API耦合

## Key Files Changed

### examples/ui/directional_navigation.rs (+5/-7)
更新了`NormalizedRenderTarget`的导入路径，并修复了相关类型引用：
```diff
 use bevy::{
+    camera::NormalizedRenderTarget,
     input_focus::{
         directional_navigation::{
             DirectionalNavigation, DirectionalNavigationMap, DirectionalNavigationPlugin,
@@ -21,7 +22,6 @@ use bevy::{
     },
     platform::collections::{HashMap, HashSet},
     prelude::*,
-    render::camera::NormalizedRenderTarget,
 };
```

### examples/2d/pixel_grid_snap.rs (+4/-6)
合并了相机相关类型的导入，清理了冗余结构：
```diff
 use bevy::{
+    camera::visibility::RenderLayers,
+    camera::RenderTarget,
     color::palettes::css::GRAY,
     prelude::*,
-    render::{
-        camera::RenderTarget,
-        render_resource::{
-            Extent3d, TextureDescriptor, TextureDimension, TextureFormat, TextureUsages,
-        },
-        view::RenderLayers,
+    render::render_resource::{
+        Extent3d, TextureDescriptor, TextureDimension, TextureFormat, TextureUsages,
     },
     window::WindowResized,
 };
```

### examples/shader_advanced/custom_phase_item.rs (+6/-3)
修复了渲染管线中相机相关组件的导入路径：
```diff
 use bevy::{
+    camera::{
+        primitives::Aabb,
+        visibility::{self, VisibilityClass},
+    },
     core_pipeline::core_3d::{Opaque3d, Opaque3dBatchSetKey, Opaque3dBinKey, CORE_3D_DEPTH_FORMAT},
     ecs::{
         component::Tick,
@@ -18,7 +22,6 @@ use bevy::{
     prelude::*,
     render::{
         extract_component::{ExtractComponent, ExtractComponentPlugin},
-        primitives::Aabb,
         render_phase::{
             AddRenderCommand, BinnedRenderPhaseType, DrawFunctions, InputUniformIndex, PhaseItem,
             RenderCommand, RenderCommandResult, SetItemPipeline, TrackedRenderPass,
@@ -31,7 +34,7 @@ use bevy::{
             Variants, VertexAttribute, VertexFormat, VertexState, VertexStepMode,
         },
         renderer::{RenderDevice, RenderQueue},
-        view::{self, ExtractedView, RenderVisibleEntities, VisibilityClass},
+        view::{ExtractedView, RenderVisibleEntities},
         Render, RenderApp, RenderSystems,
     },
 };
```

### examples/3d/transmission.rs (+3/-5)
简化了高级渲染效果的导入结构：
```diff
 use bevy::{
+    camera::{Exposure, ScreenSpaceTransmissionQuality},
     color::palettes::css::*,
-    core_pipeline::{
-        bloom::Bloom, core_3d::ScreenSpaceTransmissionQuality, prepass::DepthPrepass,
-        tonemapping::Tonemapping,
-    },
+    core_pipeline::{bloom::Bloom, prepass::DepthPrepass, tonemapping::Tonemapping},
     math::ops,
     pbr::{NotShadowCaster, PointLightShadowMap, TransmittedShadowReceiver},
     prelude::*,
     render::{
-        camera::{Exposure, TemporalJitter},
+        camera::TemporalJitter,
         view::{ColorGrading, ColorGradingGlobal, Hdr},
     },
 };
```

### examples/tools/scene_viewer/main.rs (+2/-4)
优化了场景查看工具的导入语句：
```diff
 use bevy::{
     asset::UnapprovedPathMode,
+    camera::primitives::{Aabb, Sphere},
     core_pipeline::prepass::{DeferredPrepass, DepthPrepass},
     pbr::DefaultOpaqueRendererMethod,
     prelude::*,
-    render::{
-        experimental::occlusion_culling::OcclusionCulling,
-        primitives::{Aabb, Sphere},
-    },
+    render::experimental::occlusion_culling::OcclusionCulling,
 };
```

## Further Reading
- [Bevy模块系统文档](https://bevyengine.org/learn/book/getting-started/modules/)
- [Rust API Guidelines - 模块结构](https://rust-lang.github.io/api-guidelines/naming.html#modules-are-named-after-their-primary-type-c-module)
- [Rust Re-exports最佳实践](https://doc.rust-lang.org/reference/items/use-declarations.html#use-visibility)