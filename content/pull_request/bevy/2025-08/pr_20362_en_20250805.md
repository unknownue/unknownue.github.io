+++
title = "#20362 Use the default directional light intensity constant"
date = "2025-08-05T00:00:00"
draft = false
template = "pull_request_page.html"
in_search_index = true

[taxonomies]
list_display = ["show"]

[extra]
current_language = "en"
available_languages = {"en" = { name = "English", url = "/pull_request/bevy/2025-08/pr-20362-en-20250805" }, "zh-cn" = { name = "中文", url = "/pull_request/bevy/2025-08/pr-20362-zh-cn-20250805" }}
labels = ["A-Rendering"]
+++

# Use the default directional light intensity constant

## Basic Information
- **Title**: Use the default directional light intensity constant
- **PR Link**: https://github.com/bevyengine/bevy/pull/20362
- **Author**: atlv24
- **Status**: MERGED
- **Labels**: A-Rendering, S-Ready-For-Final-Review
- **Created**: 2025-08-01T01:12:44Z
- **Merged**: 2025-08-05T19:40:28Z
- **Merged By**: alice-i-cecile

## Description Translation
# Objective

- Pressing L twice to cycle light type in shadow_biases ends up with a different brightness of light

## Solution

- Use the correct default so the brightness matches

## Testing

- run shadow_biases example

## The Story of This Pull Request

The `shadow_biases` example in Bevy allows users to cycle between different light types using the 'L' key. However, users observed an inconsistency: after cycling through light types and returning to directional light, the brightness didn't match the initial directional light's intensity. 

The root cause was a discrepancy in how the directional light's illuminance was initialized versus how it was reset during cycling. The initial setup correctly used Bevy's predefined constant for daylight illuminance (`light_consts::lux::AMBIENT_DAYLIGHT`), but the toggle logic used a hard-coded value (100000.0). While numerically identical, this duplication created a maintenance risk and caused visual inconsistency if the default constant ever changed.

The solution replaces the hard-coded value in the toggle logic with the same constant used during initialization. This ensures:
1. Consistent brightness between initial and cycled states
2. Automatic updates if the default illuminance changes
3. Elimination of magic numbers in favor of documented constants

The change demonstrates an important principle: using centralized constants instead of hard-coded values ensures consistency and maintainability. The fix was verified by running the example and confirming consistent light intensity after cycling.

## Key Files Changed

### `examples/3d/shadow_biases.rs`

**Change Description**:  
Replaced hard-coded illuminance value with Bevy's default directional light constant to ensure consistent brightness when cycling light types.

**Code Snippet**:  
```rust
// Before:
for mut light in &mut directional_lights {
    light.illuminance = if light.illuminance == 0.0 {
        *writer.text(*example_text, 4) = "DirectionalLight".to_string();
        100000.0  // Hard-coded value
    } else {
        0.0
    };
}

// After:
for mut light in &mut directional_lights {
    light.illuminance = if light.illuminance == 0.0 {
        *writer.text(*example_text, 4) = "DirectionalLight".to_string();
        light_consts::lux::AMBIENT_DAYLIGHT  // Default constant
    } else {
        0.0
    };
}
```

**Relation to PR Purpose**:  
This single-line change directly fixes the brightness inconsistency by aligning the toggle behavior with Bevy's lighting standards.

## Further Reading
- [Bevy Lighting Constants](https://docs.rs/bevy/latest/bevy/pbr/light_consts/lux/index.html)
- [Bevy Directional Light Documentation](https://docs.rs/bevy/latest/bevy/pbr/struct.DirectionalLight.html)
- [Original Light Constants Implementation](https://github.com/bevyengine/bevy/blob/main/crates/bevy_pbr/src/light_consts.rs)

# Full Code Diff
```diff
diff --git a/examples/3d/shadow_biases.rs b/examples/3d/shadow_biases.rs
index afd469affff54..0f0ff5d295a79 100644
--- a/examples/3d/shadow_biases.rs
+++ b/examples/3d/shadow_biases.rs
@@ -160,7 +160,7 @@ fn toggle_light(
         for mut light in &mut directional_lights {
             light.illuminance = if light.illuminance == 0.0 {
                 *writer.text(*example_text, 4) = "DirectionalLight".to_string();
-                100000.0
+                light_consts::lux::AMBIENT_DAYLIGHT
             } else {
                 0.0
             };
```