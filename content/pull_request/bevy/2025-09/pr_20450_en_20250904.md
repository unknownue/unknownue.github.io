+++
title = "#20450 `from_` constructors on `TextFont` with `From` impls"
date = "2025-09-04T00:00:00"
draft = false
template = "pull_request_page.html"
in_search_index = true

[taxonomies]
list_display = ["show"]

[extra]
current_language = "en"
available_languages = {"en" = { name = "English", url = "/pull_request/bevy/2025-09/pr-20450-en-20250904" }, "zh-cn" = { name = "中文", url = "/pull_request/bevy/2025-09/pr-20450-zh-cn-20250904" }}
labels = ["D-Trivial", "A-UI", "C-Code-Quality", "C-Usability", "A-Text"]
+++

# Title

## Basic Information
- **Title**: `from_` constructors on `TextFont` with `From` impls 
- **PR Link**: https://github.com/bevyengine/bevy/pull/20450
- **Author**: amedoeyes
- **Status**: MERGED
- **Labels**: D-Trivial, A-UI, C-Code-Quality, C-Usability, S-Ready-For-Final-Review, M-Needs-Migration-Guide, A-Text
- **Created**: 2025-08-07T09:16:13Z
- **Merged**: 2025-09-04T20:24:27Z
- **Merged By**: alice-i-cecile

## Description Translation
# Objective

- Closes #20353

## Solution

- Removed `TextFont::from_font` and `TextFont::from_line_height`.
- Updated `examples/testbed/2d.rs` to use the `From` impl.
- Added migration guide.

## The Story of This Pull Request

This PR addresses a straightforward but important code quality improvement in Bevy's text rendering system. The core issue was that the `TextFont` struct had redundant constructor methods that duplicated functionality already provided by Rust's standard `From` trait implementations.

The problem stemmed from having multiple ways to achieve the same result. Developers could either use the specialized `TextFont::from_font()` and `TextFont::from_line_height()` constructors, or they could use the more idiomatic `TextFont::from()` approach. This redundancy created unnecessary API surface area and violated the principle of having one clear way to do things.

The solution was simple and effective: remove the redundant constructor methods and rely exclusively on the `From` trait implementations that were already available. This approach follows Rust's established conventions where types implement `From<T>` for conversion operations, making the API more consistent and predictable for developers familiar with Rust patterns.

The implementation involved three key changes. First, the two redundant constructor methods were removed from the `TextFont` implementation in `crates/bevy_text/src/text.rs`:

```rust
// Before:
pub fn from_font(font: Handle<Font>) -> Self {
    Self::default().with_font(font)
}

pub fn from_line_height(line_height: LineHeight) -> Self {
    Self::default().with_line_height(line_height)
}

// After: (methods removed)
```

Second, the example code in `examples/testbed/2d.rs` was updated to demonstrate the preferred approach:

```rust
// Before:
let sans_serif = TextFont::from_font(asset_server.load("fonts/FiraSans-Bold.ttf"));

// After:
let sans_serif = TextFont::from(asset_server.load("fonts/FiraSans-Bold.ttf"));
```

Third, and crucially for a breaking change, a migration guide was added to help users transition from the old API to the new one. The guide provides clear before-and-after code examples:

```rust
// 0.16
let text_font = TextFont::from_font(font_handle);
let text_font = TextFont::from_line_height(line_height);

// 0.17
let text_font = TextFont::from(font_handle);
let text_font = TextFont::from(line_height);
```

This change improves the codebase in several ways. It reduces the API surface area, making the codebase easier to maintain and document. It follows Rust's established conventions, making the API more intuitive for experienced Rust developers. The migration is straightforward and mechanical, minimizing disruption for existing users.

The technical insight here is that when designing Rust APIs, it's generally better to leverage standard traits like `From` and `Into` rather than creating custom constructor methods for type conversions. This approach creates more consistent and interoperable APIs across the ecosystem.

## Visual Representation

```mermaid
graph TD
    A[TextFont Struct] --> B[From<Handle<Font>> impl]
    A --> C[From<LineHeight> impl]
    D[Old API] -.->|Removed| E[from_font()]
    D -.->|Removed| F[from_line_height()]
    B --> G[New Preferred Usage]
    C --> G
```

## Key Files Changed

### `crates/bevy_text/src/text.rs` (+0/-10)
This file contained the core implementation changes where the redundant constructor methods were removed.

**Key changes:**
```rust
// Removed methods:
pub fn from_font(font: Handle<Font>) -> Self {
    Self::default().with_font(font)
}

pub fn from_line_height(line_height: LineHeight) -> Self {
    Self::default().with_line_height(line_height)
}
```

### `examples/testbed/2d.rs` (+1/-1)
This example file was updated to demonstrate the new preferred usage pattern.

**Key change:**
```rust
// Before:
let sans_serif = TextFont::from_font(asset_server.load("fonts/FiraSans-Bold.ttf"));

// After:
let sans_serif = TextFont::from(asset_server.load("fonts/FiraSans-Bold.ttf"));
```

### `release-content/migration-guides/remove_text_font_from_constructor_methods.md` (+16/-0)
This new file provides essential migration guidance for users affected by this breaking change.

**Content:**
```markdown
---
title: `TextFont` constructor methods replaced with `From` impls
pull_requests: [20335, 20450]
---

The `TextFont::from_font` and `TextFont::from_line_height` constructor methods have been removed in favor of `From` trait implementations.

```rust
// 0.16
let text_font = TextFont::from_font(font_handle);
let text_font = TextFont::from_line_height(line_height);

// 0.17
let text_font = TextFont::from(font_handle);
let text_font = TextFont::from(line_height);
```
```

## Further Reading

- [Rust `From` and `Into` traits documentation](https://doc.rust-lang.org/std/convert/trait.From.html)
- [Rust API Guidelines on conversions](https://rust-lang.github.io/api-guidelines/interoperability.html#conversions-use-the-standard-traits-from-into-asref-asmut-c-conv)
- [Bevy Engine documentation on text rendering](https://bevyengine.org/learn/books/introduction/2d-rendering/text/)