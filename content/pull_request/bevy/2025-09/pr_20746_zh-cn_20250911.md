+++
title = "#20746 Bump actions/upload-pages-artifact from 3 to 4"
date = "2025-09-11T00:00:00"
draft = false
template = "pull_request_page.html"
in_search_index = false

[extra]
current_language = "zh-cn"
available_languages = {"en" = { name = "English", url = "/pull_request/bevy/2025-09/pr-20746-en-20250911" }, "zh-cn" = { name = "中文", url = "/pull_request/bevy/2025-09/pr-20746-zh-cn-20250911" }}
+++

# Bump actions/upload-pages-artifact from 3 to 4

## 基本信息
- **标题**: Bump actions/upload-pages-artifact from 3 to 4
- **PR链接**: https://github.com/bevyengine/bevy/pull/20746
- **作者**: app/dependabot
- **状态**: 已合并
- **标签**: D-琐碎, A-构建系统, C-依赖项, S-准备最终审核
- **创建时间**: 2025-08-25T10:21:12Z
- **合并时间**: 2025-09-11T19:44:08Z
- **合并者**: alice-i-cecile

## 描述翻译
将 [actions/upload-pages-artifact](https://github.com/actions/upload-pages-artifact) 从版本 3 升级到 4。
<details>
<summary>发布说明</summary>
<p><em>来源：<a href="https://github.com/actions/upload-pages-artifact/releases">actions/upload-pages-artifact 的发布页面</a>。</em></p>
<blockquote>
<h2>v4.0.0</h2>
<h2>变更内容</h2>
<ul>
<li>潜在的重大变更：隐藏文件（特别是点文件）将不会包含在制品中，由 <a href="https://github.com/tsusdere"><code>@​tsusdere</code></a> 在 <a href="https://redirect.github.com/actions/upload-pages-artifact/pull/102">actions/upload-pages-artifact#102</a> 中提交
如果您需要在制品中包含点文件：不要使用此 action，而是根据这些要求创建您自己的制品 <a href="https://github.com/actions/upload-pages-artifact?tab=readme-ov-file#artifact-validation">https://github.com/actions/upload-pages-artifact?tab=readme-ov-file#artifact-validation</a></li>
<li>将 <code>actions/upload-artifact</code> 固定到 SHA，由 <a href="https://github.com/heavymachinery"><code>@​heavymachinery</code></a> 在 <a href="https://redirect.github.com/actions/upload-pages-artifact/pull/127">actions/upload-pages-artifact#127</a> 中提交</li>
</ul>
<p><strong>完整变更日志</strong>: <a href="https://github.com/actions/upload-pages-artifact/compare/v3.0.1...v4.0.0">https://github.com/actions/upload-pages-artifact/compare/v3.0.1...v4.0.0</a></p>
<h2>v3.0.1</h2>
<h1>变更日志</h1>
<ul>
<li>对 tar 的输出进行分组以防止其干扰 action 日志 <a href="https://github.com/SilverRainZ"><code>@​SilverRainZ</code></a> (<a href="https://redirect.github.com/actions/upload-pages-artifact/issues/94">#94</a>)</li>
<li>更新 README.md <a href="https://github.com/uiolee"><code>@​uiolee</code></a> (<a href="https://redirect.github.com/actions/upload-pages-artifact/issues/88">#88</a>)</li>
<li>将非破坏性变更组更新一次 <a href="https://github.com/dependabot"><code>@​dependabot</code></a> (<a href="https://redirect.github.com/actions/upload-pages-artifact/issues/92">#92</a>)</li>
<li>更新 Dependabot 配置以分组非破坏性变更 <a href="https://github.com/JamesMGreene"><code>@​JamesMGreene</code></a> (<a href="https://redirect.github.com/actions/upload-pages-artifact/issues/91">#91</a>)</li>
<li>将 actions/checkout 从版本 3 升级到 4 <a href="https://github.com/dependabot"><code>@​dependabot</code></a> (<a href="https://redirect.github.com/actions/upload-pages-artifact/issues/76">#76</a>)</li>
</ul>
<p>查看自上一版本以来<a href="https://github.com/actions/upload-pages-artifact/compare/v3.0.0...v3.0.1">所有代码变更的详细信息</a>。</p>
</blockquote>
</details>
<details>
<summary>提交</summary>
<ul>
<li><a href="https://github.com/actions/upload-pages-artifact/commit/7b1f4a764d45c48632c6b24a0339c27f5614fb0b"><code>7b1f4a7</code></a> 合并拉取请求 <a href="https://redirect.github.com/actions/upload-pages-artifact/issues/127">#127</a> 来自 heavymachinery/pin-sha</li>
<li><a href="https://github.com/actions/upload-pages-artifact/commit/4cc19c7d3f3e6c87c68366501382a03c8b1ba6db"><code>4cc19c7</code></a> 将 <code>actions/upload-artifact</code> 固定到 SHA</li>
<li><a href="https://github.com/actions/upload-pages-artifact/commit/2d163be3ddce01512f3eea7ac5b7023b5d643ce1"><code>2d163be</code></a> 合并拉取请求 <a href="https://redirect.github.com/actions/upload-pages-artifact/issues/107">#107</a> 来自 KittyChiu/main</li>
<li><a href="https://github.com/actions/upload-pages-artifact/commit/c70484322b1c476728dcd37fac23c4dea2a0c51a"><code>c704843</code></a> 修复：整理了 README</li>
<li><a href="https://github.com/actions/upload-pages-artifact/commit/9605915f1d2fc79418cdce4d5fbe80511c457655"><code>9605915</code></a> 合并拉取请求 <a href="https://redirect.github.com/actions/upload-pages-artifact/issues/106">#106</a> 来自 KittyChiu/kittychiu/update-readme-1</li>
<li><a href="https://github.com/actions/upload-pages-artifact/commit/e59cdfe6d6b061aab8f0619e759cded914f3ab03"><code>e59cdfe</code></a> 更新 README.md</li>
<li><a href="https://github.com/actions/upload-pages-artifact/commit/a2d67043267d885050434d297d3dd3a3a14fd899"><code>a2d6704</code></a> 文档：更新了 README 中的使用部分</li>
<li><a href="https://github.com/actions/upload-pages-artifact/commit/984864e7b70fb5cb764344dc9c4b5c087662ef50"><code>984864e</code></a> 合并拉取请求 <a href="https://redirect.github.com/actions/upload-pages-artifact/issues/105">#105</a> 来自 actions/Jcambass-patch-1</li>
<li><a href="https://github.com/actions/upload-pages-artifact/commit/45dc78884ca148c05eddcd8ac0a804d3365e9014"><code>45dc788</code></a> 添加用于发布版本到不可变 action 包的工作流文件</li>
<li><a href="https://github.com/actions/upload-pages-artifact/commit/efaad07812d4b9ad2e8667cd46426fdfb7c22e22"><code>efaad07</code></a> 合并拉取请求 <a href="https://redirect.github.com/actions/upload-pages-artifact/issues/102">#102</a> 来自 actions/hidden-files</li>
<li>其他提交可在 <a href="https://github.com/actions/upload-pages-artifact/compare/v3...v4">比较视图</a> 中查看</li>
</ul>
</details>
<br />


[![Dependabot 兼容性评分](https://dependabot-badges.githubapp.com/badges/compatibility_score?dependency-name=actions/upload-pages-artifact&package-manager=github_actions&previous-version=3&new-version=4)](https://docs.github.com/en/github/managing-security-vulnerabilities/about-dependabot-security-updates#about-compatibility-scores)

只要您不自行修改，Dependabot 将解决此 PR 的任何冲突。您也可以通过评论 `@dependabot rebase` 手动触发变基。

[//]: # (dependabot-automerge-start)
[//]: # (dependabot-automerge-end)

---

<details>
<summary>Dependabot 命令和选项</summary>
<br />

您可以通过评论此 PR 来触发 Dependabot 操作：
- `@dependabot rebase` 将变基此 PR
- `@dependabot recreate` 将重新创建此 PR，覆盖已对其进行的任何编辑
- `@dependabot merge` 将在 CI 通过后合并此 PR
- `@dependabot squash and merge` 将在 CI 通过后压缩并合并此 PR
- `@dependabot cancel merge` 将取消先前请求的合并并阻止自动合并
- `@dependabot reopen` 将重新打开此 PR（如果已关闭）
- `@dependabot close` 将关闭此 PR 并停止 Dependabot 重新创建它。您可以通过手动关闭它来实现相同的结果
- `@dependabot show <dependency name> ignore conditions` 将显示指定依赖项的所有忽略条件
- `@dependabot ignore this major version` 将关闭此 PR 并停止 Dependabot 为此主要版本创建更多 PR（除非您重新打开 PR 或自行升级到该版本）
- `@dependabot ignore this minor version` 将关闭此 PR 并停止 Dependabot 为此次要版本创建更多 PR（除非您重新打开 PR 或自行升级到该版本）
- `@dependabot ignore this dependency` 将关闭此 PR 并停止 Dependabot 为此依赖项创建更多 PR（除非您重新打开 PR 或自行升级到该版本）


</details>

## 这个拉取请求的故事

这是一个由 Dependabot 自动生成的依赖项更新 PR，目的是将 GitHub Actions 工作流中使用的 `actions/upload-pages-artifact` 从版本 3 升级到版本 4。

### 问题背景
在软件开发项目中，保持依赖项的最新状态是维护工作的重要部分。GitHub Actions 是 Bevy 项目持续集成/持续部署（CI/CD）流程的核心组成部分，而 `actions/upload-pages-artifact` 是用于将文档制品上传到 GitHub Pages 的关键 action。

依赖项过时可能会带来安全风险、性能问题或功能缺失。Dependabot 作为自动化工具，定期检查项目依赖项并创建 PR 来更新它们，确保项目使用最新、最安全的版本。

### 解决方案方法
这个 PR 采用了最直接的方法：简单地将 action 的版本引用从 `v3` 更新为 `v4`。对于这种类型的基础设施依赖项更新，通常不需要复杂的迁移策略，除非新版本引入了破坏性变更。

从发布说明可以看出，v4.0.0 有一个潜在的重大变更：不再包含隐藏文件（特别是点文件）。不过这对 Bevy 项目的影响应该很小，因为他们上传的是 Rust 文档生成的 `target/doc` 目录，这个目录通常不包含点文件。

### 实施细节
变更非常简单，只涉及一个文件中的一行代码：

```yaml
# 文件: .github/workflows/docs.yml
# 之前:
uses: actions/upload-pages-artifact@v3

# 之后:
uses: actions/upload-pages-artifact@v4
```

这个变更发生在 GitHub Actions 工作流文件中，具体是在文档构建和部署流程中的"Upload site artifact"步骤。

### 技术洞察
这个更新带来了几个好处：

1. **安全性改进**：v4 版本将 `actions/upload-artifact` 依赖固定到特定的 SHA，这提高了 action 的安全性和确定性，避免了潜在的中间人攻击或意外变更。

2. **行为一致性**：隐藏文件处理的一致性能避免潜在的构建问题，虽然对当前项目影响不大。

3. **维护性**：使用最新版本可以确保获得最新的错误修复和性能改进。

### 影响评估
这个变更对 Bevy 项目的直接影响很小：
- 构建和部署流程应该继续正常工作
- 文档生成和上传过程不会受到负面影响
- 没有引入新的依赖项或复杂性

兼容性评分显示这次更新具有高度兼容性，进一步降低了引入问题的风险。

## 可视化表示

```mermaid
graph LR
    A[CI/CD 工作流] --> B[构建文档]
    B --> C[上传制品]
    C --> D[actions/upload-pages-artifact@v4]
    D --> E[GitHub Pages 部署]
```

## 关键文件更改

### .github/workflows/docs.yml
这个文件包含了 Bevy 项目文档构建和部署的 GitHub Actions 工作流配置。变更将 `actions/upload-pages-artifact` 的版本从 v3 升级到 v4。

**变更前:**
```yaml
- name: Upload site artifact
  uses: actions/upload-pages-artifact@v3
  with:
    path: target/doc
```

**变更后:**
```yaml
- name: Upload site artifact
  uses: actions/upload-pages-artifact@v4
  with:
    path: target/doc
```

这个变更确保了文档部署流程使用最新版本的上传工具，获得了安全性和稳定性的改进。

## 扩展阅读

- [GitHub Actions 官方文档](https://docs.github.com/en/actions)
- [actions/upload-pages-artifact 仓库](https://github.com/actions/upload-pages-artifact)
- [Dependabot 文档](https://docs.github.com/en/code-security/dependabot)
- [GitHub Pages 部署指南](https://docs.github.com/en/pages)

# 完整代码差异

```diff
diff --git a/.github/workflows/docs.yml b/.github/workflows/docs.yml
index a5cced1c9ac96..badb5c8e9650b 100644
--- a/.github/workflows/docs.yml
+++ b/.github/workflows/docs.yml
@@ -87,7 +87,7 @@ jobs:
           rm target/doc/.lock
 
       - name: Upload site artifact
-        uses: actions/upload-pages-artifact@v3
+        uses: actions/upload-pages-artifact@v4
         with:
           path: target/doc
```