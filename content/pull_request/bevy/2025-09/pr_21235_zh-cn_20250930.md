+++
title = "#21235 easy screenshot plugin"
date = "2025-09-30T00:00:00"
draft = false
template = "pull_request_page.html"
in_search_index = false

[extra]
current_language = "zh-cn"
available_languages = {"en" = { name = "English", url = "/pull_request/bevy/2025-09/pr-21235-en-20250930" }, "zh-cn" = { name = "ä¸­æ–‡", url = "/pull_request/bevy/2025-09/pr-21235-zh-cn-20250930" }}
labels = ["C-Feature", "A-Meta", "A-Dev-Tools"]
+++

# Title
## Basic Information
- **Title**: easy screenshot plugin  
- **PR Link**: https://github.com/bevyengine/bevy/pull/21235  
- **Author**: mockersf  
- **Status**: MERGED  
- **Labels**: C-Feature, A-Meta, S-Ready-For-Final-Review, A-Dev-Tools  
- **Created**: 2025-09-26T22:00:29Z  
- **Merged**: 2025-09-29T23:57:28Z  
- **Merged By**: alice-i-cecile  

## Description Translation
# ç›®æ ‡

- ä½œä¸º https://github.com/bevyengine/bevy-website/issues/2253 çš„ä¸€éƒ¨åˆ†
- æä¾›ä¸€ä¸ªç®€å•çš„æˆªå›¾è®¾ç½®

## è§£å†³æ–¹æ¡ˆ

- åœ¨å¼€å‘å·¥å…·ä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„ `EasyScreenshotPlugin`

## æµ‹è¯•

- æ·»åŠ åˆ°ä»»æ„ç¤ºä¾‹ä¸­
```
        .add_plugins(bevy::dev_tools::EasyScreenshotPlugin {
            trigger: KeyCode::KeyP,
            ..default()
        })
```
- å¯ç”¨ `bevy_dev_tools` åŠŸèƒ½è¿è¡Œç¤ºä¾‹
- æŒ‰ä¸‹ P é”®
- æˆªå›¾ï¼ğŸ‰

## The Story of This Pull Request

è¿™ä¸ªPRè§£å†³äº†ä¸€ä¸ªå®é™…çš„å¼€å‘éœ€æ±‚ï¼šä¸ºBevyå¼•æ“æä¾›ç®€å•æ˜“ç”¨çš„æˆªå›¾åŠŸèƒ½ã€‚åœ¨æ¸¸æˆå¼€å‘å’Œå¼•æ“æµ‹è¯•è¿‡ç¨‹ä¸­ï¼Œå¼€å‘è€…ç»å¸¸éœ€è¦å¿«é€Ÿæˆªå–å±å¹•ç”»é¢ï¼Œä½†ä¹‹å‰éœ€è¦æ‰‹åŠ¨ç¼–å†™ä»£ç æ¥å®ç°è¿™ä¸ªåŠŸèƒ½ã€‚

å¼€å‘è€…é¢ä¸´çš„æ ¸å¿ƒé—®é¢˜æ˜¯ç¼ºå°‘ä¸€ä¸ªå¼€ç®±å³ç”¨çš„æˆªå›¾è§£å†³æ–¹æ¡ˆã€‚æ¯æ¬¡éœ€è¦æˆªå›¾æ—¶ï¼Œå¼€å‘è€…éƒ½è¦é‡æ–°å®ç°æˆªå›¾é€»è¾‘ï¼Œè¿™å¢åŠ äº†å¼€å‘è´Ÿæ‹…å¹¶é™ä½äº†æ•ˆç‡ã€‚è¿™ä¸ªPRé€šè¿‡åˆ›å»ºä¸€ä¸ªä¸“é—¨çš„æ’ä»¶æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œè®©æˆªå›¾åŠŸèƒ½å˜å¾—ç®€å•æ˜“ç”¨ã€‚

æŠ€æœ¯å®ç°ä¸Šï¼Œè¿™ä¸ªæ’ä»¶é‡‡ç”¨äº†Bevyçš„æ ‡å‡†æ’ä»¶æ¶æ„ã€‚`EasyScreenshotPlugin` ç»“æ„ä½“å…è®¸é…ç½®è§¦å‘æŒ‰é”®å’Œå›¾ç‰‡æ ¼å¼ï¼Œæä¾›äº†åˆç†çš„é»˜è®¤å€¼ã€‚åœ¨å®ç°ç»†èŠ‚ä¸Šï¼Œæ’ä»¶åˆ©ç”¨äº†Bevyç°æœ‰çš„æˆªå›¾åŸºç¡€è®¾æ–½ï¼Œé€šè¿‡ `Screenshot::primary_window()` è·å–ä¸»çª—å£çš„æˆªå›¾ï¼Œç„¶åä½¿ç”¨ `save_to_disk` å‡½æ•°ä¿å­˜åˆ°æ–‡ä»¶ã€‚

ä¸€ä¸ªå€¼å¾—æ³¨æ„çš„è®¾è®¡é€‰æ‹©æ˜¯ä½¿ç”¨æ—¶é—´æˆ³æ¥ç”Ÿæˆå”¯ä¸€çš„æ–‡ä»¶åï¼Œè¿™é¿å…äº†æ–‡ä»¶è¦†ç›–çš„é—®é¢˜ã€‚æ–‡ä»¶åæ ¼å¼åŒ…å«äº†çª—å£æ ‡é¢˜å’Œæ¯«ç§’çº§æ—¶é—´æˆ³ï¼Œç¡®ä¿äº†æ¯æ¬¡æˆªå›¾éƒ½èƒ½ä¿å­˜ä¸ºä¸åŒçš„æ–‡ä»¶ã€‚

```rust
let since_the_epoch = SystemTime::now()
    .duration_since(UNIX_EPOCH)
    .expect("time should go forward");
```

æ’ä»¶çš„ç³»ç»Ÿåªåœ¨ç‰¹å®šæŒ‰é”®æŒ‰ä¸‹æ—¶è¿è¡Œï¼Œè¿™æ˜¯é€šè¿‡ `input_just_pressed` æ¡ä»¶å®ç°çš„ã€‚è¿™ç§è®¾è®¡æ—¢é«˜æ•ˆåˆç¬¦åˆç”¨æˆ·é¢„æœŸï¼Œä¸ä¼šåœ¨ä¸éœ€è¦æ—¶æ¶ˆè€—ç³»ç»Ÿèµ„æºã€‚

ä»å·¥ç¨‹è§’åº¦çœ‹ï¼Œè¿™ä¸ªå®ç°å±•ç¤ºäº†Bevy ECSç³»ç»Ÿçš„å‡ ä¸ªé‡è¦ç‰¹æ€§ï¼šå‘½ä»¤ç¼“å†²ï¼ˆé€šè¿‡ `Commands` å‚æ•°ï¼‰ã€æŸ¥è¯¢ç³»ç»Ÿï¼ˆé€šè¿‡ `Single<&Window, With<PrimaryWindow>>`ï¼‰å’Œæ¡ä»¶ç³»ç»Ÿæ‰§è¡Œã€‚è¿™äº›éƒ½æ˜¯Bevyå¼€å‘ä¸­çš„æ ‡å‡†æ¨¡å¼ï¼Œä¸ºå…¶ä»–å¼€å‘è€…æä¾›äº†è‰¯å¥½çš„å‚è€ƒç¤ºä¾‹ã€‚

## Visual Representation

```mermaid
graph TD
    A[EasyScreenshotPlugin] --> B[Update System]
    B --> C{Key Press Condition}
    C -->|Trigger Key Pressed| D[Take Screenshot]
    D --> E[Save to Disk]
    E --> F[File with Timestamp]
    
    G[bevy_input] --> C
    H[bevy_render] --> D
    I[bevy_window] --> D
```

## Key Files Changed

### `crates/bevy_dev_tools/src/easy_screenshot.rs` (+67/-0)
è¿™æ˜¯æ–°åˆ›å»ºçš„æ–‡ä»¶ï¼ŒåŒ…å«äº†æˆªå›¾æ’ä»¶çš„å®Œæ•´å®ç°ã€‚

```rust
// ä¸»è¦ä»£ç ç»“æ„ï¼š
pub enum ScreenshotFormat {
    Jpeg,
    Png,
    Bmp,
}

pub struct EasyScreenshotPlugin {
    pub trigger: KeyCode,
    pub format: ScreenshotFormat,
}

impl Plugin for EasyScreenshotPlugin {
    fn build(&self, app: &mut App) {
        // ç³»ç»Ÿæ³¨å†Œé€»è¾‘
    }
}
```

### `crates/bevy_dev_tools/src/lib.rs` (+3/-0)
å¯¼å‡ºæ–°æ¨¡å—å¹¶ä½¿å…¶å¯¹å¤–å¯ç”¨ã€‚

```rust
// ä¿®æ”¹å†…å®¹ï¼š
mod easy_screenshot;
pub use easy_screenshot::*;
```

### `crates/bevy_dev_tools/Cargo.toml` (+1/-0)
æ·»åŠ å¿…è¦çš„è¾“å…¥ç³»ç»Ÿä¾èµ–ã€‚

```toml
# æ–°å¢ä¾èµ–ï¼š
bevy_input = { path = "../bevy_input", version = "0.18.0-dev" }
```

## Further Reading

- [Bevy Plugin System Documentation](https://bevyengine.org/learn/book/getting-started/plugins/)
- [Bevy Input System](https://bevyengine.org/learn/book/getting-started/input/)
- [Bevy ECS Commands](https://bevyengine.org/learn/book/programming/commands/)

# Full Code Diff
diff --git a/crates/bevy_dev_tools/Cargo.toml b/crates/bevy_dev_tools/Cargo.toml
index 14a72cf121d46..8c78426c497fd 100644
--- a/crates/bevy_dev_tools/Cargo.toml
+++ b/crates/bevy_dev_tools/Cargo.toml
@@ -19,6 +19,7 @@ bevy_camera = { path = "../bevy_camera", version = "0.18.0-dev" }
 bevy_color = { path = "../bevy_color", version = "0.18.0-dev" }
 bevy_diagnostic = { path = "../bevy_diagnostic", version = "0.18.0-dev" }
 bevy_ecs = { path = "../bevy_ecs", version = "0.18.0-dev" }
+bevy_input = { path = "../bevy_input", version = "0.18.0-dev" }
 bevy_math = { path = "../bevy_math", version = "0.18.0-dev" }
 bevy_picking = { path = "../bevy_picking", version = "0.18.0-dev" }
 bevy_render = { path = "../bevy_render", version = "0.18.0-dev" }
diff --git a/crates/bevy_dev_tools/src/easy_screenshot.rs b/crates/bevy_dev_tools/src/easy_screenshot.rs
new file mode 100644
index 0000000000000..4bfacf995f261
--- /dev/null
+++ b/crates/bevy_dev_tools/src/easy_screenshot.rs
@@ -0,0 +1,67 @@
+use std::time::{SystemTime, UNIX_EPOCH};
+
+use bevy_app::{App, Plugin, Update};
+use bevy_ecs::prelude::*;
+use bevy_input::{common_conditions::input_just_pressed, keyboard::KeyCode};
+use bevy_render::view::screenshot::{save_to_disk, Screenshot};
+use bevy_window::{PrimaryWindow, Window};
+
+/// File format the screenshot will be saved in
+#[derive(Clone, Copy)]
+pub enum ScreenshotFormat {
+    /// JPEG format
+    Jpeg,
+    /// PNG format
+    Png,
+    /// BMP format
+    Bmp,
+}
+
+/// Add this plugin to your app to enable easy screenshotting.
+///
+/// Add this plugin, press the key, and you have a screenshot ğŸ‰
+pub struct EasyScreenshotPlugin {
+    /// Key that will trigger a screenshot
+    pub trigger: KeyCode,
+    /// Format of the screenshot
+    ///
+    /// The corresponding image format must be supported by bevy renderer
+    pub format: ScreenshotFormat,
+}
+
+impl Default for EasyScreenshotPlugin {
+    fn default() -> Self {
+        EasyScreenshotPlugin {
+            trigger: KeyCode::PrintScreen,
+            format: ScreenshotFormat::Png,
+        }
+    }
+}
+
+impl Plugin for EasyScreenshotPlugin {
+    fn build(&self, app: &mut App) {
+        let format = self.format;
+        app.add_systems(
+            Update,
+            (move |mut commands: Commands, window: Single<&Window, With<PrimaryWindow>>| {
+                let since_the_epoch = SystemTime::now()
+                    .duration_since(UNIX_EPOCH)
+                    .expect("time should go forward");
+
+                commands
+                    .spawn(Screenshot::primary_window())
+                    .observe(save_to_disk(format!(
+                        "{}-{}.{}",
+                        window.title,
+                        since_the_epoch.as_millis(),
+                        match format {
+                            ScreenshotFormat::Jpeg => "jpg",
+                            ScreenshotFormat::Png => "png",
+                            ScreenshotFormat::Bmp => "bmp",
+                        }
+                    )));
+            })
+            .run_if(input_just_pressed(self.trigger)),
+        );
+    }
+}
diff --git a/crates/bevy_dev_tools/src/lib.rs b/crates/bevy_dev_tools/src/lib.rs
index 8efea87f0007c..dd1e33363be7d 100644
--- a/crates/bevy_dev_tools/src/lib.rs
+++ b/crates/bevy_dev_tools/src/lib.rs
@@ -13,6 +13,7 @@ use bevy_app::prelude::*;
 #[cfg(feature = "bevy_ci_testing")]
 pub mod ci_testing;
 
+mod easy_screenshot;
 pub mod fps_overlay;
 pub mod frame_time_graph;
 
@@ -20,6 +21,8 @@ pub mod picking_debug;
 
 pub mod states;
 
+pub use easy_screenshot::*;
+
 /// Enables developer tools in an [`App`]. This plugin is added automatically with `bevy_dev_tools`
 /// feature.
 ///