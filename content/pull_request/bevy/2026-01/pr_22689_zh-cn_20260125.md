+++
title = "#22689 Fix dlss for real this time :/"
date = "2026-01-25T00:00:00"
draft = false
template = "pull_request_page.html"
in_search_index = false

[extra]
current_language = "zh-cn"
available_languages = {"en" = { name = "English", url = "/pull_request/bevy/2026-01/pr-22689-en-20260125" }, "zh-cn" = { name = "ä¸­æ–‡", url = "/pull_request/bevy/2026-01/pr-22689-zh-cn-20260125" }}
+++

# Fix dlss for real this time :/

## Basic Information
- **æ ‡é¢˜**: Fix dlss for real this time :/
- **PR é“¾æ¥**: https://github.com/bevyengine/bevy/pull/22689
- **ä½œè€…**: atlv24
- **çŠ¶æ€**: å·²åˆå¹¶
- **æ ‡ç­¾**: D-Trivial, A-Rendering, S-Ready-For-Final-Review
- **åˆ›å»ºæ—¶é—´**: 2026-01-25T02:02:27Z
- **åˆå¹¶æ—¶é—´**: 2026-01-25T04:11:19Z
- **åˆå¹¶äºº**: alice-i-cecile

## æè¿°ç¿»è¯‘
#22688 ä¹Ÿæ˜¯é”™è¯¯çš„ï¼Œæˆ‘ä»¬éœ€è¦æŒç»­é›†æˆ ğŸ˜µâ€ğŸ’«

## æœ¬æ¬¡ Pull Request çš„æŠ€æœ¯æ•…äº‹

è¿™æ¬¡ PR æ˜¯ä¸€ä¸ªå…¸å‹çš„å¯¼å…¥è·¯å¾„ä¿®å¤æ¡ˆä¾‹ã€‚å¼€å‘è€…å‘ç°ä¹‹å‰çš„ä¿®å¤å°è¯• (#22688) ä»ç„¶å­˜åœ¨é—®é¢˜ï¼Œé—®é¢˜çš„æ ¸å¿ƒæ˜¯ DLSS æ¨¡å—ä¸­ä½¿ç”¨äº†é”™è¯¯çš„ `Hdr` ç»„ä»¶å¯¼å…¥è·¯å¾„ã€‚

åœ¨ä¿®æ”¹ä¹‹å‰ï¼Œ`dlss/mod.rs` ä» `bevy_render::camera` æ¨¡å—å¯¼å…¥äº† `Hdr` ç±»å‹ã€‚ç„¶è€Œï¼Œç»è¿‡ä»£ç é‡æ„æˆ–æ¨¡å—é‡ç»„åï¼Œ`Hdr` ç»„ä»¶çš„æ­£ç¡®å®šä¹‰å®é™…ä¸Šä½äº `bevy_camera` crate ä¸­ã€‚`bevy_render` å¯èƒ½åªæ˜¯é‡æ–°å¯¼å‡ºäº†è¿™ä¸ªç±»å‹ï¼Œä½†è¿™ç§é—´æ¥ä¾èµ–å¯èƒ½ä¼šå¯¼è‡´ç¼–è¯‘é—®é¢˜æˆ–è€…æ½œåœ¨çš„ç‰ˆæœ¬ä¸ä¸€è‡´é—®é¢˜ã€‚

ä¿®å¤çš„æ–¹æ³•å¾ˆç›´æ¥ï¼šå°† `Hdr` çš„å¯¼å…¥ä» `bevy_render::camera` æ”¹ä¸ºç›´æ¥ä»å®šä¹‰å®ƒçš„ crate `bevy_camera` å¯¼å…¥ã€‚åŒæ—¶ï¼Œä¿ç•™ä» `bevy_render::camera` å¯¼å…¥çš„å…¶ä»–ç±»å‹ï¼ˆ`MipBias` å’Œ `TemporalJitter`ï¼‰ï¼Œå› ä¸ºè¿™äº›ç±»å‹å¯èƒ½ä»ç„¶æ˜¯æ­£ç¡®é€šè¿‡è¯¥è·¯å¾„å¯¼å‡ºçš„ã€‚

ä»æŠ€æœ¯è§’åº¦çœ‹ï¼Œè¿™ç§ä¿®å¤æœ‰å‡ ä¸ªå¥½å¤„ï¼š

1. **æ¶ˆé™¤æ½œåœ¨çš„ç±»å‹æ··æ·†**ï¼šç›´æ¥ä»å®šä¹‰crateå¯¼å…¥ç¡®ä¿ä½¿ç”¨çš„æ˜¯æ­£ç¡®çš„ç±»å‹å®šä¹‰ï¼Œé¿å…ç”±äºé‡æ–°å¯¼å‡ºå¯¼è‡´çš„ç‰ˆæœ¬æˆ–è·¯å¾„é—®é¢˜
2. **æé«˜ä»£ç æ¸…æ™°åº¦**ï¼šæ˜ç¡®æ˜¾ç¤ºæ¯ä¸ªç±»å‹çš„æ¥æºï¼Œè®©ä¾èµ–å…³ç³»æ›´åŠ é€æ˜
3. **é¿å…ç¼–è¯‘é”™è¯¯**ï¼šå½“é‡æ–°å¯¼å‡ºè·¯å¾„å‘ç”Ÿå˜åŒ–æˆ–ä¸å†å¯ç”¨æ—¶ï¼Œç›´æ¥å¯¼å…¥å¯ä»¥é˜²æ­¢ç¼–è¯‘ä¸­æ–­

è¿™ä¸ªä¿®å¤è™½ç„¶çœ‹ä¼¼å¾®å°ï¼Œä½†å¯¹äº DLSS åŠŸèƒ½çš„æ­£å¸¸å·¥ä½œæ˜¯å¿…è¦çš„ã€‚DLSS (æ·±åº¦å­¦ä¹ è¶…çº§é‡‡æ ·) æ˜¯ NVIDIA çš„æŠ—é”¯é½¿æŠ€æœ¯ï¼Œéœ€è¦æ­£ç¡®å¤„ç†é«˜åŠ¨æ€èŒƒå›´ (HDR) æ¸²æŸ“æ‰èƒ½æ­£å¸¸å·¥ä½œã€‚å¦‚æœ `Hdr` ç»„ä»¶å¯¼å…¥é”™è¯¯ï¼Œå¯èƒ½å¯¼è‡´ DLSS æ— æ³•æ­£ç¡®è¯†åˆ«æ¸²æŸ“ç®¡é“çš„ HDR çŠ¶æ€ï¼Œä»è€Œå½±å“æŠ—é”¯é½¿æ•ˆæœæˆ–å¯¼è‡´æ¸²æŸ“é”™è¯¯ã€‚

PR æè¿°ä¸­çš„ "we need ci" è¯„è®ºåæ˜ äº†è¿™ç±»é—®é¢˜æœ€å¥½é€šè¿‡æŒç»­é›†æˆæµ‹è¯•æ¥é¿å…ã€‚ä¸€ä¸ªå®Œå–„çš„ CI ç³»ç»Ÿå¯ä»¥åœ¨ä»£ç åˆå¹¶å‰æ£€æµ‹åˆ°è¿™ç§å¯¼å…¥é—®é¢˜ï¼Œé˜²æ­¢éœ€è¦å¤šæ¬¡ä¿®å¤ã€‚

## è§†è§‰è¡¨ç¤º

```mermaid
graph TD
    A[bevy_anti_alias/dlssæ¨¡å—] --> B[éœ€è¦ Hdr ç»„ä»¶]
    B --> C{é€‰æ‹©å¯¼å…¥æº}
    C -->|é”™è¯¯è·¯å¾„| D[bevy_render::camera::Hdr]
    C -->|æ­£ç¡®è·¯å¾„| E[bevy_camera::Hdr]
    D --> F[æ½œåœ¨çš„ç±»å‹é—®é¢˜/ç¼–è¯‘é”™è¯¯]
    E --> G[æ­£ç¡®çš„ç±»å‹å¼•ç”¨]
    
    style D fill:#ffcccc
    style E fill:#ccffcc
```

## å…³é”®æ–‡ä»¶å˜æ›´

### `crates/bevy_anti_alias/src/dlss/mod.rs` (+2/-1)

**å˜æ›´æè¿°**: ä¿®æ­£äº† `Hdr` ç»„ä»¶çš„å¯¼å…¥è·¯å¾„ï¼Œä»é—´æ¥çš„ `bevy_render::camera` è·¯å¾„æ”¹ä¸ºç›´æ¥çš„ `bevy_camera` è·¯å¾„ã€‚

**ä»£ç å˜æ›´**:
```rust
// æ–‡ä»¶: crates/bevy_anti_alias/src/dlss/mod.rs
// å˜æ›´å‰:
use bevy_render::camera::{Hdr, MipBias, TemporalJitter};

// å˜æ›´å:
use bevy_camera::Hdr;
use bevy_render::camera::{MipBias, TemporalJitter};
```

**ä¸ PR ç›®çš„çš„å…³ç³»**: è¿™ä¸ªä¿®æ”¹æ˜¯æœ¬æ¬¡ PR çš„æ ¸å¿ƒï¼Œç¡®ä¿ DLSS æ¨¡å—ä½¿ç”¨æ­£ç¡®æ¥æºçš„ `Hdr` ç»„ä»¶ï¼Œé¿å…æ½œåœ¨çš„ç¼–è¯‘é—®é¢˜æˆ–è¿è¡Œæ—¶é”™è¯¯ã€‚

## æ‰©å±•é˜…è¯»

- [Bevy ç›¸æœºç³»ç»Ÿæ–‡æ¡£](https://docs.rs/bevy_camera/latest/bevy_camera/) - äº†è§£ `Hdr` ç»„ä»¶åœ¨ç›¸æœºç³»ç»Ÿä¸­çš„è§’è‰²
- [Rust çš„æ¨¡å—ç³»ç»Ÿä¸å¯¼å…¥æœ€ä½³å®è·µ](https://doc.rust-lang.org/book/ch07-00-managing-growing-projects-with-packages-crates-and-modules.html) - ç†è§£å¦‚ä½•æ­£ç¡®ç»„ç»‡å¯¼å…¥
- [NVIDIA DLSS æŠ€æœ¯æ–‡æ¡£](https://developer.nvidia.com/dlss) - äº†è§£ DLSS æŠ€æœ¯çš„å·¥ä½œåŸç†å’Œè¦æ±‚
- [Bevy æ¸²æŸ“ç®¡çº¿æ¶æ„](https://bevyengine.org/learn/book/development/architecture/) - ç†è§£ Bevy å¼•æ“ä¸­æ¸²æŸ“ç»„ä»¶ä¹‹é—´çš„å…³ç³»

# å®Œæ•´ä»£ç å·®å¼‚
```diff
diff --git a/crates/bevy_anti_alias/src/dlss/mod.rs b/crates/bevy_anti_alias/src/dlss/mod.rs
index 7d97696fd8659..e974d577d5c3d 100644
--- a/crates/bevy_anti_alias/src/dlss/mod.rs
+++ b/crates/bevy_anti_alias/src/dlss/mod.rs
@@ -21,6 +21,7 @@ mod prepare;
 pub use dlss_wgpu::DlssPerfQualityMode;
 
 use bevy_app::{App, Plugin};
+use bevy_camera::Hdr;
 use bevy_core_pipeline::{
     core_3d::graph::{Core3d, Node3d},
     prepass::{DepthPrepass, MotionVectorPrepass},
@@ -29,7 +30,7 @@ use bevy_ecs::prelude::*;
 use bevy_math::{UVec2, Vec2};
 use bevy_reflect::{reflect_remote, Reflect};
 use bevy_render::{
-    camera::{Hdr, MipBias, TemporalJitter},
+    camera::{MipBias, TemporalJitter},
     render_graph::{RenderGraphExt, ViewNodeRunner},
     renderer::{
         raw_vulkan_init::{AdditionalVulkanFeatures, RawVulkanInitSettings},
```