+++
title = "#22429 0.18: Add migration guide for automatic `Aabb` updates"
date = "2026-01-08T00:00:00"
draft = false
template = "pull_request_page.html"
in_search_index = true

[taxonomies]
list_display = ["show"]

[extra]
current_language = "en"
available_languages = {"en" = { name = "English", url = "/pull_request/bevy/2026-01/pr-22429-en-20260108" }, "zh-cn" = { name = "中文", url = "/pull_request/bevy/2026-01/pr-22429-zh-cn-20260108" }}
labels = ["C-Docs", "A-Rendering"]
+++

# Title
## 0.18: Add migration guide for automatic `Aabb` updates

## Basic Information
- **Title**: 0.18: Add migration guide for automatic `Aabb` updates
- **PR Link**: https://github.com/bevyengine/bevy/pull/22429
- **Author**: greeble-dev
- **Status**: MERGED
- **Labels**: C-Docs, A-Rendering, S-Ready-For-Final-Review
- **Created**: 2026-01-08T14:22:42Z
- **Merged**: 2026-01-08T18:40:17Z
- **Merged By**: alice-i-cecile

## Description Translation
Adds migration guide for #18742.

I'm not entirely sure it's necessary, but was implied by https://github.com/bevyengine/bevy/pull/21837#discussion_r2617521376.

## The Story of This Pull Request

This PR documents a behavior change introduced in PR #18742 that affects how Bevy handles Axis-Aligned Bounding Box (AABB) updates for mesh and sprite components. The issue dates back to GitHub issue #4294, where Aabb components weren't being updated when their underlying meshes or sprites were modified.

In Bevy 0.17, when developers modified a mesh or sprite at runtime, the associated Aabb component - which is critical for visibility calculations and picking operations - remained static. This created a discrepancy where the visual representation changed but the bounding volume used for spatial queries didn't. Developers had to implement workarounds by manually removing and recreating the Aabb component to force Bevy to generate a new bounding box from the modified geometry.

The fix in PR #18742 made the Aabb update system reactive to changes in mesh and sprite components. Now when a mesh or sprite is modified, the system automatically recalculates the Aabb to match the new geometry. This eliminates the need for manual workarounds and ensures spatial queries remain accurate when geometry changes.

The migration guide serves a practical purpose: it helps developers identify and remove now-unnecessary workarounds from their codebases. The documentation shows the before-and-after pattern clearly:

- **Before (0.17)**: Developers had to manually remove the Aabb component after modifying a mesh to trigger regeneration
- **After (0.18)**: The Aabb updates automatically when the mesh changes

The guide also documents the new `NoAutoAabb` component, which provides an escape hatch for developers who need explicit control over Aabb creation and updates. This component disables both automatic creation and automatic updating of Aabb components for entities that have it.

This documentation follows the established pattern for Bevy migration guides, which typically explain breaking changes or behavior modifications between versions. The author notes they weren't entirely sure the guide was necessary, but included it based on discussion in another PR review, demonstrating good practice in maintaining comprehensive documentation for API changes.

## Visual Representation

```mermaid
graph TD
    A[Mesh/Sprite Component Modified] --> B{Auto Aabb Enabled?}
    B -->|Yes| C[System Triggers Aabb Recalculation]
    B -->|No (Has NoAutoAabb)| D[Aabb Remains Unchanged]
    C --> E[Updated Aabb Used for Visibility/Picking]
```

## Key Files Changed

**`release-content/migration-guides/automatic_aabb_updates.md` (+28/-0)**

This is a new file created to document the migration from the old manual Aabb update pattern to the new automatic system. The file follows the standard migration guide format and includes:

1. A clear title and reference to the implementing PR
2. Context about the problem in 0.17 and the fix in 0.18
3. Code examples showing the before/after patterns
4. Documentation of the new `NoAutoAabb` component for advanced use cases

The key content of the file:

```markdown
---
title: Automatic `Aabb` updates for sprites and meshes
pull_requests: [18742]
---

Bevy automatically creates an `Aabb` component for entities containing a mesh
or sprite - the `Aabb` is then used for visibility and picking.

In 0.17 the `Aabb` [was not updated](https://github.com/bevyengine/bevy/issues/4294)
if the mesh or sprite was modified. This has been fixed in 0.18. If you were working around the issue by manually updating or removing the
`Aabb`, then the workaround is no longer needed.

```rust
// 0.17: Modify the mesh, and remove the `Aabb` so that it's automatically
// recreated from the modified mesh.
mesh.insert_attribute(Mesh::ATTRIBUTE_POSITION, new_positions);
entity.remove::<Aabb>();

// 0.18: The `Aabb` will be automatically updated.
mesh.insert_attribute(Mesh::ATTRIBUTE_POSITION, new_positions);
```

For users who want more control, 0.18 also adds a `NoAutoAabb` component. This
will disable both automatic creation and automatic update of `Aabb` components.

```rust
entity.insert(NoAutoAabb);
```
```

## Further Reading

1. **PR #18742**: The implementation that introduced automatic Aabb updates (https://github.com/bevyengine/bevy/pull/18742)
2. **Issue #4294**: Original issue documenting the problem with Aabb not updating (https://github.com/bevyengine/bevy/issues/4294)
3. **Bevy ECS and Change Detection**: Understanding how Bevy's ECS detects component changes to trigger systems (https://bevyengine.org/learn/quick-start/ecs/)
4. **Spatial Queries in Bevy**: Documentation on how Aabb components are used for visibility and picking operations (https://bevyengine.org/learn/quick-start/3d/)