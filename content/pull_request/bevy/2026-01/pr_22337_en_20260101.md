+++
title = "#22337 Use toggle function to pause/unpause"
date = "2026-01-01T00:00:00"
draft = false
template = "pull_request_page.html"
in_search_index = true

[taxonomies]
list_display = ["show"]

[extra]
current_language = "en"
available_languages = {"en" = { name = "English", url = "/pull_request/bevy/2026-01/pr-22337-en-20260101" }, "zh-cn" = { name = "中文", url = "/pull_request/bevy/2026-01/pr-22337-zh-cn-20260101" }}
+++

# Title

## Basic Information
- **Title**: Use toggle function to pause/unpause
- **PR Link**: https://github.com/bevyengine/bevy/pull/22337
- **Author**: GitGhillie
- **Status**: MERGED
- **Labels**: None
- **Created**: 2026-01-01T14:34:19Z
- **Merged**: 2026-01-01T17:57:49Z
- **Merged By**: mockersf

## Description Translation
# Objective

Avoid code duplication

## Solution

Use the newly added toggle function

## Testing

Ran the example

## The Story of This Pull Request

This pull request addresses a straightforward code quality issue in Bevy's examples: eliminating duplicated logic for toggling the pause state of virtual time. The changes focus on two example files that demonstrate Bevy's gizmo system in 2D and 3D contexts.

The core problem was that both examples contained identical manual implementations for toggling the pause state. When a user pressed the spacebar, the code would check if the virtual time was currently paused, then either unpause or pause it accordingly. This pattern is common in game engines where developers need to implement pause functionality, but it represents unnecessary code duplication when a dedicated toggle method exists.

The solution leverages a recently added `toggle()` method on the `Time<Virtual>` resource. This method encapsulates the pause/unpause logic in a single, reusable function call. The implementation change is minimal but effective: in both example files, the conditional logic block is replaced with a direct call to `virtual_time.toggle()`.

From an engineering perspective, this change follows the DRY (Don't Repeat Yourself) principle. The original code had several issues: it was verbose, required manual state checking, and duplicated the same logic in multiple places. The new approach is cleaner, more maintainable, and reduces the cognitive load when reading the code. If the toggle logic ever needs to change (for example, to add additional side effects or logging), it can be updated in one place rather than multiple locations.

The technical context involves Bevy's time system, which provides both real and virtual time tracking. Virtual time can be paused, sped up, or slowed down relative to real time, which is useful for debugging, cutscenes, or game mechanics like bullet time. The `Time<Virtual>` resource manages this virtual time state, and the newly added `toggle()` method provides a convenient interface for changing the pause state without requiring the caller to manage the state logic.

This change also serves as a good example for Bevy users. By updating the official examples to use the new `toggle()` method, the PR demonstrates best practices and encourages users to adopt the more concise API in their own code. Examples in a game engine's documentation serve as both teaching tools and reference implementations, so keeping them up-to-date with the latest API improvements is important.

The testing approach was straightforward - running the examples to verify the pause functionality still works correctly. Since the change is essentially a refactoring that doesn't alter behavior, comprehensive testing beyond confirming the examples still compile and run was unnecessary.

## Visual Representation

```mermaid
graph TD
    A[User Presses Spacebar] --> B[Example Code]
    B --> C{Original Implementation}
    C --> D[Check if paused]
    D --> E[If paused: unpause]
    D --> F[If not paused: pause]
    B --> G{New Implementation}
    G --> H[Call toggle() method]
    H --> I[Time<Virtual> Resource]
    I --> J[Encapsulated toggle logic]
```

## Key Files Changed

### `examples/gizmos/2d_gizmos.rs` (+1/-5)
**Change**: Replaced manual pause/unpause toggle logic with a single `toggle()` method call.

**Code Before:**
```rust
if keyboard.just_pressed(KeyCode::Space) {
    if virtual_time.is_paused() {
        virtual_time.unpause();
    } else {
        virtual_time.pause();
    }
}
```

**Code After:**
```rust
if keyboard.just_pressed(KeyCode::Space) {
    virtual_time.toggle();
}
```

**Why this matters**: This change reduces 5 lines of code to 1 line while maintaining identical functionality. The `toggle()` method encapsulates the conditional logic that was previously duplicated in multiple example files.

### `examples/gizmos/3d_gizmos.rs` (+1/-5)
**Change**: Identical change to the 2D example - replaced manual toggle logic with `toggle()` method.

**Code Before:**
```rust
if keyboard.just_pressed(KeyCode::Space) {
    if virtual_time.is_paused() {
        virtual_time.unpause();
    } else {
        virtual_time.pause();
    }
}
```

**Code After:**
```rust
if keyboard.just_pressed(KeyCode::Space) {
    virtual_time.toggle();
}
```

**Why this matters**: This demonstrates consistency across examples. Both 2D and 3D gizmo examples now use the same clean API for toggling pause state, making the codebase more maintainable and providing consistent examples for users to follow.

## Further Reading

1. **Bevy Time System Documentation**: For understanding how virtual time works in Bevy and the available APIs for time manipulation
2. **DRY Principle**: The "Don't Repeat Yourself" principle in software engineering emphasizes reducing repetition in code
3. **Bevy Gizmos**: Documentation on Bevy's gizmo system for debugging and visualization in both 2D and 3D contexts
4. **Refactoring Techniques**: Martin Fowler's refactoring patterns provide guidance on improving code structure without changing behavior

# Full Code Diff
```
diff --git a/examples/gizmos/2d_gizmos.rs b/examples/gizmos/2d_gizmos.rs
index 9f060e6d20c48..50bd46d3b010d 100644
--- a/examples/gizmos/2d_gizmos.rs
+++ b/examples/gizmos/2d_gizmos.rs
@@ -210,10 +210,6 @@ fn update_config(
         };
     }
     if keyboard.just_pressed(KeyCode::Space) {
-        if virtual_time.is_paused() {
-            virtual_time.unpause();
-        } else {
-            virtual_time.pause();
-        }
+        virtual_time.toggle();
     }
 }
diff --git a/examples/gizmos/3d_gizmos.rs b/examples/gizmos/3d_gizmos.rs
index 56478e4fb1c77..aac66225779b8 100644
--- a/examples/gizmos/3d_gizmos.rs
+++ b/examples/gizmos/3d_gizmos.rs
@@ -292,10 +292,6 @@ fn update_config(
         config_store.config_mut::<AabbGizmoConfigGroup>().1.draw_all ^= true;
     }
     if keyboard.just_pressed(KeyCode::Space) {
-        if virtual_time.is_paused() {
-            virtual_time.unpause();
-        } else {
-            virtual_time.pause();
-        }
+        virtual_time.toggle();
     }
 }
```