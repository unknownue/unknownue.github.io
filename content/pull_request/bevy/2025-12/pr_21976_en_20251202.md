+++
title = "#21976 Fix crash on exit due to destroyed surface texture"
date = "2025-12-02T00:00:00"
draft = false
template = "pull_request_page.html"
in_search_index = true

[taxonomies]
list_display = ["show"]

[extra]
current_language = "en"
available_languages = {"en" = { name = "English", url = "/pull_request/bevy/2025-12/pr-21976-en-20251202" }, "zh-cn" = { name = "中文", url = "/pull_request/bevy/2025-12/pr-21976-zh-cn-20251202" }}
labels = ["A-Rendering", "A-Windowing", "P-Crash", "P-Regression"]
+++

# Fix crash on exit due to destroyed surface texture

## Basic Information
- **Title**: Fix crash on exit due to destroyed surface texture
- **PR Link**: https://github.com/bevyengine/bevy/pull/21976
- **Author**: SarthakSingh31
- **Status**: MERGED
- **Labels**: A-Rendering, A-Windowing, P-Crash, S-Ready-For-Final-Review, P-Regression
- **Created**: 2025-11-29T21:49:08Z
- **Merged**: 2025-12-02T08:28:42Z
- **Merged By**: mockersf

## Description Translation

# Objective

Fix crash when a window is closed on current main

<details>
  <summary>Crash log</summary>

```
❯ RUST_BACKTRACE=full cargo run --example 3d_scene -F dev
    Finished `dev` profile [unoptimized + debuginfo] target(s) in 0.17s
     Running `target/debug/examples/3d_scene`
2025-11-29T21:39:06.551816Z  INFO bevy_diagnostic::system_information_diagnostics_plugin::internal: SystemInfo { os: "Linux (Arch Linux rolling)", kernel: "6.17.9-arch1-1", cpu: "AMD Ryzen 9 9950X 16-Core Processor", core_count: "16", memory: "186.4 GiB" }
2025-11-29T21:39:06.589438Z  INFO bevy_render::renderer: AdapterInfo { name: "NVIDIA GeForce RTX 5080", vendor: 4318, device: 11266, device_type: DiscreteGpu, driver: "NVIDIA", driver_info: "580.105.08", backend: Vulkan }
2025-11-29T21:39:06.953148Z  INFO bevy_render::batching::gpu_preprocessing: GPU preprocessing is fully supported on this device.
2025-11-29T21:39:06.959263Z  INFO bevy_winit::system: Creating new window 3d_scene (0v0)
2025-11-29T21:39:09.503214Z  INFO bevy_window::system: No windows are open, exiting
2025-11-29T21:39:09.504687Z  INFO bevy_winit::system: Closing window 0v0
2025-11-29T21:39:09.510808Z ERROR wgpu::backend::wgpu_core: Handling wgpu errors as fatal by default

thread '<unnamed>' (664835) panicked at /home/ssingh/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/wgpu-26.0.1/src/backend/wgpu_core.rs:1852:22:
wgpu error: Validation Error

Caused by:
  In Queue::submit
    In a pass parameter
      Texture with '<Surface Texture>' label has been destroyed


stack backtrace:
   0:     0x557069cd5e42 - std[cbf56a46dac989f5]::backtrace_rs::backtrace::libunwind::trace
                               at /rustc/cc3eee7fbe17ea4b7238531cb97e1b7b8bd6afce/library/std/src/../../backtrace/src/backtrace/libunwind.rs:117:9
   1:     0x557069cd5e42 - std[cbf56a46dac989f5]::backtrace_rs::backtrace::trace_unsynchronized::<std[cbf56a46dac989f5]::sys::backtrace::_print_fmt::{closure#1}>
                               at /rustc/cc3eee7fbe17ea4b7238531cb97e1b7b8bd6afce/library/std/src/../../backtrace/src/backtrace/mod.rs:66:14
   2:     0x557069cd5e42 - std[cbf56a46dac989f5]::sys::backtrace::_print_fmt
                               at /rustc/cc3eee7fbe17ea4b7238531cb97e1b7b8bd6afce/library/std/src/sys/backtrace.rs:68:9
   3:     0x557069cd5e42 - <<std[cbf56a46dac989f5]::sys::backtrace::BacktraceLock>::print::DisplayBacktrace as core[a3424aac13c77cf6]::fmt::Display>::fmt
                               at /rustc/cc3eee7fbe17ea4b7238531cb97e1b7b8bd6afce/library/std/src/sys/backtrace.rs:38:26
   4:     0x557069cf05e7 - <core[a3424aac13c77cf6]::fmt::rt::Argument>::fmt
                               at /rustc/cc3eee7fbe17ea4b7238531cb97e1b7b8bd6afce/library/core/src/fmt/rt.rs:152:76
   5:     0x557069cf05e7 - core[a3424aac13c77cf6]::fmt::write
   6:     0x557069cdc5d6 - std[cbf56a46dac989f5]::io::default_write_fmt::<std[cbf56a46dac989f5]::sys::stdio::unix::Stderr>
                               at /rustc/cc3eee7fbe17ea4b7238531cb97e1b7b8bd6afce/library/std/src/io/mod.rs:639:11
   7:     0x557069cdc5d6 - <std[cbf56a46dac989f5]::sys::stdio::unix::Stderr as std[cbf56a46dac989f5]::io::Write>::write_fmt
                               at /rustc/cc3eee7fbe17ea4b7238531cb97e1b7b8bd6afce/library/std/src/io/mod.rs:1994:13
   8:     0x557069cb255a - <std[cbf56a46dac989f5]::sys::backtrace::BacktraceLock>::print
                               at /rustc/cc3eee7fbe17ea4b7238531cb97e1b7b8bd6afce/library/std/src/sys/backtrace.rs:41:9
   9:     0x557069cb255a - std[cbf56a46dac989f5]::panicking::default_hook::{closure#0}
                               at /rustc/cc3eee7fbe17ea4b7238531cb97e1b7b8bd6afce/library/std/src/panicking.rs:292:27
  10:     0x557069cce7e1 - std[cbf56a46dac989f5]::panicking::default_hook
                               at /rustc/cc3eee7fbe17ea4b7238531cb97e1b7b8bd6afce/library/std/src/panicking.rs:319:9
  11:     0x5570696cd6b3 - <alloc[9fa3fef380221c31]::boxed::Box<dyn for<'a, 'b> core[a3424aac13c77cf6]::ops::function::Fn<(&'a std[cbf56a46dac989f5]::panic::PanicHookInfo<'b>,), Output = ()> + core[a3424aac13c77cf6]::marker::Send + core[a3424aac13c77cf6]::marker::Sync> as core[a3424aac13c77cf6]::ops::function::Fn<(&std[cbf56a46dac989f5]::panic::PanicHookInfo,)>>::call
                               at /home/ssingh/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/alloc/src/boxed.rs:2220:9
  12:     0x5570696b9081 - bevy_ecs[ae55bfe1c74e77a3]::error::bevy_error::bevy_error_panic_hook::<alloc[9fa3fef380221c31]::boxed::Box<dyn for<'a, 'b> core[a3424aac13c77cf6]::ops::function::Fn<(&'a std[cbf56a46dac989f5]::panic::PanicHookInfo<'b>,), Output = ()> + core[a3424aac13c77cf6]::marker::Send + core[a3424aac13c77cf6]::marker::Sync>>::{closure#0}
                               at /home/ssingh/Projects/bevy/crates/bevy_ecs/src/error/bevy_error.rs:162:9
  13:     0x557069ccea82 - <alloc[9fa3fef380221c31]::boxed::Box<dyn for<'a, 'b> core[a3424aac13c77cf6]::ops::function::Fn<(&'a std[cbf56a46dac989f5]::panic::PanicHookInfo<'b>,), Output = ()> + core[a3424aac13c77cf6]::marker::Send + core[a3424aac13c77cf6]::marker::Sync> as core[a3424aac13c77cf6]::ops::function::Fn<(&std[cbf56a46dac989f5]::panic::PanicHookInfo,)>>::call
                               at /rustc/cc3eee7fbe17ea4b7238531cb97e1b7b8bd6afce/library/alloc/src/boxed.rs:2220:9
  14:     0x557069ccea82 - std[cbf56a46dac989f5]::panicking::panic_with_hook
                               at /rustc/cc3eee7fbe17ea4b7238531cb97e1b7b8bd6afce/library/std/src/panicking.rs:833:13
  15:     0x557069cb2618 - std[cbf56a46dac989f5]::panicking::panic_handler::{closure#0}
                               at /rustc/cc3eee7fbe17ea4b7238531cb97e1b7b8bd6afce/library/std/src/panicking.rs:698:13
  16:     0x557069ca9779 - std[cbf56a46dac989f5]::sys::backtrace::__rust_end_short_backtrace::<std[cbf56a46dac989f5]::panicking::panic_handler::{closure#0}, !>
                               at /rustc/cc3eee7fbe17ea4b7238531cb97e1b7b8bd6afce/library/std/src/sys/backtrace.rs:176:18
  17:     0x557069cb37cd - __rustc[f3f8441e4970532f]::rust_begin_unwind
                               at /rustc/cc3eee7fbe17ea4b7238531cb97e1b7b8bd6afce/library/std/src/panicking.rs:689:5
  18:     0x557069cf0d5c - core[a3424aac13c77cf6]::panicking::panic_fmt
                               at /rustc/cc3eee7fbe17ea4b7238531cb97e1b7b8bd6afce/library/core/src/panicking.rs:80:14
  19:     0x5570675ffab5 - wgpu[932fed8fce9d4b4b]::backend::wgpu_core::default_error_handler
                               at /home/ssingh/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/wgpu-26.0.1/src/backend/wgpu_core.rs:659:5
  20:     0x5570675ff6e5 - <wgpu[932fed8fce9d4b4b]::backend::wgpu_core::ErrorSinkRaw>::handle_error
                               at /home/ssingh/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/wgpu-26.0.1/src/backend/wgpu_core.rs:643:21
  21:     0x5570675ff3f4 - <wgpu[932fed8fce9d4b4b]::backend::wgpu_core::ContextWgpuCore>::handle_error_inner
                               at /home/ssingh/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/wgpu-26.0.1/src/backend/wgpu_core.rs:298:14
  22:     0x5570675fcda3 - <wgpu[932fed8fce9d4b4b]::backend::wgpu_core::ContextWgpuCore>::handle_error_nolabel::<wgpu_core[2f77c8d0c0f83b61]::device::queue::QueueSubmitError>
                               at /home/ssingh/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/wgpu-26.0.1/src/backend/wgpu_core.rs:323:14
  23:     0x55706760ed17 - <wgpu[932fed8fce9d4b4b]::backend::wgpu_core::CoreQueue as wgpu[932fed8fce9d4b4b]::dispatch::QueueInterface>::submit
                               at /home/ssingh/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/wgpu-26.0.1/src/backend/wgpu_core.rs:1852:22
  24:     0x5570672eef2a - <wgpu[932fed8fce9d4b4b]::api::queue::Queue>::submit::<alloc[9fa3fef380221c31]::vec::Vec<wgpu[932fed8fce9d4b4b]::api::command_buffer::CommandBuffer>>
                               at /home/ssingh/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/wgpu-26.0.1/src/api/queue.rs:253:32
  25:     0x557066f4965c - <bevy_render[cbe98d17828001b5]::renderer::graph_runner::RenderGraphRunner>::run::<bevy_render[cbe98d17828001b5]::renderer::render_system::{closure#1}>
                               at /home/ssingh/Projects/bevy/crates/bevy_render/src/renderer/graph_runner.rs:87:19
  26:     0x5570670a05ad - bevy_render[cbe98d17828001b5]::renderer::render_system
                               at /home/ssingh/Projects/bevy/crates/bevy_render/src/renderer/mod.rs:48:15
  27:     0x55706744d021 - <bevy_render[cbe98d17828001b5]::renderer::render_system as core[a3424aac13c77cf6]::ops::function::FnMut<(&mut bevy_ecs[ae55bfe1c74e77a3]::world::World, &mut bevy_ecs[ae55bfe1c74e77a3]::system::function_system::SystemState<bevy_ecs[ae55bfe1c74e77a3]::system::query::Query<(&bevy_render[cbe98d17828001b5]::view::ViewTarget, &bevy_render[cbe98d17828001b5]::camera::ExtractedCamera)>>)>>::call_mut
                               at /home/ssingh/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/ops/function.rs:166:5
  28:     0x5570670ad864 - <&mut bevy_render[cbe98d17828001b5]::renderer::render_system as core[a3424aac13c77cf6]::ops::function::FnMut<(&mut bevy_ecs[ae55bfe1c74e77a3]::world::World, &mut bevy_ecs[ae55bfe1c74e77a3]::system::function_system::SystemState<bevy_ecs[ae55bfe1c74e77a3]::system::query::Query<(&bevy_render[cbe98d17828001b5]::view::ViewTarget, &bevy_render[cbe98d17828001b5]::camera::ExtractedCamera)>>)>>::call_mut
                               at /home/ssingh/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/ops/function.rs:298:21
  29:     0x55706735dc8e - <_ as bevy_ecs[ae55bfe1c74e77a3]::system::exclusive_function_system::ExclusiveSystemParamFunction<fn(_) -> _>>::run::call_inner::<(), &mut bevy_ecs[ae55bfe1c74e77a3]::system::function_system::SystemState<bevy_ecs[ae55bfe1c74e77a3]::system::query::Query<(&bevy_render[cbe98d17828001b5]::view::ViewTarget, &bevy_render[cbe98d17828001b5]::camera::ExtractedCamera)>>, &mut bevy_render[cbe98d17828001b5]::renderer::render_system>
                               at /home/ssingh/Projects/bevy/crates/bevy_ecs/src/system/exclusive_function_system.rs:270:21
  30:     0x5570670ad95e - <bevy_render[cbe98d17828001b5]::renderer::render_system as bevy_ecs[ae55bfe1c74e77a3]::system::exclusive_function_system::ExclusiveSystemParamFunction<fn(&mut bevy_ecs[ae55bfe1c74e77a3]::system::function_system::SystemState<bevy_ecs[ae55bfe1c74e77a3]::system::query::Query<(&bevy_render[cbe98d17828001b5]::view::ViewTarget, &bevy_render[cbe98d17828001b5]::camera::ExtractedCamera)>>)>>::run
                               at /home/ssingh/Projects/bevy/crates/bevy_ecs/src/system/exclusive_function_system.rs:273:17
  31:     0x55706735e0ab - <bevy_ecs[ae55bfe1c74e77a3]::system::exclusive_function_system::ExclusiveFunctionSystem<fn(&mut bevy_ecs[ae55bfe1c74e77a3]::system::function_system::SystemState<bevy_ecs[ae55bfe1c74e77a3]::system::query::Query<(&bevy_render[cbe98d17828001b5]::view::ViewTarget, &bevy_render[cbe98d17828001b5]::camera::ExtractedCamera)>>), (), bevy_render[cbe98d17828001b5]::renderer::render_system> as bevy_ecs[ae55bfe1c74e77a3]::system::system::System>::run_unsafe::{closure#0}
                               at /home/ssingh/Projects/bevy/crates/bevy_ecs/src/system/exclusive_function_system.rs:135:33
  32:     0x55706702ac65 - <bevy_ecs[ae55bfe1c74e77a3]::world::World>::last_change_tick_scope::<core[a3424aac13c77cf6]::result::Result<(), bevy_ecs[ae55bfe1c74e77a3]::system::system::RunSystemError>, <bevy_ecs[ae55bfe1c74e77a3]::system::exclusive_function_system::ExclusiveFunctionSystem<fn(&mut bevy_ecs[ae55bfe1c74e77a3]::system::function_system::SystemState<bevy_ecs[ae55bfe1c74e77a3]::system::query::Query<(&bevy_render[cbe98d17828001b5]::view::ViewTarget, &bevy_render[cbe98d17828001b5]::camera::ExtractedCamera)>>), (), bevy_render[cbe98d17828001b5]::renderer::render_system> as bevy_ecs[ae55bfe1c74e77a3]::system::system::System>::run_unsafe::{closure#0}>
                               at /home/ssingh/Projects/bevy/crates/bevy_ecs/src/world/mod.rs:3070:9
  33:     0x55706735eb0a - <bevy_ecs[ae55bfe1c74e77a3]::system::exclusive_function_system::ExclusiveFunctionSystem<fn(&mut bevy_ecs[ae55bfe1c74e77a3]::system::function_system::SystemState<bevy_ecs[ae55bfe1c74e77a3]::system::query::Query<(&bevy_render[cbe98d17828001b5]::view::ViewTarget, &bevy_render[cbe98d17828001b5]::camera::ExtractedCamera)>>), (), bevy_render[cbe98d17828001b5]::renderer::render_system> as bevy_ecs[ae55bfe1c74e77a3]::system::system::System>::run_unsafe
                               at /home/ssingh/Projects/bevy/crates/bevy_ecs/src/system/exclusive_function_system.rs:113:15
  34:     0x55706735f7ab - <bevy_ecs[ae55bfe1c74e77a3]::system::exclusive_function_system::ExclusiveFunctionSystem<fn(&mut bevy_ecs[ae55bfe1c74e77a3]::system::function_system::SystemState<bevy_ecs[ae55bfe1c74e77a3]::system::query::Query<(&bevy_render[cbe98d17828001b5]::view::ViewTarget, &bevy_render[cbe98d17828001b5]::camera::ExtractedCamera)>>), (), bevy_render[cbe98d17828001b5]::renderer::render_system> as bevy_ecs[ae55bfe1c74e77a3]::system::system::System>::run_without_applying_deferred
                               at /home/ssingh/Projects/bevy/crates/bevy_ecs/src/system/system.rs:138:23
  35:     0x55706735f806 - <bevy_ecs[ae55bfe1c74e77a3]::system::exclusive_function_system::ExclusiveFunctionSystem<fn(&mut bevy_ecs[ae55bfe1c74e77a3]::system::function_system::SystemState<bevy_ecs[ae55bfe1c74e77a3]::system::query::Query<(&bevy_render[cbe98d17828001b5]::view::ViewTarget, &bevy_render[cbe98d17828001b5]::camera::ExtractedCamera)>>), (), bevy_render[cbe98d17828001b5]::renderer::render_system> as bevy_ecs[ae55bfe1c74e77a3]::system::system::System>::run
                               at /home/ssingh/Projects/bevy/crates/bevy_ecs/src/system/system.rs:119:24
  36:     0x55706988d090 - bevy_ecs[ae55bfe1c74e77a3]::schedule::executor::__rust_begin_short_backtrace::run
                               at /home/ssingh/Projects/bevy/crates/bevy_ecs/src/schedule/executor/mod.rs:288:29
  37:     0x5570697be94d - <bevy_ecs[ae55bfe1c74e77a3]::schedule::executor::multi_threaded::ExecutorState>::spawn_exclusive_system_task::{closure#1}::{closure#0}
                               at /home/ssingh/Projects/bevy/crates/bevy_ecs/src/schedule/executor/multi_threaded.rs:742:25
  38:     0x5570697254f9 - <<bevy_ecs[ae55bfe1c74e77a3]::schedule::executor::multi_threaded::ExecutorState>::spawn_exclusive_system_task::{closure#1}::{closure#0} as core[a3424aac13c77cf6]::ops::function::FnOnce<()>>::call_once
                               at /home/ssingh/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/ops/function.rs:250:5
  39:     0x55706977f259 - <core[a3424aac13c77cf6]::panic::unwind_safe::AssertUnwindSafe<<bevy_ecs[ae55bfe1c74e77a3]::schedule::executor::multi_threaded::ExecutorState>::spawn_exclusive_system_task::{closure#1}::{closure#0}> as core[a3424aac13c77cf6]::ops::function::FnOnce<()>>::call_once
                               at /home/ssingh/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/panic/unwind_safe.rs:274:9
  40:     0x5570697c3253 - std[cbf56a46dac989f5]::panicking::catch_unwind::do_call::<core[a3424aac13c77cf6]::panic::unwind_safe::AssertUnwindSafe<<bevy_ecs[ae55bfe1c74e77a3]::schedule::executor::multi_threaded::ExecutorState>::spawn_exclusive_system_task::{closure#1}::{closure#0}>, ()>
                               at /home/ssingh/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/std/src/panicking.rs:581:40
  41:     0x557069887a9b - __rust_try
  42:     0x557069886fae - std[cbf56a46dac989f5]::panicking::catch_unwind::<(), core[a3424aac13c77cf6]::panic::unwind_safe::AssertUnwindSafe<<bevy_ecs[ae55bfe1c74e77a3]::schedule::executor::multi_threaded::ExecutorState>::spawn_exclusive_system_task::{closure#1}::{closure#0}>>
                               at /home/ssingh/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/std/src/panicking.rs:544:19
  43:     0x557069886fae - std[cbf56a46dac989f5]::panic::catch_unwind::<core[a3424aac13c77cf6]::panic::unwind_safe::AssertUnwindSafe<<bevy_ecs[ae55bfe1c74e77a3]::schedule::executor::multi_threaded::ExecutorState>::spawn_exclusive_system_task::{closure#1}::{closure#0}>, ()>
                               at /home/ssingh/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/std/src/panic.rs:359:14
  44:     0x5570697bf233 -