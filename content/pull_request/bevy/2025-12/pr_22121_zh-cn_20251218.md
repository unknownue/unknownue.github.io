+++
title = "#22121 Bump actions/upload-artifact from 5 to 6"
date = "2025-12-18T00:00:00"
draft = false
template = "pull_request_page.html"
in_search_index = false

[extra]
current_language = "zh-cn"
available_languages = {"en" = { name = "English", url = "/pull_request/bevy/2025-12/pr-22121-en-20251218" }, "zh-cn" = { name = "中文", url = "/pull_request/bevy/2025-12/pr-22121-zh-cn-20251218" }}
+++

# 依赖升级的例行维护：actions/upload-artifact从v5升级到v6

## 基本信息
- **标题**: Bump actions/upload-artifact from 5 to 6
- **PR链接**: https://github.com/bevyengine/bevy/pull/22121
- **作者**: app/dependabot
- **状态**: 已合并
- **标签**: A-Build-System, C-Dependencies, S-Ready-For-Final-Review, D-Straightforward
- **创建时间**: 2025-12-15T06:01:16Z
- **合并时间**: 2025-12-18T19:12:44Z
- **合并者**: alice-i-cecile

## 描述翻译

将[actions/upload-artifact](https://github.com/actions/upload-artifact)从版本5升级到版本6。
<details>
<summary>发布说明</summary>
<p><em>来源自<a href="https://github.com/actions/upload-artifact/releases">actions/upload-artifact的发布记录</a>。</em></p>
<blockquote>
<h2>v6.0.0</h2>
<h2>v6 - 新功能</h2>
<blockquote>
<p>[!重要]
actions/upload-artifact@v6现在运行在Node.js 24上（<code>runs.using: node24</code>），并且要求Actions Runner的最低版本为2.327.1。如果您使用自托管运行器，请在升级前确保它们已更新。</p>
</blockquote>
<h3>Node.js 24</h3>
<p>此版本将运行时更新为Node.js 24。v5版本对Node.js 24有初步支持，但默认情况下该操作仍运行在Node.js 20上。现在默认情况下此操作将运行在Node.js 24上。</p>
<h2>变更内容</h2>
<ul>
<li>通过<a href="https://github.com/salmanmkc"><code>@​salmanmkc</code></a>在<a href="https://redirect.github.com/actions/upload-artifact/pull/719">actions/upload-artifact#719</a>中实现上传构件Node 24支持</li>
<li>修复：通过<a href="https://github.com/salmanmkc"><code>@​salmanmkc</code></a>在<a href="https://redirect.github.com/actions/upload-artifact/pull/744">actions/upload-artifact#744</a>中更新<code>@​actions/artifact</code>以解决Node.js 24的punycode弃用问题</li>
<li>通过<a href="https://github.com/salmanmkc"><code>@​salmanmkc</code></a>在<a href="https://redirect.github.com/actions/upload-artifact/pull/745">actions/upload-artifact#745</a>中为Node.js 24支持准备发布v6.0.0</li>
</ul>
<p><strong>完整变更日志</strong>：<a href="https://github.com/actions/upload-artifact/compare/v5.0.0...v6.0.0">https://github.com/actions/upload-artifact/compare/v5.0.0...v6.0.0</a></p>
</blockquote>
</details>
<details>
<summary>提交记录</summary>
<ul>
<li><a href="https://github.com/actions/upload-artifact/commit/b7c566a772e6b6bfb58ed0dc250532a479d7789f"><code>b7c566a</code></a> Merge pull request <a href="https://redirect.github.com/actions/upload-artifact/issues/745">#745</a> from actions/upload-artifact-v6-release</li>
<li><a href="https://github.com/actions/upload-artifact/commit/e516bc8500aaf3d07d591fcd4ae6ab5f9c391d5b"><code>e516bc8</code></a> 文档：修正README中关于Node.js 24支持的描述</li>
<li><a href="https://github.com/actions/upload-artifact/commit/ddc45ed9bca9b38dbd643978d88e3981cdc91415"><code>ddc45ed</code></a> 文档：更新README以更正Node.js 24支持的操作名称</li>
<li><a href="https://github.com/actions/upload-artifact/commit/615b319bd27bb32c3d64dca6b6ed6974d5fbe653"><code>615b319</code></a> 更新：为Node.js 24支持发布v6.0.0</li>
<li><a href="https://github.com/actions/upload-artifact/commit/017748b48f8610ca8e6af1222f4a618e84a9c703"><code>017748b</code></a> Merge pull request <a href="https://redirect.github.com/actions/upload-artifact/issues/744">#744</a> from actions/fix-storage-blob</li>
<li><a href="https://github.com/actions/upload-artifact/commit/38d4c7997f5510fcc41fc4aae2a6b97becdbe7fc"><code>38d4c79</code></a> 更新：重新构建dist</li>
<li><a href="https://github.com/actions/upload-artifact/commit/7d27270e0cfd253e666c44abac0711308d2d042f"><code>7d27270</code></a> 更新：为<code>@​actions/core</code>、<code>@​actions/io</code>和mi...添加缺失的许可证缓存文件</li>
<li><a href="https://github.com/actions/upload-artifact/commit/5f643d3c9475505ccaf26d686ffbfb71a8387261"><code>5f643d3</code></a> 更新：更新<code>@​actions/artifact</code><a href="https://github.com/5"><code>@​5</code></a>.0.1依赖的许可证文件</li>
<li><a href="https://github.com/actions/upload-artifact/commit/1df1684032c88614064493e1a0478fcb3583e1d0"><code>1df1684</code></a> 更新：使用<code>@​actions/artifact</code><a href="https://github.com/5"><code>@​5</code></a>.0.1更新package-lock.json</li>
<li><a href="https://github.com/actions/upload-artifact/commit/b5b1a918401ee270935b6b1d857ae66c85f3be6f"><code>b5b1a91</code></a> 修复：将<code>@​actions/artifact</code>更新到^5.0.0以解决Node.js 24的punycode问题</li>
<li>更多提交记录可在<a href="https://github.com/actions/upload-artifact/compare/v5...v6">比较视图</a>中查看</li>
</ul>
</details>
<br />


[![Dependabot兼容性评分](https://dependabot-badges.githubapp.com/badges/compatibility_score?dependency-name=actions/upload-artifact&package-manager=github_actions&previous-version=5&new-version=6)](https://docs.github.com/en/github/managing-security-vulnerabilities/about-dependabot-security-updates#about-compatibility-scores)

只要您不自行修改此PR，Dependabot将解决任何冲突。您也可以通过评论`@dependabot rebase`手动触发rebase。

[//]: # (dependabot-automerge-start)
[//]: # (dependabot-automerge-end)

---

<details>
<summary>Dependabot命令和选项</summary>
<br />

您可以通过在此PR上评论来触发Dependabot操作：
- `@dependabot rebase` 将rebase此PR
- `@dependabot recreate` 将重新创建此PR，覆盖对其所做的任何编辑
- `@dependabot merge` 将在CI通过后合并此PR
- `@dependabot squash and merge` 将在CI通过后squash并合并此PR
- `@dependabot cancel merge` 将取消先前请求的合并并阻止自动合并
- `@dependabot reopen` 如果此PR已关闭，将重新打开它
- `@dependabot close` 将关闭此PR并阻止Dependabot重新创建它。您可以通过手动关闭它来达到相同效果
- `@dependabot show <dependency name> ignore conditions` 将显示指定依赖项的所有忽略条件
- `@dependabot ignore this major version` 将关闭此PR并阻止Dependabot为此主要版本创建更多PR（除非您重新打开PR或自行升级）
- `@dependabot ignore this minor version` 将关闭此PR并阻止Dependabot为此次要版本创建更多PR（除非您重新打开PR或自行升级）
- `@dependabot ignore this dependency` 将关闭此PR并阻止Dependabot为此依赖项创建更多PR（除非您重新打开PR或自行升级）

</details>

## 这个Pull Request的故事

这是一个由Dependabot自动创建的依赖升级PR。GitHub Actions的生态系统中，`actions/upload-artifact`是一个广泛使用的官方Action，用于在工作流运行期间上传构建产物（artifacts）。Bevy项目在多个CI/CD工作流中使用这个Action来存储和共享测试结果、截图和追踪文件。

这次升级的主要驱动力是`actions/upload-artifact` v6版本将Node.js运行时从版本20升级到了版本24。对于Bevy项目来说，这意味着CI/CD工作流现在将使用更新的Node.js环境执行上传操作。根据发布说明，v6版本对Node.js 24提供了完整的支持，而v5版本虽然已有初步支持，但默认仍运行在Node.js 20上。

从技术角度看，这个变更非常直接。它没有改变任何功能逻辑或配置参数，只是将版本号从`v5`更新为`v6`。所有现有的`with`参数配置保持不变，这意味着工作流的行为应该与之前完全一致，只是运行在更新的Node.js环境中。

然而，这个升级也带来了一些需要考虑的技术要求。v6版本需要最低版本为2.327.1的GitHub Actions Runner。对于使用GitHub托管的运行器（GitHub-hosted runners）来说，这不是问题，因为这些运行器会自动更新。但对于使用自托管运行器（self-hosted runners）的项目，需要确保运行器版本符合要求，否则工作流可能会失败。

从工程实践的角度看，这种依赖升级是维护现代软件项目的常规工作。保持依赖项更新有几个好处：
1. **安全性**：新版本通常包含安全修复
2. **性能**：Node.js 24可能包含性能改进
3. **兼容性**：与GitHub Actions平台的长期兼容性
4. **功能**：可能包含新的功能或改进

Bevy项目维护者很快地审查并合并了这个PR，这反映了他们对依赖管理的重视。兼容性评分显示这个升级应该是向后兼容的，这降低了升级风险。

## 可视化表示

```mermaid
graph TD
    A[GitHub Actions工作流] --> B[actions/upload-artifact@v6]
    B --> C[上传构建产物]
    
    D[ci.yml] --> B
    E[example-run.yml] --> B
    F[example-run-report.yml] --> B
    G[validation-jobs.yml] --> B
    
    C --> H[存储测试结果]
    C --> I[存储截图]
    C --> J[存储追踪文件]
    C --> K[存储MSRV检查结果]
```

## 关键文件变更

**1. `.github/workflows/ci.yml`** (+3/-3)
这个文件包含了Bevy的主要CI工作流。变更将三个`actions/upload-artifact@v5`引用更新为`v6`。这些上传步骤用于存储缺少的示例、缺少的功能和MSRV（Minimum Supported Rust Version）检查的结果。

```yaml
# 变更示例：
# 之前：
- uses: actions/upload-artifact@v5

# 之后：
- uses: actions/upload-artifact@v6
```

**2. `.github/workflows/example-run.yml`** (+9/-9)
这个工作流用于运行示例并收集结果。变更更新了macOS、Linux和Windows平台上多个上传步骤的版本号，用于上传追踪文件、截图和运行结果。

```yaml
# 在多个位置进行了类似的变更：
# macOS部分：
- name: save traces
  uses: actions/upload-artifact@v6  # 之前是v5

- name: save screenshots
  uses: actions/upload-artifact@v6  # 之前是v5

- uses: actions/upload-artifact@v6  # 之前是v5
```

**3. `.github/workflows/example-run-report.yml`** (+1/-1)
这个工作流专门用于生成示例运行报告。变更更新了上传截图的步骤版本。

**4. `.github/workflows/validation-jobs.yml`** (+1/-1)
这个工作流包含WASM验证任务。变更更新了上传WASM示例截图的步骤版本。

## 进一步阅读

1. [GitHub Actions官方文档：上传构建产物](https://docs.github.com/en/actions/using-workflows/storing-workflow-data-as-artifacts)
2. [actions/upload-artifact仓库](https://github.com/actions/upload-artifact)
3. [Node.js 24发布说明](https://nodejs.org/en/blog/release/v24.0.0)
4. [GitHub Actions Runner版本要求](https://docs.github.com/en/actions/hosting-your-own-runners/managing-self-hosted-runners/about-self-hosted-runners#supported-architectures-and-operating-systems)

# 完整代码差异

```diff
diff --git a/.github/workflows/ci.yml b/.github/workflows/ci.yml
index ed7694c281301..fbd2d5f76050d 100644
--- a/.github/workflows/ci.yml
+++ b/.github/workflows/ci.yml
@@ -414,7 +414,7 @@ jobs:
       - name: log failed task - missing update
         if: ${{ failure() && github.event_name == 'pull_request' && steps.missing-update.conclusion == 'failure' }}
         run: touch ./missing-examples/missing-update
-      - uses: actions/upload-artifact@v5
+      - uses: actions/upload-artifact@v6
         if: ${{ failure() && github.event_name == 'pull_request' }}
         with:
           name: missing-examples
@@ -449,7 +449,7 @@ jobs:
       - name: log failed task - missing update
         if: ${{ failure() && github.event_name == 'pull_request' && steps.missing-update.conclusion == 'failure' }}
         run: touch ./missing-features/missing-update
-      - uses: actions/upload-artifact@v5
+      - uses: actions/upload-artifact@v6
         if: ${{ failure() && github.event_name == 'pull_request' }}
         with:
           name: missing-features
@@ -494,7 +494,7 @@ jobs:
         run: |
           mkdir -p ./msrv
           echo ${{ github.event.number }} > ./msrv/NR
-      - uses: actions/upload-artifact@v5
+      - uses: actions/upload-artifact@v6
         if: ${{ failure() && github.event_name == 'pull_request' && steps.check.conclusion == 'failure' }}
         with:
           name: msrv
diff --git a/.github/workflows/example-run-report.yml b/.github/workflows/example-run-report.yml
index 733fb92b82502..c59404ab7baea 100644
--- a/.github/workflows/example-run-report.yml
+++ b/.github/workflows/example-run-report.yml
@@ -54,7 +54,7 @@ jobs:
           mkdir screenshots
           mv screenshots-* screenshots/
       - name: save screenshots
-        uses: actions/upload-artifact@v5
+        uses: actions/upload-artifact@v6
         with:
           name: screenshots-macos
           path: screenshots
diff --git a/.github/workflows/example-run.yml b/.github/workflows/example-run.yml
index c41396eab7078..934e4472e3a5e 100644
--- a/.github/workflows/example-run.yml
+++ b/.github/workflows/example-run.yml
@@ -58,7 +58,7 @@ jobs:
           mkdir traces && mv trace*.json traces/
           mkdir screenshots && mv screenshots-* screenshots/
       - name: save traces
-        uses: actions/upload-artifact@v5
+        uses: actions/upload-artifact@v6
         with:
           name: example-traces-macos
           path: traces
@@ -67,11 +67,11 @@ jobs:
         run: |
           echo ${{ github.event.number }} > ./screenshots/PR
       - name: save screenshots
-        uses: actions/upload-artifact@v5
+        uses: actions/upload-artifact@v6
         with:
           name: screenshots-macos
           path: screenshots
-      - uses: actions/upload-artifact@v5
+      - uses: actions/upload-artifact@v6
         if: ${{ failure() && github.event_name == 'pull_request' }}
         with:
           name: example-run-macos
@@ -133,16 +133,16 @@ jobs:
           mkdir traces && mv trace*.json traces/
           mkdir screenshots && mv screenshots-* screenshots/
       - name: save traces
-        uses: actions/upload-artifact@v5
+        uses: actions/upload-artifact@v6
         with:
           name: example-traces-linux
           path: traces
       - name: save screenshots
-        uses: actions/upload-artifact@v5
+        uses: actions/upload-artifact@v6
         with:
           name: screenshots-linux
           path: screenshots
-      - uses: actions/upload-artifact@v5
+      - uses: actions/upload-artifact@v6
         if: ${{ failure() && github.event_name == 'pull_request' }}
         with:
           name: example-run-linux
@@ -197,16 +197,16 @@ jobs:
           mkdir traces && mv trace*.json traces/
           mkdir screenshots && mv screenshots-* screenshots/
       - name: save traces
-        uses: actions/upload-artifact@v5
+        uses: actions/upload-artifact@v6
         with:
           name: example-traces-windows
           path: traces
       - name: save screenshots
-        uses: actions/upload-artifact@v5
+        uses: actions/upload-artifact@v6
         with:
           name: screenshots-windows
           path: screenshots
-      - uses: actions/upload-artifact@v5
+      - uses: actions/upload-artifact@v6
         if: ${{ failure() && github.event_name == 'pull_request' }}
         with:
           name: example-run-windows
diff --git a/.github/workflows/validation-jobs.yml b/.github/workflows/validation-jobs.yml
index 7d3d75d9df11f..67a0546268a07 100644
--- a/.github/workflows/validation-jobs.yml
+++ b/.github/workflows/validation-jobs.yml
@@ -147,7 +147,7 @@ jobs:
           xvfb-run cargo run -p build-wasm-example -- --browsers chromium --browsers firefox --frames 25 --test 2d_shapes lighting text_debug breakout
 
       - name: Save screenshots
-        uses: actions/upload-artifact@v5
+        uses: actions/upload-artifact@v6
         with:
           name: screenshots-wasm
           path: .github/start-wasm-example/screenshot-*.png
```