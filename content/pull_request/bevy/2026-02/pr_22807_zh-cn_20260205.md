+++
title = "#22807 remove redundant warns"
date = "2026-02-05T00:00:00"
draft = false
template = "pull_request_page.html"
in_search_index = false

[extra]
current_language = "zh-cn"
available_languages = {"en" = { name = "English", url = "/pull_request/bevy/2026-02/pr-22807-en-20260205" }, "zh-cn" = { name = "中文", url = "/pull_request/bevy/2026-02/pr-22807-zh-cn-20260205" }}
+++

# remove redundant warns

## 基本信息
- **标题**: remove redundant warns
- **PR链接**: https://github.com/bevyengine/bevy/pull/22807
- **作者**: atlv24
- **状态**: 已合并
- **标签**: C-Docs, S-Needs-Review
- **创建时间**: 2026-02-05T00:33:09Z
- **合并时间**: 2026-02-05T01:26:09Z
- **合并者**: mockersf

## 描述翻译

### 目标

- 我们已经有一个对缺失文档的全面禁止设置，不需要特定的警告

### 解决方案

- 删除

### 测试

- 持续集成

## 这个PR的故事

这个PR处理一个代码库维护中的常见问题：消除重复的lint配置。Bevy项目在较高层级（很可能是工作区根目录或主Cargo.toml）设置了全局的`#![deny(missing_docs)]`规则，这意味着整个项目都对缺失文档强制执行错误级别的检查。

然而，一些独立的crate在它们自己的lib.rs文件中重复设置了相同的规则。具体来说，有三个文件包含了冗余的lint指令：
- `bevy_camera_controller/src/lib.rs` 有 `#![warn(missing_docs)]`
- `bevy_picking/src/lib.rs` 有 `#![deny(missing_docs)]`
- `bevy_ui/src/picking_backend.rs` 有 `#![deny(missing_docs)]`

这种重复配置在Rust项目中可能导致几个问题。首先，它使代码库的lint配置变得混乱，难以维护。其次，如果全局配置和局部配置发生冲突（例如一个设置为warn而另一个设置为deny），可能会引起混淆。第三，这些冗余配置没有任何实际效果，因为全局规则已经覆盖了它们。

从技术角度来看，Rust的lint系统允许在多个层级设置规则，但会遵循最具体的配置。当工作区根目录已经设置了`deny(missing_docs)`时，子crate中的相同规则实际上是多余的。将它们移除可以简化代码，提高可读性，并避免潜在的不一致性。

这个更改的风险极低，因为：
1. 它只是移除了冗余配置，没有改变任何实际功能代码
2. 全局配置仍然确保文档要求被强制执行
3. 通过CI测试验证了更改没有破坏构建

这种类型的清理工作对于保持大型代码库的可维护性很重要。它遵循了"单一事实来源"的原则，将lint配置集中管理，而不是分散在各个文件中。这也使得未来调整lint策略时更加容易，只需在一个地方修改而不是多个地方。

从工程实践的角度来看，这个PR展示了良好的代码库维护习惯：定期识别并消除冗余配置，保持代码整洁。虽然这种更改看起来很小，但它有助于减少技术债务，提高新贡献者的理解难度。

## 可视化表示

```mermaid
graph TD
    A[工作区根目录<br/>#![deny(missing_docs)]] --> B[bevy_camera_controller crate]
    A --> C[bevy_picking crate]
    A --> D[bevy_ui crate]
    
    B --> E[删除 #![warn(missing_docs)]]
    C --> F[删除 #![deny(missing_docs)]]
    D --> G[删除 #![deny(missing_docs)]]
    
    style A fill:#f9f,stroke:#333,stroke-width:2px
    style E fill:#ccf,stroke:#333
    style F fill:#ccf,stroke:#333
    style G fill:#ccf,stroke:#333
```

## 主要文件变更

**crates/bevy_camera_controller/src/lib.rs** (+0/-2)
这个文件移除了重复的`#![warn(missing_docs)]`指令。由于项目已有全局的deny规则，这里的warn级别指令是冗余的。

```rust
// 文件: crates/bevy_camera_controller/src/lib.rs
// 之前:
#![warn(missing_docs)]

// 之后:
// 移除了 #![warn(missing_docs)]
```

**crates/bevy_picking/src/lib.rs** (+0/-2)
这个文件移除了重复的`#![deny(missing_docs)]`指令。与全局配置相同，因此是冗余的。

```rust
// 文件: crates/bevy_picking/src/lib.rs
// 之前:
#![deny(missing_docs)]

// 之后:
// 移除了 #![deny(missing_docs)]
```

**crates/bevy_ui/src/picking_backend.rs** (+0/-2)
这个文件同样移除了重复的`#![deny(missing_docs)]`指令。

```rust
// 文件: crates/bevy_ui/src/picking_backend.rs
// 之前:
#![deny(missing_docs)]

// 之后:
// 移除了 #![deny(missing_docs)]
```

## 完整代码差异

```diff
diff --git a/crates/bevy_camera_controller/src/lib.rs b/crates/bevy_camera_controller/src/lib.rs
index 3356e4e87f5d4..e7625a46f672c 100644
--- a/crates/bevy_camera_controller/src/lib.rs
+++ b/crates/bevy_camera_controller/src/lib.rs
@@ -36,8 +36,6 @@
 //! Each camera controller is stored in its own module,
 //! and gated behind a feature flag of the same name.
 
-#![warn(missing_docs)]
-
 #[cfg(feature = "free_camera")]
 pub mod free_camera;
 
diff --git a/crates/bevy_picking/src/lib.rs b/crates/bevy_picking/src/lib.rs
index 3ed3ad843b22f..72b3166f4d687 100644
--- a/crates/bevy_picking/src/lib.rs
+++ b/crates/bevy_picking/src/lib.rs
@@ -152,8 +152,6 @@
 //! Because it is completely agnostic to the earlier stages of the pipeline, you can easily extend
 //! the plugin with arbitrary backends and input methods, yet still use all the high level features.
 
-#![deny(missing_docs)]
-
 extern crate alloc;
 
 pub mod backend;
diff --git a/crates/bevy_ui/src/picking_backend.rs b/crates/bevy_ui/src/picking_backend.rs
index 58d84ff607120..49c186207db02 100644
--- a/crates/bevy_ui/src/picking_backend.rs
+++ b/crates/bevy_ui/src/picking_backend.rs
@@ -21,8 +21,6 @@
 //!   `(-0.5, -0.5, 0.)` at the top left and `(0.5, 0.5, 0.)` in the bottom right. Coordinates are
 //!   relative to the entire node, not just the visible region. This backend does not provide a `normal`.
 
-#![deny(missing_docs)]
-
 use crate::{clip_check_recursive, prelude::*, ui_transform::UiGlobalTransform, UiStack};
 use bevy_app::prelude::*;
 use bevy_camera::{visibility::InheritedVisibility, Camera, RenderTarget};
```

## 进一步阅读

1. [Rust官方文档 - Lints](https://doc.rust-lang.org/rustc/lints/index.html): 关于Rust lint系统的完整说明
2. [Rust官方文档 - The Cargo Book - Workspaces](https://doc.rust-lang.org/cargo/reference/workspaces.html): 关于Cargo工作区配置的详细指南
3. [Clippy - Rust的lint工具](https://github.com/rust-lang/rust-clippy): Rust的官方lint工具，提供额外的代码质量检查
4. [The Rust Style Guide](https://github.com/rust-lang/style-team): Rust的代码风格指南，包含最佳实践