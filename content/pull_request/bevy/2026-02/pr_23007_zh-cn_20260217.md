+++
title = "#23007 Adding `TextFont` font weight helper methods"
date = "2026-02-17T00:00:00"
draft = false
template = "pull_request_page.html"
in_search_index = false

[extra]
current_language = "zh-cn"
available_languages = {"en" = { name = "English", url = "/pull_request/bevy/2026-02/pr-23007-en-20260217" }, "zh-cn" = { name = "中文", url = "/pull_request/bevy/2026-02/pr-23007-zh-cn-20260217" }}
labels = ["D-Trivial", "C-Usability", "A-Text"]
+++

# Adding `TextFont` font weight helper methods

## Basic Information
- **Title**: Adding `TextFont` font weight helper methods
- **PR Link**: https://github.com/bevyengine/bevy/pull/23007
- **Author**: Cr0a3
- **Status**: MERGED
- **Labels**: D-Trivial, C-Usability, S-Ready-For-Final-Review, A-Text
- **Created**: 2026-02-17T16:34:45Z
- **Merged**: 2026-02-17T19:52:19Z
- **Merged By**: alice-i-cecile

## Description Translation
**目标**
此PR为`TextFont`结构体添加了一个额外的构造函数，使其能够通过字体权重(FontWeight)来构造。

**解决方案**
我添加了以下方法：
```rust
fn TextFont::from_font_weight(impl Into<FontWeight>) -> Self { ... }
fn TextFont::with_font_weight(self, impl Into<FontWeight>) -> Self { ... }
```

**额外背景**
此PR与 #23006 相关。

## The Story of This Pull Request

这个PR始于一个对API一致性的简单观察。在Bevy的文本系统中，`TextFont`结构体已经提供了`from_font_size`和`with_font_size`这两个辅助方法，用于便捷地设置字体大小。然而，对于另一个核心属性——字体权重(FontWeight)——却没有对应的便捷方法。

这种不一致性使得开发者在只想设置字体权重时，代码会显得不够直观。开发者必须从默认值开始构建`TextFont`，然后手动设置`weight`字段，或者先设置一个字体大小，再链式调用`with_font_size`并覆盖掉它，这两种方式都不够理想。

解决方案很直接：为字体权重添加一对镜像方法(mirror methods)，以匹配现有字体大小方法的API模式。具体来说，添加了`from_font_weight`和`with_font_weight`这两个方法。

`from_font_weight`方法是一个关联函数(associated function)，它接受一个可以转换为`FontWeight`的类型作为参数，并返回一个以该权重构建的`TextFont`，其他字段保持默认值。它的实现巧妙地复用了现有结构：`Self::default().with_font_weight(weight)`。这不仅减少了代码重复，也清晰地表明了它与`with_font_weight`方法之间的关系。

```rust
pub fn from_font_weight(weight: impl Into<FontWeight>) -> Self {
    Self::default().with_font_weight(weight)
}
```

`with_font_weight`方法是一个实例方法，它同样接受一个可转换为`FontWeight`的参数。它的实现是标准的建造者模式(builder pattern)操作：修改自身实例的`weight`字段并返回`Self`，以支持链式调用。

```rust
pub fn with_font_weight(mut self, weight: impl Into<FontWeight>) -> Self {
    self.weight = weight.into();
    self
}
```

这两个方法都使用了`impl Into<FontWeight>`作为参数类型，这是一个良好的API设计实践。它提供了灵活性，调用者可以直接传入`FontWeight`枚举值（如`FontWeight::BOLD`），也可以传入任何实现了`Into<FontWeight>` trait的类型，这为未来的扩展留出了空间，同时保持了当前调用代码的简洁性。

从技术角度来看，这个PR是一个典型的API可用性改进。它不涉及底层算法的修改，也不改变任何现有功能。它的价值在于提升开发者体验(developer experience)和API的直观性。通过遵循已建立的模式，它使得`TextFont`的API更加完整和一致。

最终的影响是，开发者现在可以更清晰地表达他们的意图。例如，创建一个仅指定了字重的字体，代码从略显冗长的`TextFont { weight: FontWeight::BOLD, ..Default::default() }` 或 `TextFont::default().with_weight(FontWeight::BOLD)`（假设方法存在），变成了意图明确且符合直觉的 `TextFont::from_font_weight(FontWeight::BOLD)`。对于链式构建，`TextFont::default().with_font_weight(700)` 这样的调用也变得可能和流畅。

总之，这是一个小而实用的改进，通过填补API设计中的一个小缺口，提升了代码库的整洁度和开发者使用时的流畅度。

## Visual Representation

```mermaid
graph TD
    subgraph “New API Methods (Added)”
        A[from_font_weight] --> B[构造新实例]
        C[with_font_weight] --> D[修改现有实例]
    end
    subgraph “Existing API Pattern (Mirrored)”
        E[from_font_size] --> F[构造新实例]
        G[with_font_size] --> H[修改现有实例]
    end
    B --> I[TextFont 实例]
    D --> I
    F --> I
    H --> I
    I --> J[包含 FontWeight / FontSize 等字段]
```

## Key Files Changed

**`crates/bevy_text/src/text.rs` (+11/-0)**
这是此次PR修改的唯一文件。新增了`from_font_weight`和`with_font_weight`两个方法，使`TextFont`结构体设置字体权重的API与设置字体大小的API保持一致。

**关键代码修改：**
```rust
// 在 impl TextFont 块中添加的新方法：

/// Returns a new [`TextFont`] with the specified font weight
pub fn from_font_weight(weight: impl Into<FontWeight>) -> Self {
    Self::default().with_font_weight(weight)
}

// ... 其他已有方法 ...

/// Returns this [`TextFont`] with the specified [`FontWeight`].
pub fn with_font_weight(mut self, weight: impl Into<FontWeight>) -> Self {
    self.weight = weight.into();
    self
}
```

## Further Reading
1.  **Bevy 官方文档 - Text**: 了解 Bevy 文本渲染系统的基本概念和组件。
2.  **Rust 编程语言 - Builder Pattern**: 学习 Rust 中建造者模式的常见实现方式，这是`with_*`方法背后的设计模式。
3.  **Rust 编程语言 - `Into` Trait**: 深入理解`impl Into<T>`作为函数参数类型的好处，它如何提高API的灵活性和易用性。
4.  **相关PR #23006**: 查看与本PR相关的其他文本模块的改进，以获得更完整的上下文。