+++
title = "#19479 PlaneMeshBuilder: allow for different number of subdivisions in X and Z directions"
date = "2026-02-24T00:00:00"
draft = false
template = "pull_request_page.html"
in_search_index = true

[taxonomies]
list_display = ["show"]

[extra]
current_language = "en"
available_languages = {"en" = { name = "English", url = "/pull_request/bevy/2026-02/pr-19479-en-20260224" }, "zh-cn" = { name = "中文", url = "/pull_request/bevy/2026-02/pr-19479-zh-cn-20260224" }}
labels = ["C-Feature", "A-Math", "M-Migration-Guide", "D-Straightforward"]
+++

# Title
## PlaneMeshBuilder: allow for different number of subdivisions in X and Z directions

## Basic Information
- **Title**: PlaneMeshBuilder: allow for different number of subdivisions in X and Z directions
- **PR Link**: https://github.com/bevyengine/bevy/pull/19479
- **Author**: Wuketuke
- **Status**: MERGED
- **Labels**: C-Feature, S-Ready-For-Final-Review, A-Math, M-Migration-Guide, X-Uncontroversial, D-Straightforward
- **Created**: 2025-06-03T18:12:43Z
- **Merged**: 2026-02-24T03:09:59Z
- **Merged By**: alice-i-cecile

## Description Translation
Fixes #16437
it was as simple as @ulmer-a suggested
I also adapted the documentation

i havent manually tested if these axis arent switched, but from reading the code it should be fine

## The Story of This Pull Request

This PR addresses a limitation in Bevy's 3D plane mesh generation system. Previously, the `PlaneMeshBuilder` only supported a single subdivision value that applied equally to both the X and Z axes. This constraint prevented developers from creating rectangular grids with different levels of detail in each dimension, which is a common requirement for various use cases like terrain generation, UI elements, or non-square procedural meshes.

The issue was straightforward but restrictive: users who needed a 10×5 grid or any non-square subdivision pattern had no built-in way to achieve it. The existing implementation forced symmetrical subdivision, which is often not what developers need in practice.

The solution follows a predictable pattern in mesh generation APIs: splitting a single symmetrical parameter into separate axis-specific parameters. The developer implemented this by replacing the single `subdivisions` field with two separate fields: `subdivisions_x` and `subdivisions_z`. This approach maintains backward compatibility through the existing `subdivisions()` method, which now sets both axes to the same value, while providing new `subdivisions_x()` and `subdivisions_z()` methods for independent control.

Looking at the implementation, the changes are minimal but effective. The core logic in the `build()` method already calculated separate vertex counts for X and Z directions using the formula `subdivisions + 2`. The PR simply changes this to use the respective axis-specific subdivision values:

```rust
// Before:
let z_vertex_count = self.subdivisions + 2;
let x_vertex_count = self.subdivisions + 2;

// After:
let z_vertex_count = self.subdivisions_z + 2;
let x_vertex_count = self.subdivisions_x + 2;
```

This demonstrates good engineering practice: the existing algorithm already supported different counts in each dimension conceptually; it just needed the API to expose that capability.

The documentation updates are thorough, providing clear examples of what each subdivision level produces. For instance, setting `subdivisions_x = 1` adds "a vertex in the middle of the X axis, resulting in a plane with 2 quads / 4 triangles, and a new edge along the Z axis." This level of detail helps users understand exactly what they're creating.

One notable aspect is the migration strategy. The PR includes a migration guide that shows how to update code from the old field-based access to the new method-based approach:

```rust
// Before:
builder.subdivisions = 4
// After:
builder.subdivisions(4)
```

This is important because the `subdivisions` field no longer exists—it's been replaced by two separate fields. The migration guide provides the correct syntax for achieving the same behavior (equal subdivisions in both axes).

The implementation maintains the builder pattern that's common throughout Bevy's mesh generation APIs. Each setter method returns `Self`, allowing method chaining. This consistency with the rest of the codebase makes the feature intuitive for existing Bevy developers.

Performance considerations are minimal here. The change doesn't affect the mesh generation algorithm's complexity; it just changes the input parameters. The mesh generation still operates in O(n²) time relative to the total vertex count, which is expected for grid generation.

From an API design perspective, this change follows the principle of making simple things easy and complex things possible. The common case (equal subdivisions) remains simple with the existing `subdivisions()` method, while the more complex case (different subdivisions per axis) is now possible with the new axis-specific methods.

The PR author mentions not having manually tested if the axes are switched, but from reading the code, it should be correct. This is a reasonable assumption given that the original code already used separate calculations for X and Z vertex counts, and the changes simply parameterize those counts independently.

## Visual Representation

```mermaid
graph TD
    A[PlaneMeshBuilder] --> B[subdivisions_x: u32]
    A --> C[subdivisions_z: u32]
    B --> D[Vertex count in X direction]
    C --> E[Vertex count in Z direction]
    D --> F[Mesh generation]
    E --> F
    F --> G[Output Mesh]
    
    H[Legacy subdivisions() method] --> I[Sets both subdivisions_x and subdivisions_z]
```

## Key Files Changed

### `crates/bevy_mesh/src/primitives/dim3/plane.rs` (+57/-11)

This file contains the main implementation changes for the PlaneMeshBuilder. The changes replace a single `subdivisions` field with two separate fields for X and Z axes, update all constructor methods, add new setter methods, and modify the mesh generation logic to use the separate values.

**Key changes:**

1. **Struct field changes:**
```rust
// Before:
pub struct PlaneMeshBuilder {
    pub plane: Plane3d,
    pub subdivisions: u32,
}

// After:
pub struct PlaneMeshBuilder {
    pub plane: Plane3d,
    pub subdivisions_x: u32,
    pub subdivisions_z: u32,
}
```

2. **Updated constructors:**
```rust
// Example of updated constructor initialization:
// Before:
PlaneMeshBuilder {
    plane: Plane3d { ... },
    subdivisions: 0,
}

// After:
PlaneMeshBuilder {
    plane: Plane3d { ... },
    subdivisions_x: 0,
    subdivisions_z: 0,
}
```

3. **New axis-specific methods:**
```rust
pub fn subdivisions_x(mut self, subdivisions: u32) -> Self {
    self.subdivisions_x = subdivisions;
    self
}

pub fn subdivisions_z(mut self, subdivisions: u32) -> Self {
    self.subdivisions_z = subdivisions;
    self
}
```

4. **Updated mesh generation logic:**
```rust
// Before:
let z_vertex_count = self.subdivisions + 2;
let x_vertex_count = self.subdivisions + 2;

// After:
let z_vertex_count = self.subdivisions_z + 2;
let x_vertex_count = self.subdivisions_x + 2;
```

### `release-content/migration-guides/plane3d_subdivisions_xz.md` (+15/-0)

This new file provides a migration guide for users updating their code to work with the changed API.

**Content:**
```markdown
---
title: PlaneMeshBuilder, allow for different number of subdivisions in X and Z directions
pull_requests: [19479]
---

It is now possible to assign a different number of subdivisions on the X and Z axis.

The `subdivisions` field of `PlaneMeshBuilder` has been split into `subdivisions_x` and `subdivisions_z`.

```rust
// Before:
builder.subdivisions = 4
// After:
builder.subdivisions(4)
```
```

## Further Reading

1. **Bevy Mesh Primitives Documentation**: For understanding the broader mesh generation system in Bevy
2. **Builder Pattern in Rust**: For understanding the design pattern used throughout Bevy's API
3. **Procedural Mesh Generation**: For context on why flexible subdivision controls are important
4. **GitHub Issue #16437**: The original feature request that motivated this change