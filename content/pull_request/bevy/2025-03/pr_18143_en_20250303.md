+++
title = "#18143 Val::resolve doc comment fix"
date = "2025-03-03"
draft = false
template = "pull_request_page.html"
+++

## English

### Basic Information
- **Title**: `Val::resolve` doc comment fix
- **PR Link**: https://github.com/bevyengine/bevy/pull/18143
- **Author**: ickshonpe
- **Status**: MERGED
- **Created**: 2025-03-03T18:09:45Z
- **Merged**: 2025-03-03T19:22:17Z
- **Merged By**: alice-i-cecile

### Description Translation
This PR fixes an inaccurate documentation comment for the `Val::resolve` method in Bevy's UI layout system. The original documentation incorrectly stated that the method always returns values in logical pixels, when in reality this is only true when the inputs are already in logical pixels.

### The Story of This Pull Request

#### The Problem and Context
In Bevy's UI system, the `Val` enum represents various measurement units including pixels, percentages, and viewport-relative units. The `resolve` method converts these abstract values into concrete pixel measurements based on parent container dimensions. However, the documentation incorrectly claimed:
```rust
/// Returns the resolved value in logical pixels
```
This misleading statement could cause developers to misunderstand the method's behavior when working with percentage-based or viewport-relative values.

#### The Developer's Journey
While working with Bevy's layout system, the author noticed a discrepancy between documentation and actual behavior. Through code examination and testing, they confirmed that:
- `Val::Px` directly returns pixel values
- Percentage-based values (`Percent`, `Vw`, `Vh` etc.) require parent/viewport dimensions for resolution
- The documentation's blanket statement about "logical pixels" was oversimplified

#### The Implementation
The fix focused on precise technical writing. The key change modified the doc comment to clarify:
```rust
/// Resolves this [`Val`] to a concrete pixel value using the provided `parent_length` and `viewport_size`.
/// 
/// For percentage-based [`Val`] variants, the resolved value depends on the parent node's dimensions.
/// Viewport-relative variants (`Vw`, `Vh`, etc.) use the current viewport size for calculation.
/// The `Auto` variant returns 0.0 pixels by default.
```

#### Technical Insights
The correction addresses a common pitfall in API documentation - accurately describing conversion behaviors. The original statement failed to explain that:
1. Pixel resolution requires context (parent size/viewport dimensions)
2. Different `Val` variants have different resolution mechanics
3. `Auto` has special handling (returns 0.0 by convention)

#### The Impact
This change improves developer experience by:
- Preventing incorrect assumptions about unit conversion
- Clarifying the role of parent/viewport dimensions
- Documenting the default behavior of `Val::Auto`
- Maintaining backwards compatibility (no code changes needed)

### Visual Representation

```
┌─────────────┐       ┌──────────────┐
│   Val::Px   │──────►│ Direct value │
└─────────────┘       └──────────────┘
       │
       │          ┌───────────────────┐
       ├─────────►│ Percentage-based  │
       │          │ (requires parent  │
       │          │  dimensions)      │
       │          └───────────────────┘
       │
       └─────────►┌───────────────────┐
                  │ Viewport-relative │
                  │ (needs viewport   │
                  │  size)           │
                  └───────────────────┘
```

### Key Files Changed

#### `crates/bevy_ui/src/geometry.rs`
**Change**: Updated doc comment for `Val::resolve` method

Before:
```rust
/// Returns the resolved value in logical pixels
pub fn resolve(&self, parent_length: f32, viewport_size: Vec2) -> f32 {
```

After:
```rust
/// Resolves this [`Val`] to a concrete pixel value using the provided `parent_length` and `viewport_size`.
/// 
/// For percentage-based [`Val`] variants, the resolved value depends on the parent node's dimensions.
/// Viewport-relative variants (`Vw`, `Vh`, etc.) use the current viewport size for calculation.
/// The `Auto` variant returns 0.0 pixels by default.
pub fn resolve(&self, parent_length: f32, viewport_size: Vec2) -> f32 {
```

**Impact**: Clarifies the resolution logic for different `Val` variants and their dependencies on external dimensions.

### Further Reading
1. [Bevy UI Layout Documentation](https://bevyengine.org/learn/book/features/ui/)
2. [Rust API Documentation Guidelines](https://rust-lang.github.io/api-guidelines/documentation.html)
3. [CSS Relative Length Units (analogous concepts)](https://developer.mozilla.org/en-US/docs/Learn/CSS/Building_blocks/Values_and_units)