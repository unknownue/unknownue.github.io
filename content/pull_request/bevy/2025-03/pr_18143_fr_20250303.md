+++
title = "PR #18143"
date = "2025-03-03T00:00:00"
draft = false
template = "pull_request_page.html"

[extra]
current_language = "fr"
available_languages = {"fr" = { name = "Français", url = "/pull_request/bevy/2025-03/pr-18143-fr-20250303" }, "en" = { name = "English", url = "/pull_request/bevy/2025-03/pr-18143-en-20250303" }, "zh-cn" = { name = "中文", url = "/pull_request/bevy/2025-03/pr-18143-zh-cn-20250303" }}
+++


















## Français

### Informations de base
- **Titre**: Correction du commentaire doc pour `Val::resolve`
- **Lien PR**: https://github.com/bevyengine/bevy/pull/18143
- **Auteur**: ickshonpe
- **Statut**: FUSIONNÉ
- **Créé le**: 2025-03-03T18:09:45Z
- **Fusionné le**: 2025-03-03T19:22:17Z
- **Fusionné par**: alice-i-cecile

### Traduction de la description
Cette PR corrige un commentaire de documentation inexact pour la méthode `Val::resolve` dans le système de mise en page UI de Bevy. La documentation originale indiquait à tort que la méthode retournait toujours des valeurs en pixels logiques, alors que ce n'est vrai que lorsque les entrées sont déjà en pixels logiques.

### L'histoire de cette Pull Request

#### Le problème et le contexte
Dans le système UI de Bevy, l'énumération `Val` représente diverses unités de mesure incluant des pixels, pourcentages et unités relatives au viewport. La méthode `resolve` convertit ces valeurs abstraites en mesures concrètes de pixels basées sur les dimensions du conteneur parent. Cependant, la documentation déclarait incorrectement :
```rust
/// Retourne la valeur résolue en pixels logiques
```
Cette affirmation trompeuse pouvait induire les développeurs en erreur lors de l'utilisation de valeurs en pourcentage ou relatives au viewport.

#### Le parcours du développeur
En travaillant avec le système de mise en page de Bevy, l'auteur a remarqué une divergence entre la documentation et le comportement réel. Par l'examen du code et des tests, il a confirmé que :
- `Val::Px` retourne directement des valeurs en pixels
- Les valeurs en pourcentage (`Percent`, `Vw`, `Vh` etc.) nécessitent les dimensions parent/viewport pour la résolution
- L'affirmation générale de la documentation sur les "pixels logiques" était trop simpliste

#### L'implémentation
La correction s'est concentrée sur la précision technique de la documentation. Le changement clé a modifié le commentaire pour clarifier :
```rust
/// Résout cette [`Val`] en une valeur de pixel concrète en utilisant `parent_length` et `viewport_size`.
/// 
/// Pour les variantes de [`Val`] basées sur un pourcentage, la valeur résolue dépend des dimensions du nœud parent.
/// Les variantes relatives au viewport (`Vw`, `Vh`, etc.) utilisent la taille actuelle du viewport pour le calcul.
/// La variante `Auto` retourne 0.0 pixel par défaut.
```

#### Insights techniques
Cette correction aborde un piège courant dans la documentation d'API - décrire avec précision les comportements de conversion. L'énoncé original ne parvenait pas à expliquer que :
1. La résolution en pixels nécessite un contexte (dimensions parent/viewport)
2. Différentes variantes de `Val` ont des mécanismes de résolution différents
3. `Auto` a un traitement spécial (retourne 0.0 par convention)

#### L'impact
Ce changement améliore l'expérience des développeurs en :
- Prévenant les suppositions incorrectes sur la conversion d'unités
- Clarifiant le rôle des dimensions parent/viewport
- Documentant le comportement par défaut de `Val::Auto`
- Maintenant la compatibilité ascendante (aucun changement de code nécessaire)

### Représentation visuelle

```
┌─────────────┐       ┌──────────────────┐
│   Val::Px   │──────►│ Valeur directe    │
└─────────────┘       └──────────────────┘
       │
       │          ┌───────────────────────┐
       ├─────────►│ Calcul en pourcentage │
       │          │ (nécessite dimensions │
       │          │  parent)             │
       │          └───────────────────────┘
       │
       └─────────►┌───────────────────────┐
                  │ Calcul relatif au     │
                  │ viewport             │
                  │ (nécessite taille     │
                  │  viewport)           │
                  └───────────────────────┘
```

### Fichiers clés modifiés

#### `crates/bevy_ui/src/geometry.rs`
**Modification**: Mise à jour du commentaire doc pour la méthode `Val::resolve`

Avant :
```rust
/// Returns the resolved value in logical pixels
pub fn resolve(&self, parent_length: f32, viewport_size: Vec2) -> f32 {
```

Après :
```rust
/// Resolves this [`Val`] to a concrete pixel value using the provided `parent_length` and `viewport_size`.
/// 
/// For percentage-based [`Val`] variants, the resolved value depends on the parent node's dimensions.
/// Viewport-relative variants (`Vw`, `Vh`, etc.) use the current viewport size for calculation.
/// The `Auto` variant returns 0.0 pixels by default.
pub fn resolve(&self, parent_length: f32, viewport_size: Vec2) -> f32 {
```

**Impact**: Clarifie la logique de résolution pour différentes variantes de `Val` et leurs dépendances aux dimensions externes.

### Pour aller plus loin
1. [Documentation UI de Bevy](https://bevyengine.org/learn/book/features/ui/)
2. [Guide de documentation d'API Rust](https://rust-lang.github.io/api-guidelines/documentation.html)
3. [Unités CSS relatives (concepts analogues)](https://developer.mozilla.org/fr/docs/Learn/CSS/Building_blocks/Values_and_units)