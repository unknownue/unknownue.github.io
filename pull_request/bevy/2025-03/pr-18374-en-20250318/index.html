<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://unknownue.github.io name=base><title>
         #18374 only handle bin examples in showcase
        
    </title><meta content="#18374 only handle bin examples in showcase" property=og:title><meta content="A personal blog built with Zola and Apollo theme" property=og:description><meta content="A personal blog built with Zola and Apollo theme" name=description><link href=/icons/favicon.png rel=icon type=image/png><link href=https://unknownue.github.io/fonts.css rel=stylesheet><script src=https://unknownue.github.io/js/codeblock.js></script><script src=https://unknownue.github.io/js/toc.js></script><script src=https://unknownue.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Unknownue's Blog" href=https://unknownue.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://unknownue.github.io/theme/light.css rel=stylesheet><link href=https://unknownue.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://unknownue.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://unknownue.github.io/main.css media=screen rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js></script><script>// Initialize mermaid once DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            mermaid.initialize({
                startOnLoad: false,
                theme: document.body && document.body.classList.contains('dark') ? 'dark' : 'default',
                securityLevel: 'loose',
                flowchart: {
                    useMaxWidth: true,
                    htmlLabels: true
                },
                sequence: {
                    diagramMarginX: 50,
                    diagramMarginY: 10,
                    actorMargin: 50,
                    width: 150,
                    height: 65
                }
            });
        });</script><script src=https://unknownue.github.io/js/main.js></script><script defer src=https://unknownue.github.io/js/label-colors.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/rust.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/typescript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/go.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/cpp.min.js></script><script>// Ensure highlight.js is properly configured
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof hljs !== 'undefined') {
                hljs.configure({
                    languages: ['rust', 'javascript', 'python', 'cpp', 'go', 'typescript'],
                    ignoreUnescapedHTML: true
                });
                console.log('Highlight.js configured in header');
            }
        });</script><link href=https://cdn.jsdelivr.net/npm/diff2html/bundles/css/diff2html.min.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/diff2html/bundles/js/diff2html-ui.min.js></script><script src=https://unknownue.github.io/js/syntax-highlight.js></script><script src=https://unknownue.github.io/js/diff-sidebar.js></script><script src="https://unknownue.github.io/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><div class=content><header><div class=main><a href=https://unknownue.github.io>Unknownue's Blog</a><div class=socials><a class=social href=https://github.com/unknownue rel=me> <img alt=github src=https://unknownue.github.io/icons/social/github.svg> </a><a class=social href=https://github.com/unknownue/unknownue.github.io rel=me> <img alt=github-io src=https://unknownue.github.io/icons/social/rss.svg> </a></div></div><nav><a href=https://unknownue.github.io/posts style=margin-left:.25em>/posts</a><a href=https://unknownue.github.io/projects style=margin-left:.25em>/projects</a><a href=https://unknownue.github.io/about style=margin-left:.25em>/about</a><a href=https://unknownue.github.io/tags style=margin-left:.25em>/tags</a><button title="$SHORTCUT to open search" class=search-button id=search-button><img alt=Search class=search-icon src=https://unknownue.github.io/icons/search.svg></button><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><div id=modal-content><h1 class=page-header id=modalTitle>Search</h1><div id=searchBar><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search... role=combobox spellcheck=false><button title="Clear search" class=clear-button id=clear-search><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></button></div><div id=results-container><div id=results-info><span id=zero_results style=display:none>No results</span><span id=one_result style=display:none>1 result</span><span id=many_results style=display:none>$NUMBER results</span></div><div id=results role=listbox></div></div></div></div><a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://unknownue.github.io/icons/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://unknownue.github.io/icons/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><div class=pull-request-page><article class=md-content-page style=display:none></article><div class=back-link><a href=/pull_request/bevy/2025-03/>← Back to Pull Requests</a></div><div class=pr-metadata><span class=pr-date>2025-03-18</span><div class=language-switcher><span class="lang-link active" data-lang=en>English</span> / <a class=lang-link data-lang=zh-cn href=/pull_request/bevy/2025-03/pr-18374-zh-cn-20250318>中文</a></div></div><div class=pr-content><h1 id=18374-only-handle-bin-examples-in-showcase>#18374 only handle bin examples in showcase</h1><h2 id=basic-information>Basic Information</h2><ul><li><strong>Title</strong>: only handle bin examples in showcase<li><strong>PR Link</strong>: https://github.com/bevyengine/bevy/pull/18374<li><strong>Author</strong>: mockersf<li><strong>Status</strong>: MERGED<li><strong>Created</strong>: 2025-03-17T22:42:06Z<li><strong>Merged</strong>: 2025-03-18T08:12:15Z<li><strong>Merged By</strong>: cart</ul><h2 id=description-translation>Description Translation</h2><h1 id=objective>Objective</h1><ul><li>Some examples are now build as lib to be usable in other examples since https://github.com/bevyengine/bevy/pull/18288<li>Those examples are not correctly handled in the showcase as it tries to run them</ul><h2 id=solution>Solution</h2><ul><li>Ignore lib examples in showcase when taking screenshots or building for the website</ul><h2 id=the-story-of-this-pull-request>The Story of This Pull Request</h2><p>The Bevy engine’s example showcase system faced a new challenge after PR #18288 introduced library-style examples. These lib examples were designed to be reused in other examples but weren’t meant to be executed directly. However, the existing showcase tool processed all examples uniformly, attempting to run both binary and library targets. This caused failures during website generation and screenshot capture processes.<p>The core issue stemmed from how cargo metadata organizes build targets. Examples can be either [[bin]] (executable) or [[lib]] (library) types, distinguished in their Cargo.toml definitions. The showcase system needed to differentiate between these target types but was previously unaware of this distinction.<p>The solution involved modifying the example iteration logic in the showcase tool’s main processing loop. By filtering targets based on their kind attribute, the system could exclude library examples from execution paths while maintaining binary example processing. This required:<ol><li>Accessing cargo metadata’s target.kind information<li>Implementing a filter during example collection<li>Preserving existing screenshot capture and website generation workflows</ol><p>The key implementation change occurred in the example collection phase. Previously, the code collected all examples regardless of type:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#fa6e32>let</span><span> examples </span><span style=color:#ed9366>=</span><span> metadata
</span><span>    </span><span style=color:#ed9366>.</span><span>packages
</span><span>    </span><span style=color:#ed9366>.</span><span style=color:#f07171>iter</span><span>()
</span><span>    </span><span style=color:#ed9366>.</span><span style=color:#f07171>flat_map</span><span>(|</span><span style=color:#ff8f40>p</span><span>| </span><span style=color:#ed9366>&</span><span>p</span><span style=color:#ed9366>.</span><span>targets)
</span><span>    </span><span style=color:#ed9366>.</span><span style=color:#f07171>filter</span><span>(|</span><span style=color:#ff8f40>t</span><span>| t</span><span style=color:#ed9366>.</span><span style=color:#f07171>is_example</span><span>())</span><span style=color:#61676ccc>;
</span></code></pre><p>The updated version adds a filter on target kind:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#ed9366>.</span><span style=color:#f07171>filter</span><span>(|</span><span style=color:#ff8f40>t</span><span>| t</span><span style=color:#ed9366>.</span><span>kind</span><span style=color:#ed9366>.</span><span style=color:#f07171>iter</span><span>()</span><span style=color:#ed9366>.</span><span style=color:#f07171>any</span><span>(|</span><span style=color:#ff8f40>k</span><span>| k </span><span style=color:#ed9366>== </span><span style=color:#86b300>"bin"</span><span>))
</span></code></pre><p>This single filter condition effectively excludes library examples (which have <code>kind = ["lib"]</code>) from subsequent processing steps. The change maintained compatibility with existing workflows while preventing invalid execution attempts on library targets.<p>From an architectural perspective, this modification demonstrates the importance of understanding cargo’s metadata structure when building Rust tooling. The fix leverages built-in cargo classification rather than implementing custom filtering logic, making it more robust to future cargo updates.<p>The impact is immediate and specific: website generation now skips 8 library examples that were previously causing errors. This keeps CI pipelines green while preserving the showcase’s core functionality. Developers maintaining example systems can learn from this case that target kind metadata is crucial when processing cargo workspaces programmatically.<h2 id=visual-representation>Visual Representation</h2><pre class=language-mermaid data-lang=mermaid style=color:#61676c;background-color:#fafafa><code class=language-mermaid data-lang=mermaid><span>graph TD
</span><span>    A[Showcase Tool] --> B[Collect Examples]
</span><span>    B --> C{Is bin target?}
</span><span>    C -->|Yes| D[Process Example]
</span><span>    C -->|No| E[Skip Example]
</span><span>    D --> F[Capture Screenshot]
</span><span>    D --> G[Generate Web Page]
</span></code></pre><h2 id=key-files-changed>Key Files Changed</h2><p><strong><code>tools/example-showcase/src/main.rs</code></strong> (+30/-0)<ol><li>Added target kind filtering to example collection logic</ol><pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Modified example collection filter
</span><span style=color:#ed9366>.</span><span style=color:#f07171>filter</span><span>(|</span><span style=color:#ff8f40>t</span><span>| t</span><span style=color:#ed9366>.</span><span>kind</span><span style=color:#ed9366>.</span><span style=color:#f07171>iter</span><span>()</span><span style=color:#ed9366>.</span><span style=color:#f07171>any</span><span>(|</span><span style=color:#ff8f40>k</span><span>| k </span><span style=color:#ed9366>== </span><span style=color:#86b300>"bin"</span><span>))
</span></code></pre><ol start=2><li>Maintained existing processing for valid binary examples<li>No changes required to screenshot capture or web template logic</ol><h2 id=further-reading>Further Reading</h2><ol><li><a rel="noopener nofollow noreferrer" href=https://doc.rust-lang.org/cargo/commands/cargo-metadata.html target=_blank>Cargo Metadata Specification</a> - Official documentation for cargo’s metadata format<li><a rel="noopener nofollow noreferrer" href=https://doc.rust-lang.org/cargo/reference/cargo-targets.html target=_blank>Rust Target Configuration</a> - Cargo target types and their configurations<li><a rel="noopener nofollow noreferrer" href=https://github.com/bevyengine/bevy/t/main/examples target=_blank>Bevy Examples Structure</a> - How Bevy organizes its example projects</ol></div><div data-is-md-page=true data-patch-exists=true data-patch-path=/pull_request/bevy/2025-03/pr_18374.patch id=patch-info style=display:none></div><div class=bottom-spacer></div></div></div>