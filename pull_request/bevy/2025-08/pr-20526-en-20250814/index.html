<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://unknownue.github.io name=base><title>
         #20526 Add release notes for meshlet BVH culling
        
    </title><meta content="#20526 Add release notes for meshlet BVH culling" property=og:title><meta content="A personal blog built with Zola and Apollo theme" property=og:description><meta content="A personal blog built with Zola and Apollo theme" name=description><link href=/icons/favicon.png rel=icon type=image/png><link href=https://unknownue.github.io/fonts.css rel=stylesheet><script src=https://unknownue.github.io/js/codeblock.js></script><script src=https://unknownue.github.io/js/toc.js></script><script src=https://unknownue.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Unknownue's Blog" href=https://unknownue.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://unknownue.github.io/theme/light.css rel=stylesheet><link href=https://unknownue.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://unknownue.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://unknownue.github.io/main.css media=screen rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js></script><script>// Initialize mermaid once DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            mermaid.initialize({
                startOnLoad: false,
                theme: document.body && document.body.classList.contains('dark') ? 'dark' : 'default',
                securityLevel: 'loose',
                flowchart: {
                    useMaxWidth: true,
                    htmlLabels: true
                },
                sequence: {
                    diagramMarginX: 50,
                    diagramMarginY: 10,
                    actorMargin: 50,
                    width: 150,
                    height: 65
                }
            });
        });</script><script src=https://unknownue.github.io/js/main.js></script><script defer src=https://unknownue.github.io/js/label-colors.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/rust.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/typescript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/go.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/cpp.min.js></script><script>// Ensure highlight.js is properly configured
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof hljs !== 'undefined') {
                hljs.configure({
                    languages: ['rust', 'javascript', 'python', 'cpp', 'go', 'typescript'],
                    ignoreUnescapedHTML: true
                });
                console.log('Highlight.js configured in header');
            }
        });</script><link href=https://cdn.jsdelivr.net/npm/diff2html/bundles/css/diff2html.min.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/diff2html/bundles/js/diff2html-ui.min.js></script><script src=https://unknownue.github.io/js/syntax-highlight.js></script><script src=https://unknownue.github.io/js/diff-sidebar.js></script><script src="https://unknownue.github.io/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><div class=content><header><div class=main><a href=https://unknownue.github.io>Unknownue's Blog</a><div class=socials><a class=social href=https://github.com/unknownue rel=me> <img alt=github src=https://unknownue.github.io/icons/social/github.svg> </a><a class=social href=https://github.com/unknownue/unknownue.github.io rel=me> <img alt=github-io src=https://unknownue.github.io/icons/social/rss.svg> </a></div></div><nav><a href=https://unknownue.github.io/posts style=margin-left:.25em>/posts</a><a href=https://unknownue.github.io/projects style=margin-left:.25em>/projects</a><a href=https://unknownue.github.io/about style=margin-left:.25em>/about</a><a href=https://unknownue.github.io/tags style=margin-left:.25em>/tags</a><button title="$SHORTCUT to open search" class=search-button id=search-button><img alt=Search class=search-icon src=https://unknownue.github.io/icons/search.svg></button><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><div id=modal-content><h1 class=page-header id=modalTitle>Search</h1><div id=searchBar><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search... role=combobox spellcheck=false><button title="Clear search" class=clear-button id=clear-search><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></button></div><div id=results-container><div id=results-info><span id=zero_results style=display:none>No results</span><span id=one_result style=display:none>1 result</span><span id=many_results style=display:none>$NUMBER results</span></div><div id=results role=listbox></div></div></div></div><a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://unknownue.github.io/icons/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://unknownue.github.io/icons/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><div class=pull-request-page><article class=md-content-page style=display:none></article><div class=back-link><a href=/pull_request/bevy/2025-08/>← Back to Pull Requests</a></div><div class=pr-metadata><span class=pr-date>2025-08-14</span><div class=language-switcher><span class="lang-link active" data-lang=en>English</span> / <a class=lang-link data-lang=zh-cn href=/pull_request/bevy/2025-08/pr-20526-zh-cn-20250814>中文</a></div></div><div class=pr-content><h1 id=analysis-of-pr-20526-add-release-notes-for-meshlet-bvh-culling>Analysis of PR #20526: Add release notes for meshlet BVH culling</h1><h2 id=basic-information>Basic Information</h2><ul><li><strong>Title</strong>: Add release notes for meshlet BVH culling<li><strong>PR Link</strong>: https://github.com/bevyengine/bevy/pull/20526<li><strong>Author</strong>: SparkyPotato<li><strong>Status</strong>: MERGED<li><strong>Labels</strong>: C-Docs, A-Rendering, S-Ready-For-Final-Review<li><strong>Created</strong>: 2025-08-11T23:56:05Z<li><strong>Merged</strong>: 2025-08-14T21:02:26Z<li><strong>Merged By</strong>: alice-i-cecile</ul><h2 id=the-story-of-this-pull-request>The Story of This Pull Request</h2><h3 id=the-problem-and-context>The Problem and Context</h3><p>Bevy’s virtual geometry system previously had significant scalability limitations in large scenes. The engine imposed a hardcoded cluster limit of 2^24 clusters (approximately 4 billion triangles), which constrained scene complexity. More critically, rendering performance was heavily dependent on total scene geometry rather than visible geometry. This meant that adding more objects to a scene caused near-linear increases in GPU workload, making complex scenes prohibitively expensive to render.<h3 id=the-solution-approach>The Solution Approach</h3><p>The solution implemented in the referenced PR (#19318) introduced BVH (Bounding Volume Hierarchy) culling to Bevy’s meshlet rendering pipeline. This spatial acceleration structure organizes scene geometry hierarchically, enabling efficient visibility testing. Instead of processing all geometry, the system can now quickly discard entire sections of the scene that aren’t visible, significantly reducing GPU workload. This approach transformed rendering performance from geometry-dependent to visibility-dependent.<h3 id=the-implementation>The Implementation</h3><p>This PR (#20526) documents the technical achievements through release notes. The notes highlight two key improvements:<ol><li><strong>Removed cluster limit</strong>: The previous 4 billion triangle limit was eliminated, allowing arbitrarily large scenes constrained only by available VRAM<li><strong>BVH-based culling</strong>: The new spatial acceleration structure enables near-constant rendering time regardless of scene complexity</ol><p>The release notes quantify performance improvements using concrete metrics:<ul><li>130k dragon instances (115B triangles) render in 3.5ms on RTX 4070<li>1M+ instances (900B+ triangles) render in 4.5ms - only 30% slower despite 8x more geometry<li>Comparison to v0.16 shows 1.3ms vs 2.2ms for 1,300 instances</ul><h3 id=technical-insights>Technical Insights</h3><p>The BVH implementation fundamentally changes how Bevy processes geometry:<ol><li>Spatial partitioning organizes geometry into hierarchical bounding volumes<li>Early visibility testing discards entire subtrees of geometry<li>GPU workload becomes proportional to visible geometry rather than total geometry<li>Triangle processing shifts from CPU-bound to GPU-bound with optimized culling</ol><p>Current limitations noted:<ul><li>All instance data re-uploaded each frame (CPU bottleneck at high instance counts)<li>No asset streaming yet (VRAM limits scene complexity)<li>Material evaluation remains constant cost (~0.4ms in test cases)</ul><h3 id=the-impact>The Impact</h3><p>This optimization enables orders-of-magnitude more complex scenes with minimal performance penalty. Scenes with hundreds of billions of triangles become practically renderable where they were previously impossible. The performance characteristics shift from O(n) to nearly O(1) relative to total geometry, fundamentally changing how developers can design large-scale environments in Bevy.<h2 id=visual-representation>Visual Representation</h2><pre class=language-mermaid data-lang=mermaid style=color:#61676c;background-color:#fafafa><code class=language-mermaid data-lang=mermaid><span>graph TD
</span><span>    A[Meshlet BVH Culling PR] --> B[Removes cluster limit]
</span><span>    A --> C[Enables massive scenes]
</span><span>    A --> D[BVH acceleration structure]
</span><span>    D --> E[Frustum culling]
</span><span>    D --> F[Occlusion culling]
</span><span>    E --> G[Reduces visible geometry]
</span><span>    F --> G
</span><span>    G --> H[Constant-time rendering]
</span></code></pre><h2 id=key-files-changed>Key Files Changed</h2><h3 id=release-content-release-notes-meshlet-bvh-culling-md><code>release-content/release-notes/meshlet-bvh-culling.md</code></h3><p>This new file documents the BVH culling feature for release notes. It provides both technical explanations and quantitative performance data.<pre class=language-markdown data-lang=markdown style=color:#61676c;background-color:#fafafa><code class=language-markdown data-lang=markdown><span style=color:#abb0b6;background-color:#61676c10;font-weight:700>---
</span><span>title: Virtual Geometry BVH culling
</span><span>authors: ["@SparkyPotato", "@atlv24"]
</span><span>pull_requests: [19318]
</span><span style=color:#fa6e32;font-weight:700>---
</span><span>
</span><span>(TODO: Embed example screenshot here)
</span><span>
</span><span>Bevy's virtual geometry has been greatly optimized with BVH-based culling, making the cost of rendering nearly independent of scene geometry.
</span><span>Comparing the sample scene shown above with 130k dragon instances to one with over 1 million instances, total GPU rendering time only increases by 30%.
</span><span>
</span><span>This also gets rid of the previous cluster limit that limited the world to 2^24 clusters (about 4 billion triangles).
</span><span>There are now </span><span style=color:#f07171;font-style:italic>*no*</span><span> hardcoded limits to scene size. In practice you will only be limited by asset VRAM usage (since streaming is not yet implemented),
</span><span>and total instance count due the current code requiring all instances to be re-uploaded to the GPU every frame.
</span><span>
</span><span>The screenshot above has 130,000 dragons in the scene, each with about 870,000 triangles, leading to over </span><span style=color:#f07171;font-style:italic>*115 billion*</span><span> total triangles in the scene.
</span><span>
</span><span>Speaking of concrete GPU cost, the scene above renders in about 3.5 ms on the 4070, with </span><span style=color:#4cbf99>\~</span><span>3.1 ms being spent on the geometry render and </span><span style=color:#4cbf99>\~</span><span>0.4 ms on the material evaluation.
</span><span>After increasing the instance count to over 1 million (almost </span><span style=color:#f07171;font-style:italic>*900 billion triangles*</span><span>!), the total increases to about 4.5 ms, with </span><span style=color:#4cbf99>\~</span><span>4.1 ms on geometry render and material evaluation remaining constant at ~0.4 ms.
</span><span>This is a 30% increase in GPU time for an almost 8x increase in scene complexity.
</span><span style=color:#f51818>
</span><span>Comparing GPU times to 0.16 on a much smaller scene with 1,300 instances, previously the full render took 2.2 ms, whereas now it is 1.3 ms.
</span></code></pre><h2 id=further-reading>Further Reading</h2><ol><li><a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/Bounding_volume_hierarchy target=_blank>Bounding Volume Hierarchy fundamentals</a><li><a rel="noopener nofollow noreferrer" href=https://www.gdcvault.com/play/1026182/Mesh-Shading-State-of target=_blank>Meshlet rendering techniques</a><li><a rel="noopener nofollow noreferrer" href=https://github.com/bevyengine/bevy/pull/19318 target=_blank>Original implementation PR #19318</a><li><a rel="noopener nofollow noreferrer" href=https://advances.realtimerendering.com/s2020/index.htm target=_blank>Virtual geometry systems design</a></ol></div><div data-is-md-page=true data-patch-exists=true data-patch-path=/pull_request/bevy/2025-08/pr_20526.patch id=patch-info style=display:none></div><div class=bottom-spacer></div></div></div>