<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://unknownue.github.io name=base><title>
         #20417
        
    </title><meta content=#20417 property=og:title><meta content="A personal blog built with Zola and Apollo theme" property=og:description><meta content="A personal blog built with Zola and Apollo theme" name=description><link href=/icons/favicon.png rel=icon type=image/png><link href=https://unknownue.github.io/fonts.css rel=stylesheet><script src=https://unknownue.github.io/js/codeblock.js></script><script src=https://unknownue.github.io/js/toc.js></script><script src=https://unknownue.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Unknownue's Blog" href=https://unknownue.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://unknownue.github.io/theme/light.css rel=stylesheet><link href=https://unknownue.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://unknownue.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://unknownue.github.io/main.css media=screen rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js></script><script>// Initialize mermaid once DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            mermaid.initialize({
                startOnLoad: false,
                theme: document.body && document.body.classList.contains('dark') ? 'dark' : 'default',
                securityLevel: 'loose',
                flowchart: {
                    useMaxWidth: true,
                    htmlLabels: true
                },
                sequence: {
                    diagramMarginX: 50,
                    diagramMarginY: 10,
                    actorMargin: 50,
                    width: 150,
                    height: 65
                }
            });
        });</script><script src=https://unknownue.github.io/js/main.js></script><script defer src=https://unknownue.github.io/js/label-colors.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/rust.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/typescript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/go.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/cpp.min.js></script><script>// Ensure highlight.js is properly configured
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof hljs !== 'undefined') {
                hljs.configure({
                    languages: ['rust', 'javascript', 'python', 'cpp', 'go', 'typescript'],
                    ignoreUnescapedHTML: true
                });
                console.log('Highlight.js configured in header');
            }
        });</script><link href=https://cdn.jsdelivr.net/npm/diff2html/bundles/css/diff2html.min.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/diff2html/bundles/js/diff2html-ui.min.js></script><script src=https://unknownue.github.io/js/syntax-highlight.js></script><script src=https://unknownue.github.io/js/diff-sidebar.js></script><script src="https://unknownue.github.io/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><div class=content><header><div class=main><a href=https://unknownue.github.io>Unknownue's Blog</a><div class=socials><a class=social href=https://github.com/unknownue rel=me> <img alt=github src=https://unknownue.github.io/icons/social/github.svg> </a><a class=social href=https://github.com/unknownue/unknownue.github.io rel=me> <img alt=github-io src=https://unknownue.github.io/icons/social/rss.svg> </a></div></div><nav><a href=https://unknownue.github.io/posts style=margin-left:.25em>/posts</a><a href=https://unknownue.github.io/projects style=margin-left:.25em>/projects</a><a href=https://unknownue.github.io/about style=margin-left:.25em>/about</a><a href=https://unknownue.github.io/tags style=margin-left:.25em>/tags</a><button title="$SHORTCUT to open search" class=search-button id=search-button><img alt=Search class=search-icon src=https://unknownue.github.io/icons/search.svg></button><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><div id=modal-content><h1 class=page-header id=modalTitle>Search</h1><div id=searchBar><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search... role=combobox spellcheck=false><button title="Clear search" class=clear-button id=clear-search><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></button></div><div id=results-container><div id=results-info><span id=zero_results style=display:none>No results</span><span id=one_result style=display:none>1 result</span><span id=many_results style=display:none>$NUMBER results</span></div><div id=results role=listbox></div></div></div></div><a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://unknownue.github.io/icons/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://unknownue.github.io/icons/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><div class=pull-request-page><article class=md-content-page style=display:none></article><div class=back-link><a href=/pull_request/bevy/2025-08/>← Back to Pull Requests</a></div><div class=pr-metadata><span class=pr-date>2025-08-05</span><div class=language-switcher><span class="lang-link active" data-lang=en>English</span> / <a class=lang-link data-lang=zh-cn href=/pull_request/bevy/2025-08/pr-20417-zh-cn-20250805>中文</a></div></div><div class=pr-content><h2 id=technical-analysis-making-cubicsegment-iter-uniformly-public>Technical Analysis: Making <code>CubicSegment::iter_uniformly</code> Public</h2><h3 id=the-problem-and-context>The Problem and Context</h3><p>In Bevy’s math utilities, the <code>CubicSegment::iter_uniformly</code> method was implemented as a private helper function. This method provides uniform sampling of the <code>t</code> parameter along a cubic Bézier curve segment, which is essential for generating evenly spaced points along curves. While the method was internally used for curve evaluation, its private status prevented external consumers from leveraging this sampling functionality for their own curve-related operations.<p>There was no technical justification for keeping this utility private – it doesn’t mutate state, expose internal implementation details, or pose any security risks. Its private status was simply an oversight that limited the API’s flexibility without providing any benefits.<h3 id=the-solution-approach>The Solution Approach</h3><p>The straightforward solution was to change the method’s visibility from private to public. Since the method was already fully implemented and tested through its existing internal usage, no implementation changes were needed beyond the visibility modifier. The author correctly identified that exposing this utility would:<ol><li>Provide direct access to uniform parameter sampling<li>Maintain API consistency with other public curve utilities<li>Avoid unnecessary code duplication if users needed similar functionality</ol><h3 id=the-implementation>The Implementation</h3><p>The change is minimal but impactful, consisting of a single character change in the method signature:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// File: crates/bevy_math/src/cubic_splines/mod.rs
</span><span style=color:#abb0b6;font-style:italic>// Before:
</span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>inline</span><span>]
</span><span style=color:#fa6e32>fn </span><span style=color:#f29718>iter_uniformly</span><span>(</span><span style=color:#ed9366>&</span><span style=color:#ff8f40>self</span><span>, </span><span style=color:#ff8f40>subdivisions</span><span style=color:#61676ccc>: </span><span style=color:#fa6e32>usize</span><span>) </span><span style=color:#61676ccc>-></span><span> impl </span><span style=color:#55b4d4;font-style:italic>Iterator</span><span>&LTItem = </span><span style=color:#fa6e32>f32</span><span>> {
</span><span>    </span><span style=color:#fa6e32>let</span><span> step </span><span style=color:#ed9366>= </span><span style=color:#ff8f40>1.0 </span><span style=color:#ed9366>/</span><span> subdivisions </span><span style=color:#ed9366>as </span><span style=color:#fa6e32>f32</span><span style=color:#61676ccc>;
</span><span>    (</span><span style=color:#ff8f40>0</span><span style=color:#ed9366>..=</span><span>subdivisions)</span><span style=color:#ed9366>.</span><span style=color:#f07171>map</span><span>(</span><span style=color:#fa6e32>move </span><span style=color:#ed9366>|</span><span>i</span><span style=color:#ed9366>|</span><span> i </span><span style=color:#ed9366>as </span><span style=color:#fa6e32>f32 </span><span style=color:#ed9366>*</span><span> step)
</span><span>}
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After:
</span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>inline</span><span>]
</span><span style=color:#fa6e32>pub fn </span><span style=color:#f29718>iter_uniformly</span><span>(</span><span style=color:#ed9366>&</span><span style=color:#ff8f40>self</span><span>, </span><span style=color:#ff8f40>subdivisions</span><span style=color:#61676ccc>: </span><span style=color:#fa6e32>usize</span><span>) </span><span style=color:#61676ccc>-></span><span> impl </span><span style=color:#55b4d4;font-style:italic>Iterator</span><span>&LTItem = </span><span style=color:#fa6e32>f32</span><span>> {
</span><span>    </span><span style=color:#fa6e32>let</span><span> step </span><span style=color:#ed9366>= </span><span style=color:#ff8f40>1.0 </span><span style=color:#ed9366>/</span><span> subdivisions </span><span style=color:#ed9366>as </span><span style=color:#fa6e32>f32</span><span style=color:#61676ccc>;
</span><span>    (</span><span style=color:#ff8f40>0</span><span style=color:#ed9366>..=</span><span>subdivisions)</span><span style=color:#ed9366>.</span><span style=color:#f07171>map</span><span>(</span><span style=color:#fa6e32>move </span><span style=color:#ed9366>|</span><span>i</span><span style=color:#ed9366>|</span><span> i </span><span style=color:#ed9366>as </span><span style=color:#fa6e32>f32 </span><span style=color:#ed9366>*</span><span> step)
</span><span>}
</span></code></pre><p>This change makes the method part of <code>CubicSegment</code>’s public API while preserving:<ol><li>The efficient iterator-based implementation<li>The <code>#[inline]</code> optimization hint<li>The clear mathematical logic (generating <code>subdivisions + 1</code> values from 0.0 to 1.0 inclusive)</ol><h3 id=technical-insights>Technical Insights</h3><p>The method generates a sequence of <code>t</code> values uniformly distributed across [0, 1] for cubic curve evaluation. Each <code>t</code> value represents a normalized position along the curve segment, where:<ul><li><code>t = 0.0</code> corresponds to the segment’s start point<li><code>t = 1.0</code> corresponds to the segment’s end point<li>Intermediate values represent proportional positions along the curve</ul><p>The implementation efficiently creates an iterator that yields <code>(subdivisions + 1)</code> values without allocating a collection, making it suitable for both small and large subdivision counts.<h3 id=the-impact>The Impact</h3><p>This change enhances the cubic spline API’s flexibility without introducing new maintenance burden. Consumers can now directly access uniform parameter sampling for:<ol><li>Generating evenly spaced points along curves<li>Creating custom curve visualization tools<li>Implementing specialized interpolation logic<li>Performing analytical operations on curve segments</ol><p>By exposing this utility, Bevy avoids forcing users to reimplement this common operation, reducing code duplication and potential implementation errors in downstream projects.<h2 id=visual-representation>Visual Representation</h2><pre class=language-mermaid data-lang=mermaid style=color:#61676c;background-color:#fafafa><code class=language-mermaid data-lang=mermaid><span>graph TD
</span><span>    A[CubicSegment] --> B[iter_uniformly]
</span><span>    B --> C[Iterator&LTItem=f32>]
</span><span>    C --> D[0.0, 0.25, 0.5, 0.75, 1.0]
</span><span>    D --> E[Curve Evaluation]
</span><span>    D --> F[Custom Sampling]
</span></code></pre><h2 id=key-files-changed>Key Files Changed</h2><h3 id=crates-bevy-math-src-cubic-splines-mod-rs><code>crates/bevy_math/src/cubic_splines/mod.rs</code></h3><p><strong>Change:</strong> Made <code>iter_uniformly</code> method public<br> <strong>Why:</strong> To expose uniform curve parameter sampling to API consumers<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before (line 1036):
</span><span style=color:#fa6e32>fn </span><span style=color:#f29718>iter_uniformly</span><span>(</span><span style=color:#ed9366>&</span><span style=color:#ff8f40>self</span><span>, </span><span style=color:#ff8f40>subdivisions</span><span style=color:#61676ccc>: </span><span style=color:#fa6e32>usize</span><span>) </span><span style=color:#61676ccc>-></span><span> impl </span><span style=color:#55b4d4;font-style:italic>Iterator</span><span>&LTItem = </span><span style=color:#fa6e32>f32</span><span>> {
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After:
</span><span style=color:#fa6e32>pub fn </span><span style=color:#f29718>iter_uniformly</span><span>(</span><span style=color:#ed9366>&</span><span style=color:#ff8f40>self</span><span>, </span><span style=color:#ff8f40>subdivisions</span><span style=color:#61676ccc>: </span><span style=color:#fa6e32>usize</span><span>) </span><span style=color:#61676ccc>-></span><span> impl </span><span style=color:#55b4d4;font-style:italic>Iterator</span><span>&LTItem = </span><span style=color:#fa6e32>f32</span><span>> {
</span></code></pre><p>This change directly supports the PR’s objective by modifying only the visibility modifier while preserving the method’s existing functionality.<h2 id=further-reading>Further Reading</h2><ol><li><a rel="noopener nofollow noreferrer" href=https://pomax.github.io/bezierinfo/ target=_blank>Bézier Curves Primer</a><li><a rel="noopener nofollow noreferrer" href=https://docs.rs/bevy_math/latest/bevy_math/ target=_blank>Bevy Math Documentation</a><li><a rel="noopener nofollow noreferrer" href=https://doc.rust-lang.org/book/ch13-02-iterators.html target=_blank>Iterator Pattern in Rust</a><li><a rel="noopener nofollow noreferrer" href=https://rust-lang.github.io/api-guidelines/ target=_blank>API Design Guidelines</a></ol></div><div data-is-md-page=true data-patch-exists=true data-patch-path=/pull_request/bevy/2025-08/pr_20417.patch id=patch-info style=display:none></div><div class=bottom-spacer></div></div></div>