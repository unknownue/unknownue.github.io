<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://unknownue.github.io name=base><title>
         #20589 Remove `scale_value`
        
    </title><meta content="#20589 Remove `scale_value`" property=og:title><meta content="A personal blog built with Zola and Apollo theme" property=og:description><meta content="A personal blog built with Zola and Apollo theme" name=description><link href=/icons/favicon.png rel=icon type=image/png><link href=https://unknownue.github.io/fonts.css rel=stylesheet><script src=https://unknownue.github.io/js/codeblock.js></script><script src=https://unknownue.github.io/js/toc.js></script><script src=https://unknownue.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Unknownue's Blog" href=https://unknownue.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://unknownue.github.io/theme/light.css rel=stylesheet><link href=https://unknownue.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://unknownue.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://unknownue.github.io/main.css media=screen rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js></script><script>// Initialize mermaid once DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            mermaid.initialize({
                startOnLoad: false,
                theme: document.body && document.body.classList.contains('dark') ? 'dark' : 'default',
                securityLevel: 'loose',
                flowchart: {
                    useMaxWidth: true,
                    htmlLabels: true
                },
                sequence: {
                    diagramMarginX: 50,
                    diagramMarginY: 10,
                    actorMargin: 50,
                    width: 150,
                    height: 65
                }
            });
        });</script><script src=https://unknownue.github.io/js/main.js></script><script defer src=https://unknownue.github.io/js/label-colors.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/rust.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/typescript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/go.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/cpp.min.js></script><script>// Ensure highlight.js is properly configured
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof hljs !== 'undefined') {
                hljs.configure({
                    languages: ['rust', 'javascript', 'python', 'cpp', 'go', 'typescript'],
                    ignoreUnescapedHTML: true
                });
                console.log('Highlight.js configured in header');
            }
        });</script><link href=https://cdn.jsdelivr.net/npm/diff2html/bundles/css/diff2html.min.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/diff2html/bundles/js/diff2html-ui.min.js></script><script src=https://unknownue.github.io/js/syntax-highlight.js></script><script src=https://unknownue.github.io/js/diff-sidebar.js></script><script src="https://unknownue.github.io/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><div class=content><header><div class=main><a href=https://unknownue.github.io>Unknownue's Blog</a><div class=socials><a class=social href=https://github.com/unknownue rel=me> <img alt=github src=https://unknownue.github.io/icons/social/github.svg> </a><a class=social href=https://github.com/unknownue/unknownue.github.io rel=me> <img alt=github-io src=https://unknownue.github.io/icons/social/rss.svg> </a></div></div><nav><a href=https://unknownue.github.io/posts style=margin-left:.25em>/posts</a><a href=https://unknownue.github.io/projects style=margin-left:.25em>/projects</a><a href=https://unknownue.github.io/about style=margin-left:.25em>/about</a><a href=https://unknownue.github.io/tags style=margin-left:.25em>/tags</a><button title="$SHORTCUT to open search" class=search-button id=search-button><img alt=Search class=search-icon src=https://unknownue.github.io/icons/search.svg></button><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><div id=modal-content><h1 class=page-header id=modalTitle>Search</h1><div id=searchBar><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search... role=combobox spellcheck=false><button title="Clear search" class=clear-button id=clear-search><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></button></div><div id=results-container><div id=results-info><span id=zero_results style=display:none>No results</span><span id=one_result style=display:none>1 result</span><span id=many_results style=display:none>$NUMBER results</span></div><div id=results role=listbox></div></div></div></div><a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://unknownue.github.io/icons/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://unknownue.github.io/icons/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><div class=pull-request-page><article class=md-content-page style=display:none></article><div class=back-link><a href=/pull_request/bevy/2025-08/>← Back to Pull Requests</a></div><div class=pr-metadata><span class=pr-date>2025-08-16</span><div class=language-switcher><span class="lang-link active" data-lang=en>English</span> / <a class=lang-link data-lang=zh-cn href=/pull_request/bevy/2025-08/pr-20589-zh-cn-20250816>中文</a></div></div><div class=pr-content><h1 id=remove-scale-value>Remove <code>scale_value</code></h1><h2 id=basic-information>Basic Information</h2><ul><li><strong>Title</strong>: Remove <code>scale_value</code><li><strong>PR Link</strong>: https://github.com/bevyengine/bevy/pull/20589<li><strong>Author</strong>: ickshonpe<li><strong>Status</strong>: MERGED<li><strong>Labels</strong>: D-Trivial, C-Code-Quality, M-Needs-Migration-Guide, A-Text, S-Needs-Review<li><strong>Created</strong>: 2025-08-15T12:22:23Z<li><strong>Merged</strong>: 2025-08-16T00:29:21Z<li><strong>Merged By</strong>: james7132</ul><h2 id=description-translation>Description Translation</h2><h1 id=objective>Objective</h1><p>Remove this function:<pre style=color:#61676c;background-color:#fafafa><code><span>/// Scales `value` by `factor`.
</span><span>pub fn scale_value(value: f32, factor: f32) -> f32 {
</span><span>    value * factor
</span><span>}
</span></code></pre><h2 id=solution>Solution</h2><p>Replace it with a multiplication.<h2 id=the-story-of-this-pull-request>The Story of This Pull Request</h2><p>The PR addresses a straightforward code quality issue in Bevy’s text rendering system. The <code>scale_value</code> function in <code>bevy_text</code> served as a trivial wrapper around basic multiplication (<code>value * factor</code>). While originally intended to abstract scaling operations, its simplicity actually reduced code clarity rather than enhancing it.<p>The core problem was that <code>scale_value</code> provided no meaningful abstraction - it directly mapped to a basic arithmetic operation while adding an extra function call layer. This violated the principle of avoiding unnecessary indirection, especially for fundamental operations. The function’s existence required developers to look up its implementation rather than immediately understanding the operation being performed.<p>The solution was methodical:<ol><li>Identify all call sites of <code>scale_value</code> in the codebase<li>Replace each call with direct multiplication<li>Remove the function definition<li>Add migration documentation</ol><p>In <code>text2d.rs</code>, the changes demonstrate how direct multiplication improves readability. For example:<pre class=language-diff data-lang=diff style=color:#61676c;background-color:#fafafa><code class=language-diff data-lang=diff><span style=color:#f07171>- bounds.width.map(|width| scale_value(width, scale_factor))
</span><span style=color:#86b300>+ bounds.width.map(|width| width * scale_factor)
</span></code></pre><p>The author also took the opportunity to use more idiomatic Rust patterns where applicable. When scaling vector components individually, they replaced separate X/Y scaling operations with vector multiplication:<pre class=language-diff data-lang=diff style=color:#61676c;background-color:#fafafa><code class=language-diff data-lang=diff><span style=color:#f07171>- text_layout_info.size.x = scale_value(text_layout_info.size.x, inverse_scale_factor);
</span><span style=color:#f07171>- text_layout_info.size.y = scale_value(text_layout_info.size.y, inverse_scale_factor);
</span><span style=color:#86b300>+ text_layout_info.size *= inverse_scale_factor;
</span></code></pre><p>This change reduces code duplication and leverages Rust’s operator overloading for cleaner vector math. The same optimization was applied to the UI text widget in <code>widget/text.rs</code>.<p>The PR includes a migration guide that clearly communicates the change to users. The documentation is concise but sufficient, explaining both the removal and the straightforward replacement:<pre class=language-markdown data-lang=markdown style=color:#61676c;background-color:#fafafa><code class=language-markdown data-lang=markdown><span>The </span><span style=color:#ed9366;background-color:#61676c10>`scale_value`</span><span> function from </span><span style=color:#ed9366;background-color:#61676c10>`bevy::text::text2d`</span><span> has been removed. Multiply by the scale factor instead.
</span></code></pre><p>From an engineering perspective, this change:<ul><li>Reduces cognitive load by eliminating trivial abstractions<li>Maintains identical runtime performance (the compiler would inline the function anyway)<li>Follows Rust’s philosophy of favoring explicit operations over unnecessary wrappers<li>Sets a precedent for removing similar trivial utilities elsewhere in the codebase</ul><p>The PR demonstrates good judgment in identifying and removing unnecessary abstraction layers while maintaining functionality. It’s a focused, localized change that improves code quality without introducing new complexity.<h2 id=visual-representation>Visual Representation</h2><pre class=language-mermaid data-lang=mermaid style=color:#61676c;background-color:#fafafa><code class=language-mermaid data-lang=mermaid><span>graph TD
</span><span>    A[Remove scale_value function] --> B[Update text layout system]
</span><span>    A --> C[Update UI text widget]
</span><span>    B --> D[Replace with multiplication]
</span><span>    C --> D
</span><span>    D --> E[Add migration guide]
</span></code></pre><h2 id=key-files-changed>Key Files Changed</h2><h3 id=crates-bevy-text-src-text2d-rs><code>crates/bevy_text/src/text2d.rs</code></h3><ul><li>Removed <code>scale_value</code> function and replaced calls with direct multiplication<li>Used vector multiplication where appropriate for more concise code</ul><pre class=language-diff data-lang=diff style=color:#61676c;background-color:#fafafa><code class=language-diff data-lang=diff><span style=color:#f07171>- bounds.width.map(|width| scale_value(width, scale_factor))
</span><span style=color:#86b300>+ bounds.width.map(|width| width * scale_factor)
</span><span>
</span><span style=color:#f07171>- text_layout_info.size.x = scale_value(text_layout_info.size.x, inverse_scale_factor);
</span><span style=color:#f07171>- text_layout_info.size.y = scale_value(text_layout_info.size.y, inverse_scale_factor);
</span><span style=color:#86b300>+ text_layout_info.size *= inverse_scale_factor;
</span><span>
</span><span style=color:#f07171>- /// Scales `value` by `factor`.
</span><span style=color:#f07171>- pub fn scale_value(value: f32, factor: f32) -> f32 {
</span><span style=color:#f07171>-     value * factor
</span><span style=color:#f07171>- }
</span></code></pre><h3 id=crates-bevy-ui-src-widget-text-rs><code>crates/bevy_ui/src/widget/text.rs</code></h3><ul><li>Replaced <code>scale_value</code> calls with vector multiplication</ul><pre class=language-diff data-lang=diff style=color:#61676c;background-color:#fafafa><code class=language-diff data-lang=diff><span style=color:#f07171>- text_layout_info.size.x = scale_value(text_layout_info.size.x, inverse_scale_factor);
</span><span style=color:#f07171>- text_layout_info.size.y = scale_value(text_layout_info.size.y, inverse_scale_factor);
</span><span style=color:#86b300>+ text_layout_info.size *= inverse_scale_factor;
</span></code></pre><h3 id=release-content-migration-guides-remove-scale-value-md><code>release-content/migration-guides/remove_scale_value.md</code></h3><ul><li>Added documentation for the removed function</ul><pre class=language-markdown data-lang=markdown style=color:#61676c;background-color:#fafafa><code class=language-markdown data-lang=markdown><span style=color:#abb0b6;background-color:#61676c10;font-weight:700>---
</span><span>title: Remove </span><span style=color:#ed9366;background-color:#61676c10>`scale_value`</span><span>
</span><span>pull_requests: [19143]
</span><span style=color:#fa6e32;font-weight:700>---
</span><span>
</span><span>The </span><span style=color:#ed9366;background-color:#61676c10>`scale_value`</span><span> function from </span><span style=color:#ed9366;background-color:#61676c10>`bevy::text::text2d`</span><span> has been removed. Multiply by the scale factor instead.
</span></code></pre><h2 id=further-reading>Further Reading</h2><ul><li><a rel="noopener nofollow noreferrer" href=https://doc.rust-lang.org/book/ch19-03-advanced-traits.html#using-the-newtype-pattern-to-implement-external-traits-on-external-types target=_blank>Rust Operator Overloading</a><li><a rel="noopener nofollow noreferrer" href=https://refactoring.guru/smells/dispensables target=_blank>Code Smells: Dispensables</a><li><a rel="noopener nofollow noreferrer" href=https://docs.rs/bevy_text/latest/bevy_text/ target=_blank>Bevy Text Documentation</a></ul></div><div data-is-md-page=true data-patch-exists=true data-patch-path=/pull_request/bevy/2025-08/pr_20589.patch id=patch-info style=display:none></div><div class=bottom-spacer></div></div></div>