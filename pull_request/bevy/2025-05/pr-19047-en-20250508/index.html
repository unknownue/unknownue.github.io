<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://unknownue.github.io name=base><title>
         #19047 Track spawn `Tick` of entities, offer methods, query data `SpawnDetails` and query filter `Spawned`
        
    </title><meta content="#19047 Track spawn `Tick` of entities, offer methods, query data `SpawnDetails` and query filter `Spawned`" property=og:title><meta content="A personal blog built with Zola and Apollo theme" property=og:description><meta content="A personal blog built with Zola and Apollo theme" name=description><link href=/icons/favicon.png rel=icon type=image/png><link href=https://unknownue.github.io/fonts.css rel=stylesheet><script src=https://unknownue.github.io/js/codeblock.js></script><script src=https://unknownue.github.io/js/toc.js></script><script src=https://unknownue.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Unknownue's Blog" href=https://unknownue.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://unknownue.github.io/theme/light.css rel=stylesheet><link href=https://unknownue.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://unknownue.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://unknownue.github.io/main.css media=screen rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js></script><script>// Initialize mermaid once DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            mermaid.initialize({
                startOnLoad: false,
                theme: document.body && document.body.classList.contains('dark') ? 'dark' : 'default',
                securityLevel: 'loose',
                flowchart: {
                    useMaxWidth: true,
                    htmlLabels: true
                },
                sequence: {
                    diagramMarginX: 50,
                    diagramMarginY: 10,
                    actorMargin: 50,
                    width: 150,
                    height: 65
                }
            });
        });</script><script src=https://unknownue.github.io/js/main.js></script><script defer src=https://unknownue.github.io/js/label-colors.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/rust.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/typescript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/go.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/cpp.min.js></script><script>// Ensure highlight.js is properly configured
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof hljs !== 'undefined') {
                hljs.configure({
                    languages: ['rust', 'javascript', 'python', 'cpp', 'go', 'typescript'],
                    ignoreUnescapedHTML: true
                });
                console.log('Highlight.js configured in header');
            }
        });</script><link href=https://cdn.jsdelivr.net/npm/diff2html/bundles/css/diff2html.min.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/diff2html/bundles/js/diff2html-ui.min.js></script><script src=https://unknownue.github.io/js/syntax-highlight.js></script><script src=https://unknownue.github.io/js/diff-sidebar.js></script><script src="https://unknownue.github.io/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><div class=content><header><div class=main><a href=https://unknownue.github.io>Unknownue's Blog</a><div class=socials><a class=social href=https://github.com/unknownue rel=me> <img alt=github src=https://unknownue.github.io/icons/social/github.svg> </a><a class=social href=https://github.com/unknownue/unknownue.github.io rel=me> <img alt=github-io src=https://unknownue.github.io/icons/social/rss.svg> </a></div></div><nav><a href=https://unknownue.github.io/posts style=margin-left:.25em>/posts</a><a href=https://unknownue.github.io/projects style=margin-left:.25em>/projects</a><a href=https://unknownue.github.io/about style=margin-left:.25em>/about</a><a href=https://unknownue.github.io/tags style=margin-left:.25em>/tags</a><button title="$SHORTCUT to open search" class=search-button id=search-button><img alt=Search class=search-icon src=https://unknownue.github.io/icons/search.svg></button><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><div id=modal-content><h1 class=page-header id=modalTitle>Search</h1><div id=searchBar><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search... role=combobox spellcheck=false><button title="Clear search" class=clear-button id=clear-search><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></button></div><div id=results-container><div id=results-info><span id=zero_results style=display:none>No results</span><span id=one_result style=display:none>1 result</span><span id=many_results style=display:none>$NUMBER results</span></div><div id=results role=listbox></div></div></div></div><a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://unknownue.github.io/icons/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://unknownue.github.io/icons/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><div class=pull-request-page><article class=md-content-page style=display:none></article><div class=back-link><a href=/pull_request/bevy/2025-05/>← Back to Pull Requests</a></div><div class=pr-metadata><span class=pr-date>2025-05-08</span><div class=language-switcher><span class="lang-link active" data-lang=en>English</span> / <a class=lang-link data-lang=zh-cn href=/pull_request/bevy/2025-05/pr-19047-zh-cn-20250508>中文</a></div></div><div class=pr-content><h1 id=track-spawn-tick-of-entities-offer-methods-query-data-spawndetails-and-query-filter-spawned>Track spawn <code>Tick</code> of entities, offer methods, query data <code>SpawnDetails</code> and query filter <code>Spawned</code></h1><h2 id=basic-information>Basic Information</h2><ul><li><strong>Title</strong>: Track spawn <code>Tick</code> of entities, offer methods, query data <code>SpawnDetails</code> and query filter <code>Spawned</code><li><strong>PR Link</strong>: https://github.com/bevyengine/bevy/pull/19047<li><strong>Author</strong>: urben1680<li><strong>Status</strong>: MERGED<li><strong>Labels</strong>: C-Feature, A-ECS, S-Ready-For-Final-Review, M-Needs-Release-Note, X-Contentious<li><strong>Created</strong>: 2025-05-03T16:59:53Z<li><strong>Merged</strong>: 2025-05-08T15:20:15Z<li><strong>Merged By</strong>: alice-i-cecile</ul><h2 id=description-translation>Description Translation</h2><h1 id=objective>Objective</h1><p>In my own project I was encountering the issue to find out which entities were spawned after applying commands. I began maintaining a vector of all entities with generational information before and after applying the command and diffing it. This was awfully complicated though and has no constant complexity but grows with the number of entities.<h2 id=solution>Solution</h2><p>Looking at <code>EntyMeta</code> it seemed obvious to me that struct can track the tick just as it does with <code>MaybeLocation</code>, updated from the same call. After that it became almost a given to also introduce query data <code>SpawnDetails</code> which offers methods to get the spawn tick and location, and query filter <code>Spawned</code> that filters entities out that were not spawned since the last run.<h2 id=testing>Testing</h2><p>I expanded a few tests and added new ones, though maybe I forgot a group of tests that should be extended too. I basically searched <code>bevy_ecs</code> for mentions of <code>Changed</code> and <code>Added</code> to see where the tests and docs are.<p>Benchmarks of spawn/despawn can be found <a rel="noopener nofollow noreferrer" href=https://github.com/bevyengine/bevy/pull/19047#issuecomment-2852181374 target=_blank>here</a>.<hr><h2 id=showcase>Showcase</h2><p>From the added docs, systems with equal complexity since the filter is not archetypal:<pre class=language-rs data-lang=rs style=color:#61676c;background-color:#fafafa><code class=language-rs data-lang=rs><span style=color:#fa6e32>fn </span><span style=color:#f29718>system1</span><span>(</span><span style=color:#ff8f40>q</span><span style=color:#61676ccc>: </span><span>Query&LTEntity, Spawned>) {
</span><span>    </span><span style=color:#fa6e32>for</span><span> entity </span><span style=color:#ed9366>in &</span><span>q { </span><span style=color:#abb0b6;font-style:italic>/* entity spawned */ </span><span>}
</span><span>}
</span><span>
</span><span style=color:#fa6e32>fn </span><span style=color:#f29718>system2</span><span>(</span><span style=color:#ff8f40>query</span><span style=color:#61676ccc>: </span><span>Query<(Entity, SpawnDetails)>) {
</span><span>    </span><span style=color:#fa6e32>for </span><span>(entity</span><span style=color:#61676ccc>,</span><span> spawned) </span><span style=color:#ed9366>in &</span><span>query {
</span><span>        </span><span style=color:#fa6e32>if</span><span> spawned</span><span style=color:#ed9366>.</span><span style=color:#f07171>is_spawned</span><span>() { </span><span style=color:#abb0b6;font-style:italic>/* entity spawned */ </span><span>}
</span><span>    }
</span><span>}
</span></code></pre><p><code>SpawnedDetails</code> has a few more methods:<pre class=language-rs data-lang=rs style=color:#61676c;background-color:#fafafa><code class=language-rs data-lang=rs><span style=color:#fa6e32>fn </span><span style=color:#f29718>print_spawn_details</span><span>(</span><span style=color:#ff8f40>query</span><span style=color:#61676ccc>: </span><span>Query<(Entity, SpawnDetails)>) {
</span><span>    </span><span style=color:#fa6e32>for </span><span>(entity</span><span style=color:#61676ccc>,</span><span> spawn_details) </span><span style=color:#ed9366>in &</span><span>query {
</span><span>        </span><span style=color:#fa6e32>if</span><span> spawn_details</span><span style=color:#ed9366>.</span><span style=color:#f07171>is_spawned</span><span>() {
</span><span>            </span><span style=color:#f07171>print!</span><span>(</span><span style=color:#86b300>"new "</span><span>)</span><span style=color:#61676ccc>;
</span><span>        }
</span><span>        </span><span style=color:#f07171>println!</span><span>(
</span><span>            </span><span style=color:#86b300>"entity </span><span style=color:#ff8f40>{:?}</span><span style=color:#86b300> spawned at </span><span style=color:#ff8f40>{:?}</span><span style=color:#86b300> by </span><span style=color:#ff8f40>{:?}</span><span style=color:#86b300>"</span><span style=color:#61676ccc>,
</span><span>            entity</span><span style=color:#61676ccc>,
</span><span>            spawn_details</span><span style=color:#ed9366>.</span><span style=color:#f07171>spawned_at</span><span>()</span><span style=color:#61676ccc>,
</span><span>            spawn_details</span><span style=color:#ed9366>.</span><span style=color:#f07171>spawned_by</span><span>()
</span><span>        )</span><span style=color:#61676ccc>;        
</span><span>    }
</span><span>}
</span></code></pre><h2 id=changes>Changes</h2><p>No public api was changed, I only added to it. That is why I added no migration guide.<ul><li>query data <code>SpawnDetails</code><li>query filter <code>Spawned</code><li>method <code>Entities::entity_get_spawned_or_despawned_at</code><li>method <code>EntityRef::spawned_at</code><li>method <code>EntityMut::spawned_at</code><li>method <code>EntityWorldMut::spawned_at</code><li>method <code>UnsafeEntityCell::spawned_at</code><li>method <code>FilteredEntityRef::spawned_at</code><li>method <code>FilteredEntityMut::spawned_at</code><li>method <code>EntityRefExcept::spawned_at</code><li>method <code>EntityMutExcept::spawned_at</code></ul><h2 id=the-story-of-this-pull-request>The Story of This Pull Request</h2><h3 id=the-problem-and-context>The Problem and Context</h3><p>Tracking entity spawns in Bevy ECS previously required workarounds like maintaining external tracking structures or using marker components with <code>Added</code> filters. These approaches had scaling issues - manual tracking became complex with entity count growth, while marker components couldn’t distinguish between new spawns and component additions to existing entities.<p>The core challenge was providing efficient spawn detection without:<ol><li>Requiring manual tracking<li>Imposing archetype restrictions<li>Adding significant memory overhead</ol><h3 id=the-solution-approach>The Solution Approach</h3><p>The implementation leverages existing entity metadata storage (<code>EntityMeta</code>) to track spawn events. By storing both the spawn location (call site) and tick (timing) in entity metadata, we enable:<ol><li>Direct querying of spawn information<li>Efficient change detection using existing tick comparison mechanisms<li>Zero-cost tracking for users who don’t need this feature</ol><p>Key technical decisions:<ol><li>Store spawn ticks in <code>EntityMeta</code> using <code>MaybeUninit</code> for memory efficiency<li>Reuse existing change detection infrastructure for tick comparisons<li>Mirror the API patterns of <code>Added</code>/<code>Changed</code> filters for consistency</ol><h3 id=the-implementation>The Implementation</h3><p>The core changes occur in <code>entity/mod.rs</code> where <code>EntityMeta</code> was extended:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#fa6e32>struct </span><span style=color:#399ee6>EntityMeta </span><span>{
</span><span>    location</span><span style=color:#61676ccc>:</span><span> EntityLocation,
</span><span>    spawned_or_despawned</span><span style=color:#61676ccc>: </span><span>MaybeUninit&LTSpawnedOrDespawned>,
</span><span>}
</span><span>
</span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>derive</span><span>(Copy</span><span style=color:#61676ccc>,</span><span> Clone</span><span style=color:#61676ccc>,</span><span> Debug)]
</span><span style=color:#fa6e32>struct </span><span style=color:#399ee6>SpawnedOrDespawned </span><span>{
</span><span>    by</span><span style=color:#61676ccc>:</span><span> MaybeLocation,
</span><span>    at</span><span style=color:#61676ccc>:</span><span> Tick,
</span><span>}
</span></code></pre><p>New query types were added in <code>query/fetch.rs</code> and <code>query/filter.rs</code>:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// query/fetch.rs
</span><span style=color:#fa6e32>pub struct </span><span style=color:#399ee6>SpawnDetails </span><span>{
</span><span>    spawned_by</span><span style=color:#61676ccc>:</span><span> MaybeLocation,
</span><span>    spawned_at</span><span style=color:#61676ccc>:</span><span> Tick,
</span><span>    last_run</span><span style=color:#61676ccc>:</span><span> Tick,
</span><span>    this_run</span><span style=color:#61676ccc>:</span><span> Tick,
</span><span>}
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// query/filter.rs
</span><span style=color:#fa6e32>pub struct </span><span style=color:#399ee6>Spawned</span><span style=color:#61676ccc>;
</span></code></pre><p>The implementation follows Bevy’s existing patterns for change detection:<ol><li><strong>Data propagation</strong> during entity operations:</ol><pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// In BundleSpawner::spawn
</span><span>entities</span><span style=color:#ed9366>.</span><span style=color:#f07171>set_spawn_despawn</span><span>(entity</span><span style=color:#ed9366>.</span><span style=color:#f07171>index</span><span>()</span><span style=color:#61676ccc>,</span><span> location</span><span style=color:#61676ccc>,</span><span> caller</span><span style=color:#61676ccc>, </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>change_tick)</span><span style=color:#61676ccc>;
</span></code></pre><ol start=2><li><strong>Tick checking</strong> during query evaluation:</ol><pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Spawned filter implementation
</span><span style=color:#fa6e32>fn </span><span style=color:#f29718>filter_fetch</span><span>(</span><span style=color:#ff8f40>fetch</span><span style=color:#61676ccc>: </span><span style=color:#ed9366>&</span><span style=color:#fa6e32>mut Self</span><span style=color:#ed9366>::</span><span>Fetch<'</span><span style=color:#ed9366>_</span><span>>, </span><span style=color:#ff8f40>entity</span><span style=color:#61676ccc>:</span><span> Entity, </span><span style=color:#ed9366>_</span><span>: TableRow) </span><span style=color:#61676ccc>-> </span><span style=color:#fa6e32>bool </span><span>{
</span><span>    </span><span style=color:#fa6e32>let</span><span> spawned_at </span><span style=color:#ed9366>=</span><span> fetch</span><span style=color:#ed9366>.</span><span>entities</span><span style=color:#ed9366>.</span><span style=color:#f07171>entity_get_spawned_or_despawned_unchecked</span><span>(entity)</span><span style=color:#ed9366>.</span><span style=color:#ff8f40>1</span><span style=color:#61676ccc>;
</span><span>    spawned_at</span><span style=color:#ed9366>.</span><span style=color:#f07171>is_newer_than</span><span>(fetch</span><span style=color:#ed9366>.</span><span>last_run</span><span style=color:#61676ccc>,</span><span> fetch</span><span style=color:#ed9366>.</span><span>this_run)
</span><span>}
</span></code></pre><h3 id=technical-insights>Technical Insights</h3><ol><li><strong>Memory Efficiency</strong>: Using <code>MaybeUninit</code> for <code>SpawnedOrDespawned</code> avoids allocating space for unused spawn data on entities that haven’t spawned/despawned<li><strong>Performance Characteristics</strong>: Similar to <code>Added</code>/<code>Changed</code>: <ul><li>O(n) time complexity for non-archetypal filters<li>Constant-time checks for individual entities</ul><li><strong>API Design</strong>: Mirroring existing patterns (<code>Added</code>/<code>Changed</code>) reduces cognitive overhead:</ol><pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Consistent with existing filters
</span><span style=color:#fa6e32>fn </span><span style=color:#f29718>system</span><span>(</span><span style=color:#ff8f40>q</span><span style=color:#61676ccc>: </span><span>Query&LTEntity, (With&LTComponent>, Spawned)>) {
</span><span>    </span><span style=color:#fa6e32>for</span><span> entity </span><span style=color:#ed9366>in &</span><span>q { </span><span style=color:#abb0b6;font-style:italic>/* ... */ </span><span>}
</span><span>}
</span></code></pre><ol start=4><li><strong>Change Detection Integration</strong>: Leverages Bevy’s existing tick comparison logic:</ol><pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#fa6e32>impl </span><span style=color:#399ee6>SpawnDetails </span><span>{
</span><span>    </span><span style=color:#fa6e32>pub fn </span><span style=color:#f29718>is_spawned</span><span>(</span><span style=color:#ff8f40>self</span><span>) </span><span style=color:#61676ccc>-> </span><span style=color:#fa6e32>bool </span><span>{
</span><span>        </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>spawned_at</span><span style=color:#ed9366>.</span><span style=color:#f07171>is_newer_than</span><span>(</span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>last_run</span><span style=color:#61676ccc>, </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>this_run)
</span><span>    }
</span><span>}
</span></code></pre><h3 id=the-impact>The Impact</h3><ol><li><p><strong>New Capabilities</strong>:</p> <ul><li>Direct spawn detection without marker components<li>Access to spawn timing information<li>Filter entities by spawn status</ul><li><p><strong>Performance</strong>:</p> <ul><li>No additional memory overhead for existing users<li>Microbenchmarks show negligible impact on spawn/despawn operations</ul><li><p><strong>Ecosystem Alignment</strong>:</p> <ul><li>Complements existing change detection features<li>Enables new patterns for entity lifecycle management</ul><li><p><strong>Maintainability</strong>:</p> <ul><li>100% backward compatibility<li>No required migrations<li>Clear API parallels with existing systems</ul></ol><h2 id=visual-representation>Visual Representation</h2><pre class=language-mermaid data-lang=mermaid style=color:#61676c;background-color:#fafafa><code class=language-mermaid data-lang=mermaid><span>graph TD
</span><span>    A[EntityMeta] --> B[Track SpawnTick]
</span><span>    B --> C[SpawnDetails Query]
</span><span>    B --> D[Spawned Filter]
</span><span>    C --> E[System Logic]
</span><span>    D --> E
</span><span>    E --> F[Entity Processing]
</span></code></pre><h2 id=key-files-changed>Key Files Changed</h2><ol><li><strong>crates/bevy_ecs/src/entity/mod.rs</strong> (+101/-26) <ul><li>Added spawn tick tracking to entity metadata<li>Implemented spawn tick access methods</ul></ol><pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Added method
</span><span style=color:#fa6e32>pub fn </span><span style=color:#f29718>entity_get_spawned_or_despawned_at</span><span>(</span><span style=color:#ed9366>&</span><span style=color:#ff8f40>self</span><span>, </span><span style=color:#ff8f40>entity</span><span style=color:#61676ccc>:</span><span> Entity) </span><span style=color:#61676ccc>-> </span><span style=color:#55b4d4;font-style:italic>Option</span><span>&LTTick> {
</span><span>    </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span style=color:#f07171>entity_get_spawned_or_despawned</span><span>(entity)
</span><span>        </span><span style=color:#ed9366>.</span><span style=color:#f07171>map</span><span>(|</span><span style=color:#ff8f40>sod</span><span>| sod</span><span style=color:#ed9366>.</span><span>at)
</span><span>}
</span></code></pre><ol start=2><li><strong>crates/bevy_ecs/src/query/fetch.rs</strong> (+162/-0) <ul><li>Implemented <code>SpawnDetails</code> query data type</ul></ol><pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// New query data implementation
</span><span style=color:#fa6e32>unsafe impl </span><span>WorldQuery </span><span style=color:#fa6e32>for </span><span style=color:#399ee6>SpawnDetails </span><span>{
</span><span>    </span><span style=color:#fa6e32>type </span><span style=color:#399ee6>Fetch</span><span style=color:#ed9366><</span><span style=color:#fa6e32>'w</span><span style=color:#ed9366>> = </span><span>SpawnDetailsFetch<</span><span style=color:#fa6e32>'w</span><span>></span><span style=color:#61676ccc>;
</span><span>    </span><span style=color:#abb0b6;font-style:italic>// ...boilerplate omitted...
</span><span>}
</span></code></pre><ol start=3><li><strong>crates/bevy_ecs/src/query/filter.rs</strong> (+148/-7) <ul><li>Added <code>Spawned</code> filter implementation</ul></ol><pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Filter implementation
</span><span style=color:#fa6e32>unsafe impl </span><span>QueryFilter </span><span style=color:#fa6e32>for </span><span style=color:#399ee6>Spawned </span><span>{
</span><span>    </span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>inline</span><span>(always)]
</span><span>    </span><span style=color:#fa6e32>unsafe fn </span><span style=color:#f29718>filter_fetch</span><span>(...) </span><span style=color:#61676ccc>-> </span><span style=color:#fa6e32>bool </span><span>{
</span><span>        </span><span style=color:#abb0b6;font-style:italic>// Tick comparison logic
</span><span>    }
</span><span>}
</span></code></pre><ol start=4><li><strong>crates/bevy_ecs/src/world/entity_ref.rs</strong> (+74/-21) <ul><li>Added spawn tick accessors to entity reference types</ul></ol><pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Added to EntityRef
</span><span style=color:#fa6e32>pub fn </span><span style=color:#f29718>spawned_at</span><span>(</span><span style=color:#ed9366>&</span><span style=color:#ff8f40>self</span><span>) </span><span style=color:#61676ccc>-></span><span> Tick {
</span><span>    </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>cell</span><span style=color:#ed9366>.</span><span style=color:#f07171>spawned_at</span><span>()
</span><span>}
</span></code></pre><ol start=5><li><strong>release-content/release-notes/entity-spawn-ticks.md</strong> (+83/-0) <ul><li>Documentation of new feature for end users</ul></ol><pre class=language-markdown data-lang=markdown style=color:#61676c;background-color:#fafafa><code class=language-markdown data-lang=markdown><span style=color:#fa6e32;font-weight:700>## </span><span style=color:#399ee6;font-weight:700>Spawned
</span><span>Use this filter in your query if you are only interested in entities that were spawned after the last time your system ran.
</span></code></pre><h2 id=further-reading>Further Reading</h2><ol><li><a rel="noopener nofollow noreferrer" href=https://bevyengine.org/learn/book/implementation/change-detection/ target=_blank>Bevy ECS Change Detection Documentation</a><li><a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/Entity_component_system target=_blank>Entity Component System Pattern</a><li><a rel="noopener nofollow noreferrer" href=https://doc.rust-lang.org/std/mem/union.MaybeUninit.html target=_blank>Rust MaybeUninit Documentation</a><li><a rel="noopener nofollow noreferrer" href=https://jamesmcm.github.io/blog/2020/07/25/intro-dod/ target=_blank>Data Oriented Design Resources</a></ol></div><div data-is-md-page=true data-patch-exists=true data-patch-path=/pull_request/bevy/2025-05/pr_19047.patch id=patch-info style=display:none></div><div class=bottom-spacer></div></div></div>