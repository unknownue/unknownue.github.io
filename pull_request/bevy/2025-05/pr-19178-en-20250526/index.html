<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://unknownue.github.io name=base><title>
         #19178 Added support for .wesl files to the regex pattern for examples
        
    </title><meta content="#19178 Added support for .wesl files to the regex pattern for examples" property=og:title><meta content="A personal blog built with Zola and Apollo theme" property=og:description><meta content="A personal blog built with Zola and Apollo theme" name=description><link href=/icons/favicon.png rel=icon type=image/png><link href=https://unknownue.github.io/fonts.css rel=stylesheet><script src=https://unknownue.github.io/js/codeblock.js></script><script src=https://unknownue.github.io/js/toc.js></script><script src=https://unknownue.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Unknownue's Blog" href=https://unknownue.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://unknownue.github.io/theme/light.css rel=stylesheet><link href=https://unknownue.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://unknownue.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://unknownue.github.io/main.css media=screen rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js></script><script>// Initialize mermaid once DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            mermaid.initialize({
                startOnLoad: false,
                theme: document.body && document.body.classList.contains('dark') ? 'dark' : 'default',
                securityLevel: 'loose',
                flowchart: {
                    useMaxWidth: true,
                    htmlLabels: true
                },
                sequence: {
                    diagramMarginX: 50,
                    diagramMarginY: 10,
                    actorMargin: 50,
                    width: 150,
                    height: 65
                }
            });
        });</script><script src=https://unknownue.github.io/js/main.js></script><script defer src=https://unknownue.github.io/js/label-colors.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/rust.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/typescript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/go.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/cpp.min.js></script><script>// Ensure highlight.js is properly configured
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof hljs !== 'undefined') {
                hljs.configure({
                    languages: ['rust', 'javascript', 'python', 'cpp', 'go', 'typescript'],
                    ignoreUnescapedHTML: true
                });
                console.log('Highlight.js configured in header');
            }
        });</script><link href=https://cdn.jsdelivr.net/npm/diff2html/bundles/css/diff2html.min.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/diff2html/bundles/js/diff2html-ui.min.js></script><script src=https://unknownue.github.io/js/syntax-highlight.js></script><script src=https://unknownue.github.io/js/diff-sidebar.js></script><script src="https://unknownue.github.io/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><div class=content><header><div class=main><a href=https://unknownue.github.io>Unknownue's Blog</a><div class=socials><a class=social href=https://github.com/unknownue rel=me> <img alt=github src=https://unknownue.github.io/icons/social/github.svg> </a><a class=social href=https://github.com/unknownue/unknownue.github.io rel=me> <img alt=github-io src=https://unknownue.github.io/icons/social/rss.svg> </a></div></div><nav><a href=https://unknownue.github.io/posts style=margin-left:.25em>/posts</a><a href=https://unknownue.github.io/projects style=margin-left:.25em>/projects</a><a href=https://unknownue.github.io/about style=margin-left:.25em>/about</a><a href=https://unknownue.github.io/tags style=margin-left:.25em>/tags</a><button title="$SHORTCUT to open search" class=search-button id=search-button><img alt=Search class=search-icon src=https://unknownue.github.io/icons/search.svg></button><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><div id=modal-content><h1 class=page-header id=modalTitle>Search</h1><div id=searchBar><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search... role=combobox spellcheck=false><button title="Clear search" class=clear-button id=clear-search><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></button></div><div id=results-container><div id=results-info><span id=zero_results style=display:none>No results</span><span id=one_result style=display:none>1 result</span><span id=many_results style=display:none>$NUMBER results</span></div><div id=results role=listbox></div></div></div></div><a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://unknownue.github.io/icons/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://unknownue.github.io/icons/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><div class=pull-request-page><article class=md-content-page style=display:none></article><div class=back-link><a href=/pull_request/bevy/2025-05/>← Back to Pull Requests</a></div><div class=pr-metadata><span class=pr-date>2025-05-26</span><div class=language-switcher><span class="lang-link active" data-lang=en>English</span> / <a class=lang-link data-lang=zh-cn href=/pull_request/bevy/2025-05/pr-19178-zh-cn-20250526>中文</a></div></div><div class=pr-content><h1 id=added-support-for-wesl-files-to-the-regex-pattern-for-examples>Added support for .wesl files to the regex pattern for examples</h1><h2 id=basic-information>Basic Information</h2><ul><li><strong>Title</strong>: Added support for .wesl files to the regex pattern for examples<li><strong>PR Link</strong>: https://github.com/bevyengine/bevy/pull/19178<li><strong>Author</strong>: atlasgorn<li><strong>Status</strong>: MERGED<li><strong>Labels</strong>: C-Docs, D-Trivial, C-Examples, S-Ready-For-Final-Review<li><strong>Created</strong>: 2025-05-11T17:15:08Z<li><strong>Merged</strong>: 2025-05-26T18:18:20Z<li><strong>Merged By</strong>: alice-i-cecile</ul><h2 id=description-translation>Description Translation</h2><p>The original description is in English and preserved as-is:<h2 id=objective>Objective</h2><p><a rel="noopener nofollow noreferrer" href=https://bevyengine.org/examples-webgpu/shaders/shader-material-wesl/ target=_blank>Shaders / Material - WESL</a> example doesn’t have a WESL file tab<h2 id=solution>Solution</h2><p>Added wesl to regex<h2 id=the-story-of-this-pull-request>The Story of This Pull Request</h2><p>The Bevy engine’s example showcase system faced a specific documentation gap - its WESL (WebGPU Shading Language) example wasn’t properly displaying shader file tabs. This occurred because the file detection logic used a regular expression that didn’t account for .wesl file extensions.<p>The core issue resided in how the example processing system identifies shader files. The existing implementation used a regex pattern that explicitly matched .wgsl, .frag, and .vert extensions through an alternation pattern:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#fa6e32>r</span><span style=color:#86b300>"(shaders\/\w+\.wgsl)|(shaders\/\w+\.frag)|(shaders\/\w+\.vert)"
</span></code></pre><p>This pattern effectively created three separate capture groups for different shader extensions. However, it lacked support for the newer .wesl extension used in WebGPU examples, causing those files to be overlooked in the documentation generation.<p>The solution involved refactoring the regex to use a unified extension group while adding the missing wesl extension. The revised pattern:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#fa6e32>r</span><span style=color:#86b300>"shaders\/\w+\.(wgsl|frag|vert|wesl)"
</span></code></pre><p>This change achieves three key improvements:<ol><li><strong>Simplified maintenance</strong>: By grouping extensions in a single capture<li><strong>Extended coverage</strong>: Explicit inclusion of .wesl files<li><strong>Pattern clarity</strong>: More readable structure through logical grouping</ol><p>The implementation required modifying only three lines in the example showcase tool’s Rust code. The updated regex now correctly identifies all supported shader types, ensuring proper tab rendering for WESL examples in the documentation.<p>From an engineering perspective, this change demonstrates the importance of:<ul><li>Regular expression optimization for maintainability<li>Comprehensive extension handling in file processing systems<li>Documentation system validation when introducing new asset types</ul><p>The impact is immediately visible in the <a rel="noopener nofollow noreferrer" href=https://bevyengine.org/examples-webgpu/shaders/shader-material-wesl/ target=_blank>updated WESL example documentation</a>, which now properly displays all relevant shader files through tabbed navigation.<h2 id=visual-representation>Visual Representation</h2><pre class=language-mermaid data-lang=mermaid style=color:#61676c;background-color:#fafafa><code class=language-mermaid data-lang=mermaid><span>graph LR
</span><span>    A[Example Showcase Tool] --> B[Shader File Detection]
</span><span>    B --> C[Regex Pattern]
</span><span>    C --> D[.wgsl]
</span><span>    C --> E[.frag]
</span><span>    C --> F[.vert]
</span><span>    C --> G[.wesl]
</span></code></pre><h2 id=key-files-changed>Key Files Changed</h2><h3 id=tools-example-showcase-src-main-rs-1-3><code>tools/example-showcase/src/main.rs</code> (+1/-3)</h3><p><strong>Purpose</strong>: Update regex pattern to include .wesl shader files<p><strong>Code Changes</strong>:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before:
</span><span style=color:#fa6e32>let</span><span> shader_regex </span><span style=color:#ed9366>=
</span><span>    Regex</span><span style=color:#ed9366>::</span><span>new(</span><span style=color:#fa6e32>r</span><span style=color:#86b300>"(shaders\/\w+\.wgsl)|(shaders\/\w+\.frag)|(shaders\/\w+\.vert)"</span><span>)
</span><span>        </span><span style=color:#ed9366>.</span><span style=color:#f07171>unwrap</span><span>()</span><span style=color:#61676ccc>;
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After:
</span><span style=color:#fa6e32>let</span><span> shader_regex </span><span style=color:#ed9366>= </span><span>Regex</span><span style=color:#ed9366>::</span><span>new(</span><span style=color:#fa6e32>r</span><span style=color:#86b300>"shaders\/\w+\.(wgsl|frag|vert|wesl)"</span><span>)</span><span style=color:#ed9366>.</span><span style=color:#f07171>unwrap</span><span>()</span><span style=color:#61676ccc>;
</span></code></pre><p><strong>Impact</strong>:<ul><li>Reduced regex complexity from 3 alternations to 1 grouped pattern<li>Added wesl extension to recognized shader files<li>Maintained backward compatibility with existing shader types</ul><h2 id=further-reading>Further Reading</h2><ol><li><a rel="noopener nofollow noreferrer" href=https://bevyengine.org/learn/book/getting-started/examples/ target=_blank>Bevy Examples Documentation</a><li><a rel="noopener nofollow noreferrer" href=https://docs.rs/regex/latest/regex/ target=_blank>Rust Regex Crate Documentation</a><li><a rel="noopener nofollow noreferrer" href=https://www.w3.org/TR/WGSL/ target=_blank>WebGPU Shading Language (WGSL) Spec</a></ol><h1 id=full-code-diff>Full Code Diff</h1><pre class=language-diff data-lang=diff style=color:#61676c;background-color:#fafafa><code class=language-diff data-lang=diff><span>diff --git a/tools/example-showcase/src/main.rs b/tools/example-showcase/src/main.rs
</span><span>index c8feff10503e1..6fa24b1a27359 100644
</span><span style=color:#c594c5>--- a/tools/example-showcase/src/main.rs
</span><span style=color:#c594c5>+++ b/tools/example-showcase/src/main.rs
</span><span style=color:#c594c5>@@ -773,9 +773,7 @@ </span><span style=color:#399ee6>fn parse_examples() -> Vec&LTExample> {
</span><span>             let technical_name = val.get("name").unwrap().as_str().unwrap().to_string();
</span><span> 
</span><span>             let source_code = fs::read_to_string(val["path"].as_str().unwrap()).unwrap();
</span><span style=color:#f07171>-            let shader_regex =
</span><span style=color:#f07171>-                Regex::new(r"(shaders\/\w+\.wgsl)|(shaders\/\w+\.frag)|(shaders\/\w+\.vert)")
</span><span style=color:#f07171>-                    .unwrap();
</span><span style=color:#86b300>+            let shader_regex = Regex::new(r"shaders\/\w+\.(wgsl|frag|vert|wesl)").unwrap();
</span><span> 
</span><span>             // Find all instances of references to shader files, and keep them in an ordered and deduped vec.
</span><span>             let mut shader_paths = vec![];
</span></code></pre></div><div data-is-md-page=true data-patch-exists=true data-patch-path=/pull_request/bevy/2025-05/pr_19178.patch id=patch-info style=display:none></div><div class=bottom-spacer></div></div></div>