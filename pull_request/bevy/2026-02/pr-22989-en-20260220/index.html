<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://unknownue.github.io name=base><title>
         #22989 Allow accessing subassets using their handle
        
    </title><meta content="#22989 Allow accessing subassets using their handle" property=og:title><meta content="A personal blog built with Zola and Apollo theme" property=og:description><meta content="A personal blog built with Zola and Apollo theme" name=description><link href=/icons/favicon.png rel=icon type=image/png><link href=https://unknownue.github.io/fonts.css rel=stylesheet><script src=https://unknownue.github.io/js/codeblock.js></script><script src=https://unknownue.github.io/js/toc.js></script><script src=https://unknownue.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Unknownue's Blog" href=https://unknownue.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://unknownue.github.io/theme/light.css rel=stylesheet><link href=https://unknownue.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://unknownue.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://unknownue.github.io/main.css media=screen rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js></script><script>// Initialize mermaid once DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            mermaid.initialize({
                startOnLoad: false,
                theme: document.body && document.body.classList.contains('dark') ? 'dark' : 'default',
                securityLevel: 'loose',
                flowchart: {
                    useMaxWidth: true,
                    htmlLabels: true
                },
                sequence: {
                    diagramMarginX: 50,
                    diagramMarginY: 10,
                    actorMargin: 50,
                    width: 150,
                    height: 65
                }
            });
        });</script><script src=https://unknownue.github.io/js/main.js></script><script defer src=https://unknownue.github.io/js/label-colors.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/rust.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/typescript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/go.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/cpp.min.js></script><script>// Ensure highlight.js is properly configured
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof hljs !== 'undefined') {
                hljs.configure({
                    languages: ['rust', 'javascript', 'python', 'cpp', 'go', 'typescript'],
                    ignoreUnescapedHTML: true
                });
                console.log('Highlight.js configured in header');
            }
        });</script><link href=https://cdn.jsdelivr.net/npm/diff2html/bundles/css/diff2html.min.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/diff2html/bundles/js/diff2html-ui.min.js></script><script src=https://unknownue.github.io/js/syntax-highlight.js></script><script src=https://unknownue.github.io/js/diff-sidebar.js></script><script src="https://unknownue.github.io/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><div class=content><header><div class=main><a href=https://unknownue.github.io>Unknownue's Blog</a><div class=socials><a class=social href=https://github.com/unknownue rel=me> <img alt=github src=https://unknownue.github.io/icons/social/github.svg> </a><a class=social href=https://github.com/unknownue/unknownue.github.io rel=me> <img alt=github-io src=https://unknownue.github.io/icons/social/rss.svg> </a></div></div><nav><a href=https://unknownue.github.io/posts style=margin-left:.25em>/posts</a><a href=https://unknownue.github.io/projects style=margin-left:.25em>/projects</a><a href=https://unknownue.github.io/about style=margin-left:.25em>/about</a><a href=https://unknownue.github.io/tags style=margin-left:.25em>/tags</a><button title="$SHORTCUT to open search" class=search-button id=search-button><img alt=Search class=search-icon src=https://unknownue.github.io/icons/search.svg></button><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><div id=modal-content><h1 class=page-header id=modalTitle>Search</h1><div id=searchBar><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search... role=combobox spellcheck=false><button title="Clear search" class=clear-button id=clear-search><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></button></div><div id=results-container><div id=results-info><span id=zero_results style=display:none>No results</span><span id=one_result style=display:none>1 result</span><span id=many_results style=display:none>$NUMBER results</span></div><div id=results role=listbox></div></div></div></div><a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://unknownue.github.io/icons/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://unknownue.github.io/icons/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><div class=pull-request-page><article class=md-content-page style=display:none></article><div class=back-link><a href=/pull_request/bevy/2026-02/>← Back to Pull Requests</a></div><div class=pr-metadata><span class=pr-date>2026-02-20</span><div class=language-switcher><span class="lang-link active" data-lang=en>English</span> / <a class=lang-link data-lang=zh-cn href=/pull_request/bevy/2026-02/pr-22989-zh-cn-20260220>中文</a></div></div><div class=pr-content><h1 id=title-allow-accessing-subassets-using-their-handle>Title: Allow accessing subassets using their handle</h1><h2 id=basic-information>Basic Information</h2><ul><li><strong>Title</strong>: Allow accessing subassets using their handle.<li><strong>PR Link</strong>: https://github.com/bevyengine/bevy/pull/22989<li><strong>Author</strong>: andriyDev<li><strong>Status</strong>: MERGED<li><strong>Labels</strong>: C-Feature, A-Assets, S-Ready-For-Final-Review, D-Straightforward<li><strong>Created</strong>: 2026-02-17T04:27:30Z<li><strong>Merged</strong>: 2026-02-20T01:53:56Z<li><strong>Merged By</strong>: alice-i-cecile</ul><h2 id=description-translation>Description Translation</h2><h1 id=objective>Objective</h1><ul><li>Fixes #11595.</ul><h2 id=solution>Solution</h2><ul><li>Change our labeled asset storage to be a <code>Vec</code> of labeled assets, and then a <code>HashMap</code> from label to index.<li>Add an <code>AssetId</code> -> index mapping.<li>Provide methods to do that lookup.<li>Fixed an annoying TODO in our asset saving example.</ul><p>This is all managed by the asset loading stuff internally - so no migration guide!<h2 id=testing>Testing</h2><ul><li>Ran the <code>asset_saving</code> example and it still works!</ul><h2 id=the-story-of-this-pull-request>The Story of This Pull Request</h2><p>The problem this PR addresses is a straightforward but important limitation in Bevy’s asset system. Developers working with labeled subassets (subassets within a main asset) could only access them by label, not by their handles. This created an inconsistency since handles are the primary way to reference assets elsewhere in Bevy, but for subassets, developers had to maintain separate label information.<p>The issue #11595 documented this limitation, where someone trying to use subasset handles couldn’t easily retrieve the corresponding asset data. This was particularly problematic in asset saving scenarios where you might have handles to subassets but need to access the actual asset data during the save process.<p>The solution takes a pragmatic approach: rather than just adding handle-based lookups to the existing HashMap structure, the implementation reorganizes the storage to support multiple efficient lookup methods. The key insight is that labeled assets need to be accessible by both label and asset ID (from the handle), and using a single HashMap keyed by label doesn’t support the latter.<p>The implementation changes the data structure from a simple <code>HashMap&LTCowArc<'static, str>, LabeledAsset></code> to a more complex but versatile structure:<ul><li>A <code>Vec&LTLabeledAsset></code> for ordered storage<li>A <code>HashMap&LTCowArc<'static, str>, usize></code> for label-to-index lookups<li>A <code>HashMap&LTUntypedAssetId, usize></code> for asset-ID-to-index lookups</ul><p>This three-part structure provides O(1) lookups by both label and asset ID while maintaining the ability to iterate over all labeled assets. The comment in the code acknowledges that the asset ID mapping is “entirely redundant” with the labeled assets vector, but necessary for efficient handle-based lookups.<p>The changes propagate consistently through Bevy’s asset system components: <code>LoadedAsset</code>, <code>ErasedLoadedAsset</code>, <code>LoadContext</code>, <code>SavedAsset</code>, <code>ErasedSavedAsset</code>, <code>TransformedAsset</code>, and <code>TransformedSubAsset</code>. Each of these structs gets the same three-field structure and corresponding lookup methods. This consistency ensures that handle-based lookups work uniformly across asset loading, saving, and transformation contexts.<p>One notable implementation detail is in the <code>add_labeled_asset</code> method in <code>LoadContext</code>. When adding a labeled asset, the code now handles the case where a label might already exist (an “occupied” entry in the HashMap). The comment notes that this should probably be treated as an error since replacing a subasset is likely accidental, but the current implementation allows replacement while properly updating the asset ID mapping.<p>The PR also fixes a TODO comment in the <code>asset_saving</code> example, where the previous code had to work around the limitation by extracting labels from handles and then doing label-based lookups. The new code can directly use <code>get_labeled_by_id</code>, which is cleaner and more reliable.<p>From a performance perspective, the changes add some memory overhead (two additional HashMaps per asset with labeled subassets) but maintain O(1) lookups. The trade-off is reasonable given that labeled assets are typically used for complex assets like scenes or glTF files with embedded textures, where the convenience and correctness of handle-based access outweighs the modest memory cost.<p>The implementation demonstrates good software engineering practices: it solves the immediate problem while maintaining API consistency, it doesn’t break existing code (no migration needed), and it fixes related TODOs in the codebase. The changes are localized to the asset system internals, so users only see the new capabilities without having to change their code unless they want to use the new handle-based lookups.<h2 id=visual-representation>Visual Representation</h2><pre class=language-mermaid data-lang=mermaid style=color:#61676c;background-color:#fafafa><code class=language-mermaid data-lang=mermaid><span>graph TB
</span><span>    subgraph "Asset with Subassets"
</span><span>        A[LoadedAsset/TransformedAsset/SavedAsset]
</span><span>        
</span><span>        subgraph "Storage Structure"
</span><span>            B[Vec&LTLabeledAsset>]
</span><span>            C[HashMap&LTLabel, Index>]
</span><span>            D[HashMap&LTAssetId, Index>]
</span><span>        end
</span><span>        
</span><span>        subgraph "Lookup Methods"
</span><span>            E[get_labeled("label")]
</span><span>            F[get_labeled_by_id(handle)]
</span><span>            G[iter_labels()]
</span><span>        end
</span><span>    end
</span><span>    
</span><span>    A --> B
</span><span>    A --> C
</span><span>    A --> D
</span><span>    
</span><span>    C --> E
</span><span>    D --> F
</span><span>    B --> G
</span></code></pre><h2 id=key-files-changed>Key Files Changed</h2><h3 id=crates-bevy-asset-src-loader-rs-185-19><code>crates/bevy_asset/src/loader.rs</code> (+185/-19)</h3><p>This file contains the core changes to the asset loading system. The <code>LoadedAsset</code>, <code>ErasedLoadedAsset</code>, and <code>LoadContext</code> structs were updated to use the new three-part storage structure.<p>Key changes:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before:
</span><span style=color:#fa6e32>pub</span><span>(</span><span style=color:#fa6e32>crate</span><span>) labeled_assets</span><span style=color:#61676ccc>: </span><span>HashMap&LTCowArc<</span><span style=color:#fa6e32>'static</span><span>, </span><span style=color:#fa6e32>str</span><span>>, LabeledAsset></span><span style=color:#61676ccc>,
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After:
</span><span style=color:#fa6e32>pub</span><span>(</span><span style=color:#fa6e32>crate</span><span>) labeled_assets</span><span style=color:#61676ccc>: </span><span style=color:#55b4d4;font-style:italic>Vec</span><span>&LTLabeledAsset></span><span style=color:#61676ccc>,
</span><span style=color:#fa6e32>pub</span><span>(</span><span style=color:#fa6e32>crate</span><span>) label_to_asset_index</span><span style=color:#61676ccc>: </span><span>HashMap&LTCowArc<</span><span style=color:#fa6e32>'static</span><span>, </span><span style=color:#fa6e32>str</span><span>>, </span><span style=color:#fa6e32>usize</span><span>></span><span style=color:#61676ccc>,
</span><span style=color:#fa6e32>pub</span><span>(</span><span style=color:#fa6e32>crate</span><span>) asset_id_to_asset_index</span><span style=color:#61676ccc>: </span><span>HashMap&LTUntypedAssetId, </span><span style=color:#fa6e32>usize</span><span>></span><span style=color:#61676ccc>,
</span></code></pre><p>New methods added:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#fa6e32>pub fn </span><span style=color:#f29718>get_labeled_by_id</span><span>(</span><span style=color:#ed9366>&</span><span style=color:#ff8f40>self</span><span>, </span><span style=color:#ff8f40>id</span><span style=color:#61676ccc>:</span><span> impl </span><span style=color:#55b4d4;font-style:italic>Into</span><span>&LTUntypedAssetId>) </span><span style=color:#61676ccc>-> </span><span style=color:#55b4d4;font-style:italic>Option</span><span><</span><span style=color:#ed9366>&</span><span>ErasedLoadedAsset> {
</span><span>    </span><span style=color:#fa6e32>let</span><span> index </span><span style=color:#ed9366>= </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>asset_id_to_asset_index</span><span style=color:#ed9366>.</span><span style=color:#f07171>get</span><span>(</span><span style=color:#ed9366>&</span><span>id</span><span style=color:#ed9366>.</span><span style=color:#f07171>into</span><span>())</span><span style=color:#ed9366>?</span><span style=color:#61676ccc>;
</span><span>    </span><span style=color:#fa6e32>let</span><span> labeled </span><span style=color:#ed9366>= &</span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>labeled_assets[</span><span style=color:#ed9366>*</span><span>index]</span><span style=color:#61676ccc>;
</span><span>    </span><span style=color:#55b4d4;font-style:italic>Some</span><span>(</span><span style=color:#ed9366>&</span><span>labeled</span><span style=color:#ed9366>.</span><span>asset)
</span><span>}
</span></code></pre><h3 id=crates-bevy-asset-src-saver-rs-126-32><code>crates/bevy_asset/src/saver.rs</code> (+126/-32)</h3><p>The asset saving system was updated to match the new structure. <code>SavedAsset</code>, <code>ErasedSavedAsset</code>, and <code>SavedAssetBuilder</code> now support handle-based lookups.<p>Key changes:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before:
</span><span>labeled_assets</span><span style=color:#61676ccc>: </span><span>Moo<</span><span style=color:#fa6e32>'b</span><span>, HashMap&LTCowArc<</span><span style=color:#fa6e32>'a</span><span>, </span><span style=color:#fa6e32>str</span><span>>, LabeledSavedAsset<</span><span style=color:#fa6e32>'a</span><span>>>></span><span style=color:#61676ccc>,
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After:
</span><span>labeled_assets</span><span style=color:#61676ccc>: </span><span>Moo<</span><span style=color:#fa6e32>'b</span><span>, </span><span style=color:#55b4d4;font-style:italic>Vec</span><span>&LTLabeledSavedAsset<</span><span style=color:#fa6e32>'a</span><span>>>></span><span style=color:#61676ccc>,
</span><span>label_to_asset_index</span><span style=color:#61676ccc>: </span><span>Moo<</span><span style=color:#fa6e32>'b</span><span>, HashMap&LTCowArc<</span><span style=color:#fa6e32>'a</span><span>, </span><span style=color:#fa6e32>str</span><span>>, </span><span style=color:#fa6e32>usize</span><span>>></span><span style=color:#61676ccc>,
</span><span>asset_id_to_asset_index</span><span style=color:#61676ccc>: </span><span>Moo<</span><span style=color:#fa6e32>'b</span><span>, HashMap&LTUntypedAssetId, </span><span style=color:#fa6e32>usize</span><span>>></span><span style=color:#61676ccc>,
</span></code></pre><p>New methods added:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#fa6e32>pub fn </span><span style=color:#f29718>get_labeled_by_id</span><span>&LTB</span><span style=color:#61676ccc>:</span><span> Asset>(
</span><span>    </span><span style=color:#ed9366>&</span><span style=color:#ff8f40>self</span><span>,
</span><span>    </span><span style=color:#ff8f40>id</span><span style=color:#61676ccc>:</span><span> impl </span><span style=color:#55b4d4;font-style:italic>Into</span><span>&LTAssetId&LTB>>,
</span><span>) </span><span style=color:#61676ccc>-> </span><span style=color:#55b4d4;font-style:italic>Option</span><span>&LTSavedAsset<</span><span style=color:#fa6e32>'a</span><span>, '</span><span style=color:#ed9366>_</span><span>, B>> {
</span><span>    </span><span style=color:#fa6e32>let</span><span> index </span><span style=color:#ed9366>= </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>asset_id_to_asset_index</span><span style=color:#ed9366>.</span><span style=color:#f07171>get</span><span>(</span><span style=color:#ed9366>&</span><span>id</span><span style=color:#ed9366>.</span><span style=color:#f07171>into</span><span>()</span><span style=color:#ed9366>.</span><span style=color:#f07171>untyped</span><span>())</span><span style=color:#ed9366>?</span><span style=color:#61676ccc>;
</span><span>    </span><span style=color:#fa6e32>let</span><span> labeled </span><span style=color:#ed9366>= &</span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>labeled_assets[</span><span style=color:#ed9366>*</span><span>index]</span><span style=color:#61676ccc>;
</span><span>    labeled</span><span style=color:#ed9366>.</span><span>asset</span><span style=color:#ed9366>.</span><span style=color:#f07171>downcast</span><span>()
</span><span>}
</span></code></pre><h3 id=crates-bevy-asset-src-transformer-rs-185-19><code>crates/bevy_asset/src/transformer.rs</code> (+185/-19)</h3><p>The asset transformation system was updated for consistency. <code>TransformedAsset</code> and <code>TransformedSubAsset</code> now support the same lookup patterns.<p>Key changes:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before:
</span><span style=color:#fa6e32>pub</span><span>(</span><span style=color:#fa6e32>crate</span><span>) labeled_assets</span><span style=color:#61676ccc>: </span><span>HashMap&LTCowArc<</span><span style=color:#fa6e32>'static</span><span>, </span><span style=color:#fa6e32>str</span><span>>, LabeledAsset></span><span style=color:#61676ccc>,
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After:
</span><span style=color:#fa6e32>pub</span><span>(</span><span style=color:#fa6e32>crate</span><span>) labeled_assets</span><span style=color:#61676ccc>: </span><span style=color:#55b4d4;font-style:italic>Vec</span><span>&LTLabeledAsset></span><span style=color:#61676ccc>,
</span><span style=color:#fa6e32>pub</span><span>(</span><span style=color:#fa6e32>crate</span><span>) label_to_asset_index</span><span style=color:#61676ccc>: </span><span>HashMap&LTCowArc<</span><span style=color:#fa6e32>'static</span><span>, </span><span style=color:#fa6e32>str</span><span>>, </span><span style=color:#fa6e32>usize</span><span>></span><span style=color:#61676ccc>,
</span><span style=color:#fa6e32>pub</span><span>(</span><span style=color:#fa6e32>crate</span><span>) asset_id_to_asset_index</span><span style=color:#61676ccc>: </span><span>HashMap&LTUntypedAssetId, </span><span style=color:#fa6e32>usize</span><span>></span><span style=color:#61676ccc>,
</span></code></pre><p>New methods added:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#fa6e32>pub fn </span><span style=color:#f29718>get_labeled_by_id</span><span>&LTB</span><span style=color:#61676ccc>:</span><span> Asset, Q>(
</span><span>    </span><span style=color:#ed9366>&</span><span style=color:#fa6e32>mut </span><span style=color:#ff8f40>self</span><span>,
</span><span>    </span><span style=color:#ff8f40>id</span><span style=color:#61676ccc>:</span><span> impl </span><span style=color:#55b4d4;font-style:italic>Into</span><span>&LTAssetId&LTB>>,
</span><span>) </span><span style=color:#61676ccc>-> </span><span style=color:#55b4d4;font-style:italic>Option</span><span>&LTTransformedSubAsset<'</span><span style=color:#ed9366>_</span><span>, B>>
</span><span style=color:#fa6e32>where
</span><span>    CowArc<</span><span style=color:#fa6e32>'static</span><span>, </span><span style=color:#fa6e32>str</span><span>></span><span style=color:#61676ccc>: </span><span>Borrow&LTQ>,
</span><span>    Q</span><span style=color:#61676ccc>:</span><span> ?Sized + Hash + Eq,
</span><span>{
</span><span>    </span><span style=color:#fa6e32>let</span><span> index </span><span style=color:#ed9366>= </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>asset_id_to_asset_index</span><span style=color:#ed9366>.</span><span style=color:#f07171>get</span><span>(</span><span style=color:#ed9366>&</span><span>id</span><span style=color:#ed9366>.</span><span style=color:#f07171>into</span><span>()</span><span style=color:#ed9366>.</span><span style=color:#f07171>untyped</span><span>())</span><span style=color:#ed9366>?</span><span style=color:#61676ccc>;
</span><span>    </span><span style=color:#fa6e32>let</span><span> labeled </span><span style=color:#ed9366>= &</span><span style=color:#fa6e32>mut </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>labeled_assets[</span><span style=color:#ed9366>*</span><span>index]</span><span style=color:#61676ccc>;
</span><span>    </span><span style=color:#fa6e32>let</span><span> value </span><span style=color:#ed9366>=</span><span> labeled</span><span style=color:#ed9366>.</span><span>asset</span><span style=color:#ed9366>.</span><span>value</span><span style=color:#ed9366>.</span><span>downcast_mut</span><span style=color:#ed9366>::</span><span>&LTB>()</span><span style=color:#ed9366>?</span><span style=color:#61676ccc>;
</span><span>    </span><span style=color:#55b4d4;font-style:italic>Some</span><span>(TransformedSubAsset {
</span><span>        value</span><span style=color:#61676ccc>,
</span><span>        labeled_assets</span><span style=color:#61676ccc>: </span><span style=color:#ed9366>&</span><span style=color:#fa6e32>mut</span><span> labeled</span><span style=color:#ed9366>.</span><span>asset</span><span style=color:#ed9366>.</span><span>labeled_assets</span><span style=color:#61676ccc>,
</span><span>        label_to_asset_index</span><span style=color:#61676ccc>: </span><span style=color:#ed9366>&</span><span style=color:#fa6e32>mut</span><span> labeled</span><span style=color:#ed9366>.</span><span>asset</span><span style=color:#ed9366>.</span><span>label_to_asset_index</span><span style=color:#61676ccc>,
</span><span>        asset_id_to_asset_index</span><span style=color:#61676ccc>: </span><span style=color:#ed9366>&</span><span style=color:#fa6e32>mut</span><span> labeled</span><span style=color:#ed9366>.</span><span>asset</span><span style=color:#ed9366>.</span><span>asset_id_to_asset_index</span><span style=color:#61676ccc>,
</span><span>    })
</span><span>}
</span></code></pre><h3 id=examples-asset-asset-saving-rs-5-9><code>examples/asset/asset_saving.rs</code> (+5/-9)</h3><p>The example was updated to use the new handle-based lookup instead of the workaround that extracted labels from handles.<p>Key change:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before (with TODO comment):
</span><span style=color:#abb0b6;font-style:italic>// TODO: We should have a better to get the asset for a subasset handle.
</span><span style=color:#fa6e32>let</span><span> label </span><span style=color:#ed9366>=</span><span> handle
</span><span>    </span><span style=color:#ed9366>.</span><span style=color:#f07171>path</span><span>()
</span><span>    </span><span style=color:#ed9366>.</span><span style=color:#f07171>and_then</span><span>(|</span><span style=color:#ff8f40>path</span><span>| path</span><span style=color:#ed9366>.</span><span style=color:#f07171>label</span><span>())
</span><span>    </span><span style=color:#ed9366>.</span><span style=color:#f07171>ok_or_else</span><span>(|| </span><span style=color:#f07171>format!</span><span>(</span><span style=color:#86b300>"Failed to get label for handle </span><span style=color:#ff8f40>{handle:?}</span><span style=color:#86b300>"</span><span>))</span><span style=color:#ed9366>?</span><span style=color:#61676ccc>;
</span><span>asset
</span><span>    </span><span style=color:#ed9366>.</span><span>get_labeled</span><span style=color:#ed9366>::</span><span>&LTOneBox>(label)
</span><span>    </span><span style=color:#ed9366>.</span><span style=color:#f07171>map</span><span>(|</span><span style=color:#ff8f40>subasset</span><span>| subasset</span><span style=color:#ed9366>.</span><span style=color:#f07171>get</span><span>()</span><span style=color:#ed9366>.</span><span style=color:#f07171>clone</span><span>())
</span><span>    </span><span style=color:#ed9366>.</span><span style=color:#f07171>ok_or_else</span><span>(|| </span><span style=color:#f07171>format!</span><span>(</span><span style=color:#86b300>"Failed to find labeled asset for label </span><span style=color:#ff8f40>{label}</span><span style=color:#86b300>"</span><span>))
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After (simplified):
</span><span>asset
</span><span>    </span><span style=color:#ed9366>.</span><span>get_labeled_by_id</span><span style=color:#ed9366>::</span><span>&LTOneBox>(handle)
</span><span>    </span><span style=color:#ed9366>.</span><span style=color:#f07171>unwrap</span><span>()
</span><span>    </span><span style=color:#ed9366>.</span><span style=color:#f07171>get</span><span>()
</span><span>    </span><span style=color:#ed9366>.</span><span style=color:#f07171>clone</span><span>()
</span></code></pre><h3 id=crates-bevy-asset-src-server-mod-rs-3-2><code>crates/bevy_asset/src/server/mod.rs</code> (+3/-2)</h3><p>Minor updates to use the new structure when looking up labeled assets by label in the asset server.<h2 id=further-reading>Further Reading</h2><ol><li><a rel="noopener nofollow noreferrer" href=https://docs.rs/bevy_asset/latest/bevy_asset/ target=_blank>Bevy Assets Documentation</a> - Official documentation for Bevy’s asset system<li><a rel="noopener nofollow noreferrer" href=https://bevy-cheatbook.github.io/features/assets.html target=_blank>Handles and Assets in Bevy</a> - Cheat sheet for working with assets in Bevy<li><a rel="noopener nofollow noreferrer" href=https://github.com/bevyengine/bevy/issues/11595 target=_blank>Issue #11595</a> - The original issue that motivated this PR<li><a rel="noopener nofollow noreferrer" href=https://doc.rust-lang.org/std/collections/index.html target=_blank>HashMap vs Vec for lookups</a> - Rust documentation on collection performance characteristics<li><a rel="noopener nofollow noreferrer" href=https://www.gameenginebook.com/ target=_blank>Asset Pipelines in Game Engines</a> - General concepts about asset management in game engines</ol></div><div data-is-md-page=true data-patch-exists=true data-patch-path=/pull_request/bevy/2026-02/pr_22989.patch id=patch-info style=display:none></div><div class=bottom-spacer></div></div></div>