<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://unknownue.github.io name=base><title>
         #23066 Makes Free Camera speed change exponential wrt scroll
        
    </title><meta content="#23066 Makes Free Camera speed change exponential wrt scroll" property=og:title><meta content="A personal blog built with Zola and Apollo theme" property=og:description><meta content="A personal blog built with Zola and Apollo theme" name=description><link href=/icons/favicon.png rel=icon type=image/png><link href=https://unknownue.github.io/fonts.css rel=stylesheet><script src=https://unknownue.github.io/js/codeblock.js></script><script src=https://unknownue.github.io/js/toc.js></script><script src=https://unknownue.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Unknownue's Blog" href=https://unknownue.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://unknownue.github.io/theme/light.css rel=stylesheet><link href=https://unknownue.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://unknownue.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://unknownue.github.io/main.css media=screen rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js></script><script>// Initialize mermaid once DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            mermaid.initialize({
                startOnLoad: false,
                theme: document.body && document.body.classList.contains('dark') ? 'dark' : 'default',
                securityLevel: 'loose',
                flowchart: {
                    useMaxWidth: true,
                    htmlLabels: true
                },
                sequence: {
                    diagramMarginX: 50,
                    diagramMarginY: 10,
                    actorMargin: 50,
                    width: 150,
                    height: 65
                }
            });
        });</script><script src=https://unknownue.github.io/js/main.js></script><script defer src=https://unknownue.github.io/js/label-colors.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/rust.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/typescript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/go.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/cpp.min.js></script><script>// Ensure highlight.js is properly configured
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof hljs !== 'undefined') {
                hljs.configure({
                    languages: ['rust', 'javascript', 'python', 'cpp', 'go', 'typescript'],
                    ignoreUnescapedHTML: true
                });
                console.log('Highlight.js configured in header');
            }
        });</script><link href=https://cdn.jsdelivr.net/npm/diff2html/bundles/css/diff2html.min.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/diff2html/bundles/js/diff2html-ui.min.js></script><script src=https://unknownue.github.io/js/syntax-highlight.js></script><script src=https://unknownue.github.io/js/diff-sidebar.js></script><script src="https://unknownue.github.io/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><div class=content><header><div class=main><a href=https://unknownue.github.io>Unknownue's Blog</a><div class=socials><a class=social href=https://github.com/unknownue rel=me> <img alt=github src=https://unknownue.github.io/icons/social/github.svg> </a><a class=social href=https://github.com/unknownue/unknownue.github.io rel=me> <img alt=github-io src=https://unknownue.github.io/icons/social/rss.svg> </a></div></div><nav><a href=https://unknownue.github.io/posts style=margin-left:.25em>/posts</a><a href=https://unknownue.github.io/projects style=margin-left:.25em>/projects</a><a href=https://unknownue.github.io/about style=margin-left:.25em>/about</a><a href=https://unknownue.github.io/tags style=margin-left:.25em>/tags</a><button title="$SHORTCUT to open search" class=search-button id=search-button><img alt=Search class=search-icon src=https://unknownue.github.io/icons/search.svg></button><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><div id=modal-content><h1 class=page-header id=modalTitle>Search</h1><div id=searchBar><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search... role=combobox spellcheck=false><button title="Clear search" class=clear-button id=clear-search><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></button></div><div id=results-container><div id=results-info><span id=zero_results style=display:none>No results</span><span id=one_result style=display:none>1 result</span><span id=many_results style=display:none>$NUMBER results</span></div><div id=results role=listbox></div></div></div></div><a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://unknownue.github.io/icons/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://unknownue.github.io/icons/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><div class=pull-request-page><article class=md-content-page style=display:none></article><div class=back-link><a href=/pull_request/bevy/2026-02/>← Back to Pull Requests</a></div><div class=pr-metadata><span class=pr-date>2026-02-24</span><div class=language-switcher><span class="lang-link active" data-lang=en>English</span> / <a class=lang-link data-lang=zh-cn href=/pull_request/bevy/2026-02/pr-23066-zh-cn-20260224>中文</a></div></div><div class=pr-content><h1 id=title>Title</h1><p>Makes Free Camera speed change exponential wrt scroll<h2 id=basic-information>Basic Information</h2><ul><li><strong>Title</strong>: Makes Free Camera speed change exponential wrt scroll<li><strong>PR Link</strong>: https://github.com/bevyengine/bevy/pull/23066<li><strong>Author</strong>: kfc35<li><strong>Status</strong>: MERGED<li><strong>Labels</strong>: C-Usability, S-Ready-For-Final-Review, A-Math, D-Straightforward, A-Camera<li><strong>Created</strong>: 2026-02-20T06:12:13Z<li><strong>Merged</strong>: 2026-02-24T01:50:21Z<li><strong>Merged By</strong>: alice-i-cecile</ul><h2 id=description-translation>Description Translation</h2><h1 id=objective>Objective</h1><ul><li>Adopts and closes #21453 and goes the side of using <code>exp</code><li>Supersedes and closes #21483<li>Make free_camera more usable at very large or very small scales</ul><h2 id=solution>Solution</h2><ul><li>Basically updated #21453 to use <code>exp</code> instead of <code>powf</code> with a percent change. This means that <code>scroll_factor</code> no longer means “the additional percentage added to/subtracted from speed.”<li>I made sure to add some helpful comments in <code>scroll_factor</code> for determining an appropriate value for <code>scroll_factor</code> and what a reasonable default is. Hopefully it’s not too wordy</ul><h2 id=testing>Testing</h2><p>I tested with <code>cargo run --example free_camera_controller --features="free_camera"</code> and <code>cargo run --example 3d_gizmos --features="free_camera"</code> and made sure the controls feel good. Compared to <code>main</code>, it doesn’t take too long to go really fast and decreasing slower than the initial speed is more gradual.<h2 id=the-story-of-this-pull-request>The Story of This Pull Request</h2><p>The problem with the free camera controller in Bevy was that adjusting movement speed with the mouse scroll wheel used a linear scaling approach, which became problematic when navigating scenes at very large or very small scales. When dealing with large virtual worlds, developers needed to scroll excessively to reach usable speeds, while fine-grained speed adjustments were difficult at smaller scales.<p>Two previous PRs (#21453 and #21483) had attempted to solve this problem by implementing exponential scaling. This PR adopts the approach from #21453 but improves it by using the exponential function (<code>exp</code>) instead of power functions (<code>powf</code>), which is mathematically cleaner and more efficient. The key insight is that exponential scaling ensures that each unit of scroll has the same relative effect on speed, regardless of whether the hardware reports scroll events as one large event or multiple smaller ones.<p>The implementation changes how the <code>scroll_factor</code> parameter works. Previously, it represented a linear percentage change applied to the speed multiplier. With the new exponential approach, <code>scroll_factor</code> becomes the exponent in <code>e^(scroll_factor * scroll_delta)</code>, where each unit of scroll multiplies the current speed by <code>e^(scroll_factor)</code> for positive scrolls and divides it by <code>e^(scroll_factor)</code> (or multiplies by <code>e^(-scroll_factor)</code>) for negative scrolls.<p>The default <code>scroll_factor</code> value was changed from 0.5 to approximately ln(1.05) ≈ 0.04879016, which means each positive scroll unit increases speed by 5%, and each negative scroll unit decreases it by about 4.76%. This provides smooth, intuitive control where users can quickly reach high speeds with reasonable scrolling but still have fine-grained control at lower speeds.<p>The implementation also updates the minimum clamp value for the speed multiplier from 0.0 to <code>f32::EPSILON</code>. This is necessary because with exponential scaling, the speed multiplier should never reach zero (since <code>exp(x) > 0</code> for all real x). Using <code>f32::EPSILON</code> prevents division by zero issues while maintaining mathematical correctness.<p>From an engineering perspective, this change improves the user experience significantly while keeping the API simple. The updated documentation provides clear guidance for developers on choosing appropriate <code>scroll_factor</code> values, explaining the mathematical relationship and suggesting reasonable ranges. The implementation is computationally efficient, using the <code>exp</code> function from Bevy’s math utilities.<p>The testing approach was practical - the author verified the changes work correctly using existing examples (<code>free_camera_controller</code> and <code>3d_gizmos</code>), confirming that speed adjustments feel responsive and intuitive across different scales. Compared to the previous linear approach, users can now reach high speeds more quickly while still having precise control at lower speeds.<p>This change demonstrates good API design principles: it solves a real usability problem, maintains backward compatibility for the most part (the <code>scroll_factor</code> parameter still exists but now has a different semantic meaning), provides clear documentation, and uses appropriate mathematical functions for the problem domain.<h2 id=visual-representation>Visual Representation</h2><pre class=language-mermaid data-lang=mermaid style=color:#61676c;background-color:#fafafa><code class=language-mermaid data-lang=mermaid><span>graph TD
</span><span>    A[Mouse Scroll Event] --> B{Determine Scroll Amount}
</span><span>    B -->|Line units| C[Use delta.y directly]
</span><span>    B -->|Pixel units| D[Convert pixels to lines]
</span><span>    C --> E[Calculate scroll factor]
</span><span>    D --> E
</span><span>    E --> F[Compute exponential multiplier: exp(scroll_factor * scroll)]
</span><span>    F --> G[Update speed_multiplier *= multiplier]
</span><span>    G --> H[Clamp to EPSILON..MAX]
</span><span>    H --> I[Apply to camera movement]
</span></code></pre><h2 id=key-files-changed>Key Files Changed</h2><h3 id=crates-bevy-camera-controller-src-free-camera-rs-27-10><code>crates/bevy_camera_controller/src/free_camera.rs</code> (+27/-10)</h3><p>This file contains the implementation of the free camera controller, which handles user input for camera movement, rotation, and speed adjustment. The changes modify how mouse scroll wheel input affects the camera’s movement speed.<p><strong>Key modifications:</strong><ol><li><strong>Import addition</strong>: Added <code>ops::exp</code> to the math imports to use the exponential function.</ol><pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before:
</span><span style=color:#fa6e32>use </span><span>bevy_math</span><span style=color:#ed9366>::</span><span>{EulerRot</span><span style=color:#61676ccc>,</span><span> Quat</span><span style=color:#61676ccc>,</span><span> StableInterpolate</span><span style=color:#61676ccc>,</span><span> Vec2</span><span style=color:#61676ccc>,</span><span> Vec3}</span><span style=color:#61676ccc>;
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After:
</span><span style=color:#fa6e32>use </span><span>bevy_math</span><span style=color:#ed9366>::</span><span>{ops</span><span style=color:#ed9366>::</span><span>exp</span><span style=color:#61676ccc>,</span><span> EulerRot</span><span style=color:#61676ccc>,</span><span> Quat</span><span style=color:#61676ccc>,</span><span> StableInterpolate</span><span style=color:#61676ccc>,</span><span> Vec2</span><span style=color:#61676ccc>,</span><span> Vec3}</span><span style=color:#61676ccc>;
</span></code></pre><ol start=2><li><strong>Documentation update</strong>: Expanded the documentation for <code>scroll_factor</code> to explain the new exponential behavior and provide guidance on choosing appropriate values.</ol><pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before (brief comment):
</span><span style=color:#abb0b6;font-style:italic>/// Multiplier for how the mouse scroll wheel modifies [`walk_speed`](FreeCamera::walk_speed)
</span><span style=color:#abb0b6;font-style:italic>/// and [`run_speed`](FreeCamera::run_speed).
</span><span style=color:#fa6e32>pub</span><span> scroll_factor</span><span style=color:#61676ccc>: </span><span style=color:#fa6e32>f32</span><span style=color:#61676ccc>,
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After (detailed explanation):
</span><span style=color:#abb0b6;font-style:italic>/// Multiplier for how much the mouse scroll wheel affects [`walk_speed`](FreeCamera::walk_speed)
</span><span style=color:#abb0b6;font-style:italic>/// and [`run_speed`](FreeCamera::run_speed).
</span><span style=color:#abb0b6;font-style:italic>///
</span><span style=color:#abb0b6;font-style:italic>/// Mouse scroll affects speed exponentially. This is to ensure that scrolling the same
</span><span style=color:#abb0b6;font-style:italic>/// amount always has the same effect on speed, regardless of how the scroll amount
</span><span style=color:#abb0b6;font-style:italic>/// is reported by the hardware (i.e. as one big event vs many smaller events). This
</span><span style=color:#abb0b6;font-style:italic>/// also allows the free camera to navigate very large scenes easier.
</span><span style=color:#abb0b6;font-style:italic>///
</span><span style=color:#abb0b6;font-style:italic>/// For every unit of scroll, the speed of the camera is multiplied by a factor of
</span><span style=color:#abb0b6;font-style:italic>/// `e^(scroll_factor)`.
</span><span style=color:#abb0b6;font-style:italic>///
</span><span style=color:#abb0b6;font-style:italic>/// A reasonable value to start with is a `scroll_factor` between 0.04879016 (~ln(1.05))
</span><span style=color:#abb0b6;font-style:italic>/// and 0.0953102 (~ln(1.1)). They represent an increase by a factor between 1.05 and 1.1 per
</span><span style=color:#abb0b6;font-style:italic>/// positive unit scroll and a reduction between ~0.952 (~e^-0.04879016) and ~0.909
</span><span style=color:#abb0b6;font-style:italic>/// (~e^-0.0953102) times its value per negative unit scroll
</span><span style=color:#abb0b6;font-style:italic>///
</span><span style=color:#abb0b6;font-style:italic>/// A `scroll_factor` closer to 0.0 means that speed will be less sensitive to scroll.
</span><span style=color:#abb0b6;font-style:italic>/// A `scroll_factor` equal to 0.0 means that speed is unaffected by scroll
</span><span style=color:#abb0b6;font-style:italic>/// (it will be multiplied by a factor of 1.0 per positive and negative unit scroll).
</span><span style=color:#fa6e32>pub</span><span> scroll_factor</span><span style=color:#61676ccc>: </span><span style=color:#fa6e32>f32</span><span style=color:#61676ccc>,
</span></code></pre><ol start=3><li><strong>Default value change</strong>: Updated the default <code>scroll_factor</code> from 0.5 to approximately ln(1.05).</ol><pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before:
</span><span>scroll_factor</span><span style=color:#61676ccc>: </span><span style=color:#ff8f40>0.5</span><span style=color:#61676ccc>,
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After:
</span><span style=color:#abb0b6;font-style:italic>// Approximation of ln(1.05)
</span><span>scroll_factor</span><span style=color:#61676ccc>: </span><span style=color:#ff8f40>0.04879016</span><span style=color:#61676ccc>,
</span></code></pre><ol start=4><li><strong>Scroll processing logic</strong>: Changed from linear accumulation to exponential scaling.</ol><pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before implementation (simplified for comparison):
</span><span style=color:#fa6e32>let mut</span><span> scroll </span><span style=color:#ed9366>= </span><span style=color:#ff8f40>0.0</span><span style=color:#61676ccc>;
</span><span>scroll </span><span style=color:#ed9366>+=</span><span> amount</span><span style=color:#61676ccc>;  </span><span style=color:#abb0b6;font-style:italic>// accumulated scroll
</span><span>state</span><span style=color:#ed9366>.</span><span>speed_multiplier </span><span style=color:#ed9366>+=</span><span> scroll </span><span style=color:#ed9366>*</span><span> config</span><span style=color:#ed9366>.</span><span>scroll_factor</span><span style=color:#61676ccc>;
</span><span>state</span><span style=color:#ed9366>.</span><span>speed_multiplier </span><span style=color:#ed9366>=</span><span> state</span><span style=color:#ed9366>.</span><span>speed_multiplier</span><span style=color:#ed9366>.</span><span style=color:#f07171>clamp</span><span>(</span><span style=color:#ff8f40>0.0</span><span style=color:#61676ccc>, </span><span style=color:#fa6e32>f32</span><span style=color:#ed9366>::</span><span style=color:#ff8f40>MAX</span><span>)</span><span style=color:#61676ccc>;
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After implementation:
</span><span style=color:#fa6e32>let</span><span> scroll </span><span style=color:#ed9366>= </span><span style=color:#fa6e32>match</span><span> accumulated_mouse_scroll</span><span style=color:#ed9366>.</span><span>unit {
</span><span>    MouseScrollUnit</span><span style=color:#ed9366>::</span><span>Line </span><span style=color:#ed9366>=></span><span> accumulated_mouse_scroll</span><span style=color:#ed9366>.</span><span>delta</span><span style=color:#ed9366>.</span><span>y</span><span style=color:#61676ccc>,
</span><span>    MouseScrollUnit</span><span style=color:#ed9366>::</span><span>Pixel </span><span style=color:#ed9366>=> </span><span>{
</span><span>        accumulated_mouse_scroll</span><span style=color:#ed9366>.</span><span>delta</span><span style=color:#ed9366>.</span><span>y </span><span style=color:#ed9366>/ </span><span>MouseScrollUnit</span><span style=color:#ed9366>::</span><span style=color:#ff8f40>SCROLL_UNIT_CONVERSION_FACTOR
</span><span>    }
</span><span>}</span><span style=color:#61676ccc>;
</span><span style=color:#abb0b6;font-style:italic>// By using exponentiation we ensure that this scales up and down smoothly
</span><span style=color:#abb0b6;font-style:italic>// regardless of the amount of scrolling processed per frame
</span><span>state</span><span style=color:#ed9366>.</span><span>speed_multiplier </span><span style=color:#ed9366>*= </span><span style=color:#f07171>exp</span><span>(config</span><span style=color:#ed9366>.</span><span>scroll_factor </span><span style=color:#ed9366>*</span><span> scroll)</span><span style=color:#61676ccc>;
</span><span style=color:#abb0b6;font-style:italic>// Clamp the speed multiplier for safety.
</span><span>state</span><span style=color:#ed9366>.</span><span>speed_multiplier </span><span style=color:#ed9366>=</span><span> state</span><span style=color:#ed9366>.</span><span>speed_multiplier</span><span style=color:#ed9366>.</span><span style=color:#f07171>clamp</span><span>(</span><span style=color:#fa6e32>f32</span><span style=color:#ed9366>::</span><span style=color:#ff8f40>EPSILON</span><span style=color:#61676ccc>, </span><span style=color:#fa6e32>f32</span><span style=color:#ed9366>::</span><span style=color:#ff8f40>MAX</span><span>)</span><span style=color:#61676ccc>;
</span></code></pre><p>These changes relate directly to the PR’s purpose of making camera speed adjustments more usable across different scales by implementing exponential scaling, which provides consistent relative speed changes regardless of the current speed or how scroll events are reported by hardware.<h2 id=further-reading>Further Reading</h2><ol><li><p><strong>Exponential Functions in Game Development</strong>: Exponential scaling is commonly used for camera controls, volume sliders, and other settings where users need to adjust values across multiple orders of magnitude while maintaining fine control at both ends of the range.</p><li><p><strong>Logarithmic and Exponential Relationships</strong>: Understanding the mathematical relationship between logarithmic and exponential functions is key to designing intuitive control schemes. The natural logarithm (ln) and exponential (exp) functions are inverses of each other.</p><li><p><strong>Human Perception and Control Design</strong>: Research in human-computer interaction shows that humans perceive many physical phenomena (like sound, light, and in this case, motion speed) logarithmically rather than linearly, making exponential controls more intuitive.</p><li><p><strong>Bevy Input System</strong>: For developers wanting to understand how input events work in Bevy, the <code>bevy_input</code> crate documentation provides details on how mouse, keyboard, and other input events are processed and can be used in game systems.</p><li><p><strong>Camera Controllers in 3D Engines</strong>: Most modern 3D game engines and DCC tools use exponential or logarithmic scaling for camera navigation controls, as this approach has proven most effective for working with scenes that can vary dramatically in scale.</p></ol></div><div data-is-md-page=true data-patch-exists=true data-patch-path=/pull_request/bevy/2026-02/pr_23066.patch id=patch-info style=display:none></div><div class=bottom-spacer></div></div></div>