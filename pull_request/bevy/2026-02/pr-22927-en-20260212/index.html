<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://unknownue.github.io name=base><title>
         #22927 Specify nightly toolchain version in CI config
        
    </title><meta content="#22927 Specify nightly toolchain version in CI config" property=og:title><meta content="A personal blog built with Zola and Apollo theme" property=og:description><meta content="A personal blog built with Zola and Apollo theme" name=description><link href=/icons/favicon.png rel=icon type=image/png><link href=https://unknownue.github.io/fonts.css rel=stylesheet><script src=https://unknownue.github.io/js/codeblock.js></script><script src=https://unknownue.github.io/js/toc.js></script><script src=https://unknownue.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Unknownue's Blog" href=https://unknownue.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://unknownue.github.io/theme/light.css rel=stylesheet><link href=https://unknownue.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://unknownue.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://unknownue.github.io/main.css media=screen rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js></script><script>// Initialize mermaid once DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            mermaid.initialize({
                startOnLoad: false,
                theme: document.body && document.body.classList.contains('dark') ? 'dark' : 'default',
                securityLevel: 'loose',
                flowchart: {
                    useMaxWidth: true,
                    htmlLabels: true
                },
                sequence: {
                    diagramMarginX: 50,
                    diagramMarginY: 10,
                    actorMargin: 50,
                    width: 150,
                    height: 65
                }
            });
        });</script><script src=https://unknownue.github.io/js/main.js></script><script defer src=https://unknownue.github.io/js/label-colors.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/rust.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/typescript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/go.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/cpp.min.js></script><script>// Ensure highlight.js is properly configured
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof hljs !== 'undefined') {
                hljs.configure({
                    languages: ['rust', 'javascript', 'python', 'cpp', 'go', 'typescript'],
                    ignoreUnescapedHTML: true
                });
                console.log('Highlight.js configured in header');
            }
        });</script><link href=https://cdn.jsdelivr.net/npm/diff2html/bundles/css/diff2html.min.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/diff2html/bundles/js/diff2html-ui.min.js></script><script src=https://unknownue.github.io/js/syntax-highlight.js></script><script src=https://unknownue.github.io/js/diff-sidebar.js></script><script src="https://unknownue.github.io/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><div class=content><header><div class=main><a href=https://unknownue.github.io>Unknownue's Blog</a><div class=socials><a class=social href=https://github.com/unknownue rel=me> <img alt=github src=https://unknownue.github.io/icons/social/github.svg> </a><a class=social href=https://github.com/unknownue/unknownue.github.io rel=me> <img alt=github-io src=https://unknownue.github.io/icons/social/rss.svg> </a></div></div><nav><a href=https://unknownue.github.io/posts style=margin-left:.25em>/posts</a><a href=https://unknownue.github.io/projects style=margin-left:.25em>/projects</a><a href=https://unknownue.github.io/about style=margin-left:.25em>/about</a><a href=https://unknownue.github.io/tags style=margin-left:.25em>/tags</a><button title="$SHORTCUT to open search" class=search-button id=search-button><img alt=Search class=search-icon src=https://unknownue.github.io/icons/search.svg></button><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><div id=modal-content><h1 class=page-header id=modalTitle>Search</h1><div id=searchBar><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search... role=combobox spellcheck=false><button title="Clear search" class=clear-button id=clear-search><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></button></div><div id=results-container><div id=results-info><span id=zero_results style=display:none>No results</span><span id=one_result style=display:none>1 result</span><span id=many_results style=display:none>$NUMBER results</span></div><div id=results role=listbox></div></div></div></div><a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://unknownue.github.io/icons/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://unknownue.github.io/icons/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><div class=pull-request-page><article class=md-content-page style=display:none></article><div class=back-link><a href=/pull_request/bevy/2026-02/>← Back to Pull Requests</a></div><div class=pr-metadata><span class=pr-date>2026-02-12</span><div class=language-switcher><span class="lang-link active" data-lang=en>English</span> / <a class=lang-link data-lang=zh-cn href=/pull_request/bevy/2026-02/pr-22927-zh-cn-20260212>中文</a></div></div><div class=pr-content><h1 id=title>Title</h1><h2 id=basic-information>Basic Information</h2><ul><li><strong>Title</strong>: Specify nightly toolchain version in CI config<li><strong>PR Link</strong>: https://github.com/bevyengine/bevy/pull/22927<li><strong>Author</strong>: Person-93<li><strong>Status</strong>: MERGED<li><strong>Labels</strong>: D-Trivial, A-Build-System<li><strong>Created</strong>: 2026-02-12T11:45:09Z<li><strong>Merged</strong>: 2026-02-12T13:40:51Z<li><strong>Merged By</strong>: mockersf</ul><h2 id=description-translation>Description Translation</h2><p><strong>Objective</strong><p>There is an issue with miri<p><strong>Solution</strong><p>Pin miri to <code>2026-02-11</code> as suggested by @mockersf in discord<h2 id=the-story-of-this-pull-request>The Story of This Pull Request</h2><p>This PR addresses a CI stability issue by pinning the Rust nightly toolchain to a specific date across all GitHub Actions workflows in the Bevy project. The problem emerged when the miri interpreter, which runs on nightly Rust, encountered issues with the latest nightly build. This is a common scenario in projects that depend on nightly toolchains—unstable features or regressions in new nightly releases can break CI pipelines unpredictably.<p>The solution follows a standard practice in Rust projects that use nightly features: when CI breaks due to a nightly toolchain issue, you pin to a known-working version until the issue is resolved upstream. The developer @mockersf identified the specific nightly version (<code>2026-02-11</code>) that worked correctly with miri and suggested this fix via Discord discussion.<p>The implementation is straightforward but systematic—the <code>NIGHTLY_TOOLCHAIN</code> environment variable was updated in four separate workflow files to ensure consistency across all CI jobs. This variable controls which Rust toolchain version is installed and used for jobs requiring nightly Rust. By changing it from the generic <code>nightly</code> (which always fetches the latest version) to <code>nightly-2026-02-11</code>, the CI system now uses a fixed, known-good version.<p>This approach provides immediate stability while the upstream issue with miri is investigated. It’s a pragmatic solution that balances two competing needs: using nightly features for tools like miri while maintaining CI reliability. The existing codebase already included a comment indicating this variable should be modified if nightly breaks CI, showing this was an anticipated use case.<p>The changes affect multiple aspects of the CI pipeline: main CI builds, documentation generation, cache updates, and validation jobs. Each workflow uses the same environment variable pattern, demonstrating good DRY principles in the CI configuration. The fix ensures that all CI components remain synchronized on the same toolchain version, preventing subtle inconsistencies that could arise if different workflows used different nightly versions.<p>From an engineering perspective, this PR demonstrates effective CI maintenance practices. The solution is minimal, targeted, and follows established patterns within the project. It temporarily trades automatic updates for stability, which is the correct trade-off when CI is broken. Once the upstream issue is resolved, the team can revert to using the generic <code>nightly</code> or update to a newer stable nightly version.<h2 id=visual-representation>Visual Representation</h2><pre class=language-mermaid data-lang=mermaid style=color:#61676c;background-color:#fafafa><code class=language-mermaid data-lang=mermaid><span>graph TD
</span><span>    A[GitHub Actions Workflow] --> B{Which Toolchain?}
</span><span>    B -->|Before| C[Latest Nightly]
</span><span>    B -->|After| D[nightly-2026-02-11]
</span><span>    C --> E[CI Break: Miri Issues]
</span><span>    D --> F[CI Stability Restored]
</span><span>    
</span><span>    subgraph "Affected Workflows"
</span><span>        G[ci.yml]
</span><span>        H[docs.yml]
</span><span>        I[update-caches.yml]
</span><span>        J[validation-jobs.yml]
</span><span>    end
</span><span>    
</span><span>    F --> G
</span><span>    F --> H
</span><span>    F --> I
</span><span>    F --> J
</span></code></pre><h2 id=key-files-changed>Key Files Changed</h2><ol><li><p><strong><code>.github/workflows/ci.yml</code></strong> (+1/-1)</p> <ul><li><strong>Change</strong>: Updated <code>NIGHTLY_TOOLCHAIN</code> environment variable from <code>nightly</code> to <code>"nightly-2026-02-11"</code><li><strong>Why</strong>: The main CI workflow uses nightly Rust for miri and other nightly-only features<li><strong>Code</strong>:<pre class=language-yaml data-lang=yaml style=color:#61676c;background-color:#fafafa><code class=language-yaml data-lang=yaml><span style=color:#abb0b6;font-style:italic># Before:
</span><span style=color:#399ee6>NIGHTLY_TOOLCHAIN</span><span style=color:#61676ccc>: </span><span style=color:#86b300>nightly
</span><span>
</span><span style=color:#abb0b6;font-style:italic># After:
</span><span style=color:#399ee6>NIGHTLY_TOOLCHAIN</span><span style=color:#61676ccc>: </span><span style=color:#86b300>"nightly-2026-02-11"
</span></code></pre></ul><li><p><strong><code>.github/workflows/docs.yml</code></strong> (+1/-1)</p> <ul><li><strong>Change</strong>: Same environment variable update<li><strong>Why</strong>: Documentation generation may use nightly features or tools<li><strong>Code</strong>:<pre class=language-yaml data-lang=yaml style=color:#61676c;background-color:#fafafa><code class=language-yaml data-lang=yaml><span style=color:#abb0b6;font-style:italic># Before:
</span><span style=color:#399ee6>NIGHTLY_TOOLCHAIN</span><span style=color:#61676ccc>: </span><span style=color:#86b300>nightly
</span><span>
</span><span style=color:#abb0b6;font-style:italic># After:
</span><span style=color:#399ee6>NIGHTLY_TOOLCHAIN</span><span style=color:#61676ccc>: </span><span style=color:#86b300>"nightly-2026-02-11"
</span></code></pre></ul><li><p><strong><code>.github/workflows/update-caches.yml</code></strong> (+1/-1)</p> <ul><li><strong>Change</strong>: Same environment variable update<li><strong>Why</strong>: Cache update jobs need consistency with other workflows<li><strong>Code</strong>:<pre class=language-yaml data-lang=yaml style=color:#61676c;background-color:#fafafa><code class=language-yaml data-lang=yaml><span style=color:#abb0b6;font-style:italic># Before:
</span><span style=color:#399ee6>NIGHTLY_TOOLCHAIN</span><span style=color:#61676ccc>: </span><span style=color:#86b300>nightly
</span><span>
</span><span style=color:#abb0b6;font-style:italic># After:
</span><span style=color:#399ee6>NIGHTLY_TOOLCHAIN</span><span style=color:#61676ccc>: </span><span style=color:#86b300>"nightly-2026-02-11"
</span></code></pre></ul><li><p><strong><code>.github/workflows/validation-jobs.yml</code></strong> (+1/-1)</p> <ul><li><strong>Change</strong>: Same environment variable update<li><strong>Why</strong>: Validation jobs (like iOS builds) use nightly toolchain<li><strong>Code</strong>:<pre class=language-yaml data-lang=yaml style=color:#61676c;background-color:#fafafa><code class=language-yaml data-lang=yaml><span style=color:#abb0b6;font-style:italic># Before:
</span><span style=color:#399ee6>NIGHTLY_TOOLCHAIN</span><span style=color:#61676ccc>: </span><span style=color:#86b300>nightly
</span><span>
</span><span style=color:#abb0b6;font-style:italic># After:
</span><span style=color:#399ee6>NIGHTLY_TOOLCHAIN</span><span style=color:#61676ccc>: </span><span style=color:#86b300>"nightly-2026-02-11"
</span></code></pre></ul></ol><p>All changes follow the same pattern and serve the same purpose: ensuring consistent toolchain usage across the entire CI pipeline to resolve miri-related issues.<h2 id=further-reading>Further Reading</h2><ol><li><strong>Rustup Toolchain Management</strong>: https://rust-lang.github.io/rustup/concepts/toolchains.html<li><strong>GitHub Actions Environment Variables</strong>: https://docs.github.com/en/actions/learn-github-actions/environment-variables<li><strong>Miri - Rust MIR Interpreter</strong>: https://github.com/rust-lang/miri<li><strong>Rust Nightly vs Stable</strong>: https://doc.rust-lang.org/book/appendix-07-nightly-rust.html<li><strong>CI/CD Best Practices for Rust Projects</strong>: https://www.shuttle.rs/blog/2023/08/23/ci-cd-for-rust-projects</ol><h1 id=full-code-diff>Full Code Diff</h1><p>diff –git a/.github/workflows/ci.yml b/.github/workflows/ci.yml index 9ae460d5128f7..2a08b4d1ceea7 100644 — a/.github/workflows/ci.yml +++ b/.github/workflows/ci.yml @@ -17,7 +17,7 @@ env: CARGO_PROFILE_TEST_DEBUG: 0 CARGO_PROFILE_DEV_DEBUG: 0<h1 id=if-nightly-is-breaking-ci-modify-this-variable-to-target-a-specific-nightly-version>If nightly is breaking CI, modify this variable to target a specific nightly version.</h1><ul><li>NIGHTLY_TOOLCHAIN: nightly</ul><ul><li>NIGHTLY_TOOLCHAIN: “nightly-2026-02-11” RUSTFLAGS: “-D warnings”</ul><p>concurrency: diff –git a/.github/workflows/docs.yml b/.github/workflows/docs.yml index 6bf97af9f6fea..1aab6d328e476 100644 — a/.github/workflows/docs.yml +++ b/.github/workflows/docs.yml @@ -11,7 +11,7 @@ env: CARGO_TERM_COLOR: always RUSTDOCFLAGS: –html-in-header header.html<h1 id=if-nightly-is-breaking-ci-modify-this-variable-to-target-a-specific-nightly-version-1>If nightly is breaking CI, modify this variable to target a specific nightly version.</h1><ul><li>NIGHTLY_TOOLCHAIN: nightly</ul><ul><li>NIGHTLY_TOOLCHAIN: “nightly-2026-02-11”</ul><h1 id=sets-the-permissions-to-allow-deploying-to-github-pages>Sets the permissions to allow deploying to Github pages.</h1><p>permissions: diff –git a/.github/workflows/update-caches.yml b/.github/workflows/update-caches.yml index db265e6af4b76..6647b1906604c 100644 — a/.github/workflows/update-caches.yml +++ b/.github/workflows/update-caches.yml @@ -20,7 +20,7 @@ env: CARGO_PROFILE_TEST_DEBUG: 0 CARGO_PROFILE_DEV_DEBUG: 0<h1 id=if-nightly-is-breaking-ci-modify-this-variable-to-target-a-specific-nightly-version-2>If nightly is breaking CI, modify this variable to target a specific nightly version.</h1><ul><li>NIGHTLY_TOOLCHAIN: nightly</ul><ul><li>NIGHTLY_TOOLCHAIN: “nightly-2026-02-11”</ul><p>jobs: env: diff –git a/.github/workflows/validation-jobs.yml b/.github/workflows/validation-jobs.yml index a3e365ba60a83..fbe8eb3f531a4 100644 — a/.github/workflows/validation-jobs.yml +++ b/.github/workflows/validation-jobs.yml @@ -21,7 +21,7 @@ env: CARGO_PROFILE_TEST_DEBUG: 0 CARGO_PROFILE_DEV_DEBUG: 0<h1 id=if-nightly-is-breaking-ci-modify-this-variable-to-target-a-specific-nightly-version-3>If nightly is breaking CI, modify this variable to target a specific nightly version.</h1><ul><li>NIGHTLY_TOOLCHAIN: nightly</ul><ul><li>NIGHTLY_TOOLCHAIN: “nightly-2026-02-11”</ul><p>jobs: build-and-install-on-iOS:</div><div data-is-md-page=true data-patch-exists=true data-patch-path=/pull_request/bevy/2026-02/pr_22927.patch id=patch-info style=display:none></div><div class=bottom-spacer></div></div></div>