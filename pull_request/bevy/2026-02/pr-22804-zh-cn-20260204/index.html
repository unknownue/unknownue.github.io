<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://unknownue.github.io name=base><title>
         #22804 document bevy light
        
    </title><meta content="#22804 document bevy light" property=og:title><meta content="A personal blog built with Zola and Apollo theme" property=og:description><meta content="A personal blog built with Zola and Apollo theme" name=description><link href=/icons/favicon.png rel=icon type=image/png><link href=https://unknownue.github.io/fonts.css rel=stylesheet><script src=https://unknownue.github.io/js/codeblock.js></script><script src=https://unknownue.github.io/js/toc.js></script><script src=https://unknownue.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Unknownue's Blog" href=https://unknownue.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://unknownue.github.io/theme/light.css rel=stylesheet><link href=https://unknownue.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://unknownue.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://unknownue.github.io/main.css media=screen rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js></script><script>// Initialize mermaid once DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            mermaid.initialize({
                startOnLoad: false,
                theme: document.body && document.body.classList.contains('dark') ? 'dark' : 'default',
                securityLevel: 'loose',
                flowchart: {
                    useMaxWidth: true,
                    htmlLabels: true
                },
                sequence: {
                    diagramMarginX: 50,
                    diagramMarginY: 10,
                    actorMargin: 50,
                    width: 150,
                    height: 65
                }
            });
        });</script><script src=https://unknownue.github.io/js/main.js></script><script defer src=https://unknownue.github.io/js/label-colors.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/rust.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/typescript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/go.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/cpp.min.js></script><script>// Ensure highlight.js is properly configured
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof hljs !== 'undefined') {
                hljs.configure({
                    languages: ['rust', 'javascript', 'python', 'cpp', 'go', 'typescript'],
                    ignoreUnescapedHTML: true
                });
                console.log('Highlight.js configured in header');
            }
        });</script><link href=https://cdn.jsdelivr.net/npm/diff2html/bundles/css/diff2html.min.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/diff2html/bundles/js/diff2html-ui.min.js></script><script src=https://unknownue.github.io/js/syntax-highlight.js></script><script src=https://unknownue.github.io/js/diff-sidebar.js></script><script src="https://unknownue.github.io/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><div class=content><header><div class=main><a href=https://unknownue.github.io>Unknownue's Blog</a><div class=socials><a class=social href=https://github.com/unknownue rel=me> <img alt=github src=https://unknownue.github.io/icons/social/github.svg> </a><a class=social href=https://github.com/unknownue/unknownue.github.io rel=me> <img alt=github-io src=https://unknownue.github.io/icons/social/rss.svg> </a></div></div><nav><a href=https://unknownue.github.io/posts style=margin-left:.25em>/posts</a><a href=https://unknownue.github.io/projects style=margin-left:.25em>/projects</a><a href=https://unknownue.github.io/about style=margin-left:.25em>/about</a><a href=https://unknownue.github.io/tags style=margin-left:.25em>/tags</a><button title="$SHORTCUT to open search" class=search-button id=search-button><img alt=Search class=search-icon src=https://unknownue.github.io/icons/search.svg></button><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><div id=modal-content><h1 class=page-header id=modalTitle>Search</h1><div id=searchBar><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search... role=combobox spellcheck=false><button title="Clear search" class=clear-button id=clear-search><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></button></div><div id=results-container><div id=results-info><span id=zero_results style=display:none>No results</span><span id=one_result style=display:none>1 result</span><span id=many_results style=display:none>$NUMBER results</span></div><div id=results role=listbox></div></div></div></div><a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://unknownue.github.io/icons/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://unknownue.github.io/icons/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><div class=pull-request-page><article class=md-content-page style=display:none></article><div class=back-link><a href=/pull_request/bevy/2026-02/>← Back to Pull Requests</a></div><div class=pr-metadata><span class=pr-date>2026-02-04</span><div class=language-switcher><a class=lang-link data-lang=en href=/pull_request/bevy/2026-02/pr-22804-en-20260204>English</a> / <span class="lang-link active" data-lang=zh-cn>中文</span></div></div><div class=pr-content><h1 id=title>Title</h1><h2 id=document-bevy-light>document bevy light</h2><h2 id=basic-information>Basic Information</h2><ul><li><strong>标题</strong>: document bevy light<li><strong>PR链接</strong>: https://github.com/bevyengine/bevy/pull/22804<li><strong>作者</strong>: atlv24<li><strong>状态</strong>: 已合并<li><strong>标签</strong>: C-Docs, A-Rendering, S-Ready-For-Final-Review, D-Straightforward<li><strong>创建时间</strong>: 2026-02-04T09:00:10Z<li><strong>合并时间</strong>: 2026-02-04T20:15:40Z<li><strong>合并者</strong>: alice-i-cecile</ul><h2 id=description-translation>Description Translation</h2><h3 id=objective-mu-biao>Objective (目标)</h3><ul><li>移除另一个渲染模块中的 <code>#![expect(missing_docs, reason = "Not all docs are written yet, see #3492.")]</code> 宏。<li>清理一些过时的代码。</ul><h3 id=solution-jie-jue-fang-an>Solution (解决方案)</h3><ul><li>添加文档。</ul><h3 id=testing-ce-shi>Testing (测试)</h3><ul><li>运行了 lighting, deferred, shadow_biases 和其他几个示例。看起来正常。<li>注意：请按提交逐一审阅。</ul><h2 id=the-story-of-this-pull-request>The Story of This Pull Request</h2><p>这个PR的核心目标是提升 <code>bevy_light</code> 模块的文档完整性，同时清理一部分不再必要的系统逻辑。它是一个典型的代码维护和质量改进任务。<h3 id=wen-ti-de-he-xin-que-shi-de-wen-dang-he-rong-yu-de-xi-tong>问题的核心：缺失的文档和冗余的系统</h3><p>在Bevy项目中，Issue #3492 旨在追踪并补齐缺失的文档。<code>bevy_light</code> 模块作为一个相对独立的核心渲染组件，许多公共接口、方法和常量都缺乏说明，这对于新开发者理解和使用光照系统构成了障碍。模块开头的 <code>#![expect(missing_docs, ...)]</code> 宏就是一个明确的标记，表示这里存在已知的文档缺失问题。<p>同时，在代码审查中，开发者发现了一些可以优化的逻辑。具体来说，一个用于清除级联阴影（cascade shadows）数据的独立系统 <code>clear_directional_light_cascades</code> 显得有些冗余，因为它所做的事情完全可以合并到负责构建级联数据的后续系统中。这不仅增加了系统的复杂性，也可能在系统调度顺序上引入不必要的隐患。<h3 id=jie-jue-fang-an-quan-mian-de-wen-dang-hua-he-luo-ji-jian-hua>解决方案：全面的文档化和逻辑简化</h3><p>开发者采取了直接且实用的方法：<ol><li><strong>添加文档</strong>：对模块、结构体、枚举、字段、方法以及常量添加了详细的文档注释（doc comments）。<li><strong>重构系统</strong>：移除独立的清除系统，将其功能内联到构建系统 <code>build_directional_light_cascades</code> 的开头，并相应地调整了系统集合（SystemSet）的配置。</ol><h4 id=shi-shi-xi-jie-cong-mo-kuai-ceng-mian-dao-ju-ti-fang-fa>实施细节：从模块层面到具体方法</h4><p>文档化工作是从顶层开始的。例如，为 <code>lib.rs</code> 添加了模块概览：<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>//! Provides component types for lighting a bevy scene. This includes the usual
</span><span style=color:#abb0b6;font-style:italic>//! directional, point, and spot lights, as well as light probes, atmosphere,
</span><span style=color:#abb0b6;font-style:italic>//! other volumetrics, and shadow configuration.
</span></code></pre><p>这为整个 <code>bevy_light</code> crate 的功能定下了清晰的基调。<p>对于关键的结构体，如 <code>DirectionalLight</code>，文档不仅解释了其用途，还补充了单位（勒克斯，lux）的说明、默认值来源以及启用阴影的方法：<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>/// Some of these are provided as constants in [`light_consts::lux`].
</span><span style=color:#abb0b6;font-style:italic>/// ...
</span><span style=color:#abb0b6;font-style:italic>/// The default is [`light_consts::lux::AMBIENT_DAYLIGHT`] = 10,000.
</span><span style=color:#fa6e32>pub</span><span> illuminance</span><span style=color:#61676ccc>: </span><span style=color:#fa6e32>f32</span><span style=color:#61676ccc>,
</span></code></pre><p>在 <code>cluster</code> 模块中，文档解释了其根本目的——“空间聚类（spatial clustering）以加速渲染性能”，并澄清了 <code>ClusterConfig</code> 等配置项的用途，特别是它们与渲染后端能力的关系。<h4 id=zhong-gou-ji-lian-yin-ying-geng-xin-luo-ji>重构级联阴影更新逻辑</h4><p>重构的核心在于简化。原本的流程是：<ol><li><code>clear_directional_light_cascades</code> 系统：遍历所有启用了阴影的 <code>DirectionalLight</code>，清空其关联的 <code>Cascades</code> 组件中的 <code>cascades</code> 哈希映射。<li><code>build_directional_light_cascades</code> 系统：为每个光源和视图（view）重新计算并填充级联数据。</ol><p>开发者发现，清空操作完全可以作为重建操作的第一步，从而消除一个独立的系统。修改后的 <code>build_directional_light_cascades</code> 系统在开始处理每个光源时，会首先调用 <code>cascades.cascades.clear()</code>。<p><strong>技术见解</strong>：<ul><li><strong>正交矩阵的逆</strong>：在计算光源的变换矩阵时，文档特别强调了为了阴影的数值（视觉）稳定性，需要确保矩阵的正交性。代码通过直接使用旋转部分构建矩阵，并利用正交矩阵的特性（其转置即为逆矩阵），避免了直接求逆可能引入的精度问题。修改将变量名从 <code>light_to_world_inverse</code> 改为更具描述性的 <code>light_from_world</code>，使意图更清晰。<li><strong>系统顺序保障</strong>：移除 <code>clear_directional_light_cascades</code> 后，也移除了对应的 <code>SimulationLightSystems::AddClusters</code> 系统集。这简化了在 <code>PostUpdate</code> 阶段中光照相关系统的调度图，减少了潜在的歧义（ambiguities）。</ul><h4 id=xiu-fu-ji-qun-fen-pei-zhong-de-qian-zai-wen-ti>修复集群分配中的潜在问题</h4><p>在 <code>assign.rs</code> 中，<code>assign_objects_to_clusters</code> 系统的查询参数从 <code>&ClusterConfig</code> 改为 <code>Option<&ClusterConfig></code>，并在内部使用 <code>.copied().unwrap_or_default()</code> 来获取配置。这更准确地反映了现实情况——摄像机（Camera）可能没有 <code>ClusterConfig</code> 组件，此时应使用默认配置。<h3 id=ying-xiang-yu-zong-jie>影响与总结</h3><p>这次修改带来了以下具体改进：<ol><li><strong>可维护性提升</strong>：详尽的文档降低了新贡献者参与光照相关开发的门槛，也方便了现有开发者的代码审查。<li><strong>代码简化</strong>：移除一个系统和一个系统集，使光照更新的逻辑流更加紧凑和直接。<li><strong>正确性增强</strong>：将 <code>ClusterConfig</code> 的处理改为 <code>Option</code> 类型，修复了当摄像机未配置该组件时可能存在的逻辑漏洞。<li><strong>技术债务减少</strong>：消除了一处 <code>expect(missing_docs)</code> 警告，向完全解决 #3492 迈进了一步。</ol><p>这是一个典型的“磨刀不误砍柴工”式的PR。它没有引入新功能，但通过完善文档和优化现有结构，为未来光照系统的功能扩展和问题排查奠定了更坚实的基础。它展示了在复杂游戏引擎项目中，持续性的代码卫生（code hygiene）工作对于长期健康至关重要。<h2 id=visual-representation>Visual Representation</h2><pre class=language-mermaid data-lang=mermaid style=color:#61676c;background-color:#fafafa><code class=language-mermaid data-lang=mermaid><span>graph TD
</span><span>    subgraph “PostUpdate 阶段 (简化)”
</span><span>        A[CameraUpdateSystems] --> B[AssignLightsToClusters]
</span><span>        B --> C[UpdateDirectionalLightCascades]
</span><span>        C --> D[UpdateLightFrusta]
</span><span>    end
</span><span>
</span><span>    subgraph “关键变更点”
</span><span>        B -.-> E[assign_objects_to_clusters&LTbr/>修复 Option&LTClusterConfig> 处理]
</span><span>        C -.-> F[build_directional_light_cascades&LTbr/>集成清理逻辑]
</span><span>        G[被移除: clear_directional_light_cascades]
</span><span>        H[被移除: AddClusters 系统集]
</span><span>    end
</span><span>
</span><span>    style E fill:#ccffcc
</span><span>    style F fill:#ccffcc
</span><span>    style G fill:#ffcccc
</span><span>    style H fill:#ffcccc
</span></code></pre><h2 id=key-files-changed>Key Files Changed</h2><h3 id=crates-bevy-light-src-lib-rs-26-25><code>crates/bevy_light/src/lib.rs</code> (+26/-25)</h3><p>这是本次修改的“指挥部”。主要变化包括：<ol><li><strong>移除缺失文档的期望宏</strong>：删除了顶部的 <code>#![expect(missing_docs, ...)]</code>，标志着该模块的文档已基本完善。<li><strong>添加模块级文档</strong>：清晰地说明了 <code>bevy_light</code> 模块的职责。<li><strong>重构插件系统集</strong>： <ul><li>移除了 <code>SimulationLightSystems::AddClusters</code> 系统集。<li>移除了对 <code>add_clusters</code> 系统的调用。<li>移除了独立的 <code>clear_directional_light_cascades</code> 系统，并将其功能合并到 <code>build_directional_light_cascades</code> 的执行顺序中。<li>使用 <code>register_required_components::&LTCamera3d, Clusters>()</code> 确保 <code>Clusters</code> 组件会被自动添加到 <code>Camera3d</code> 实体上，替代了之前手动添加的系统。</ul></ol><p><strong>代码示例 - 系统集变化</strong>:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// 之前:
</span><span>SimulationLightSystems</span><span style=color:#ed9366>::</span><span>AddClusters</span><span style=color:#61676ccc>,
</span><span>SimulationLightSystems</span><span style=color:#ed9366>::</span><span>AssignLightsToClusters</span><span style=color:#61676ccc>,
</span><span>
</span><span>clear_directional_light_cascades
</span><span>    </span><span style=color:#ed9366>.</span><span style=color:#f07171>in_set</span><span>(SimulationLightSystems</span><span style=color:#ed9366>::</span><span>UpdateDirectionalLightCascades)
</span><span>    </span><span style=color:#ed9366>.</span><span style=color:#f07171>after</span><span>(TransformSystems</span><span style=color:#ed9366>::</span><span>Propagate)
</span><span>    </span><span style=color:#ed9366>.</span><span style=color:#f07171>after</span><span>(CameraUpdateSystems)</span><span style=color:#61676ccc>,
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// 之后:
</span><span style=color:#abb0b6;font-style:italic>// AddClusters 系统集和相关系统被移除
</span><span style=color:#abb0b6;font-style:italic>// clear_directional_light_cascades 系统被移除
</span><span>
</span><span>build_directional_light_cascades
</span><span>    </span><span style=color:#ed9366>.</span><span style=color:#f07171>in_set</span><span>(SimulationLightSystems</span><span style=color:#ed9366>::</span><span>UpdateDirectionalLightCascades)
</span><span>    </span><span style=color:#ed9366>.</span><span style=color:#f07171>after</span><span>(TransformSystems</span><span style=color:#ed9366>::</span><span>Propagate)
</span><span>    </span><span style=color:#ed9366>.</span><span style=color:#f07171>after</span><span>(CameraUpdateSystems)</span><span style=color:#61676ccc>, </span><span style=color:#abb0b6;font-style:italic>// 现在直接在这里之后运行
</span></code></pre><h3 id=crates-bevy-light-src-cluster-mod-rs-16-30><code>crates/bevy_light/src/cluster/mod.rs</code> (+16/-30)</h3><p>这是集群模块的入口文件，修改侧重于澄清概念和移除过时代码。<ol><li><strong>模块文档</strong>：从简单的“对象（目前仅是点光源和聚光灯）的空间聚类”更新为更准确的“空间聚类以加速渲染性能”。<li><strong>移除 <code>add_clusters</code> 函数</strong>：随着 <code>lib.rs</code> 中的重构，这个用于向摄像机添加 <code>Clusters</code> 组件的系统函数不再需要。<li><strong>增强结构体和枚举的文档</strong>：为 <code>GlobalClusterSettings</code>, <code>ClusterConfig</code> 及其变体字段，<code>Clusters</code> 结构体的字段添加了说明，使其配置项的意义更明确。</ol><h3 id=crates-bevy-light-src-cascade-rs-16-14><code>crates/bevy_light/src/cascade.rs</code> (+16/-14)</h3><p>级联阴影配置和构建的核心模块。<ol><li><strong>模块文档</strong>：添加了简要说明。<li><strong>移除 <code>clear_directional_light_cascades</code> 函数</strong>：其功能已内联到 <code>build_directional_light_cascades</code> 中。<li><strong>增强结构体文档</strong>：为 <code>Cascades</code> 和 <code>Cascade</code> 添加了注释，解释了它们的作用和关系。<li><strong>代码清晰化</strong>：在 <code>build_directional_light_cascades</code> 函数内，将变量名 <code>light_to_world_inverse</code> 改为 <code>light_from_world</code>，并更新了注释以强调正交矩阵性质，使变换方向更易理解。</ol><p><strong>代码示例 - 关键重构</strong>:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// 在 build_directional_light_cascades 系统内部，针对每个光源：
</span><span style=color:#fa6e32>if </span><span style=color:#ed9366>!</span><span>directional_light</span><span style=color:#ed9366>.</span><span>shadow_maps_enabled {
</span><span>    </span><span style=color:#fa6e32>continue</span><span style=color:#61676ccc>;
</span><span>}
</span><span>cascades</span><span style=color:#ed9366>.</span><span>cascades</span><span style=color:#ed9366>.</span><span style=color:#f07171>clear</span><span>()</span><span style=color:#61676ccc>; </span><span style=color:#abb0b6;font-style:italic>// 清空操作移到了这里
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// ... 之后是计算 world_from_light 和 light_from_world
</span><span style=color:#fa6e32>let</span><span> world_from_light </span><span style=color:#ed9366>= </span><span>Mat4</span><span style=color:#ed9366>::</span><span>from_quat(transform</span><span style=color:#ed9366>.</span><span style=color:#f07171>rotation</span><span>())</span><span style=color:#61676ccc>;
</span><span style=color:#fa6e32>let</span><span> light_from_world </span><span style=color:#ed9366>=</span><span> world_from_light</span><span style=color:#ed9366>.</span><span style=color:#f07171>transpose</span><span>()</span><span style=color:#61676ccc>; </span><span style=color:#abb0b6;font-style:italic>// 更清晰的命名
</span><span>
</span><span style=color:#fa6e32>for </span><span>(view_entity</span><span style=color:#61676ccc>,</span><span> projection</span><span style=color:#61676ccc>,</span><span> world_from_view) </span><span style=color:#ed9366>in</span><span> views</span><span style=color:#ed9366>.</span><span style=color:#f07171>iter</span><span>()</span><span style=color:#ed9366>.</span><span style=color:#f07171>copied</span><span>() {
</span><span>    </span><span style=color:#fa6e32>let</span><span> light_view_from_camera </span><span style=color:#ed9366>=</span><span> light_from_world </span><span style=color:#ed9366>*</span><span> world_from_view</span><span style=color:#61676ccc>; </span><span style=color:#abb0b6;font-style:italic>// 更新了变量名以匹配
</span><span>    </span><span style=color:#abb0b6;font-style:italic>// ...
</span><span>}
</span></code></pre><h3 id=crates-bevy-light-src-atmosphere-rs-10-5><code>crates/bevy_light/src/atmosphere.rs</code> (+10/-5)</h3><p>大气散射模块。<ol><li><strong>模块文档</strong>：添加了说明。<li><strong>方法文档</strong>：为 <code>earthlike</code>, <code>new</code>, <code>with_label</code>, <code>with_density_multiplier</code>, <code>sample</code> 等方法添加了文档。<li><strong>常量引用修复</strong>：将 <code>//</code> 开头的注释改为更正式的 <code>///</code> 文档注释。</ol><h3 id=crates-bevy-pbr-src-lib-rs-2-13><code>crates/bevy_pbr/src/lib.rs</code> (+2/-13)</h3><p>主要的PBR渲染插件。由于 <code>bevy_light</code> 中移除了 <code>SimulationLightSystems::AddClusters</code> 系统集，这里相应地移除了对它的配置。<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// 之前:
</span><span style=color:#ed9366>.</span><span style=color:#f07171>configure_sets</span><span>(
</span><span>    PostUpdate</span><span style=color:#61676ccc>,
</span><span>    (
</span><span>        SimulationLightSystems</span><span style=color:#ed9366>::</span><span>AddClusters</span><span style=color:#61676ccc>,
</span><span>        SimulationLightSystems</span><span style=color:#ed9366>::</span><span>AssignLightsToClusters</span><span style=color:#61676ccc>,
</span><span>    )
</span><span>        </span><span style=color:#ed9366>.</span><span style=color:#f07171>chain</span><span>()</span><span style=color:#61676ccc>,
</span><span>)</span><span style=color:#61676ccc>;
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// 之后:
</span><span style=color:#abb0b6;font-style:italic>// 上述整个 configure_sets 调用被移除。AssignLightsToClusters 的顺序现在由 `bevy_light` 的 `LightPlugin` 单独管理。
</span></code></pre><h2 id=further-reading>Further Reading</h2><ol><li><strong>Bevy 官方文档</strong>：关于 <a rel="noopener nofollow noreferrer" href=https://docs.rs/bevy_ecs/latest/bevy_ecs/system/index.html target=_blank>ECS 系统</a> 和 <a rel="noopener nofollow noreferrer" href=https://docs.rs/bevy_ecs/latest/bevy_ecs/component/index.html target=_blank>组件</a> 的详细说明。<li><strong>Rust 文档注释指南</strong>：<a rel="noopener nofollow noreferrer" href=https://rust-lang.github.io/rfcs/1574-more-api-documentation-conventions.html target=_blank>Rust RFC 1574</a> 中关于如何编写高效文档的约定。<li><strong>级联阴影贴图（Cascaded Shadow Maps, CSM）</strong>：可阅读 <a rel="noopener nofollow noreferrer" href=https://developer.nvidia.com/gpugems/gpugems3/part-ii-light-and-shadows/chapter-10-parallel-split-shadow-maps-pssms target=_blank>NVIDIA 的 GPU Gems 文章</a> 了解其基本原理，这是解决大场景中方向光阴影质量问题的常用技术。<li><strong>聚类前向渲染（Clustered Forward Rendering）</strong>：原始论文 <a rel="noopener nofollow noreferrer" href=http://www.cse.chalmers.se/~uffe/clustered_shading_preprint.pdf target=_blank>“Clustered Deferred and Forward Shading”</a> 详细介绍了该技术的动机和实现。</ol></div><div data-is-md-page=true data-patch-exists=true data-patch-path=/pull_request/bevy/2026-02/pr_22804.patch id=patch-info style=display:none></div><div class=bottom-spacer></div></div></div>