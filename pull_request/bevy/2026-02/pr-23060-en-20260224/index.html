<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://unknownue.github.io name=base><title>
         #23060 Add motion blur option to various stress tests
        
    </title><meta content="#23060 Add motion blur option to various stress tests" property=og:title><meta content="A personal blog built with Zola and Apollo theme" property=og:description><meta content="A personal blog built with Zola and Apollo theme" name=description><link href=/icons/favicon.png rel=icon type=image/png><link href=https://unknownue.github.io/fonts.css rel=stylesheet><script src=https://unknownue.github.io/js/codeblock.js></script><script src=https://unknownue.github.io/js/toc.js></script><script src=https://unknownue.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Unknownue's Blog" href=https://unknownue.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://unknownue.github.io/theme/light.css rel=stylesheet><link href=https://unknownue.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://unknownue.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://unknownue.github.io/main.css media=screen rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js></script><script>// Initialize mermaid once DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            mermaid.initialize({
                startOnLoad: false,
                theme: document.body && document.body.classList.contains('dark') ? 'dark' : 'default',
                securityLevel: 'loose',
                flowchart: {
                    useMaxWidth: true,
                    htmlLabels: true
                },
                sequence: {
                    diagramMarginX: 50,
                    diagramMarginY: 10,
                    actorMargin: 50,
                    width: 150,
                    height: 65
                }
            });
        });</script><script src=https://unknownue.github.io/js/main.js></script><script defer src=https://unknownue.github.io/js/label-colors.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/rust.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/typescript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/go.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/cpp.min.js></script><script>// Ensure highlight.js is properly configured
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof hljs !== 'undefined') {
                hljs.configure({
                    languages: ['rust', 'javascript', 'python', 'cpp', 'go', 'typescript'],
                    ignoreUnescapedHTML: true
                });
                console.log('Highlight.js configured in header');
            }
        });</script><link href=https://cdn.jsdelivr.net/npm/diff2html/bundles/css/diff2html.min.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/diff2html/bundles/js/diff2html-ui.min.js></script><script src=https://unknownue.github.io/js/syntax-highlight.js></script><script src=https://unknownue.github.io/js/diff-sidebar.js></script><script src="https://unknownue.github.io/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><div class=content><header><div class=main><a href=https://unknownue.github.io>Unknownue's Blog</a><div class=socials><a class=social href=https://github.com/unknownue rel=me> <img alt=github src=https://unknownue.github.io/icons/social/github.svg> </a><a class=social href=https://github.com/unknownue/unknownue.github.io rel=me> <img alt=github-io src=https://unknownue.github.io/icons/social/rss.svg> </a></div></div><nav><a href=https://unknownue.github.io/posts style=margin-left:.25em>/posts</a><a href=https://unknownue.github.io/projects style=margin-left:.25em>/projects</a><a href=https://unknownue.github.io/about style=margin-left:.25em>/about</a><a href=https://unknownue.github.io/tags style=margin-left:.25em>/tags</a><button title="$SHORTCUT to open search" class=search-button id=search-button><img alt=Search class=search-icon src=https://unknownue.github.io/icons/search.svg></button><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><div id=modal-content><h1 class=page-header id=modalTitle>Search</h1><div id=searchBar><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search... role=combobox spellcheck=false><button title="Clear search" class=clear-button id=clear-search><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></button></div><div id=results-container><div id=results-info><span id=zero_results style=display:none>No results</span><span id=one_result style=display:none>1 result</span><span id=many_results style=display:none>$NUMBER results</span></div><div id=results role=listbox></div></div></div></div><a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://unknownue.github.io/icons/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://unknownue.github.io/icons/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><div class=pull-request-page><article class=md-content-page style=display:none></article><div class=back-link><a href=/pull_request/bevy/2026-02/>← Back to Pull Requests</a></div><div class=pr-metadata><span class=pr-date>2026-02-24</span><div class=language-switcher><span class="lang-link active" data-lang=en>English</span> / <a class=lang-link data-lang=zh-cn href=/pull_request/bevy/2026-02/pr-23060-zh-cn-20260224>中文</a></div></div><div class=pr-content><h1 id=title>Title</h1><p>Add motion blur option to various stress tests<h2 id=basic-information>Basic Information</h2><ul><li><strong>Title</strong>: Add motion blur option to various stress tests<li><strong>PR Link</strong>: https://github.com/bevyengine/bevy/pull/23060<li><strong>Author</strong>: greeble-dev<li><strong>Status</strong>: MERGED<li><strong>Labels</strong>: A-Rendering, S-Ready-For-Final-Review, C-Benchmarks, D-Straightforward<li><strong>Created</strong>: 2026-02-19T18:22:15Z<li><strong>Merged</strong>: 2026-02-24T19:02:50Z<li><strong>Merged By</strong>: alice-i-cecile</ul><h2 id=description-translation>Description Translation</h2><h2 id=objective>Objective</h2><p>Add a motion blur option to various stress tests. This is useful for benchmarking, but also for bug reproduction - not many examples use motion blur. In particular, I want this to repro a suspected bug with motion blur and morph targets.<h2 id=solution>Solution</h2><p>Add an opt-in <code>--motion-blur</code> argument to <code>many_foxes</code>, <code>many_morph_targets</code> and <code>many_cubes</code>.<p>I’m a bit unhappy about the cut and paste. Maybe there should be some shared utilities for the stress tests.<h2 id=testing>Testing</h2><p>Tested on Native/Win10/Nvidia/Vulkan.<pre class=language-sh data-lang=sh style=color:#61676c;background-color:#fafafa><code class=language-sh data-lang=sh><span style=color:#f29718>cargo</span><span> run</span><span style=color:#ff8f40> --example</span><span> many_foxes</span><span style=color:#ed9366> --</span><span> --motion-blur
</span><span style=color:#f29718>cargo</span><span> run</span><span style=color:#ff8f40> --example</span><span> many_morph_targets</span><span style=color:#ed9366> --</span><span> --motion-blur
</span><span style=color:#f29718>cargo</span><span> run</span><span style=color:#ff8f40> --example</span><span> many_many_cubes</span><span style=color:#ed9366> --</span><span> --motion-blur
</span></code></pre><h2 id=the-story-of-this-pull-request>The Story of This Pull Request</h2><p>The PR addresses a practical issue in the Bevy engine’s test suite: the lack of motion blur examples in stress tests. The developer needed a reliable way to reproduce a suspected bug involving motion blur interacting with morph targets, but discovered that most stress test examples didn’t include motion blur functionality.<p>The problem had two dimensions. First, from a debugging perspective, there was no straightforward way to test motion blur under realistic stress conditions. Second, for benchmarking purposes, there was a gap in being able to measure the performance impact of motion blur in scenes with many moving entities. The existing examples either didn’t support motion blur or weren’t set up to demonstrate it clearly.<p>The solution approach was straightforward: add a command-line flag to three existing stress test examples (<code>many_foxes</code>, <code>many_morph_targets</code>, and <code>many_cubes</code>) that would enable motion blur when specified. The implementation needed to be minimal and non-invasive, adding functionality without changing the default behavior of the examples.<p>The implementation follows a consistent pattern across all three files. Each example’s <code>Args</code> struct gains a new boolean field:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>/// whether to enable motion blur.
</span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>argh</span><span>(switch)]
</span><span>motion_blur</span><span style=color:#61676ccc>: </span><span style=color:#fa6e32>bool</span><span style=color:#61676ccc>,
</span></code></pre><p>In the camera setup logic, a conditional check adds the <code>MotionBlur</code> component when the flag is true:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#fa6e32>if</span><span> args</span><span style=color:#ed9366>.</span><span>motion_blur {
</span><span>    camera</span><span style=color:#ed9366>.</span><span style=color:#f07171>insert</span><span>((
</span><span>        MotionBlur {
</span><span>            </span><span style=color:#abb0b6;font-style:italic>// Use an unrealistically large shutter angle so that motion blur is clearly visible.
</span><span>            shutter_angle</span><span style=color:#61676ccc>: </span><span style=color:#ff8f40>3.0</span><span style=color:#61676ccc>,
</span><span>            </span><span style=color:#ed9366>..</span><span style=color:#55b4d4;font-style:italic>Default</span><span style=color:#ed9366>::</span><span>default()
</span><span>        }</span><span style=color:#61676ccc>,
</span><span>        </span><span style=color:#abb0b6;font-style:italic>// MSAA and MotionBlur are not compatible on WebGL.
</span><span>        </span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>cfg</span><span>(</span><span style=color:#f29718>all</span><span>(
</span><span>            feature </span><span style=color:#ed9366>= </span><span style=color:#86b300>"webgl2"</span><span style=color:#61676ccc>,
</span><span>            target_arch </span><span style=color:#ed9366>= </span><span style=color:#86b300>"wasm32"</span><span style=color:#61676ccc>,
</span><span>            </span><span style=color:#f29718>not</span><span>(feature </span><span style=color:#ed9366>= </span><span style=color:#86b300>"webgpu"</span><span>)
</span><span>        ))]
</span><span>        Msaa</span><span style=color:#ed9366>::</span><span>Off</span><span style=color:#61676ccc>,
</span><span>    ))</span><span style=color:#61676ccc>;
</span><span>}
</span></code></pre><p>This implementation shows attention to platform-specific considerations. The code includes a conditional compilation directive for WebGL platforms where MSAA (Multisample Anti-Aliasing) and motion blur are incompatible. When targeting WebGL2 on wasm32 without webgpu support, it disables MSAA when motion blur is enabled.<p>The <code>shutter_angle</code> is set to 3.0 radians (approximately 172 degrees), which the comment correctly notes is “unrealistically large” but makes the motion blur effect clearly visible for debugging and demonstration purposes. This is a sensible choice for stress tests where the goal is to make effects visible rather than achieve photorealistic results.<p>A technical insight here is the use of Bevy’s component system. The <code>MotionBlur</code> component is part of Bevy’s post-processing pipeline, and adding it to the camera entity automatically enables the motion blur effect without requiring additional setup in the rendering pipeline. This demonstrates Bevy’s data-oriented design where rendering features are often implemented as components that systems can query and process.<p>The developer expressed some dissatisfaction with the cut-and-paste approach, noting that “maybe there should be some shared utilities for the stress tests.” This is a valid observation - the same motion blur setup code appears in three places with only minor variations. In a larger codebase, this duplication could become a maintenance burden, especially if the motion blur API changes or if additional configuration options need to be added. However, for a focused PR adding a specific feature to examples, the duplication is acceptable and keeps each example self-contained.<p>The impact of this PR is practical and immediate. It provides developers with:<ol><li>A way to reproduce motion blur-related bugs in stress scenarios<li>A means to benchmark motion blur performance with many entities<li>Clear examples of how to integrate motion blur into Bevy applications<li>Documentation of the WebGL compatibility constraint with MSAA</ol><p>The changes are backward compatible - existing command-line invocations continue to work without modification, and the new <code>--motion-blur</code> flag is entirely optional.<h2 id=visual-representation>Visual Representation</h2><pre class=language-mermaid data-lang=mermaid style=color:#61676c;background-color:#fafafa><code class=language-mermaid data-lang=mermaid><span>graph TD
</span><span>    A[User runs example with --motion-blur flag] --> B[Args struct parses flag]
</span><span>    B --> C{Camera setup system}
</span><span>    C -->|motion_blur: true| D[Add MotionBlur component to camera]
</span><span>    C -->|motion_blur: false| E[No motion blur component]
</span><span>    D --> F[Motion blur post-processing enabled]
</span><span>    F --> G[Visible motion blur in rendered output]
</span><span>    
</span><span>    subgraph "Platform-specific considerations"
</span><span>        H[WebGL2 on wasm32] --> I[Disable MSAA when motion blur enabled]
</span><span>    end
</span></code></pre><h2 id=key-files-changed>Key Files Changed</h2><h3 id=examples-stress-tests-many-cubes-rs-21-1><code>examples/stress_tests/many_cubes.rs</code> (+21/-1)</h3><p>This file gained motion blur support for the cube stress test. The changes include:<ol><li>Added <code>MotionBlur</code> import<li>Added <code>motion_blur</code> boolean field to <code>Args</code> struct<li>Added conditional motion blur setup in camera spawning</ol><p>Key code addition:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#fa6e32>if</span><span> args</span><span style=color:#ed9366>.</span><span>motion_blur {
</span><span>    camera</span><span style=color:#ed9366>.</span><span style=color:#f07171>insert</span><span>((
</span><span>        MotionBlur {
</span><span>            </span><span style=color:#abb0b6;font-style:italic>// Use an unrealistically large shutter angle so that motion blur is clearly visible.
</span><span>            shutter_angle</span><span style=color:#61676ccc>: </span><span style=color:#ff8f40>3.0</span><span style=color:#61676ccc>,
</span><span>            </span><span style=color:#ed9366>..</span><span style=color:#55b4d4;font-style:italic>Default</span><span style=color:#ed9366>::</span><span>default()
</span><span>        }</span><span style=color:#61676ccc>,
</span><span>        </span><span style=color:#abb0b6;font-style:italic>// MSAA and MotionBlur are not compatible on WebGL.
</span><span>        </span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>cfg</span><span>(</span><span style=color:#f29718>all</span><span>(
</span><span>            feature </span><span style=color:#ed9366>= </span><span style=color:#86b300>"webgl2"</span><span style=color:#61676ccc>,
</span><span>            target_arch </span><span style=color:#ed9366>= </span><span style=color:#86b300>"wasm32"</span><span style=color:#61676ccc>,
</span><span>            </span><span style=color:#f29718>not</span><span>(feature </span><span style=color:#ed9366>= </span><span style=color:#86b300>"webgpu"</span><span>)
</span><span>        ))]
</span><span>        Msaa</span><span style=color:#ed9366>::</span><span>Off</span><span style=color:#61676ccc>,
</span><span>    ))</span><span style=color:#61676ccc>;
</span><span>}
</span></code></pre><h3 id=examples-stress-tests-many-foxes-rs-21-1><code>examples/stress_tests/many_foxes.rs</code> (+21/-1)</h3><p>This file gained motion blur support for the fox animation stress test. The changes are similar to <code>many_cubes.rs</code> but with different camera positioning logic.<p>Key differences:<ul><li>The <code>args</code> parameter needed to be added to the <code>setup</code> function signature<li>The camera is spawned first, then motion blur components are conditionally added</ul><p>Code addition:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#fa6e32>if</span><span> args</span><span style=color:#ed9366>.</span><span>motion_blur {
</span><span>    camera</span><span style=color:#ed9366>.</span><span style=color:#f07171>insert</span><span>((
</span><span>        MotionBlur {
</span><span>            </span><span style=color:#abb0b6;font-style:italic>// Use an unrealistically large shutter angle so that motion blur is clearly visible.
</span><span>            shutter_angle</span><span style=color:#61676ccc>: </span><span style=color:#ff8f40>3.0</span><span style=color:#61676ccc>,
</span><span>            </span><span style=color:#ed9366>..</span><span style=color:#55b4d4;font-style:italic>Default</span><span style=color:#ed9366>::</span><span>default()
</span><span>        }</span><span style=color:#61676ccc>,
</span><span>        </span><span style=color:#abb0b6;font-style:italic>// MSAA and MotionBlur are not compatible on WebGL.
</span><span>        </span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>cfg</span><span>(</span><span style=color:#f29718>all</span><span>(feature </span><span style=color:#ed9366>= </span><span style=color:#86b300>"webgl2"</span><span style=color:#61676ccc>,</span><span> target_arch </span><span style=color:#ed9366>= </span><span style=color:#86b300>"wasm32"</span><span style=color:#61676ccc>, </span><span style=color:#f29718>not</span><span>(feature </span><span style=color:#ed9366>= </span><span style=color:#86b300>"webgpu"</span><span>)))]
</span><span>        Msaa</span><span style=color:#ed9366>::</span><span>Off</span><span style=color:#61676ccc>,
</span><span>    ))</span><span style=color:#61676ccc>;
</span><span>}
</span></code></pre><h3 id=examples-stress-tests-many-morph-targets-rs-19-1><code>examples/stress_tests/many_morph_targets.rs</code> (+19/-1)</h3><p>This file gained motion blur support specifically for testing morph targets with motion blur, which was the original motivation mentioned in the PR description.<p>The implementation follows the same pattern as the other files, with the camera distance determined by the existing <code>camera</code> argument (near or far positioning).<p>Code addition:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#fa6e32>if</span><span> args</span><span style=color:#ed9366>.</span><span>motion_blur {
</span><span>    camera</span><span style=color:#ed9366>.</span><span style=color:#f07171>insert</span><span>((
</span><span>        MotionBlur {
</span><span>            </span><span style=color:#abb0b6;font-style:italic>// Use an unrealistically large shutter angle so that motion blur is clearly visible.
</span><span>            shutter_angle</span><span style=color:#61676ccc>: </span><span style=color:#ff8f40>3.0</span><span style=color:#61676ccc>,
</span><span>            </span><span style=color:#ed9366>..</span><span style=color:#55b4d4;font-style:italic>Default</span><span style=color:#ed9366>::</span><span>default()
</span><span>        }</span><span style=color:#61676ccc>,
</span><span>        </span><span style=color:#abb0b6;font-style:italic>// MSAA and MotionBlur are not compatible on WebGL.
</span><span>        </span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>cfg</span><span>(</span><span style=color:#f29718>all</span><span>(feature </span><span style=color:#ed9366>= </span><span style=color:#86b300>"webgl2"</span><span style=color:#61676ccc>,</span><span> target_arch </span><span style=color:#ed9366>= </span><span style=color:#86b300>"wasm32"</span><span style=color:#61676ccc>, </span><span style=color:#f29718>not</span><span>(feature </span><span style=color:#ed9366>= </span><span style=color:#86b300>"webgpu"</span><span>)))]
</span><span>        Msaa</span><span style=color:#ed9366>::</span><span>Off</span><span style=color:#61676ccc>,
</span><span>    ))</span><span style=color:#61676ccc>;
</span><span>}
</span></code></pre><h2 id=further-reading>Further Reading</h2><ol><li><strong>Bevy Motion Blur Documentation</strong>: The <code>MotionBlur</code> component documentation in Bevy’s API reference<li><strong>Post-processing in Bevy</strong>: How Bevy’s post-processing pipeline works and how to create custom post-processing effects<li><strong>Temporal Anti-Aliasing and Motion Blur</strong>: The relationship between TAA and motion blur in modern rendering pipelines<li><strong>Command-line Argument Parsing with Argh</strong>: The <code>argh</code> crate used for parsing command-line arguments in these examples<li><strong>WebGL Limitations in Graphics APIs</strong>: Understanding platform-specific constraints like the MSAA/motion blur incompatibility on WebGL</ol></div><div data-is-md-page=true data-patch-exists=true data-patch-path=/pull_request/bevy/2026-02/pr_23060.patch id=patch-info style=display:none></div><div class=bottom-spacer></div></div></div>