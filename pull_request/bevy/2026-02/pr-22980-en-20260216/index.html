<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://unknownue.github.io name=base><title>
         #22980 fix: ResolvedBorderRadius left -> right, right -> left
        
    </title><meta content="#22980 fix: ResolvedBorderRadius left -> right, right -> left" property=og:title><meta content="A personal blog built with Zola and Apollo theme" property=og:description><meta content="A personal blog built with Zola and Apollo theme" name=description><link href=/icons/favicon.png rel=icon type=image/png><link href=https://unknownue.github.io/fonts.css rel=stylesheet><script src=https://unknownue.github.io/js/codeblock.js></script><script src=https://unknownue.github.io/js/toc.js></script><script src=https://unknownue.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Unknownue's Blog" href=https://unknownue.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://unknownue.github.io/theme/light.css rel=stylesheet><link href=https://unknownue.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://unknownue.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://unknownue.github.io/main.css media=screen rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js></script><script>// Initialize mermaid once DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            mermaid.initialize({
                startOnLoad: false,
                theme: document.body && document.body.classList.contains('dark') ? 'dark' : 'default',
                securityLevel: 'loose',
                flowchart: {
                    useMaxWidth: true,
                    htmlLabels: true
                },
                sequence: {
                    diagramMarginX: 50,
                    diagramMarginY: 10,
                    actorMargin: 50,
                    width: 150,
                    height: 65
                }
            });
        });</script><script src=https://unknownue.github.io/js/main.js></script><script defer src=https://unknownue.github.io/js/label-colors.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/rust.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/typescript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/go.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/cpp.min.js></script><script>// Ensure highlight.js is properly configured
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof hljs !== 'undefined') {
                hljs.configure({
                    languages: ['rust', 'javascript', 'python', 'cpp', 'go', 'typescript'],
                    ignoreUnescapedHTML: true
                });
                console.log('Highlight.js configured in header');
            }
        });</script><link href=https://cdn.jsdelivr.net/npm/diff2html/bundles/css/diff2html.min.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/diff2html/bundles/js/diff2html-ui.min.js></script><script src=https://unknownue.github.io/js/syntax-highlight.js></script><script src=https://unknownue.github.io/js/diff-sidebar.js></script><script src="https://unknownue.github.io/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><div class=content><header><div class=main><a href=https://unknownue.github.io>Unknownue's Blog</a><div class=socials><a class=social href=https://github.com/unknownue rel=me> <img alt=github src=https://unknownue.github.io/icons/social/github.svg> </a><a class=social href=https://github.com/unknownue/unknownue.github.io rel=me> <img alt=github-io src=https://unknownue.github.io/icons/social/rss.svg> </a></div></div><nav><a href=https://unknownue.github.io/posts style=margin-left:.25em>/posts</a><a href=https://unknownue.github.io/projects style=margin-left:.25em>/projects</a><a href=https://unknownue.github.io/about style=margin-left:.25em>/about</a><a href=https://unknownue.github.io/tags style=margin-left:.25em>/tags</a><button title="$SHORTCUT to open search" class=search-button id=search-button><img alt=Search class=search-icon src=https://unknownue.github.io/icons/search.svg></button><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><div id=modal-content><h1 class=page-header id=modalTitle>Search</h1><div id=searchBar><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search... role=combobox spellcheck=false><button title="Clear search" class=clear-button id=clear-search><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></button></div><div id=results-container><div id=results-info><span id=zero_results style=display:none>No results</span><span id=one_result style=display:none>1 result</span><span id=many_results style=display:none>$NUMBER results</span></div><div id=results role=listbox></div></div></div></div><a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://unknownue.github.io/icons/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://unknownue.github.io/icons/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><div class=pull-request-page><article class=md-content-page style=display:none></article><div class=back-link><a href=/pull_request/bevy/2026-02/>← Back to Pull Requests</a></div><div class=pr-metadata><span class=pr-date>2026-02-16</span><div class=language-switcher><span class="lang-link active" data-lang=en>English</span> / <a class=lang-link data-lang=zh-cn href=/pull_request/bevy/2026-02/pr-22980-zh-cn-20260216>中文</a></div></div><div class=pr-content><h1 id=title>Title</h1><h2 id=basic-information>Basic Information</h2><ul><li><strong>Title</strong>: fix: ResolvedBorderRadius left -> right, right -> left<li><strong>PR Link</strong>: https://github.com/bevyengine/bevy/pull/22980<li><strong>Author</strong>: cuiweixie<li><strong>Status</strong>: MERGED<li><strong>Labels</strong>: C-Bug, A-UI, S-Ready-For-Final-Review, M-Deliberate-Rendering-Change<li><strong>Created</strong>: 2026-02-16T13:31:14Z<li><strong>Merged</strong>: 2026-02-16T17:57:25Z<li><strong>Merged By</strong>: mockersf</ul><h2 id=description-translation>Description Translation</h2><p>The PR description is already in English:<h1 id=objective>Objective</h1><p>fixes ResolvedBorderRadius calculation<h2 id=the-story-of-this-pull-request>The Story of This Pull Request</h2><p>This pull request fixes a straightforward but critical bug in Bevy’s UI border radius calculation system. The issue was discovered during development when testing UI elements with asymmetric border radii - specifically, when the bottom-left and bottom-right corner radii were set to different values. The bug manifested as these corners being swapped in the actual rendered output: what should have been the bottom-right radius was applied to the bottom-left corner, and vice versa.<p>The problem originated in the <code>ComputedNode::resolved_border_radius()</code> method in <code>ui_node.rs</code>. This method is responsible for converting a <code>BorderRadius</code> struct (which stores the raw radius values for each corner) into a <code>ResolvedBorderRadius</code> struct (which clamps these values based on the node’s size and border thickness). The bug was a simple variable swap in two lines of code, but it had noticeable visual consequences for any UI element with non-uniform border radii.<p>When examining the code, we can see the logical flow of the original implementation. The method takes the computed node’s border radius values and applies clamping to ensure they don’t exceed the available space. For the top corners, the code was correct:<ul><li><code>top_left</code> used <code>self.border_radius.top_left</code><li><code>top_right</code> used <code>self.border_radius.top_right</code></ul><p>However, for the bottom corners, the assignments were reversed:<ul><li><code>bottom_right</code> incorrectly used <code>self.border_radius.bottom_left</code><li><code>bottom_left</code> incorrectly used <code>self.border_radius.bottom_right</code></ul><p>This type of bug is common in symmetric data structures where fields have similar names and purposes. The developer likely made a copy-paste error or mental slip when writing the initial implementation. The fix is minimal but important - simply swapping the two assignments to match the correct field names.<p>The clamping function <code>clamp_corner</code> itself wasn’t affected by this bug. It properly handles the mathematical constraints of border radii, ensuring that the sum of adjacent radii doesn’t exceed the corresponding dimension of the node’s rectangle. The bug was purely in the data routing - passing the wrong source values to the correct processing function.<p>From an architectural perspective, this fix maintains the existing design pattern where <code>ComputedNode</code> serves as an intermediate representation between the high-level UI components and the low-level rendering data. The <code>resolved_border_radius()</code> method acts as a transformation layer that applies constraints and produces render-ready values. The bug fix ensures this transformation preserves the intended corner assignments.<p>The impact of this fix is specific but important for UI consistency. Any UI element with different bottom-left and bottom-right border radii would have rendered incorrectly. This could affect visual design systems, theme implementations, or any game UI that uses rounded corners asymmetrically for aesthetic or functional purposes.<p>The fix was merged quickly (within about 4.5 hours of creation), indicating it was clearly correct and addressed a concrete bug. The labels applied (C-Bug, A-UI, M-Deliberate-Rendering-Change) accurately categorize this as a bug fix in the UI system that intentionally changes rendering behavior to correct the previous incorrect output.<h2 id=visual-representation>Visual Representation</h2><pre class=language-mermaid data-lang=mermaid style=color:#61676c;background-color:#fafafa><code class=language-mermaid data-lang=mermaid><span>graph TD
</span><span>    A[BorderRadius Struct] --> B[ComputedNode.resolved_border_radius]
</span><span>    B --> C{Clamp Calculation}
</span><span>    C --> D[top_left: top_left clamped]
</span><span>    C --> E[top_right: top_right clamped]
</span><span>    C --> F[bottom_right: bottom_right clamped]
</span><span>    C --> G[bottom_left: bottom_left clamped]
</span><span>    D --> H[ResolvedBorderRadius Struct]
</span><span>    E --> H
</span><span>    F --> H
</span><span>    G --> H
</span><span>    H --> I[Rendering System]
</span><span>    
</span><span>    style F stroke:#f00
</span><span>    style G stroke:#f00
</span></code></pre><p>The diagram shows the data flow through the border radius resolution process. The red highlights indicate where the bug occurred - the <code>bottom_right</code> and <code>bottom_left</code> assignments were swapped in their data sources.<h2 id=key-files-changed>Key Files Changed</h2><h3 id=crates-bevy-ui-src-ui-node-rs><code>crates/bevy_ui/src/ui_node.rs</code></h3><p>This file contains the <code>ComputedNode</code> struct and its implementation, including the <code>resolved_border_radius()</code> method that was fixed.<p><strong>Change Description</strong>: Fixed a variable assignment bug where bottom-left and bottom-right border radius values were swapped during the resolution process.<p><strong>Code Snippet</strong>:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before the fix:
</span><span>ResolvedBorderRadius {
</span><span>    top_left</span><span style=color:#61676ccc>: </span><span style=color:#f07171>clamp_corner</span><span>(</span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>border_radius</span><span style=color:#ed9366>.</span><span>top_left</span><span style=color:#61676ccc>,</span><span> s</span><span style=color:#61676ccc>,</span><span> b</span><span style=color:#ed9366>.</span><span style=color:#f07171>xy</span><span>())</span><span style=color:#61676ccc>,
</span><span>    top_right</span><span style=color:#61676ccc>: </span><span style=color:#f07171>clamp_corner</span><span>(</span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>border_radius</span><span style=color:#ed9366>.</span><span>top_right</span><span style=color:#61676ccc>,</span><span> s</span><span style=color:#61676ccc>,</span><span> b</span><span style=color:#ed9366>.</span><span style=color:#f07171>zy</span><span>())</span><span style=color:#61676ccc>,
</span><span>    bottom_right</span><span style=color:#61676ccc>: </span><span style=color:#f07171>clamp_corner</span><span>(</span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>border_radius</span><span style=color:#ed9366>.</span><span>bottom_left</span><span style=color:#61676ccc>,</span><span> s</span><span style=color:#61676ccc>,</span><span> b</span><span style=color:#ed9366>.</span><span style=color:#f07171>xw</span><span>())</span><span style=color:#61676ccc>,  </span><span style=color:#abb0b6;font-style:italic>// BUG: Using bottom_left
</span><span>    bottom_left</span><span style=color:#61676ccc>: </span><span style=color:#f07171>clamp_corner</span><span>(</span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>border_radius</span><span style=color:#ed9366>.</span><span>bottom_right</span><span style=color:#61676ccc>,</span><span> s</span><span style=color:#61676ccc>,</span><span> b</span><span style=color:#ed9366>.</span><span style=color:#f07171>zw</span><span>())</span><span style=color:#61676ccc>,  </span><span style=color:#abb0b6;font-style:italic>// BUG: Using bottom_right
</span><span>}
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After the fix:
</span><span>ResolvedBorderRadius {
</span><span>    top_left</span><span style=color:#61676ccc>: </span><span style=color:#f07171>clamp_corner</span><span>(</span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>border_radius</span><span style=color:#ed9366>.</span><span>top_left</span><span style=color:#61676ccc>,</span><span> s</span><span style=color:#61676ccc>,</span><span> b</span><span style=color:#ed9366>.</span><span style=color:#f07171>xy</span><span>())</span><span style=color:#61676ccc>,
</span><span>    top_right</span><span style=color:#61676ccc>: </span><span style=color:#f07171>clamp_corner</span><span>(</span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>border_radius</span><span style=color:#ed9366>.</span><span>top_right</span><span style=color:#61676ccc>,</span><span> s</span><span style=color:#61676ccc>,</span><span> b</span><span style=color:#ed9366>.</span><span style=color:#f07171>zy</span><span>())</span><span style=color:#61676ccc>,
</span><span>    bottom_right</span><span style=color:#61676ccc>: </span><span style=color:#f07171>clamp_corner</span><span>(</span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>border_radius</span><span style=color:#ed9366>.</span><span>bottom_right</span><span style=color:#61676ccc>,</span><span> s</span><span style=color:#61676ccc>,</span><span> b</span><span style=color:#ed9366>.</span><span style=color:#f07171>xw</span><span>())</span><span style=color:#61676ccc>,  </span><span style=color:#abb0b6;font-style:italic>// FIXED: Now using bottom_right
</span><span>    bottom_left</span><span style=color:#61676ccc>: </span><span style=color:#f07171>clamp_corner</span><span>(</span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>border_radius</span><span style=color:#ed9366>.</span><span>bottom_left</span><span style=color:#61676ccc>,</span><span> s</span><span style=color:#61676ccc>,</span><span> b</span><span style=color:#ed9366>.</span><span style=color:#f07171>zw</span><span>())</span><span style=color:#61676ccc>,    </span><span style=color:#abb0b6;font-style:italic>// FIXED: Now using bottom_left
</span><span>}
</span></code></pre><p><strong>Relationship to PR Purpose</strong>: This is the only change in the PR and directly addresses the bug described in the objective. The fix ensures that each corner’s border radius value is correctly associated with its intended corner during the resolution process.<h2 id=further-reading>Further Reading</h2><ol><li><strong>Bevy UI System Documentation</strong>: For understanding how UI components are structured and rendered in Bevy<li><strong>Border Radius Clamping Algorithms</strong>: For the mathematical principles behind constraining border radii to fit within element dimensions<li><strong>Common Anti-patterns in Data Transformation</strong>: For understanding how similar bugs can be prevented through code review practices and testing strategies<li><strong>Rounded Rectangle Rendering Techniques</strong>: For background on how border radii are implemented in rendering pipelines</ol><h1 id=full-code-diff>Full Code Diff</h1><pre style=color:#61676c;background-color:#fafafa><code><span>diff --git a/crates/bevy_ui/src/ui_node.rs b/crates/bevy_ui/src/ui_node.rs
</span><span>index 4f672126e4800..685dd152541fa 100644
</span><span>--- a/crates/bevy_ui/src/ui_node.rs
</span><span>+++ b/crates/bevy_ui/src/ui_node.rs
</span><span>@@ -201,8 +201,8 @@ impl ComputedNode {
</span><span>         ResolvedBorderRadius {
</span><span>             top_left: clamp_corner(self.border_radius.top_left, s, b.xy()),
</span><span>             top_right: clamp_corner(self.border_radius.top_right, s, b.zy()),
</span><span>-            bottom_right: clamp_corner(self.border_radius.bottom_left, s, b.xw()),
</span><span>-            bottom_left: clamp_corner(self.border_radius.bottom_right, s, b.zw()),
</span><span>+            bottom_right: clamp_corner(self.border_radius.bottom_right, s, b.xw()),
</span><span>+            bottom_left: clamp_corner(self.border_radius.bottom_left, s, b.zw()),
</span><span>         }
</span><span>     }
</span><span> 
</span></code></pre></div><div data-is-md-page=true data-patch-exists=true data-patch-path=/pull_request/bevy/2026-02/pr_22980.patch id=patch-info style=display:none></div><div class=bottom-spacer></div></div></div>