<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://unknownue.github.io name=base><title>
         #22933 Condense bevy_picking (input focus) feature into bevy_ui_picking feature
        
    </title><meta content="#22933 Condense bevy_picking (input focus) feature into bevy_ui_picking feature" property=og:title><meta content="A personal blog built with Zola and Apollo theme" property=og:description><meta content="A personal blog built with Zola and Apollo theme" name=description><link href=/icons/favicon.png rel=icon type=image/png><link href=https://unknownue.github.io/fonts.css rel=stylesheet><script src=https://unknownue.github.io/js/codeblock.js></script><script src=https://unknownue.github.io/js/toc.js></script><script src=https://unknownue.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Unknownue's Blog" href=https://unknownue.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://unknownue.github.io/theme/light.css rel=stylesheet><link href=https://unknownue.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://unknownue.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://unknownue.github.io/main.css media=screen rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js></script><script>// Initialize mermaid once DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            mermaid.initialize({
                startOnLoad: false,
                theme: document.body && document.body.classList.contains('dark') ? 'dark' : 'default',
                securityLevel: 'loose',
                flowchart: {
                    useMaxWidth: true,
                    htmlLabels: true
                },
                sequence: {
                    diagramMarginX: 50,
                    diagramMarginY: 10,
                    actorMargin: 50,
                    width: 150,
                    height: 65
                }
            });
        });</script><script src=https://unknownue.github.io/js/main.js></script><script defer src=https://unknownue.github.io/js/label-colors.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/rust.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/typescript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/go.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/cpp.min.js></script><script>// Ensure highlight.js is properly configured
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof hljs !== 'undefined') {
                hljs.configure({
                    languages: ['rust', 'javascript', 'python', 'cpp', 'go', 'typescript'],
                    ignoreUnescapedHTML: true
                });
                console.log('Highlight.js configured in header');
            }
        });</script><link href=https://cdn.jsdelivr.net/npm/diff2html/bundles/css/diff2html.min.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/diff2html/bundles/js/diff2html-ui.min.js></script><script src=https://unknownue.github.io/js/syntax-highlight.js></script><script src=https://unknownue.github.io/js/diff-sidebar.js></script><script src="https://unknownue.github.io/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><div class=content><header><div class=main><a href=https://unknownue.github.io>Unknownue's Blog</a><div class=socials><a class=social href=https://github.com/unknownue rel=me> <img alt=github src=https://unknownue.github.io/icons/social/github.svg> </a><a class=social href=https://github.com/unknownue/unknownue.github.io rel=me> <img alt=github-io src=https://unknownue.github.io/icons/social/rss.svg> </a></div></div><nav><a href=https://unknownue.github.io/posts style=margin-left:.25em>/posts</a><a href=https://unknownue.github.io/projects style=margin-left:.25em>/projects</a><a href=https://unknownue.github.io/about style=margin-left:.25em>/about</a><a href=https://unknownue.github.io/tags style=margin-left:.25em>/tags</a><button title="$SHORTCUT to open search" class=search-button id=search-button><img alt=Search class=search-icon src=https://unknownue.github.io/icons/search.svg></button><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><div id=modal-content><h1 class=page-header id=modalTitle>Search</h1><div id=searchBar><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search... role=combobox spellcheck=false><button title="Clear search" class=clear-button id=clear-search><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></button></div><div id=results-container><div id=results-info><span id=zero_results style=display:none>No results</span><span id=one_result style=display:none>1 result</span><span id=many_results style=display:none>$NUMBER results</span></div><div id=results role=listbox></div></div></div></div><a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://unknownue.github.io/icons/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://unknownue.github.io/icons/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><div class=pull-request-page><article class=md-content-page style=display:none></article><div class=back-link><a href=/pull_request/bevy/2026-02/>← Back to Pull Requests</a></div><div class=pr-metadata><span class=pr-date>2026-02-17</span><div class=language-switcher><a class=lang-link data-lang=en href=/pull_request/bevy/2026-02/pr-22933-en-20260217>English</a> / <span class="lang-link active" data-lang=zh-cn>中文</span></div></div><div class=pr-content><h1 id=condense-bevy-picking-input-focus-feature-into-bevy-ui-picking-feature>Condense bevy_picking (input focus) feature into bevy_ui_picking feature</h1><h2 id=basic-information>Basic Information</h2><ul><li><strong>Title</strong>: Condense bevy_picking (input focus) feature into bevy_ui_picking feature<li><strong>PR Link</strong>: https://github.com/bevyengine/bevy/pull/22933<li><strong>Author</strong>: alice-i-cecile<li><strong>Status</strong>: MERGED<li><strong>Labels</strong>: A-UI, C-Usability, S-Ready-For-Final-Review, M-Migration-Guide, X-Contentious, D-Straightforward, A-Picking<li><strong>Created</strong>: 2026-02-13T01:36:56Z<li><strong>Merged</strong>: 2026-02-17T01:47:20Z<li><strong>Merged By</strong>: alice-i-cecile</ul><h2 id=description-translation>Description Translation</h2><p>这个PR解决了特性标记“bevy_picking“和“picking“描述相同但功能不同的问题，这非常令人困惑！<p>修复 #22931。<p>在本次PR之前的状态：<ul><li>picking是bevy中的一个特性集合，启用[“bevy_picking”, “mesh_picking”, “sprite_picking”, “ui_picking”]<li>ui特性集合启用了picking本身<li>bevy_picking在bevy中定义，委托到[“bevy_internal/bevy_picking”]<li>在bevy_internal中，这切换了bevy_picking = [“dep:bevy_picking”, “bevy_input_focus?/bevy_picking”]<li>然后这切换了bevy_picking依赖（看起来像是特性？）在bevy_input_focus中<li>最终用于启用基于鼠标/虚拟光标输入焦点选择<li>@viridia担心因为观察者开销的问题而使其成为必需</ul><p>解决方案： 在bevy_internal层级将bevy_picking压缩到bevy_ui_picking中。没有人会想要通用的UI选取功能但不想要输入焦点选取功能。这修复了冗余问题，更合理地分组功能，同时仍然允许出于任何原因避免整个UI选取功能。<p>需要更细粒度控制的用户可以按需组合各种Bevy crate。<p>替代方案：<ol><li>保留此特性，将其重命名为<code>input_focus_picking</code><li>在<code>ui_picking</code>中启用该特性</ol><p>这会在顶层添加另一个小众特性标记，但使想要使用<code>bevy_input_focus</code>而不使用<code>bevy_ui</code>的用户更容易。我从未见过这样的用户，但也许他们存在！<h2 id=the-story-of-this-pull-request>The Story of This Pull Request</h2><p>这个PR的核心问题是Bevy中picking功能相关的特性标记存在混淆和冗余。在现有的架构中，有两个名为“picking“的实体：一个是特性集合（feature collection），另一个是具体的特性（feature）。虽然它们的描述相同，但功能却不同，这给开发者带来了理解和使用上的困难。<p>问题的根源在于特性依赖链的复杂性。在顶层，<code>picking</code>特性集合包含了四个组件：<code>bevy_picking</code>、<code>mesh_picking</code>、<code>sprite_picking</code>和<code>ui_picking</code>。但<code>bevy_picking</code>本身并不是一个具体的实现，而是一个转发到内部模块的标记。在<code>bevy_internal</code>中，<code>bevy_picking</code>特性实际上控制的是<code>bevy_input_focus</code> crate中的鼠标/虚拟光标输入焦点选择功能。这种多层间接导致功能边界不清晰。<p>从工程角度看，这里存在一个设计上的不一致性：<code>bevy_picking</code>特性实际上控制的是输入焦点功能，但用户可能期望它控制的是通用的picking功能。同时，<code>ui_picking</code>特性已经包含了UI元素的picking功能，将输入焦点picking功能合并到其中是逻辑上更合理的，因为UI picking自然需要处理输入焦点。<p>开发者采取了一个直接而实用的解决方案：将<code>bevy_picking</code>特性从顶层移除，并将其功能整合到<code>ui_picking</code>特性中。这样做有以下几个技术理由：<ol><li><strong>功能逻辑分组</strong>：UI picking和输入焦点picking在功能上是紧密相关的。当用户需要UI picking时，几乎总是需要输入焦点功能。<li><strong>简化特性树</strong>：减少特性数量可以降低认知负担和维护成本。<li><strong>保持灵活性</strong>：如果用户确实需要输入焦点功能而不需要UI，仍然可以通过直接依赖<code>bevy_input_focus</code> crate并启用其<code>bevy_picking</code>特性来实现。</ol><p>这个重构涉及多个层面的修改。在顶层<code>Cargo.toml</code>中，<code>picking</code>特性集合不再包含<code>bevy_picking</code>，因为该特性被移除了。同时，相关的示例需要更新其特性依赖。在<code>bevy_internal/Cargo.toml</code>中，<code>bevy_picking</code>特性的定义被完全移除，其功能被整合到<code>ui_picking</code>特性中：<pre class=language-toml data-lang=toml style=color:#61676c;background-color:#fafafa><code class=language-toml data-lang=toml><span style=color:#abb0b6;font-style:italic># Before:
</span><span style=color:#399ee6>bevy_picking </span><span>= [</span><span style=color:#86b300>"dep:bevy_picking"</span><span style=color:#61676ccc>, </span><span style=color:#86b300>"bevy_input_focus?/bevy_picking"</span><span>]
</span><span style=color:#399ee6>ui_picking </span><span>= [</span><span style=color:#86b300>"bevy_picking"</span><span style=color:#61676ccc>, </span><span style=color:#86b300>"bevy_ui?/bevy_picking"</span><span>]
</span><span>
</span><span style=color:#abb0b6;font-style:italic># After:
</span><span style=color:#399ee6>ui_picking </span><span>= [
</span><span>  </span><span style=color:#86b300>"bevy_picking"</span><span style=color:#61676ccc>,
</span><span>  </span><span style=color:#86b300>"bevy_ui?/bevy_picking"</span><span style=color:#61676ccc>,
</span><span>  </span><span style=color:#86b300>"bevy_input_focus?/bevy_picking"</span><span style=color:#61676ccc>,
</span><span>]
</span></code></pre><p>这种修改使得<code>ui_picking</code>特性现在不仅包含了基本的picking功能和UI相关的picking，还包含了输入焦点功能。这反映了这些功能在实际使用中的紧密耦合关系。<p>文档也需要相应更新。特性文档现在正确反映了<code>picking</code>特性集合只包含三个具体的picking后端，而不是四个。同时，为了帮助用户迁移，添加了一个迁移指南，明确说明了<code>bevy_picking</code>特性被移除，并指导用户如何迁移他们的代码。<p>从技术实现的角度看，这个PR展示了几个重要的工程实践：<ol><li><strong>特性设计的清晰性原则</strong>：每个特性应该有明确的、单一的责任<li><strong>减少不必要的抽象层</strong>：当间接层不提供实际价值时，应该考虑简化<li><strong>向后兼容性处理</strong>：通过迁移指南帮助用户理解变化并适应</ol><p>这个改变也引发了一个关于权衡的讨论：是保持更细粒度的控制（保留<code>bevy_picking</code>作为独立特性）还是提供更简化的体验（将其合并到<code>ui_picking</code>中）。最终决策选择了简化，这反映了Bevy项目在易用性和灵活性之间的平衡考虑。对于确实需要更细粒度控制的用户，仍然可以通过直接依赖相关crate来实现他们的需求。<h2 id=visual-representation>Visual Representation</h2><pre class=language-mermaid data-lang=mermaid style=color:#61676c;background-color:#fafafa><code class=language-mermaid data-lang=mermaid><span>graph TD
</span><span>    A[picking feature collection] --> B[mesh_picking]
</span><span>    A --> C[sprite_picking]
</span><span>    A --> D[ui_picking]
</span><span>    D --> E[bevy_picking crate]
</span><span>    D --> F[bevy_ui picking]
</span><span>    D --> G[bevy_input_focus picking]
</span><span>    
</span><span>    style A fill:#f9f,stroke:#333,stroke-width:2px
</span><span>    style D fill:#bbf,stroke:#333,stroke-width:2px
</span></code></pre><h2 id=key-files-changed>Key Files Changed</h2><h3 id=1-cargo-toml-3-6>1. <code>Cargo.toml</code> (+3/-6)</h3><p>这个文件包含了顶层的特性定义和示例的配置。主要修改包括：<ul><li>从<code>picking</code>特性集合中移除了<code>bevy_picking</code><li>移除了<code>bevy_picking</code>特性的定义<li>更新了两个示例的<code>required-features</code>，从<code>bevy_picking</code>改为<code>ui_picking</code></ul><pre class=language-toml data-lang=toml style=color:#61676c;background-color:#fafafa><code class=language-toml data-lang=toml><span style=color:#abb0b6;font-style:italic># Before:
</span><span style=color:#399ee6>picking </span><span>= [</span><span style=color:#86b300>"bevy_picking"</span><span style=color:#61676ccc>, </span><span style=color:#86b300>"mesh_picking"</span><span style=color:#61676ccc>, </span><span style=color:#86b300>"sprite_picking"</span><span style=color:#61676ccc>, </span><span style=color:#86b300>"ui_picking"</span><span>]
</span><span>
</span><span style=color:#abb0b6;font-style:italic># Provides picking functionality
</span><span style=color:#399ee6>bevy_picking </span><span>= [</span><span style=color:#86b300>"bevy_internal/bevy_picking"</span><span>]
</span><span>
</span><span style=color:#abb0b6;font-style:italic># After:
</span><span style=color:#399ee6>picking </span><span>= [</span><span style=color:#86b300>"mesh_picking"</span><span style=color:#61676ccc>, </span><span style=color:#86b300>"sprite_picking"</span><span style=color:#61676ccc>, </span><span style=color:#86b300>"ui_picking"</span><span>]
</span></code></pre><pre class=language-toml data-lang=toml style=color:#61676c;background-color:#fafafa><code class=language-toml data-lang=toml><span style=color:#abb0b6;font-style:italic># Before example configuration:
</span><span style=color:#399ee6>required-features </span><span>= [</span><span style=color:#86b300>"bevy_picking"</span><span style=color:#61676ccc>, </span><span style=color:#86b300>"sprite_picking"</span><span>]
</span><span>
</span><span style=color:#abb0b6;font-style:italic># After example configuration:
</span><span style=color:#399ee6>required-features </span><span>= [</span><span style=color:#86b300>"ui_picking"</span><span style=color:#61676ccc>, </span><span style=color:#86b300>"sprite_picking"</span><span>]
</span></code></pre><h3 id=2-crates-bevy-internal-cargo-toml-5-4>2. <code>crates/bevy_internal/Cargo.toml</code> (+5/-4)</h3><p>这是核心的修改文件，重新组织了picking特性的依赖关系：<ul><li>移除了<code>bevy_picking</code>特性的定义<li>在<code>ui_picking</code>特性中添加了<code>bevy_input_focus?/bevy_picking</code>依赖</ul><pre class=language-toml data-lang=toml style=color:#61676c;background-color:#fafafa><code class=language-toml data-lang=toml><span style=color:#abb0b6;font-style:italic># Before:
</span><span style=color:#abb0b6;font-style:italic># Provides picking functionality
</span><span style=color:#399ee6>bevy_picking </span><span>= [</span><span style=color:#86b300>"dep:bevy_picking"</span><span style=color:#61676ccc>, </span><span style=color:#86b300>"bevy_input_focus?/bevy_picking"</span><span>]
</span><span>
</span><span style=color:#abb0b6;font-style:italic># Provides a UI picking backend
</span><span style=color:#399ee6>ui_picking </span><span>= [</span><span style=color:#86b300>"bevy_picking"</span><span style=color:#61676ccc>, </span><span style=color:#86b300>"bevy_ui?/bevy_picking"</span><span>]
</span><span>
</span><span style=color:#abb0b6;font-style:italic># After:
</span><span style=color:#abb0b6;font-style:italic># Provides a UI picking backend
</span><span style=color:#399ee6>ui_picking </span><span>= [
</span><span>  </span><span style=color:#86b300>"bevy_picking"</span><span style=color:#61676ccc>,
</span><span>  </span><span style=color:#86b300>"bevy_ui?/bevy_picking"</span><span style=color:#61676ccc>,
</span><span>  </span><span style=color:#86b300>"bevy_input_focus?/bevy_picking"</span><span style=color:#61676ccc>,
</span><span>]
</span></code></pre><h3 id=3-docs-cargo-features-md-1-2>3. <code>docs/cargo_features.md</code> (+1/-2)</h3><p>更新了特性文档以反映新的结构：<ul><li>更新了<code>picking</code>特性集合的描述，移除了<code>bevy_picking</code><li>从特性列表中移除了<code>bevy_picking</code>条目</ul><pre class=language-markdown data-lang=markdown style=color:#61676c;background-color:#fafafa><code class=language-markdown data-lang=markdown><span style=color:#fa6e32;font-weight:700># </span><span style=color:#399ee6;font-weight:700>Before:
</span><span style=color:#61676ccc>|</span><span>picking</span><span style=color:#61676ccc>|</span><span>Enables picking functionality. </span><span style=color:#f07171;font-weight:700>**Feature set:** </span><span style=color:#ed9366;background-color:#61676c10>`bevy_picking`</span><span>, </span><span style=color:#ed9366;background-color:#61676c10>`mesh_picking`</span><span>, </span><span style=color:#ed9366;background-color:#61676c10>`sprite_picking`</span><span>, </span><span style=color:#ed9366;background-color:#61676c10>`ui_picking`</span><span>.</span><span style=color:#61676ccc>|
</span><span>
</span><span style=color:#fa6e32;font-weight:700># </span><span style=color:#399ee6;font-weight:700>After:
</span><span style=color:#61676ccc>|</span><span>picking</span><span style=color:#61676ccc>|</span><span>Enables picking functionality. </span><span style=color:#f07171;font-weight:700>**Feature set:** </span><span style=color:#ed9366;background-color:#61676c10>`mesh_picking`</span><span>, </span><span style=color:#ed9366;background-color:#61676c10>`sprite_picking`</span><span>, </span><span style=color:#ed9366;background-color:#61676c10>`ui_picking`</span><span>.</span><span style=color:#61676ccc>|
</span></code></pre><h3 id=4-release-content-migration-guides-bevy-picking-feature-md-12-0>4. <code>release-content/migration-guides/bevy_picking_feature.md</code> (+12/-0)</h3><p>新增了迁移指南，帮助用户适应这个变化：<pre class=language-markdown data-lang=markdown style=color:#61676c;background-color:#fafafa><code class=language-markdown data-lang=markdown><span style=color:#abb0b6;background-color:#61676c10;font-weight:700>---
</span><span>title: "</span><span style=color:#ed9366;background-color:#61676c10>`bevy_picking`</span><span> feature flag removed"
</span><span>pull_requests: [22933]
</span><span style=color:#fa6e32;font-weight:700>---
</span><span>
</span><span>The </span><span style=color:#ed9366;background-color:#61676c10>`bevy/bevy_picking`</span><span> feature flag has been removed. This previously enabled picking functionality in </span><span style=color:#ed9366;background-color:#61676c10>`bevy_input_focus`</span><span>,
</span><span>allowing users to select elements to focus using their mouse.
</span><span>
</span><span>This is now exposed as part of the existing </span><span style=color:#ed9366;background-color:#61676c10>`bevy/bevy_ui_picking`</span><span> feature, which is itself part of the </span><span style=color:#ed9366;background-color:#61676c10>`ui`</span><span> feature collection.
</span><span>In most cases, you should add the </span><span style=color:#ed9366;background-color:#61676c10>`ui`</span><span> feature collection to your project if you are using </span><span style=color:#ed9366;background-color:#61676c10>`bevy_ui`</span><span>.
</span><span>
</span><span>If you want to enable </span><span style=color:#ed9366;background-color:#61676c10>`bevy_input_focus`</span><span>'s picking functionality, but do </span><span style=color:#f07171;font-style:italic>*not*</span><span> want to use </span><span style=color:#ed9366;background-color:#61676c10>`bevy_ui`</span><span>, add a separate dependency to the same version of </span><span style=color:#ed9366;background-color:#61676c10>`bevy_input_focus`</span><span> in your project and enable the optional </span><span style=color:#ed9366;background-color:#61676c10>`bevy_picking`</span><span> feature there.
</span></code></pre><h2 id=further-reading>Further Reading</h2><ol><li><a rel="noopener nofollow noreferrer" href=https://doc.rust-lang.org/cargo/reference/features.html target=_blank>Cargo Features Documentation</a> - 了解Cargo特性系统的工作原理<li><a rel="noopener nofollow noreferrer" href=https://github.com/bevyengine/bevy/tree/main/crates/bevy_picking target=_blank>Bevy Picking System</a> - 了解Bevy的picking系统实现<li><a rel="noopener nofollow noreferrer" href=https://martinfowler.com/articles/feature-toggles.html target=_blank>Feature Flag Best Practices</a> - Martin Fowler关于特性标记的经典文章<li><a rel="noopener nofollow noreferrer" href=https://bevyengine.org/learn/quick-start/features/ target=_blank>Bevy Cargo Features Guide</a> - Bevy官方关于特性使用的指南</ol></div><div data-is-md-page=true data-patch-exists=true data-patch-path=/pull_request/bevy/2026-02/pr_22933.patch id=patch-info style=display:none></div><div class=bottom-spacer></div></div></div>