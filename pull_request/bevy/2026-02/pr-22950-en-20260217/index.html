<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://unknownue.github.io name=base><title>
         #22950 Move render time from extract to render
        
    </title><meta content="#22950 Move render time from extract to render" property=og:title><meta content="A personal blog built with Zola and Apollo theme" property=og:description><meta content="A personal blog built with Zola and Apollo theme" name=description><link href=/icons/favicon.png rel=icon type=image/png><link href=https://unknownue.github.io/fonts.css rel=stylesheet><script src=https://unknownue.github.io/js/codeblock.js></script><script src=https://unknownue.github.io/js/toc.js></script><script src=https://unknownue.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Unknownue's Blog" href=https://unknownue.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://unknownue.github.io/theme/light.css rel=stylesheet><link href=https://unknownue.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://unknownue.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://unknownue.github.io/main.css media=screen rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js></script><script>// Initialize mermaid once DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            mermaid.initialize({
                startOnLoad: false,
                theme: document.body && document.body.classList.contains('dark') ? 'dark' : 'default',
                securityLevel: 'loose',
                flowchart: {
                    useMaxWidth: true,
                    htmlLabels: true
                },
                sequence: {
                    diagramMarginX: 50,
                    diagramMarginY: 10,
                    actorMargin: 50,
                    width: 150,
                    height: 65
                }
            });
        });</script><script src=https://unknownue.github.io/js/main.js></script><script defer src=https://unknownue.github.io/js/label-colors.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/rust.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/typescript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/go.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/cpp.min.js></script><script>// Ensure highlight.js is properly configured
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof hljs !== 'undefined') {
                hljs.configure({
                    languages: ['rust', 'javascript', 'python', 'cpp', 'go', 'typescript'],
                    ignoreUnescapedHTML: true
                });
                console.log('Highlight.js configured in header');
            }
        });</script><link href=https://cdn.jsdelivr.net/npm/diff2html/bundles/css/diff2html.min.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/diff2html/bundles/js/diff2html-ui.min.js></script><script src=https://unknownue.github.io/js/syntax-highlight.js></script><script src=https://unknownue.github.io/js/diff-sidebar.js></script><script src="https://unknownue.github.io/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><div class=content><header><div class=main><a href=https://unknownue.github.io>Unknownue's Blog</a><div class=socials><a class=social href=https://github.com/unknownue rel=me> <img alt=github src=https://unknownue.github.io/icons/social/github.svg> </a><a class=social href=https://github.com/unknownue/unknownue.github.io rel=me> <img alt=github-io src=https://unknownue.github.io/icons/social/rss.svg> </a></div></div><nav><a href=https://unknownue.github.io/posts style=margin-left:.25em>/posts</a><a href=https://unknownue.github.io/projects style=margin-left:.25em>/projects</a><a href=https://unknownue.github.io/about style=margin-left:.25em>/about</a><a href=https://unknownue.github.io/tags style=margin-left:.25em>/tags</a><button title="$SHORTCUT to open search" class=search-button id=search-button><img alt=Search class=search-icon src=https://unknownue.github.io/icons/search.svg></button><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><div id=modal-content><h1 class=page-header id=modalTitle>Search</h1><div id=searchBar><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search... role=combobox spellcheck=false><button title="Clear search" class=clear-button id=clear-search><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></button></div><div id=results-container><div id=results-info><span id=zero_results style=display:none>No results</span><span id=one_result style=display:none>1 result</span><span id=many_results style=display:none>$NUMBER results</span></div><div id=results role=listbox></div></div></div></div><a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://unknownue.github.io/icons/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://unknownue.github.io/icons/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><div class=pull-request-page><article class=md-content-page style=display:none></article><div class=back-link><a href=/pull_request/bevy/2026-02/>← Back to Pull Requests</a></div><div class=pr-metadata><span class=pr-date>2026-02-17</span><div class=language-switcher><span class="lang-link active" data-lang=en>English</span> / <a class=lang-link data-lang=zh-cn href=/pull_request/bevy/2026-02/pr-22950-zh-cn-20260217>中文</a></div></div><div class=pr-content><h1 id=title>Title</h1><h2 id=basic-information>Basic Information</h2><ul><li><strong>Title</strong>: Move render time from extract to render<li><strong>PR Link</strong>: https://github.com/bevyengine/bevy/pull/22950<li><strong>Author</strong>: Zeophlite<li><strong>Status</strong>: MERGED<li><strong>Labels</strong>: D-Trivial, A-Rendering, S-Ready-For-Final-Review<li><strong>Created</strong>: 2026-02-14T06:09:04Z<li><strong>Merged</strong>: 2026-02-17T02:49:51Z<li><strong>Merged By</strong>: alice-i-cecile</ul><h2 id=description-translation>Description Translation</h2><h1 id=objective>Objective</h1><ul><li>Move render time from extract to render</ul><h2 id=solution>Solution</h2><ul><li>Move it</ul><h2 id=testing>Testing</h2><ul><li><code>cargo run --example animated_mesh</code> , but I think</ul><h2 id=the-story-of-this-pull-request>The Story of This Pull Request</h2><p>This PR represents a straightforward but meaningful architectural cleanup in Bevy’s render system. The core issue was a misplacement of timing-related resource initialization in the codebase’s plugin structure. Specifically, the code responsible for creating and setting up time synchronization channels between Bevy’s main world and render world was located in the wrong plugin.<p>In Bevy’s rendering architecture, there are two separate worlds: the main world (where application logic runs) and the render world (where rendering systems execute). These worlds operate in parallel, and they need to synchronize certain data, including timing information. The <code>bevy_time::create_time_channels()</code> function creates a sender-receiver pair that facilitates this synchronization.<p>The problem was that this channel creation and resource insertion was happening in the <code>ExtractPlugin</code>, which is primarily responsible for extracting data from the main world to the render world. However, the render time channels are not strictly part of the extraction process—they’re a foundational infrastructure component for the entire render system.<p>Looking at the implementation, we see that before this change, the <code>ExtractPlugin</code> was creating the time channels and inserting the sender into the render app and the receiver into the main app. This worked functionally, but it violated the architectural separation of concerns. The <code>ExtractPlugin</code> should focus on data extraction, not on setting up core render infrastructure.<p>The solution implemented here moves the time channel initialization from the <code>ExtractPlugin</code> to the <code>RenderPlugin</code>, which is the central plugin responsible for configuring the entire render system. This is a more logical placement because:<ol><li>Time synchronization is a cross-cutting concern for the entire render system, not just extraction<li>The <code>RenderPlugin</code> is already responsible for setting up other render infrastructure<li>This keeps the <code>ExtractPlugin</code> focused on its single responsibility</ol><p>From a technical perspective, this change doesn’t alter behavior—the same resources are created and inserted into the same places. However, it improves code organization by placing infrastructure setup in the appropriate plugin. This makes the codebase easier to understand and maintain, as developers looking for render infrastructure setup will naturally check the <code>RenderPlugin</code> first.<p>The testing approach mentioned in the PR description (<code>cargo run --example animated_mesh</code>) is minimal but appropriate. Since this is a refactoring that doesn’t change observable behavior, running an example that uses the render system should be sufficient to verify that the time synchronization still works correctly.<p>This change exemplifies a common pattern in plugin-based architectures: continually refining the separation of responsibilities between plugins to maintain clean architectural boundaries. While small, such refactorings accumulate to create a more maintainable and understandable codebase.<h2 id=visual-representation>Visual Representation</h2><pre class=language-mermaid data-lang=mermaid style=color:#61676c;background-color:#fafafa><code class=language-mermaid data-lang=mermaid><span>graph TB
</span><span>    MainApp[Main App] -->|Extracts data| ExtractPlugin
</span><span>    ExtractPlugin --> RenderApp[Render App]
</span><span>    
</span><span>    RenderPlugin -->|Sets up infrastructure| RenderApp
</span><span>    RenderPlugin -->|Sets up infrastructure| MainApp
</span><span>    
</span><span>    subgraph Before
</span><span>        ExtractPlugin -->|Created time channels| TimeChannels
</span><span>        TimeChannels -->|Sender| RenderApp
</span><span>        TimeChannels -->|Receiver| MainApp
</span><span>    end
</span><span>    
</span><span>    subgraph After
</span><span>        RenderPlugin -->|Creates time channels| TimeChannels2
</span><span>        TimeChannels2 -->|Sender| RenderApp
</span><span>        TimeChannels2 -->|Receiver| MainApp
</span><span>    end
</span></code></pre><h2 id=key-files-changed>Key Files Changed</h2><h3 id=crates-bevy-render-src-extract-plugin-rs><code>crates/bevy_render/src/extract_plugin.rs</code></h3><p>This file contained the <code>ExtractPlugin</code> which was previously responsible for creating and inserting the time channels. The change removes this responsibility, keeping the plugin focused solely on data extraction.<p><strong>Code change:</strong><pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before:
</span><span style=color:#fa6e32>impl </span><span>Plugin </span><span style=color:#fa6e32>for </span><span style=color:#399ee6>ExtractPlugin </span><span>{
</span><span>    </span><span style=color:#fa6e32>fn </span><span style=color:#f29718>build</span><span>(</span><span style=color:#ed9366>&</span><span style=color:#ff8f40>self</span><span>, </span><span style=color:#ff8f40>app</span><span style=color:#61676ccc>: </span><span style=color:#ed9366>&</span><span style=color:#fa6e32>mut</span><span> App) {
</span><span>        </span><span style=color:#fa6e32>let</span><span> render_app </span><span style=color:#ed9366>=</span><span> app</span><span style=color:#ed9366>.</span><span style=color:#f07171>get_sub_app_mut</span><span>(RenderApp)</span><span style=color:#ed9366>.</span><span style=color:#f07171>unwrap</span><span>()</span><span style=color:#61676ccc>;
</span><span>        
</span><span>        </span><span style=color:#abb0b6;font-style:italic>// ... extraction setup code ...
</span><span>        
</span><span>        </span><span style=color:#fa6e32>let </span><span>(sender</span><span style=color:#61676ccc>,</span><span> receiver) </span><span style=color:#ed9366>= </span><span>bevy_time</span><span style=color:#ed9366>::</span><span>create_time_channels()</span><span style=color:#61676ccc>;
</span><span>        render_app</span><span style=color:#ed9366>.</span><span style=color:#f07171>insert_resource</span><span>(sender)</span><span style=color:#61676ccc>;
</span><span>        app</span><span style=color:#ed9366>.</span><span style=color:#f07171>insert_resource</span><span>(receiver)</span><span style=color:#61676ccc>;
</span><span>        app</span><span style=color:#ed9366>.</span><span style=color:#f07171>insert_sub_app</span><span>(RenderApp</span><span style=color:#61676ccc>,</span><span> render_app)</span><span style=color:#61676ccc>;
</span><span>    }
</span><span>}
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After:
</span><span style=color:#fa6e32>impl </span><span>Plugin </span><span style=color:#fa6e32>for </span><span style=color:#399ee6>ExtractPlugin </span><span>{
</span><span>    </span><span style=color:#fa6e32>fn </span><span style=color:#f29718>build</span><span>(</span><span style=color:#ed9366>&</span><span style=color:#ff8f40>self</span><span>, </span><span style=color:#ff8f40>app</span><span style=color:#61676ccc>: </span><span style=color:#ed9366>&</span><span style=color:#fa6e32>mut</span><span> App) {
</span><span>        </span><span style=color:#fa6e32>let</span><span> render_app </span><span style=color:#ed9366>=</span><span> app</span><span style=color:#ed9366>.</span><span style=color:#f07171>get_sub_app_mut</span><span>(RenderApp)</span><span style=color:#ed9366>.</span><span style=color:#f07171>unwrap</span><span>()</span><span style=color:#61676ccc>;
</span><span>        
</span><span>        </span><span style=color:#abb0b6;font-style:italic>// ... extraction setup code (time channel creation removed) ...
</span><span>        
</span><span>        app</span><span style=color:#ed9366>.</span><span style=color:#f07171>insert_sub_app</span><span>(RenderApp</span><span style=color:#61676ccc>,</span><span> render_app)</span><span style=color:#61676ccc>;
</span><span>    }
</span><span>}
</span></code></pre><h3 id=crates-bevy-render-src-lib-rs><code>crates/bevy_render/src/lib.rs</code></h3><p>This file contains the <code>RenderPlugin</code> which now takes responsibility for creating and inserting the time channels. This is a more appropriate location since the <code>RenderPlugin</code> handles overall render system configuration.<p><strong>Code change:</strong><pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before:
</span><span style=color:#fa6e32>impl </span><span>Plugin </span><span style=color:#fa6e32>for </span><span style=color:#399ee6>RenderPlugin </span><span>{
</span><span>    </span><span style=color:#fa6e32>fn </span><span style=color:#f29718>build</span><span>(</span><span style=color:#ed9366>&</span><span style=color:#ff8f40>self</span><span>, </span><span style=color:#ff8f40>app</span><span style=color:#61676ccc>: </span><span style=color:#ed9366>&</span><span style=color:#fa6e32>mut</span><span> App) {
</span><span>        </span><span style=color:#abb0b6;font-style:italic>// ... render setup code ...
</span><span>        
</span><span>        </span><span style=color:#abb0b6;font-style:italic>// No time channel creation here
</span><span>    }
</span><span>}
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After:
</span><span style=color:#fa6e32>impl </span><span>Plugin </span><span style=color:#fa6e32>for </span><span style=color:#399ee6>RenderPlugin </span><span>{
</span><span>    </span><span style=color:#fa6e32>fn </span><span style=color:#f29718>build</span><span>(</span><span style=color:#ed9366>&</span><span style=color:#ff8f40>self</span><span>, </span><span style=color:#ff8f40>app</span><span style=color:#61676ccc>: </span><span style=color:#ed9366>&</span><span style=color:#fa6e32>mut</span><span> App) {
</span><span>        </span><span style=color:#abb0b6;font-style:italic>// ... render setup code ...
</span><span>        
</span><span>        </span><span style=color:#fa6e32>let </span><span>(sender</span><span style=color:#61676ccc>,</span><span> receiver) </span><span style=color:#ed9366>= </span><span>bevy_time</span><span style=color:#ed9366>::</span><span>create_time_channels()</span><span style=color:#61676ccc>;
</span><span>        app</span><span style=color:#ed9366>.</span><span style=color:#f07171>insert_resource</span><span>(receiver)</span><span style=color:#61676ccc>;
</span><span>        
</span><span>        </span><span style=color:#fa6e32>if let </span><span style=color:#55b4d4;font-style:italic>Some</span><span>(render_app) </span><span style=color:#ed9366>=</span><span> app</span><span style=color:#ed9366>.</span><span style=color:#f07171>get_sub_app_mut</span><span>(RenderApp) {
</span><span>            </span><span style=color:#abb0b6;font-style:italic>// ... other render app setup ...
</span><span>            render_app</span><span style=color:#ed9366>.</span><span style=color:#f07171>insert_resource</span><span>(sender)</span><span style=color:#61676ccc>;
</span><span>            </span><span style=color:#abb0b6;font-style:italic>// ... more setup ...
</span><span>        }
</span><span>    }
</span><span>}
</span></code></pre><p>The key change is that <code>bevy_time::create_time_channels()</code> is now called in the <code>RenderPlugin</code>, with the receiver inserted into the main app and the sender inserted into the render app, exactly as before but from a different location.<h2 id=further-reading>Further Reading</h2><ol><li><strong>Bevy ECS and Plugin Architecture</strong>: The official Bevy book covers plugin architecture and the ECS system in detail: https://bevyengine.org/learn/book/plugins/<li><strong>Bevy Render Graph</strong>: Understanding Bevy’s render graph architecture provides context for why separate main and render worlds exist: https://bevyengine.org/learn/book/render/<li><strong>Resource Management in Bevy</strong>: The Bevy cheatbook has a section on resources which explains how resources like the time channels work: https://bevy-cheatbook.github.io/programming/res.html<li><strong>Sender-Receiver Pattern</strong>: While not Bevy-specific, understanding channel-based communication patterns helps understand the time synchronization approach: https://doc.rust-lang.org/book/ch16-02-message-passing.html</ol><h1 id=full-code-diff>Full Code Diff</h1><pre style=color:#61676c;background-color:#fafafa><code><span>diff --git a/crates/bevy_render/src/extract_plugin.rs b/crates/bevy_render/src/extract_plugin.rs
</span><span>index 79db16580c45b..458848ab0ac53 100644
</span><span>--- a/crates/bevy_render/src/extract_plugin.rs
</span><span>+++ b/crates/bevy_render/src/extract_plugin.rs
</span><span>@@ -70,9 +70,6 @@ impl Plugin for ExtractPlugin {
</span><span>             extract(main_world, render_world);
</span><span>         });
</span><span> 
</span><span>-        let (sender, receiver) = bevy_time::create_time_channels();
</span><span>-        render_app.insert_resource(sender);
</span><span>-        app.insert_resource(receiver);
</span><span>         app.insert_sub_app(RenderApp, render_app);
</span><span>     }
</span><span> }
</span><span>diff --git a/crates/bevy_render/src/lib.rs b/crates/bevy_render/src/lib.rs
</span><span>index 3a75044bcdd22..2cc2de3390982 100644
</span><span>--- a/crates/bevy_render/src/lib.rs
</span><span>+++ b/crates/bevy_render/src/lib.rs
</span><span>@@ -295,12 +295,16 @@ impl Plugin for RenderPlugin {
</span><span>             diagnostic::RenderDiagnosticsPlugin,
</span><span>         ));
</span><span> 
</span><span>+        let (sender, receiver) = bevy_time::create_time_channels();
</span><span>+        app.insert_resource(receiver);
</span><span>+
</span><span>         let asset_server = app.world().resource::&LTAssetServer>().clone();
</span><span>         app.init_resource::&LTRenderAssetBytesPerFrame>()
</span><span>             .init_resource::&LTRenderErrorHandler>();
</span><span>         if let Some(render_app) = app.get_sub_app_mut(RenderApp) {
</span><span>             render_app.init_resource::&LTRenderAssetBytesPerFrameLimiter>();
</span><span>             render_app.init_resource::&LTrenderer::PendingCommandBuffers>();
</span><span>+            render_app.insert_resource(sender);
</span><span>             render_app.insert_resource(asset_server);
</span><span>             render_app.insert_resource(RenderState::Initializing);
</span><span>             render_app.add_systems(
</span></code></pre></div><div data-is-md-page=true data-patch-exists=true data-patch-path=/pull_request/bevy/2026-02/pr_22950.patch id=patch-info style=display:none></div><div class=bottom-spacer></div></div></div>