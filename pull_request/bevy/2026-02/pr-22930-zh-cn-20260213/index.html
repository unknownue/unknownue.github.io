<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://unknownue.github.io name=base><title>
         #22930 Remove component/resource redundancies
        
    </title><meta content="#22930 Remove component/resource redundancies" property=og:title><meta content="A personal blog built with Zola and Apollo theme" property=og:description><meta content="A personal blog built with Zola and Apollo theme" name=description><link href=/icons/favicon.png rel=icon type=image/png><link href=https://unknownue.github.io/fonts.css rel=stylesheet><script src=https://unknownue.github.io/js/codeblock.js></script><script src=https://unknownue.github.io/js/toc.js></script><script src=https://unknownue.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Unknownue's Blog" href=https://unknownue.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://unknownue.github.io/theme/light.css rel=stylesheet><link href=https://unknownue.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://unknownue.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://unknownue.github.io/main.css media=screen rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js></script><script>// Initialize mermaid once DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            mermaid.initialize({
                startOnLoad: false,
                theme: document.body && document.body.classList.contains('dark') ? 'dark' : 'default',
                securityLevel: 'loose',
                flowchart: {
                    useMaxWidth: true,
                    htmlLabels: true
                },
                sequence: {
                    diagramMarginX: 50,
                    diagramMarginY: 10,
                    actorMargin: 50,
                    width: 150,
                    height: 65
                }
            });
        });</script><script src=https://unknownue.github.io/js/main.js></script><script defer src=https://unknownue.github.io/js/label-colors.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/rust.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/typescript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/go.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/cpp.min.js></script><script>// Ensure highlight.js is properly configured
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof hljs !== 'undefined') {
                hljs.configure({
                    languages: ['rust', 'javascript', 'python', 'cpp', 'go', 'typescript'],
                    ignoreUnescapedHTML: true
                });
                console.log('Highlight.js configured in header');
            }
        });</script><link href=https://cdn.jsdelivr.net/npm/diff2html/bundles/css/diff2html.min.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/diff2html/bundles/js/diff2html-ui.min.js></script><script src=https://unknownue.github.io/js/syntax-highlight.js></script><script src=https://unknownue.github.io/js/diff-sidebar.js></script><script src="https://unknownue.github.io/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><div class=content><header><div class=main><a href=https://unknownue.github.io>Unknownue's Blog</a><div class=socials><a class=social href=https://github.com/unknownue rel=me> <img alt=github src=https://unknownue.github.io/icons/social/github.svg> </a><a class=social href=https://github.com/unknownue/unknownue.github.io rel=me> <img alt=github-io src=https://unknownue.github.io/icons/social/rss.svg> </a></div></div><nav><a href=https://unknownue.github.io/posts style=margin-left:.25em>/posts</a><a href=https://unknownue.github.io/projects style=margin-left:.25em>/projects</a><a href=https://unknownue.github.io/about style=margin-left:.25em>/about</a><a href=https://unknownue.github.io/tags style=margin-left:.25em>/tags</a><button title="$SHORTCUT to open search" class=search-button id=search-button><img alt=Search class=search-icon src=https://unknownue.github.io/icons/search.svg></button><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><div id=modal-content><h1 class=page-header id=modalTitle>Search</h1><div id=searchBar><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search... role=combobox spellcheck=false><button title="Clear search" class=clear-button id=clear-search><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></button></div><div id=results-container><div id=results-info><span id=zero_results style=display:none>No results</span><span id=one_result style=display:none>1 result</span><span id=many_results style=display:none>$NUMBER results</span></div><div id=results role=listbox></div></div></div></div><a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://unknownue.github.io/icons/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://unknownue.github.io/icons/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><div class=pull-request-page><article class=md-content-page style=display:none></article><div class=back-link><a href=/pull_request/bevy/2026-02/>← Back to Pull Requests</a></div><div class=pr-metadata><span class=pr-date>2026-02-13</span><div class=language-switcher><a class=lang-link data-lang=en href=/pull_request/bevy/2026-02/pr-22930-en-20260213>English</a> / <span class="lang-link active" data-lang=zh-cn>中文</span></div></div><div class=pr-content><h1 id=remove-component-resource-redundancies>Remove component/resource redundancies</h1><h2 id=ji-ben-xin-xi>基本信息</h2><ul><li><strong>标题</strong>: Remove component/resource redundancies<li><strong>PR链接</strong>: https://github.com/bevyengine/bevy/pull/22930<li><strong>作者</strong>: cart<li><strong>状态</strong>: 已合并<li><strong>标签</strong>: A-ECS, C-Code-Quality<li><strong>创建时间</strong>: 2026-02-12T22:37:17Z<li><strong>合并时间</strong>: 2026-02-13T02:21:26Z<li><strong>合并者</strong>: cart</ul><h2 id=miao-shu-fan-yi>描述翻译</h2><p>属于 #19731 的一部分 是 #22919 和 #20934 的后续工作<p>这整合了我们的一些组件注册内部逻辑，并消除了其中存在的一些资源/组件冗余。<h2 id=zhe-ge-pull-requestde-gu-shi>这个Pull Request的故事</h2><p>这个PR是Bevy引擎Entity Component System（ECS）核心代码库持续清理和统一工作的一部分。其目标是解决组件和资源在底层标识与注册API上的历史性冗余。<p><strong>问题的根源</strong><p>在Bevy ECS中，资源和组件在概念和实现上有着紧密的联系。简单来说，一个<code>Resource</code>就是一种特殊的<code>Component</code>，它被存储在一个特定的、全局的Entity上，而不是与许多Entity关联。从实现角度看，<code>Resource</code> trait是<code>Component</code> trait的子trait。这意味着所有<code>Resource</code>类型在运行时都被系统视为<code>Component</code>，并共享相同的底层标识符——<code>ComponentId</code>。<p>尽管存在这种内在的统一，但在Bevy 0.19版本之前的API中，资源和组件却有两套平行的接口。例如，要获取一个类型的<code>ComponentId</code>，你可以调用<code>Components::component_id()</code>（针对组件）或<code>Components::resource_id()</code>（针对资源）。同样，也存在<code>valid_component_id</code>和<code>valid_resource_id</code>、<code>get_id</code>和<code>get_resource_id</code>等成对的方法。这种重复不仅增加了API的复杂性，也增加了维护负担，并且可能使新用户感到困惑。<p><strong>解决方案：统一API</strong><p>这个PR的主要策略是废弃所有专门用于资源的、重复的标识符获取和注册方法，并引导用户使用统一的组件API。由于<code>Resource</code>就是<code>Component</code>，用<code>component_id()</code>来获取资源的ID是完全合理且正确的。这样做简化了心智模型：你只需要考虑“组件ID”，而不用再区分“组件ID”和“资源ID”。<p>具体的做法是：<ol><li><strong>标记废弃</strong>：将所有专门的资源方法（如<code>resource_id</code>、<code>valid_resource_id</code>）标记为<code>#[deprecated]</code>，并指向其对应的通用组件方法。<li><strong>内部重构</strong>：更新引擎内部所有调用这些废弃方法的地方，改为使用统一的组件方法。<li><strong>清理注册逻辑</strong>：统一组件和资源的注册路径，移除为资源定制的冗余注册函数。</ol><p>让我们看一个核心的修改，它反映了这种哲学上的转变。在 <code>crates/bevy_ecs/src/component/info.rs</code> 中，<code>ComponentId</code> 的文档被更新，明确指出它同样适用于 <code>Resource</code>：<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#ed9366>-</span><span style=color:#abb0b6;font-style:italic>/// Given a type `T` which implements [`Component`], the `ComponentId` for `T` can be retrieved
</span><span style=color:#ed9366>+</span><span style=color:#abb0b6;font-style:italic>/// Given a type `T` which implements [`Component`] (including [`Resource`]), the `ComponentId` for `T` can be retrieved
</span><span> </span><span style=color:#abb0b6;font-style:italic>/// from a `World` using [`World::component_id()`](crate::world::World::component_id) or via [`Components::component_id()`].
</span><span style=color:#ed9366>-</span><span style=color:#abb0b6;font-style:italic>/// Access to the `ComponentId` for a [`Resource`] is available via [`Components::resource_id()`].
</span></code></pre><p>这个文档变更清晰地传达了新的统一概念。<p><strong>实现细节与简化</strong><p>这个PR不仅改变了公开API，也清理了内部实现。最大的改动发生在 <code>crates/bevy_ecs/src/component/register.rs</code> 中。之前，组件的排队注册和资源的排队注册有不同的内部函数（<code>register_arbitrary_component</code> 和 <code>register_arbitrary_resource</code>）。实际上，它们的逻辑几乎相同，都是将一个注册任务推入队列。<p>PR删除了<code>register_arbitrary_resource</code>函数，并将其所有调用替换为对<code>register_arbitrary_component</code>的调用。此外，它还将注册回调函数的类型从 <code>Box&LTdyn FnOnce(...)></code> 简化为了简单的函数指针 (<code>fn(...)</code>)。这是一个重要的内部优化，因为它消除了动态分配和trait对象带来的开销，使得回调更轻量、更高效。<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#ed9366>-    </span><span style=color:#fa6e32>pub</span><span>(</span><span style=color:#fa6e32>super</span><span>) registrator</span><span style=color:#61676ccc>: </span><span style=color:#55b4d4;font-style:italic>Box</span><span>&LTdyn </span><span style=color:#55b4d4;font-style:italic>FnOnce</span><span>(</span><span style=color:#ed9366>&</span><span style=color:#fa6e32>mut</span><span> ComponentsRegistrator, ComponentId, ComponentDescriptor)></span><span style=color:#61676ccc>,
</span><span style=color:#ed9366>+    </span><span style=color:#fa6e32>pub</span><span>(</span><span style=color:#fa6e32>super</span><span>) registrator</span><span style=color:#61676ccc>: </span><span style=color:#fa6e32>fn</span><span>(</span><span style=color:#ed9366>&</span><span style=color:#fa6e32>mut</span><span> ComponentsRegistrator</span><span style=color:#61676ccc>,</span><span> ComponentId</span><span style=color:#61676ccc>,</span><span> ComponentDescriptor)</span><span style=color:#61676ccc>,
</span></code></pre><p>类似地，<code>queue_register_resource</code>方法被简单重定向到<code>queue_register_component</code>：<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span>    </span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>inline</span><span>]
</span><span>    </span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>deprecated</span><span>(since </span><span style=color:#ed9366>= </span><span style=color:#86b300>"0.19.0"</span><span style=color:#61676ccc>,</span><span> note </span><span style=color:#ed9366>= </span><span style=color:#86b300>"use queue_register_component"</span><span>)]
</span><span>    </span><span style=color:#fa6e32>pub fn </span><span style=color:#f29718>queue_register_resource</span><span>&LTT</span><span style=color:#61676ccc>:</span><span> Resource>(</span><span style=color:#ed9366>&</span><span style=color:#ff8f40>self</span><span>) </span><span style=color:#61676ccc>-></span><span> ComponentId {
</span><span>        </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>queue_register_component</span><span style=color:#ed9366>::</span><span>&LTT>()
</span><span>    }
</span></code></pre><p><strong>影响与意义</strong><p>这个PR的影响是广泛的，但又是渐进式的。它通过废弃API而非立即移除，为现有用户提供了平滑的迁移路径。开发者会收到编译警告，提示他们将<code>resource_id()</code>改为<code>component_id()</code>。这种更改通常是机械式的，但能使代码与Bevy ECS更统一的心智模型保持一致。<p>从代码库健康度来看，这次修改带来了多重好处：<ol><li><strong>减少认知负荷</strong>：开发者现在只需记住一套用于获取ID的方法。<li><strong>减少代码体积</strong>：删除了大量重复的函数实现和文档。<li><strong>提高内部一致性</strong>：简化了注册机制的内部状态机。<li><strong>为未来铺路</strong>：这是迈向更统一、更灵活的ECS核心的又一步（如 #19731 所规划）。</ol><p>这次清理也凸显了一个重要的软件工程原则：当底层抽象统一时，应尽可能在API层面也反映这种统一，以避免不必要的概念重复和“陷阱门”（trap doors）。<h2 id=ke-shi-hua-biao-shi>可视化表示</h2><pre class=language-mermaid data-lang=mermaid style=color:#61676c;background-color:#fafafa><code class=language-mermaid data-lang=mermaid><span>graph TD
</span><span>    subgraph "统一前 (冗余API)"
</span><span>        A1[ComponentId] --> B1[Component API&LTbr/>component_id/valid_component_id/get_id]
</span><span>        A1 --> C1[Resource API&LTbr/>resource_id/valid_resource_id/get_resource_id]
</span><span>    end
</span><span>
</span><span>    subgraph "统一后 (简化API)"
</span><span>        A2[ComponentId] --> B2[统一 Component API&LTbr/>component_id/valid_component_id/get_id]
</span><span>        C2[Resource类型] -. 是 .-> D2[Component trait]
</span><span>        D2 --> B2
</span><span>    end
</span><span>
</span><span>    B1 -- “废弃并重定向” --> B2
</span><span>    C1 -- “废弃并重定向” --> B2
</span></code></pre><h2 id=guan-jian-wen-jian-bian-geng>关键文件变更</h2><ol><li><p><strong><code>crates/bevy_ecs/src/component/info.rs</code></strong> (+8/-6)</p> <ul><li><strong>变更描述</strong>：更新了<code>ComponentId</code>的文档，明确指出它也适用于<code>Resource</code>。将多个专门用于资源的方法标记为废弃，并重定向到其对应的通用组件方法。<li><strong>关键代码片段</strong>：<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// 文档更新，反映ComponentId对资源和组件的统一适用性
</span><span style=color:#abb0b6;font-style:italic>/// Given a type `T` which implements [`Component`] (including [`Resource`]), the `ComponentId` for `T` can be retrieved
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// 方法废弃示例
</span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>deprecated</span><span>(since </span><span style=color:#ed9366>= </span><span style=color:#86b300>"0.19.0"</span><span style=color:#61676ccc>,</span><span> note </span><span style=color:#ed9366>= </span><span style=color:#86b300>"use get_valid_id"</span><span>)]
</span><span style=color:#fa6e32>pub fn </span><span style=color:#f29718>get_valid_resource_id</span><span>(</span><span style=color:#ed9366>&</span><span style=color:#ff8f40>self</span><span>, </span><span style=color:#ff8f40>type_id</span><span style=color:#61676ccc>:</span><span> TypeId) </span><span style=color:#61676ccc>-> </span><span style=color:#55b4d4;font-style:italic>Option</span><span>&LTComponentId> {
</span><span>    </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>indices</span><span style=color:#ed9366>.</span><span style=color:#f07171>get</span><span>(</span><span style=color:#ed9366>&</span><span>type_id)</span><span style=color:#ed9366>.</span><span style=color:#f07171>copied</span><span>()
</span><span>}
</span><span>
</span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>deprecated</span><span>(since </span><span style=color:#ed9366>= </span><span style=color:#86b300>"0.19.0"</span><span style=color:#61676ccc>,</span><span> note </span><span style=color:#ed9366>= </span><span style=color:#86b300>"use valid_component_id"</span><span>)]
</span><span style=color:#fa6e32>pub fn </span><span style=color:#f29718>valid_resource_id</span><span>&LTT</span><span style=color:#61676ccc>:</span><span> Resource>(</span><span style=color:#ed9366>&</span><span style=color:#ff8f40>self</span><span>) </span><span style=color:#61676ccc>-> </span><span style=color:#55b4d4;font-style:italic>Option</span><span>&LTComponentId> {
</span><span>    </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span style=color:#f07171>get_valid_id</span><span>(TypeId</span><span style=color:#ed9366>::</span><span>of</span><span style=color:#ed9366>::</span><span>&LTT>()) </span><span style=color:#abb0b6;font-style:italic>// 直接调用通用方法
</span><span>}
</span></code></pre><li><strong>与PR目标的关联</strong>：这是统一API概念的核心体现，通过文档和方法重定向引导用户使用单一接口。</ul><li><p><strong><code>crates/bevy_ecs/src/component/register.rs</code></strong> (+19/-61)</p> <ul><li><strong>变更描述</strong>：大幅简化了排队注册的内部机制。删除了专门处理资源的<code>register_arbitrary_resource</code>函数，统一使用<code>register_arbitrary_component</code>。将回调类型从<code>Box&LTdyn FnOnce></code>优化为函数指针(<code>fn</code>)。废弃了<code>queue_register_resource</code>方法。<li><strong>关键代码片段</strong>：<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// 回调类型从堆分配的trait对象简化为函数指针
</span><span style=color:#ed9366>-    </span><span style=color:#fa6e32>pub</span><span>(</span><span style=color:#fa6e32>super</span><span>) registrator</span><span style=color:#61676ccc>: </span><span style=color:#55b4d4;font-style:italic>Box</span><span>&LTdyn </span><span style=color:#55b4d4;font-style:italic>FnOnce</span><span>(</span><span style=color:#ed9366>&</span><span style=color:#fa6e32>mut</span><span> ComponentsRegistrator, ComponentId, ComponentDescriptor)></span><span style=color:#61676ccc>,
</span><span style=color:#ed9366>+    </span><span style=color:#fa6e32>pub</span><span>(</span><span style=color:#fa6e32>super</span><span>) registrator</span><span style=color:#61676ccc>: </span><span style=color:#fa6e32>fn</span><span>(</span><span style=color:#ed9366>&</span><span style=color:#fa6e32>mut</span><span> ComponentsRegistrator</span><span style=color:#61676ccc>,</span><span> ComponentId</span><span style=color:#61676ccc>,</span><span> ComponentDescriptor)</span><span style=color:#61676ccc>,
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// 删除冗余的注册函数，统一入口
</span><span style=color:#ed9366>-    </span><span style=color:#fa6e32>unsafe fn </span><span style=color:#f29718>register_arbitrary_resource</span><span>(...) { </span><span style=color:#ed9366>... </span><span>}
</span><span style=color:#abb0b6;font-style:italic>// 所有调用点改为使用 register_arbitrary_component
</span></code></pre><li><strong>与PR目标的关联</strong>：这是消除内部冗余、统一注册流程和进行性能微优化的关键。</ul><li><p><strong><code>crates/bevy_ecs/src/world/mod.rs</code></strong> (+12/-11)</p> <ul><li><strong>变更描述</strong>：更新<code>World</code>的方法，使其内部实现也使用统一的组件标识符API。例如，<code>World::resource_id()</code>被标记为废弃并重定向到<code>component_id()</code>。<li><strong>关键代码片段</strong>：<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>deprecated</span><span>(since </span><span style=color:#ed9366>= </span><span style=color:#86b300>"0.19.0"</span><span style=color:#61676ccc>,</span><span> note </span><span style=color:#ed9366>= </span><span style=color:#86b300>"use component_id"</span><span>)]
</span><span style=color:#fa6e32>pub fn </span><span style=color:#f29718>resource_id</span><span>&LTT</span><span style=color:#61676ccc>:</span><span> Resource>(</span><span style=color:#ed9366>&</span><span style=color:#ff8f40>self</span><span>) </span><span style=color:#61676ccc>-> </span><span style=color:#55b4d4;font-style:italic>Option</span><span>&LTComponentId> {
</span><span>    </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>components</span><span style=color:#ed9366>.</span><span style=color:#f07171>get_id</span><span>(TypeId</span><span style=color:#ed9366>::</span><span>of</span><span style=color:#ed9366>::</span><span>&LTT>()) </span><span style=color:#abb0b6;font-style:italic>// 使用通用的 get_id
</span><span>}
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// 内部使用也改为统一方法
</span><span style=color:#fa6e32>pub fn </span><span style=color:#f29718>remove_resource</span><span>&LTR</span><span style=color:#61676ccc>:</span><span> Resource>(</span><span style=color:#ed9366>&</span><span style=color:#fa6e32>mut </span><span style=color:#ff8f40>self</span><span>) </span><span style=color:#61676ccc>-> </span><span style=color:#55b4d4;font-style:italic>Option</span><span>&LTR> {
</span><span>    </span><span style=color:#ed9366>- </span><span style=color:#fa6e32>let</span><span> resource_id </span><span style=color:#ed9366>= </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>resource_id</span><span style=color:#ed9366>::</span><span>&LTR>()</span><span style=color:#ed9366>?</span><span style=color:#61676ccc>;
</span><span>    </span><span style=color:#ed9366>+ </span><span style=color:#fa6e32>let</span><span> resource_id </span><span style=color:#ed9366>= </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>component_id</span><span style=color:#ed9366>::</span><span>&LTR>()</span><span style=color:#ed9366>?</span><span style=color:#61676ccc>; </span><span style=color:#abb0b6;font-style:italic>// 使用 component_id
</span><span>}
</span></code></pre><li><strong>与PR目标的关联</strong>：确保<code>World</code>这一主要用户接口也与新的统一API保持一致。</ul><li><p><strong><code>crates/bevy_ecs/src/world/filtered_resource.rs</code></strong> (+5/-5)</p> <ul><li><strong>变更描述</strong>：将<code>FilteredResources</code>和<code>FilteredResourcesMut</code>中检查资源访问权限的方法调用从<code>resource_id</code>/<code>valid_resource_id</code>更新为<code>component_id</code>/<code>valid_component_id</code>。<li><strong>与PR目标的关联</strong>：更新特定模块以使用新的统一API，保持整个代码库的一致性。</ul><li><p><strong><code>release-content/migration-guides/resources_as_components.md</code></strong></p> <ul><li><strong>变更描述</strong>：更新了迁移指南，记录了所有被废弃的API及其替代方法。这是帮助用户从旧API过渡的关键文档。<li><strong>与PR目标的关联</strong>：提供正式的用户 facing 文档，说明如何迁移代码以适配此PR引入的变更。</ul></ol><h2 id=jin-yi-bu-yue-du>进一步阅读</h2><ul><li><strong>PR #19731</strong>: <a rel="noopener nofollow noreferrer" href=https://github.com/bevyengine/bevy/pull/19731 target=_blank>RFC: Unify Resources and Components</a> - 这项长期工作的总纲，阐述了统一资源和组件的愿景。<li><strong>PR #22919</strong>: 本PR的直接前驱，可能包含相关的底层重构。<li><strong>PR #20934</strong>: 另一个相关的清理或统一工作。<li><strong>Bevy官方文档 - ECS部分</strong>：了解Bevy ECS的核心概念，包括<code>Component</code>、<code>Resource</code>和<code>World</code>。</ul></div><div data-is-md-page=true data-patch-exists=true data-patch-path=/pull_request/bevy/2026-02/pr_22930.patch id=patch-info style=display:none></div><div class=bottom-spacer></div></div></div>