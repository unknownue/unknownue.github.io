<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://unknownue.github.io name=base><title>
         #23102 Add component info to BRP registry schema
        
    </title><meta content="#23102 Add component info to BRP registry schema" property=og:title><meta content="A personal blog built with Zola and Apollo theme" property=og:description><meta content="A personal blog built with Zola and Apollo theme" name=description><link href=/icons/favicon.png rel=icon type=image/png><link href=https://unknownue.github.io/fonts.css rel=stylesheet><script src=https://unknownue.github.io/js/codeblock.js></script><script src=https://unknownue.github.io/js/toc.js></script><script src=https://unknownue.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Unknownue's Blog" href=https://unknownue.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://unknownue.github.io/theme/light.css rel=stylesheet><link href=https://unknownue.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://unknownue.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://unknownue.github.io/main.css media=screen rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js></script><script>// Initialize mermaid once DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            mermaid.initialize({
                startOnLoad: false,
                theme: document.body && document.body.classList.contains('dark') ? 'dark' : 'default',
                securityLevel: 'loose',
                flowchart: {
                    useMaxWidth: true,
                    htmlLabels: true
                },
                sequence: {
                    diagramMarginX: 50,
                    diagramMarginY: 10,
                    actorMargin: 50,
                    width: 150,
                    height: 65
                }
            });
        });</script><script src=https://unknownue.github.io/js/main.js></script><script defer src=https://unknownue.github.io/js/label-colors.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/rust.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/typescript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/go.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/cpp.min.js></script><script>// Ensure highlight.js is properly configured
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof hljs !== 'undefined') {
                hljs.configure({
                    languages: ['rust', 'javascript', 'python', 'cpp', 'go', 'typescript'],
                    ignoreUnescapedHTML: true
                });
                console.log('Highlight.js configured in header');
            }
        });</script><link href=https://cdn.jsdelivr.net/npm/diff2html/bundles/css/diff2html.min.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/diff2html/bundles/js/diff2html-ui.min.js></script><script src=https://unknownue.github.io/js/syntax-highlight.js></script><script src=https://unknownue.github.io/js/diff-sidebar.js></script><script src="https://unknownue.github.io/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><div class=content><header><div class=main><a href=https://unknownue.github.io>Unknownue's Blog</a><div class=socials><a class=social href=https://github.com/unknownue rel=me> <img alt=github src=https://unknownue.github.io/icons/social/github.svg> </a><a class=social href=https://github.com/unknownue/unknownue.github.io rel=me> <img alt=github-io src=https://unknownue.github.io/icons/social/rss.svg> </a></div></div><nav><a href=https://unknownue.github.io/posts style=margin-left:.25em>/posts</a><a href=https://unknownue.github.io/projects style=margin-left:.25em>/projects</a><a href=https://unknownue.github.io/about style=margin-left:.25em>/about</a><a href=https://unknownue.github.io/tags style=margin-left:.25em>/tags</a><button title="$SHORTCUT to open search" class=search-button id=search-button><img alt=Search class=search-icon src=https://unknownue.github.io/icons/search.svg></button><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><div id=modal-content><h1 class=page-header id=modalTitle>Search</h1><div id=searchBar><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search... role=combobox spellcheck=false><button title="Clear search" class=clear-button id=clear-search><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></button></div><div id=results-container><div id=results-info><span id=zero_results style=display:none>No results</span><span id=one_result style=display:none>1 result</span><span id=many_results style=display:none>$NUMBER results</span></div><div id=results role=listbox></div></div></div></div><a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://unknownue.github.io/icons/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://unknownue.github.io/icons/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><div class=pull-request-page><article class=md-content-page style=display:none></article><div class=back-link><a href=/pull_request/bevy/2026-03/>← Back to Pull Requests</a></div><div class=pr-metadata><span class=pr-date>2026-03-01</span><div class=language-switcher><span class="lang-link active" data-lang=en>English</span></div></div><div class=pr-content><h1 id=title>Title</h1><h2 id=basic-information>Basic Information</h2><ul><li><strong>Title</strong>: Add component info to BRP registry schema<li><strong>PR Link</strong>: https://github.com/bevyengine/bevy/pull/23102<li><strong>Author</strong>: splo<li><strong>Status</strong>: MERGED<li><strong>Labels</strong>: A-ECS, S-Ready-For-Final-Review, A-Dev-Tools, D-Straightforward<li><strong>Created</strong>: 2026-02-21T22:11:53Z<li><strong>Merged</strong>: 2026-03-01T21:11:31Z<li><strong>Merged By</strong>: alice-i-cecile</ul><h2 id=description-translation>Description Translation</h2><h1 id=objective>Objective</h1><p>Add component metadata to the BRP <code>registry.schema</code> method.<p>The following data related to components is missing and this PR adds it:<ul><li>Whether the component is mutable or not.<li>Type paths of required components.<li>Whether the component is a relationship or relationship target.</ul><p>Other metadata could easily be added, basically everything in the <a rel="noopener nofollow noreferrer" href=https://docs.rs/bevy/latest/bevy/ecs/component/struct.ComponentInfo.html target=_blank><code>ComponentInfo</code></a> type.<h2 id=solution>Solution</h2><ul><li>Once per type, use <code>World::components</code> to obtain a potential <code>ComponentId</code> and <code>ComponentInfo</code>.<li>Use it to fill the new <code>component_info</code> field.<li>It doesn’t introduce a breaking change, as the new field is optional and hidden for non-component types.</ul><h2 id=testing>Testing</h2><ul><li>I added a unit test. It verifies mutability, required components, and relationship kind for a few test components.<li>I also called BRP to retrieve a schema and verify the returned data is correct.</ul><hr><h2 id=showcase>Showcase</h2><p>Here are a few examples of the returned JSON schema when calling the BRP <code>registry.schema</code> method, with other fields omitted for brevity (they are unchanged):<pre class=language-json data-lang=json style=color:#61676c;background-color:#fafafa><code class=language-json data-lang=json><span>{
</span><span>  </span><span style=color:#86b300>"bevy_ecs::hierarchy::ChildOf"</span><span style=color:#61676ccc>: </span><span>{
</span><span>    </span><span style=color:#86b300>"componentInfo"</span><span style=color:#61676ccc>: </span><span>{
</span><span>      </span><span style=color:#86b300>"isSendAndSync"</span><span style=color:#61676ccc>: </span><span style=color:#ff8f40>true</span><span style=color:#61676ccc>,
</span><span>      </span><span style=color:#86b300>"mutable"</span><span style=color:#61676ccc>: </span><span style=color:#ff8f40>false</span><span style=color:#61676ccc>,
</span><span>      </span><span style=color:#86b300>"relationshipKind"</span><span style=color:#61676ccc>: </span><span style=color:#86b300>"Relationship"</span><span style=color:#61676ccc>,
</span><span>      </span><span style=color:#86b300>"storageType"</span><span style=color:#61676ccc>: </span><span style=color:#86b300>"Table"
</span><span>    }
</span><span>  }</span><span style=color:#61676ccc>,
</span><span>  </span><span style=color:#86b300>"bevy_ecs::hierarchy::Children"</span><span style=color:#61676ccc>: </span><span>{
</span><span>    </span><span style=color:#86b300>"componentInfo"</span><span style=color:#61676ccc>: </span><span>{
</span><span>      </span><span style=color:#86b300>"isSendAndSync"</span><span style=color:#61676ccc>: </span><span style=color:#ff8f40>true</span><span style=color:#61676ccc>,
</span><span>      </span><span style=color:#86b300>"mutable"</span><span style=color:#61676ccc>: </span><span style=color:#ff8f40>true</span><span style=color:#61676ccc>,
</span><span>      </span><span style=color:#86b300>"relationshipKind"</span><span style=color:#61676ccc>: </span><span style=color:#86b300>"RelationshipTarget"</span><span style=color:#61676ccc>,
</span><span>      </span><span style=color:#86b300>"storageType"</span><span style=color:#61676ccc>: </span><span style=color:#86b300>"Table"
</span><span>    }
</span><span>  }</span><span style=color:#61676ccc>,
</span><span>  </span><span style=color:#86b300>"bevy_transform::components::transform::Transform"</span><span style=color:#61676ccc>: </span><span>{
</span><span>    </span><span style=color:#86b300>"componentInfo"</span><span style=color:#61676ccc>: </span><span>{
</span><span>      </span><span style=color:#86b300>"isSendAndSync"</span><span style=color:#61676ccc>: </span><span style=color:#ff8f40>true</span><span style=color:#61676ccc>,
</span><span>      </span><span style=color:#86b300>"mutable"</span><span style=color:#61676ccc>: </span><span style=color:#ff8f40>true</span><span style=color:#61676ccc>,
</span><span>      </span><span style=color:#86b300>"requiredComponentTypes"</span><span style=color:#61676ccc>: </span><span>[
</span><span>        </span><span style=color:#86b300>"bevy_transform::components::global_transform::GlobalTransform"</span><span style=color:#61676ccc>,
</span><span>        </span><span style=color:#86b300>"bevy_transform::components::transform::TransformTreeChanged"
</span><span>      ]</span><span style=color:#61676ccc>,
</span><span>      </span><span style=color:#86b300>"storageType"</span><span style=color:#61676ccc>: </span><span style=color:#86b300>"Table"
</span><span>    }
</span><span>  }</span><span style=color:#61676ccc>,
</span><span>  </span><span style=color:#86b300>"bevy_render::sync_world::SyncToRenderWorld"</span><span style=color:#61676ccc>: </span><span>{
</span><span>    </span><span style=color:#86b300>"componentInfo"</span><span style=color:#61676ccc>: </span><span>{
</span><span>      </span><span style=color:#86b300>"isSendAndSync"</span><span style=color:#61676ccc>: </span><span style=color:#ff8f40>true</span><span style=color:#61676ccc>,
</span><span>      </span><span style=color:#86b300>"mutable"</span><span style=color:#61676ccc>: </span><span style=color:#ff8f40>true</span><span style=color:#61676ccc>,
</span><span>      </span><span style=color:#86b300>"storageType"</span><span style=color:#61676ccc>: </span><span style=color:#86b300>"SparseSet"
</span><span>    }
</span><span>  }
</span><span>}
</span></code></pre><h2 id=the-story-of-this-pull-request>The Story of This Pull Request</h2><p>The Bevy Remote Protocol (BRP) provides a way to introspect type information through its <code>registry.schema</code> method, which returns JSON schemas for registered types. Before this PR, the schema lacked important component-specific metadata that tools and external systems need to understand how components behave in the ECS.<p>The problem was that while the schema system captured general type information through reflection, it didn’t expose ECS-specific component characteristics. Specifically, there was no way to know if a component was mutable, what components it required, whether it used table or sparse set storage, or if it was part of a relationship system. This metadata is crucial for tools that need to understand component behavior without directly interacting with the ECS world.<p>The solution approach was straightforward: leverage the existing <code>ComponentInfo</code> structure that already contains all this metadata, and expose it through the JSON schema. The developer accessed the world’s <code>Components</code> resource, looked up the <code>ComponentInfo</code> for each type, and mapped it to a new <code>ComponentMetadata</code> structure in the schema. This approach is non-breaking because the new field is optional and only appears for component types.<p>The implementation required changes in two main areas. First, in <code>builtin_methods.rs</code>, the <code>export_registry_types</code> function needed to pass the <code>Components</code> resource from the world to the schema generation functions. This was done by adding <code>let components = world.components();</code> and modifying the call to <code>export_type</code> to include this parameter.<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// In builtin_methods.rs, line 1432
</span><span style=color:#fa6e32>let</span><span> components </span><span style=color:#ed9366>=</span><span> world</span><span style=color:#ed9366>.</span><span style=color:#f07171>components</span><span>()</span><span style=color:#61676ccc>;
</span><span style=color:#abb0b6;font-style:italic>// ...
</span><span style=color:#fa6e32>let </span><span>(id</span><span style=color:#61676ccc>,</span><span> schema) </span><span style=color:#ed9366>= </span><span style=color:#f07171>export_type</span><span>(type_reg</span><span style=color:#61676ccc>,</span><span> extra_info</span><span style=color:#61676ccc>,</span><span> components)</span><span style=color:#61676ccc>;
</span></code></pre><p>Second, in <code>json_schema.rs</code>, the schema generation logic was extended to handle component metadata. A new <code>ComponentMetadata</code> struct was added with fields for mutability, storage type, thread safety, required components, and relationship kind. The key conversion logic maps from Bevy’s internal <code>ComponentInfo</code> to this serializable structure:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// In json_schema.rs, lines 73-96
</span><span style=color:#fa6e32>let</span><span> component_info</span><span style=color:#61676ccc>: </span><span style=color:#55b4d4;font-style:italic>Option</span><span><</span><span style=color:#ed9366>&</span><span>ComponentInfo> </span><span style=color:#ed9366>=</span><span> components
</span><span>    </span><span style=color:#ed9366>.</span><span style=color:#f07171>get_valid_id</span><span>(t</span><span style=color:#ed9366>.</span><span style=color:#f07171>type_id</span><span>())
</span><span>    </span><span style=color:#ed9366>.</span><span style=color:#f07171>and_then</span><span>(|</span><span style=color:#ff8f40>component_id</span><span>| components</span><span style=color:#ed9366>.</span><span style=color:#f07171>get_info</span><span>(component_id))</span><span style=color:#61676ccc>;
</span><span>typed_schema</span><span style=color:#ed9366>.</span><span>component_info </span><span style=color:#ed9366>=</span><span> component_info</span><span style=color:#ed9366>.</span><span style=color:#f07171>map</span><span>(|</span><span style=color:#ff8f40>info</span><span>| {
</span><span>    </span><span style=color:#fa6e32>let</span><span> mutable </span><span style=color:#ed9366>=</span><span> info</span><span style=color:#ed9366>.</span><span style=color:#f07171>mutable</span><span>()</span><span style=color:#61676ccc>;
</span><span>    </span><span style=color:#fa6e32>let</span><span> storage_type </span><span style=color:#ed9366>=</span><span> info</span><span style=color:#ed9366>.</span><span style=color:#f07171>storage_type</span><span>()</span><span style=color:#ed9366>.</span><span style=color:#f07171>into</span><span>()</span><span style=color:#61676ccc>;
</span><span>    </span><span style=color:#fa6e32>let</span><span> is_send_and_sync </span><span style=color:#ed9366>=</span><span> info</span><span style=color:#ed9366>.</span><span style=color:#f07171>is_send_and_sync</span><span>()</span><span style=color:#61676ccc>;
</span><span>    </span><span style=color:#fa6e32>let</span><span> required_component_types </span><span style=color:#ed9366>=</span><span> info
</span><span>        </span><span style=color:#ed9366>.</span><span style=color:#f07171>required_components</span><span>()
</span><span>        </span><span style=color:#ed9366>.</span><span style=color:#f07171>iter_ids</span><span>()
</span><span>        </span><span style=color:#ed9366>.</span><span style=color:#f07171>flat_map</span><span>(|</span><span style=color:#ff8f40>component_id</span><span>| components</span><span style=color:#ed9366>.</span><span style=color:#f07171>get_info</span><span>(component_id))
</span><span>        </span><span style=color:#ed9366>.</span><span style=color:#f07171>map</span><span>(|</span><span style=color:#ff8f40>info</span><span style=color:#61676ccc>: </span><span style=color:#ed9366>&</span><span>ComponentInfo| info</span><span style=color:#ed9366>.</span><span style=color:#f07171>name</span><span>()</span><span style=color:#ed9366>.</span><span style=color:#f07171>to_string</span><span>())
</span><span>        </span><span style=color:#ed9366>.</span><span>collect</span><span style=color:#ed9366>::</span><span><</span><span style=color:#55b4d4;font-style:italic>Vec</span><span><</span><span style=color:#ed9366>_</span><span>>>()</span><span style=color:#61676ccc>;
</span><span>    </span><span style=color:#fa6e32>let</span><span> relationship_kind </span><span style=color:#ed9366>=</span><span> info
</span><span>        </span><span style=color:#ed9366>.</span><span style=color:#f07171>relationship_accessor</span><span>()
</span><span>        </span><span style=color:#ed9366>.</span><span style=color:#f07171>map</span><span>(|</span><span style=color:#ed9366>&</span><span style=color:#ff8f40>relationship</span><span>| relationship</span><span style=color:#ed9366>.</span><span style=color:#f07171>into</span><span>())</span><span style=color:#61676ccc>;
</span><span>    ComponentMetadata {
</span><span>        mutable</span><span style=color:#61676ccc>,
</span><span>        storage_type</span><span style=color:#61676ccc>,
</span><span>        is_send_and_sync</span><span style=color:#61676ccc>,
</span><span>        required_component_types</span><span style=color:#61676ccc>,
</span><span>        relationship_kind</span><span style=color:#61676ccc>,
</span><span>    }
</span><span>})</span><span style=color:#61676ccc>;
</span></code></pre><p>An important technical consideration was how to handle required components. The implementation resolves component IDs to their type names by looking up each required component in the <code>Components</code> resource and extracting its name. This ensures that the schema contains human-readable type paths rather than opaque IDs.<p>The test suite was expanded with a comprehensive unit test that validates the new functionality. The test creates two components with specific characteristics: one with required components and relationship attributes, and another with sparse set storage. It then verifies that the generated schema contains the correct metadata:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>test</span><span>]
</span><span style=color:#fa6e32>fn </span><span style=color:#f29718>export_registry_types_with_reliationship</span><span>() {
</span><span>    </span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>derive</span><span>(Component</span><span style=color:#61676ccc>,</span><span> Debug</span><span style=color:#61676ccc>,</span><span> Reflect)]
</span><span>    </span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>reflect</span><span>(Component</span><span style=color:#61676ccc>,</span><span> Debug)]
</span><span>    </span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>require</span><span>(bevy_ecs::name::Name)]
</span><span>    </span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>relationship</span><span>(relationship_target </span><span style=color:#ed9366>=</span><span> FollowedBy)]
</span><span>    </span><span style=color:#fa6e32>struct </span><span style=color:#399ee6>Following</span><span>(Entity)</span><span style=color:#61676ccc>;
</span><span>    
</span><span>    </span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>derive</span><span>(Component</span><span style=color:#61676ccc>,</span><span> Debug</span><span style=color:#61676ccc>,</span><span> Reflect)]
</span><span>    </span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>component</span><span>(storage </span><span style=color:#ed9366>= </span><span style=color:#86b300>"SparseSet"</span><span>)]
</span><span>    </span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>reflect</span><span>(Component</span><span style=color:#61676ccc>,</span><span> Debug)]
</span><span>    </span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>relationship_target</span><span>(relationship </span><span style=color:#ed9366>=</span><span> Following)]
</span><span>    </span><span style=color:#fa6e32>struct </span><span style=color:#399ee6>FollowedBy</span><span>(</span><span style=color:#55b4d4;font-style:italic>Vec</span><span>&LTEntity>)</span><span style=color:#61676ccc>;
</span><span>    
</span><span>    </span><span style=color:#abb0b6;font-style:italic>// ... test setup and assertions
</span><span>}
</span></code></pre><p>The impact of this change is significant for tooling and external systems that consume BRP schemas. Now they can understand component constraints and relationships without needing to parse Rust attributes or understand the internal ECS implementation. This enables better editor tooling, documentation generation, and runtime analysis tools.<p>One technical insight from this implementation is the clean separation between reflection metadata (which handles type structure) and component metadata (which handles ECS behavior). The PR maintains this separation by adding component information as an optional field that only appears for types that are actually registered as components in the ECS world.<p>The implementation also demonstrates good API design by making the new field optional and using camelCase JSON field names (<code>componentInfo</code>) to match JavaScript conventions, since the schema is primarily consumed by web-based tools.<h2 id=visual-representation>Visual Representation</h2><pre class=language-mermaid data-lang=mermaid style=color:#61676c;background-color:#fafafa><code class=language-mermaid data-lang=mermaid><span>graph TD
</span><span>    A[BRP registry.schema Method] --> B[export_registry_types Function]
</span><span>    B --> C[World.components() Resource]
</span><span>    C --> D[export_type Function]
</span><span>    D --> E[ComponentInfo Lookup]
</span><span>    E --> F[ComponentMetadata Creation]
</span><span>    F --> G[JSON Schema with componentInfo]
</span><span>    
</span><span>    H[TypeRegistry] --> D
</span><span>    I[SchemaTypesMetadata] --> D
</span><span>    
</span><span>    style G fill:#e1f5e1
</span><span>    style C fill:#e3f2fd
</span></code></pre><h2 id=key-files-changed>Key Files Changed</h2><h3 id=crates-bevy-remote-src-schemas-json-schema-rs-123-12><code>crates/bevy_remote/src/schemas/json_schema.rs</code> (+123/-12)</h3><p>This file contains the core schema definitions and the logic for converting Bevy types to JSON schema. The main changes include:<ol><li>Added new data structures for component metadata:</ol><pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>derive</span><span>(Debug</span><span style=color:#61676ccc>,</span><span> Serialize</span><span style=color:#61676ccc>,</span><span> Deserialize</span><span style=color:#61676ccc>,</span><span> Clone</span><span style=color:#61676ccc>,</span><span> PartialEq</span><span style=color:#61676ccc>,</span><span> Default)]
</span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>serde</span><span>(rename_all </span><span style=color:#ed9366>= </span><span style=color:#86b300>"camelCase"</span><span>)]
</span><span style=color:#fa6e32>pub struct </span><span style=color:#399ee6>ComponentMetadata </span><span>{
</span><span>    </span><span style=color:#fa6e32>pub </span><span>mutable</span><span style=color:#61676ccc>: </span><span style=color:#fa6e32>bool</span><span>,
</span><span>    </span><span style=color:#fa6e32>pub </span><span>storage_type</span><span style=color:#61676ccc>:</span><span> StorageKind,
</span><span>    </span><span style=color:#fa6e32>pub </span><span>is_send_and_sync</span><span style=color:#61676ccc>: </span><span style=color:#fa6e32>bool</span><span>,
</span><span>    </span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>serde</span><span>(skip_serializing_if </span><span style=color:#ed9366>= </span><span style=color:#86b300>"Vec::is_empty"</span><span style=color:#61676ccc>,</span><span> default)]
</span><span>    </span><span style=color:#fa6e32>pub </span><span>required_component_types</span><span style=color:#61676ccc>: </span><span style=color:#55b4d4;font-style:italic>Vec</span><span><</span><span style=color:#55b4d4;font-style:italic>String</span><span>>,
</span><span>    </span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>serde</span><span>(skip_serializing_if </span><span style=color:#ed9366>= </span><span style=color:#86b300>"Option::is_none"</span><span style=color:#61676ccc>,</span><span> default)]
</span><span>    </span><span style=color:#fa6e32>pub </span><span>relationship_kind</span><span style=color:#61676ccc>: </span><span style=color:#55b4d4;font-style:italic>Option</span><span>&LTRelationshipKind>,
</span><span>}
</span><span>
</span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>derive</span><span>(Debug</span><span style=color:#61676ccc>,</span><span> Serialize</span><span style=color:#61676ccc>,</span><span> Deserialize</span><span style=color:#61676ccc>,</span><span> Clone</span><span style=color:#61676ccc>,</span><span> PartialEq</span><span style=color:#61676ccc>,</span><span> Default)]
</span><span style=color:#fa6e32>pub enum </span><span style=color:#399ee6>StorageKind </span><span>{
</span><span>    </span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>default</span><span>]
</span><span>    Table</span><span style=color:#61676ccc>,
</span><span>    SparseSet</span><span style=color:#61676ccc>,
</span><span>}
</span><span>
</span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>derive</span><span>(Debug</span><span style=color:#61676ccc>,</span><span> Serialize</span><span style=color:#61676ccc>,</span><span> Deserialize</span><span style=color:#61676ccc>,</span><span> Clone</span><span style=color:#61676ccc>,</span><span> PartialEq)]
</span><span style=color:#fa6e32>pub enum </span><span style=color:#399ee6>RelationshipKind </span><span>{
</span><span>    Relationship</span><span style=color:#61676ccc>,
</span><span>    RelationshipTarget</span><span style=color:#61676ccc>,
</span><span>}
</span></code></pre><ol start=2><li>Modified the <code>JsonSchemaBevyType</code> struct to include the new optional field:</ol><pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#fa6e32>pub struct </span><span style=color:#399ee6>JsonSchemaBevyType </span><span>{
</span><span>    </span><span style=color:#abb0b6;font-style:italic>// ... existing fields
</span><span>    </span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>serde</span><span>(skip_serializing_if </span><span style=color:#ed9366>= </span><span style=color:#86b300>"Option::is_none"</span><span style=color:#61676ccc>,</span><span> default)]
</span><span>    </span><span style=color:#fa6e32>pub </span><span>component_info</span><span style=color:#61676ccc>: </span><span style=color:#55b4d4;font-style:italic>Option</span><span>&LTComponentMetadata>,
</span><span>}
</span></code></pre><ol start=3><li>Updated the <code>From</code> implementation to accept <code>Components</code> and populate component metadata.</ol><h3 id=crates-bevy-remote-src-builtin-methods-rs-69-1><code>crates/bevy_remote/src/builtin_methods.rs</code> (+69/-1)</h3><p>This file contains the BRP built-in methods implementation. The key changes are:<ol><li>Modified <code>export_registry_types</code> to pass the <code>Components</code> resource:</ol><pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before:
</span><span style=color:#fa6e32>let </span><span>(id</span><span style=color:#61676ccc>,</span><span> schema) </span><span style=color:#ed9366>= </span><span style=color:#f07171>export_type</span><span>(type_reg</span><span style=color:#61676ccc>,</span><span> extra_info)</span><span style=color:#61676ccc>;
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After:
</span><span style=color:#fa6e32>let</span><span> components </span><span style=color:#ed9366>=</span><span> world</span><span style=color:#ed9366>.</span><span style=color:#f07171>components</span><span>()</span><span style=color:#61676ccc>;
</span><span style=color:#fa6e32>let </span><span>(id</span><span style=color:#61676ccc>,</span><span> schema) </span><span style=color:#ed9366>= </span><span style=color:#f07171>export_type</span><span>(type_reg</span><span style=color:#61676ccc>,</span><span> extra_info</span><span style=color:#61676ccc>,</span><span> components)</span><span style=color:#61676ccc>;
</span></code></pre><ol start=2><li>Added a comprehensive unit test that validates the new component metadata functionality with actual component definitions and assertions about the generated schema.</ol><h2 id=further-reading>Further Reading</h2><ul><li><a rel="noopener nofollow noreferrer" href=https://docs.rs/bevy/latest/bevy/ecs/component/index.html target=_blank>Bevy ECS Component Documentation</a> - Understanding component metadata and storage types<li><a rel="noopener nofollow noreferrer" href=https://github.com/bevyengine/bevy/tree/main/crates/bevy_remote target=_blank>Bevy Remote Protocol</a> - Overview of BRP capabilities<li><a rel="noopener nofollow noreferrer" href=https://json-schema.org/ target=_blank>JSON Schema Specification</a> - Standard for describing JSON data structures<li><a rel="noopener nofollow noreferrer" href=https://bevy-cheatbook.github.io/programming/reflection.html target=_blank>Bevy Reflect System</a> - How Bevy’s reflection system works</ul></div><div data-is-md-page=true data-patch-exists=true data-patch-path=/pull_request/bevy/2026-03/pr_23102.patch id=patch-info style=display:none></div><div class=bottom-spacer></div></div></div>