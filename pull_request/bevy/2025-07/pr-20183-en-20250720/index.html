<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://unknownue.github.io name=base><title>
         #20183 stop exposing minimp3
        
    </title><meta content="#20183 stop exposing minimp3" property=og:title><meta content="A personal blog built with Zola and Apollo theme" property=og:description><meta content="A personal blog built with Zola and Apollo theme" name=description><link href=/icons/favicon.png rel=icon type=image/png><link href=https://unknownue.github.io/fonts.css rel=stylesheet><script src=https://unknownue.github.io/js/codeblock.js></script><script src=https://unknownue.github.io/js/toc.js></script><script src=https://unknownue.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Unknownue's Blog" href=https://unknownue.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://unknownue.github.io/theme/light.css rel=stylesheet><link href=https://unknownue.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://unknownue.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://unknownue.github.io/main.css media=screen rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js></script><script>// Initialize mermaid once DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            mermaid.initialize({
                startOnLoad: false,
                theme: document.body && document.body.classList.contains('dark') ? 'dark' : 'default',
                securityLevel: 'loose',
                flowchart: {
                    useMaxWidth: true,
                    htmlLabels: true
                },
                sequence: {
                    diagramMarginX: 50,
                    diagramMarginY: 10,
                    actorMargin: 50,
                    width: 150,
                    height: 65
                }
            });
        });</script><script src=https://unknownue.github.io/js/main.js></script><script defer src=https://unknownue.github.io/js/label-colors.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/rust.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/typescript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/go.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/cpp.min.js></script><script>// Ensure highlight.js is properly configured
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof hljs !== 'undefined') {
                hljs.configure({
                    languages: ['rust', 'javascript', 'python', 'cpp', 'go', 'typescript'],
                    ignoreUnescapedHTML: true
                });
                console.log('Highlight.js configured in header');
            }
        });</script><link href=https://cdn.jsdelivr.net/npm/diff2html/bundles/css/diff2html.min.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/diff2html/bundles/js/diff2html-ui.min.js></script><script src=https://unknownue.github.io/js/syntax-highlight.js></script><script src=https://unknownue.github.io/js/diff-sidebar.js></script><script src="https://unknownue.github.io/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><div class=content><header><div class=main><a href=https://unknownue.github.io>Unknownue's Blog</a><div class=socials><a class=social href=https://github.com/unknownue rel=me> <img alt=github src=https://unknownue.github.io/icons/social/github.svg> </a><a class=social href=https://github.com/unknownue/unknownue.github.io rel=me> <img alt=github-io src=https://unknownue.github.io/icons/social/rss.svg> </a></div></div><nav><a href=https://unknownue.github.io/posts style=margin-left:.25em>/posts</a><a href=https://unknownue.github.io/projects style=margin-left:.25em>/projects</a><a href=https://unknownue.github.io/about style=margin-left:.25em>/about</a><a href=https://unknownue.github.io/tags style=margin-left:.25em>/tags</a><button title="$SHORTCUT to open search" class=search-button id=search-button><img alt=Search class=search-icon src=https://unknownue.github.io/icons/search.svg></button><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><div id=modal-content><h1 class=page-header id=modalTitle>Search</h1><div id=searchBar><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search... role=combobox spellcheck=false><button title="Clear search" class=clear-button id=clear-search><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></button></div><div id=results-container><div id=results-info><span id=zero_results style=display:none>No results</span><span id=one_result style=display:none>1 result</span><span id=many_results style=display:none>$NUMBER results</span></div><div id=results role=listbox></div></div></div></div><a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://unknownue.github.io/icons/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://unknownue.github.io/icons/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><div class=pull-request-page><article class=md-content-page style=display:none></article><div class=back-link><a href=/pull_request/bevy/2025-07/>← Back to Pull Requests</a></div><div class=pr-metadata><span class=pr-date>2025-07-20</span><div class=language-switcher><span class="lang-link active" data-lang=en>English</span> / <a class=lang-link data-lang=zh-cn href=/pull_request/bevy/2025-07/pr-20183-zh-cn-20250720>中文</a></div></div><div class=pr-content><h1 id=technical-analysis-stop-exposing-minimp3>Technical Analysis: stop exposing minimp3</h1><h2 id=basic-information>Basic Information</h2><ul><li><strong>Title</strong>: stop exposing minimp3<li><strong>PR Link</strong>: https://github.com/bevyengine/bevy/pull/20183<li><strong>Author</strong>: mockersf<li><strong>Status</strong>: MERGED<li><strong>Labels</strong>: A-Audio, C-Dependencies, S-Ready-For-Final-Review, M-Needs-Migration-Guide<li><strong>Created</strong>: 2025-07-17T22:00:07Z<li><strong>Merged</strong>: 2025-07-20T18:30:37Z<li><strong>Merged By</strong>: alice-i-cecile</ul><h2 id=description-translation>Description Translation</h2><h1 id=objective>Objective</h1><ul><li>Fixes #20181</ul><h2 id=solution>Solution</h2><ul><li>Stop exposing rodio support of mp3 through minimp3. rodio defaults to symphonia for mp3 now. People who really want an unsecured way to play mp3 that doesn’t work in wasm and will get their app rejected from the iOS App Store can still enable it manually by adding a dependency on rodio</ul><h2 id=the-story-of-this-pull-request>The Story of This Pull Request</h2><p>The core issue addressed in this PR (#20181) centered around Bevy’s continued exposure of the <code>minimp3</code> feature for MP3 audio decoding. This dependency had several significant drawbacks that made it unsuitable as a default option. The minimp3 library is no longer actively maintained, contains known security vulnerabilities, doesn’t function in WebAssembly environments, and has been known to cause application rejections from the Apple App Store due to its security flaws.<p>Historically, Bevy’s audio system used rodio for audio decoding, which previously relied on minimp3 for MP3 support. However, rodio has since transitioned to using symphonia as its default MP3 decoder. This shift meant that Bevy’s continued exposure of minimp3 was redundant and potentially harmful, as it encouraged use of an inferior and insecure decoding option when a better alternative was already available through the same dependency.<p>The solution implemented was straightforward: completely remove the <code>minimp3</code> feature flag from Bevy’s public interface. This involved deleting:<ol><li>The feature declaration from Bevy’s top-level Cargo.toml<li>The feature mapping in bevy_audio’s Cargo.toml<li>The feature exposure in bevy_internal’s Cargo.toml<li>The documentation reference in cargo_features.md</ol><p>Crucially, the standard <code>mp3</code> feature remains available and now transparently uses rodio’s symphonia backend instead of minimp3. This change maintains MP3 support while removing the problematic minimp3 pathway. For developers who specifically require minimp3 despite its drawbacks (perhaps for compatibility with existing assets or specialized use cases), the PR includes a migration guide explaining how to manually add rodio with minimp3 support:<pre class=language-toml data-lang=toml style=color:#61676c;background-color:#fafafa><code class=language-toml data-lang=toml><span>[</span><span style=color:#399ee6>dependencies</span><span>]
</span><span style=color:#399ee6>rodio </span><span>= { </span><span style=color:#399ee6>version </span><span>= </span><span style=color:#86b300>"0.20"</span><span style=color:#61676ccc>, </span><span style=color:#399ee6>features </span><span>= [</span><span style=color:#86b300>"minimp3"</span><span>] }
</span></code></pre><p>This approach balances several technical considerations:<ol><li>Security: Eliminates exposure of a library with known vulnerabilities<li>Maintenance: Reduces Bevy’s maintenance surface by removing a deprecated code path<li>Compatibility: Maintains MP3 support through the more robust symphonia backend<li>Flexibility: Allows specialized use cases through direct dependency management</ol><p>The technical impact is a cleaner dependency tree and more secure defaults. The <code>minimp3</code> feature was completely removed from Bevy’s public API, meaning projects relying on it will need to either migrate to the standard <code>mp3</code> feature or explicitly add rodio with minimp3 support. The migration guide provides clear steps for both paths.<h2 id=visual-representation>Visual Representation</h2><pre class=language-mermaid data-lang=mermaid style=color:#61676c;background-color:#fafafa><code class=language-mermaid data-lang=mermaid><span>graph LR
</span><span>    Bevy[Bevy Audio System] --> Rodio[Rodio Decoder]
</span><span>    Rodio -->|Default| Symphonia[MP3 via Symphonia]
</span><span>    Rodio -->|Optional| MiniMP3[MP3 via MiniMP3]
</span><span>    style MiniMP3 stroke:red,stroke-width:2px,stroke-dasharray:5,5
</span><span>    linkStyle 2 stroke:red,stroke-width:1px,stroke-dasharray:5,5
</span></code></pre><p>The diagram shows how Bevy’s audio system interacts with Rodio. The solid line represents the default MP3 decoding path via Symphonia, while the dashed red line shows the now-removed MiniMP3 pathway that requires explicit opt-in.<h2 id=key-files-changed>Key Files Changed</h2><h3 id=release-content-migration-guides-stop-exposing-minimp3-md>release-content/migration-guides/stop-exposing-minimp3.md</h3><pre class=language-markdown data-lang=markdown style=color:#61676c;background-color:#fafafa><code class=language-markdown data-lang=markdown><span style=color:#abb0b6;background-color:#61676c10;font-weight:700>---
</span><span>title: Stop exposing mp3 support through minimp3
</span><span>pull_requests: [20183]
</span><span style=color:#fa6e32;font-weight:700>---
</span><span>
</span><span>The </span><span style=color:#ed9366;background-color:#61676c10>`minimp3`</span><span> feature is no longer exposed from Bevy. Bevy still supports mp3 through the </span><span style=color:#ed9366;background-color:#61676c10>`mp3`</span><span> feature.
</span><span>
</span><span>If you were relying on something specific to </span><span style=color:#ed9366;background-color:#61676c10>`minimp3`</span><span>, you can still enable it by adding a dependency to </span><span style=color:#ed9366;background-color:#61676c10>`rodio`</span><span> with the </span><span style=color:#ed9366;background-color:#61676c10>`minimp3`</span><span> feature:
</span><span>
</span><span>```</span><span style=color:#ff8f40>toml
</span><span style=color:#61676c;background-color:#61676c07>[dependencies]
</span><span style=color:#61676c;background-color:#61676c07>rodio = { version = "0.20", features = ["minimp3"] }
</span></code></pre><p>This is best to avoid though, as <code>minimp3</code> is not actively maintained, doesn’t work in wasm, has been known to cause application rejection from the Apple App Store, and has a few security vulnerabilities.<pre style=color:#61676c;background-color:#fafafa><code><span>
</span><span>**Purpose**: Provides migration instructions for users affected by the removal. Explains how to manually enable minimp3 if absolutely necessary while strongly recommending against it due to security and compatibility concerns.
</span><span>
</span><span>### Cargo.toml
</span><span>```diff
</span><span>diff --git a/Cargo.toml b/Cargo.toml
</span><span>index 0b64a82ed330a..c7a03998db982 100644
</span><span>--- a/Cargo.toml
</span><span>+++ b/Cargo.toml
</span><span>@@ -407,9 +407,6 @@ vorbis = ["bevy_internal/vorbis"]
</span><span> # WAV audio format support
</span><span> wav = ["bevy_internal/wav"]
</span><span> 
</span><span>-# MP3 audio format support (through minimp3)
</span><span>-minimp3 = ["bevy_internal/minimp3"]
</span><span>-
</span><span> # AAC audio format support (through symphonia)
</span><span> symphonia-aac = ["bevy_internal/symphonia-aac"]
</span></code></pre><p><strong>Purpose</strong>: Removes the top-level minimp3 feature declaration from Bevy’s main manifest. This eliminates the feature from Bevy’s public API.<h3 id=crates-bevy-audio-cargo-toml>crates/bevy_audio/Cargo.toml</h3><pre class=language-diff data-lang=diff style=color:#61676c;background-color:#fafafa><code class=language-diff data-lang=diff><span>diff --git a/crates/bevy_audio/Cargo.toml b/crates/bevy_audio/Cargo.toml
</span><span>index 8beba77c0dfa7..d8a72c1a7b38f 100644
</span><span style=color:#c594c5>--- a/crates/bevy_audio/Cargo.toml
</span><span style=color:#c594c5>+++ b/crates/bevy_audio/Cargo.toml
</span><span style=color:#c594c5>@@ -47,7 +47,6 @@ </span><span style=color:#399ee6>mp3 = ["rodio/mp3"]
</span><span> flac = ["rodio/flac"]
</span><span> wav = ["rodio/wav"]
</span><span> vorbis = ["rodio/vorbis"]
</span><span style=color:#f07171>-minimp3 = ["rodio/minimp3"]
</span><span> symphonia-aac = ["rodio/symphonia-aac"]
</span><span> symphonia-all = ["rodio/symphonia-all"]
</span><span> symphonia-flac = ["rodio/symphonia-flac"]
</span></code></pre><p><strong>Purpose</strong>: Removes the minimp3 feature mapping in the audio crate. This severs the connection between Bevy’s feature flags and rodio’s minimp3 implementation.<h3 id=crates-bevy-internal-cargo-toml>crates/bevy_internal/Cargo.toml</h3><pre class=language-diff data-lang=diff style=color:#61676c;background-color:#fafafa><code class=language-diff data-lang=diff><span>diff --git a/crates/bevy_internal/Cargo.toml b/crates/bevy_internal/Cargo.toml
</span><span>index e591803751f7d..5f2bddb602a1e 100644
</span><span style=color:#c594c5>--- a/crates/bevy_internal/Cargo.toml
</span><span style=color:#c594c5>+++ b/crates/bevy_internal/Cargo.toml
</span><span style=color:#c594c5>@@ -78,7 +78,6 @@ </span><span style=color:#399ee6>flac = ["bevy_audio/flac"]
</span><span> mp3 = ["bevy_audio/mp3"]
</span><span> vorbis = ["bevy_audio/vorbis"]
</span><span> wav = ["bevy_audio/wav"]
</span><span style=color:#f07171>-minimp3 = ["bevy_audio/minimp3"]
</span><span> symphonia-aac = ["bevy_audio/symphonia-aac"]
</span><span> symphonia-all = ["bevy_audio/symphonia-all"]
</span><span> symphonia-flac = ["bevy_audio/symphonia-flac"]
</span></code></pre><p><strong>Purpose</strong>: Removes the internal feature mapping that connected the top-level minimp3 feature to the audio crate’s implementation.<h3 id=docs-cargo-features-md>docs/cargo_features.md</h3><pre class=language-diff data-lang=diff style=color:#61676c;background-color:#fafafa><code class=language-diff data-lang=diff><span>diff --git a/docs/cargo_features.md b/docs/cargo_features.md
</span><span>index 120c461efe378..96edd47522c1c 100644
</span><span style=color:#c594c5>--- a/docs/cargo_features.md
</span><span style=color:#c594c5>+++ b/docs/cargo_features.md
</span><span style=color:#c594c5>@@ -98,7 +98,6 @@ </span><span style=color:#399ee6>The default feature set enables most of the expected features of a game engine,
</span><span> |libm|Uses the `libm` maths library instead of the one provided in `std` and `core`.|
</span><span> |meshlet|Enables the meshlet renderer for dense high-poly scenes (experimental)|
</span><span> |meshlet_processor|Enables processing meshes into meshlet meshes for bevy_pbr|
</span><span style=color:#f07171>-|minimp3|MP3 audio format support (through minimp3)|
</span><span> |mp3|MP3 audio format support|
</span><span> |pbr_anisotropy_texture|Enable support for anisotropy texture in the `StandardMaterial`, at the risk of blowing past the global, per-shader texture limit on older/lower-end GPUs|
</span><span> |pbr_clustered_decals|Enable support for Clustered Decals|
</span></code></pre><p><strong>Purpose</strong>: Updates the feature documentation to reflect the removal of minimp3, preventing confusion about available audio features.<h2 id=further-reading>Further Reading</h2><ol><li><a rel="noopener nofollow noreferrer" href=https://docs.rs/rodio/latest/rodio/ target=_blank>Rodio documentation</a>: Understanding Bevy’s underlying audio library<li><a rel="noopener nofollow noreferrer" href=https://docs.rs/symphonia/latest/symphonia/ target=_blank>Symphonia documentation</a>: The modern audio decoding library used by Rodio<li><a rel="noopener nofollow noreferrer" href=https://doc.rust-lang.org/cargo/reference/features.html target=_blank>Cargo Features documentation</a>: How feature flags work in Rust<li><a rel="noopener nofollow noreferrer" href=https://github.com/bevyengine/bevy/issues/20181 target=_blank>Issue #20181</a>: Original issue detailing problems with minimp3<li><a rel="noopener nofollow noreferrer" href=https://developer.apple.com/app-store/review/guidelines/ target=_blank>Apple App Store Review Guidelines</a>: Security requirements that minimp3 fails to meet</ol></div><div data-is-md-page=true data-patch-exists=true data-patch-path=/pull_request/bevy/2025-07/pr_20183.patch id=patch-info style=display:none></div><div class=bottom-spacer></div></div></div>