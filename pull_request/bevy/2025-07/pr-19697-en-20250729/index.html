<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://unknownue.github.io name=base><title>
         #19697 Bug fix in Gizmo grid
        
    </title><meta content="#19697 Bug fix in Gizmo grid" property=og:title><meta content="A personal blog built with Zola and Apollo theme" property=og:description><meta content="A personal blog built with Zola and Apollo theme" name=description><link href=/icons/favicon.png rel=icon type=image/png><link href=https://unknownue.github.io/fonts.css rel=stylesheet><script src=https://unknownue.github.io/js/codeblock.js></script><script src=https://unknownue.github.io/js/toc.js></script><script src=https://unknownue.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Unknownue's Blog" href=https://unknownue.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://unknownue.github.io/theme/light.css rel=stylesheet><link href=https://unknownue.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://unknownue.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://unknownue.github.io/main.css media=screen rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js></script><script>// Initialize mermaid once DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            mermaid.initialize({
                startOnLoad: false,
                theme: document.body && document.body.classList.contains('dark') ? 'dark' : 'default',
                securityLevel: 'loose',
                flowchart: {
                    useMaxWidth: true,
                    htmlLabels: true
                },
                sequence: {
                    diagramMarginX: 50,
                    diagramMarginY: 10,
                    actorMargin: 50,
                    width: 150,
                    height: 65
                }
            });
        });</script><script src=https://unknownue.github.io/js/main.js></script><script defer src=https://unknownue.github.io/js/label-colors.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/rust.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/typescript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/go.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/cpp.min.js></script><script>// Ensure highlight.js is properly configured
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof hljs !== 'undefined') {
                hljs.configure({
                    languages: ['rust', 'javascript', 'python', 'cpp', 'go', 'typescript'],
                    ignoreUnescapedHTML: true
                });
                console.log('Highlight.js configured in header');
            }
        });</script><link href=https://cdn.jsdelivr.net/npm/diff2html/bundles/css/diff2html.min.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/diff2html/bundles/js/diff2html-ui.min.js></script><script src=https://unknownue.github.io/js/syntax-highlight.js></script><script src=https://unknownue.github.io/js/diff-sidebar.js></script><script src="https://unknownue.github.io/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><div class=content><header><div class=main><a href=https://unknownue.github.io>Unknownue's Blog</a><div class=socials><a class=social href=https://github.com/unknownue rel=me> <img alt=github src=https://unknownue.github.io/icons/social/github.svg> </a><a class=social href=https://github.com/unknownue/unknownue.github.io rel=me> <img alt=github-io src=https://unknownue.github.io/icons/social/rss.svg> </a></div></div><nav><a href=https://unknownue.github.io/posts style=margin-left:.25em>/posts</a><a href=https://unknownue.github.io/projects style=margin-left:.25em>/projects</a><a href=https://unknownue.github.io/about style=margin-left:.25em>/about</a><a href=https://unknownue.github.io/tags style=margin-left:.25em>/tags</a><button title="$SHORTCUT to open search" class=search-button id=search-button><img alt=Search class=search-icon src=https://unknownue.github.io/icons/search.svg></button><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><div id=modal-content><h1 class=page-header id=modalTitle>Search</h1><div id=searchBar><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search... role=combobox spellcheck=false><button title="Clear search" class=clear-button id=clear-search><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></button></div><div id=results-container><div id=results-info><span id=zero_results style=display:none>No results</span><span id=one_result style=display:none>1 result</span><span id=many_results style=display:none>$NUMBER results</span></div><div id=results role=listbox></div></div></div></div><a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://unknownue.github.io/icons/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://unknownue.github.io/icons/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><div class=pull-request-page><article class=md-content-page style=display:none></article><div class=back-link><a href=/pull_request/bevy/2025-07/>← Back to Pull Requests</a></div><div class=pr-metadata><span class=pr-date>2025-07-29</span><div class=language-switcher><span class="lang-link active" data-lang=en>English</span> / <a class=lang-link data-lang=zh-cn href=/pull_request/bevy/2025-07/pr-19697-zh-cn-20250729>中文</a></div></div><div class=pr-content><h2 id=bug-fix-in-gizmo-grid-rendering>Bug Fix in Gizmo Grid Rendering</h2><h3 id=basic-information>Basic Information</h3><ul><li><strong>Title</strong>: Bug fix in Gizmo grid<li><strong>PR Link</strong>: https://github.com/bevyengine/bevy/pull/19697<li><strong>Author</strong>: theotherphil<li><strong>Status</strong>: MERGED<li><strong>Labels</strong>: C-Bug, S-Ready-For-Final-Review, A-Gizmos, M-Deliberate-Rendering-Change<li><strong>Created</strong>: 2025-06-17T18:59:45Z<li><strong>Merged</strong>: 2025-07-29T20:39:30Z<li><strong>Merged By</strong>: alice-i-cecile</ul><h3 id=description>Description</h3><p>Fix https://github.com/bevyengine/bevy/issues/19480<h4 id=solution>Solution</h4><p>Fix calculation of line counts in each direction<h4 id=testing>Testing</h4><p>Added grids to the gizmos screens of testbed/example_3d and testbed/example_2d.</p><img alt=image src=https://github.com/user-attachments/assets/56924e44-1b54-43dc-9cf0-dba390570f3b width=1246><img alt=image src=https://github.com/user-attachments/assets/566c3d1b-64aa-43bb-a1db-c2e41de2a7a6 width=1246><h3 id=the-story-of-this-pull-request>The Story of This Pull Request</h3><h4 id=the-problem>The Problem</h4><p>The grid gizmo implementation had a miscalculation in determining how many lines to draw when toggling outer edges. When users enabled outer edges using <code>outer_edges_x()</code>, <code>outer_edges_y()</code>, or <code>outer_edges_z()</code>, the grid would render with an incorrect number of lines. This violated user expectations about grid rendering behavior and made the feature unreliable for visual debugging. The core issue was in the line count calculation logic that didn’t properly account for the edge inclusion flags across different axes.<h4 id=the-solution-approach>The Solution Approach</h4><p>The fix required rethinking how line counts are calculated when outer edges are enabled. Instead of using a vectorized approach that treated all axes uniformly, we needed:<ol><li>A per-axis calculation that respects each axis’s outer edge flag independently<li>Proper handling of edge cases like zero cell counts<li>Clear separation between cell counts and line counts</ol><p>The solution introduces a helper function that calculates line counts based on:<ul><li>Whether outer edges should be included for that axis<li>The number of cells along the perpendicular axes</ul><h4 id=implementation-details>Implementation Details</h4><p>The main change replaces the monolithic line count calculation with a targeted approach:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// New helper function
</span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>inline</span><span>]
</span><span style=color:#fa6e32>fn </span><span style=color:#f29718>cell_count_to_line_count</span><span>(</span><span style=color:#ff8f40>include_outer</span><span style=color:#61676ccc>: </span><span style=color:#fa6e32>bool</span><span>, </span><span style=color:#ff8f40>cell_count</span><span style=color:#61676ccc>: </span><span style=color:#fa6e32>u32</span><span>) </span><span style=color:#61676ccc>-> </span><span style=color:#fa6e32>u32 </span><span>{
</span><span>    </span><span style=color:#fa6e32>if</span><span> include_outer {
</span><span>        cell_count</span><span style=color:#ed9366>.</span><span style=color:#f07171>saturating_add</span><span>(</span><span style=color:#ff8f40>1</span><span>)
</span><span>    } </span><span style=color:#fa6e32>else </span><span>{
</span><span>        cell_count</span><span style=color:#ed9366>.</span><span style=color:#f07171>saturating_sub</span><span>(</span><span style=color:#ff8f40>1</span><span>)</span><span style=color:#ed9366>.</span><span style=color:#f07171>max</span><span>(</span><span style=color:#ff8f40>1</span><span>)
</span><span>    }
</span><span>}
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// Per-axis line count calculation
</span><span style=color:#fa6e32>let</span><span> x_line_count </span><span style=color:#ed9366>= </span><span>UVec2</span><span style=color:#ed9366>::</span><span>new(
</span><span>    </span><span style=color:#f07171>cell_count_to_line_count</span><span>(outer_edges[</span><span style=color:#ff8f40>0</span><span>]</span><span style=color:#61676ccc>,</span><span> cell_count</span><span style=color:#ed9366>.</span><span>y)</span><span style=color:#61676ccc>,
</span><span>    </span><span style=color:#f07171>cell_count_to_line_count</span><span>(outer_edges[</span><span style=color:#ff8f40>0</span><span>]</span><span style=color:#61676ccc>,</span><span> cell_count</span><span style=color:#ed9366>.</span><span>z)</span><span style=color:#61676ccc>,
</span><span>)</span><span style=color:#61676ccc>;
</span></code></pre><p>This approach:<ol><li>Clearly separates the logic for each axis<li>Uses saturating arithmetic to prevent underflow<li>Ensures at least one line is always drawn<li>Maintains the existing API while fixing internal calculations</ol><p>The parameter documentation was also updated to clarify that these methods affect edges <em>parallel</em> to each axis, not <em>along</em> them:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>/// Declare that the outer edges of the grid parallel to the x axis should be drawn.
</span><span style=color:#fa6e32>pub fn </span><span style=color:#f29718>outer_edges_x</span><span>(</span><span style=color:#fa6e32>mut </span><span style=color:#ff8f40>self</span><span>) </span><span style=color:#61676ccc>-> </span><span style=color:#fa6e32>Self </span><span>{
</span><span>    </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>outer_edges[</span><span style=color:#ff8f40>0</span><span>] </span><span style=color:#ed9366>= </span><span style=color:#ff8f40>true</span><span style=color:#61676ccc>;
</span><span>    </span><span style=color:#55b4d4;font-style:italic>self
</span><span>}
</span></code></pre><h4 id=testing-strategy>Testing Strategy</h4><p>To verify the fix, we added comprehensive test cases in both 2D and 3D examples:<ul><li>Multiple grid configurations with all combinations of outer edges toggled<li>Visual verification through screenshots<li>Consistent positioning to allow side-by-side comparison</ul><p>The test code systematically exercises all edge flag combinations:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// 2D testing
</span><span style=color:#fa6e32>for</span><span> i </span><span style=color:#ed9366>in </span><span style=color:#ff8f40>0</span><span style=color:#ed9366>..</span><span style=color:#ff8f40>4 </span><span>{
</span><span>    </span><span style=color:#fa6e32>let mut</span><span> grid </span><span style=color:#ed9366>=</span><span> gizmos</span><span style=color:#ed9366>.</span><span style=color:#f07171>grid</span><span>(</span><span style=color:#ed9366>...</span><span>)</span><span style=color:#61676ccc>;
</span><span>    </span><span style=color:#fa6e32>if</span><span> i </span><span style=color:#ed9366>& </span><span style=color:#ff8f40>1 </span><span style=color:#ed9366>> </span><span style=color:#ff8f40>0 </span><span>{ grid </span><span style=color:#ed9366>=</span><span> grid</span><span style=color:#ed9366>.</span><span style=color:#f07171>outer_edges_x</span><span>()</span><span style=color:#61676ccc>; </span><span>}
</span><span>    </span><span style=color:#fa6e32>if</span><span> i </span><span style=color:#ed9366>& </span><span style=color:#ff8f40>2 </span><span style=color:#ed9366>> </span><span style=color:#ff8f40>0 </span><span>{ grid</span><span style=color:#ed9366>.</span><span style=color:#f07171>outer_edges_y</span><span>()</span><span style=color:#61676ccc>; </span><span>}
</span><span>}
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// 3D testing
</span><span style=color:#fa6e32>for</span><span> i </span><span style=color:#ed9366>in </span><span style=color:#ff8f40>0</span><span style=color:#ed9366>..</span><span style=color:#ff8f40>8 </span><span>{
</span><span>    </span><span style=color:#fa6e32>let mut</span><span> grid </span><span style=color:#ed9366>=</span><span> gizmos</span><span style=color:#ed9366>.</span><span style=color:#f07171>grid_3d</span><span>(</span><span style=color:#ed9366>...</span><span>)</span><span style=color:#61676ccc>;
</span><span>    </span><span style=color:#fa6e32>if</span><span> i </span><span style=color:#ed9366>& </span><span style=color:#ff8f40>1 </span><span style=color:#ed9366>> </span><span style=color:#ff8f40>0 </span><span>{ grid </span><span style=color:#ed9366>=</span><span> grid</span><span style=color:#ed9366>.</span><span style=color:#f07171>outer_edges_x</span><span>()</span><span style=color:#61676ccc>; </span><span>}
</span><span>    </span><span style=color:#fa6e32>if</span><span> i </span><span style=color:#ed9366>& </span><span style=color:#ff8f40>2 </span><span style=color:#ed9366>> </span><span style=color:#ff8f40>0 </span><span>{ grid </span><span style=color:#ed9366>=</span><span> grid</span><span style=color:#ed9366>.</span><span style=color:#f07171>outer_edges_y</span><span>()</span><span style=color:#61676ccc>; </span><span>}
</span><span>    </span><span style=color:#fa6e32>if</span><span> i </span><span style=color:#ed9366>& </span><span style=color:#ff8f40>4 </span><span style=color:#ed9366>> </span><span style=color:#ff8f40>0 </span><span>{ grid</span><span style=color:#ed9366>.</span><span style=color:#f07171>outer_edges_z</span><span>()</span><span style=color:#61676ccc>; </span><span>}
</span><span>}
</span></code></pre><h4 id=impact>Impact</h4><p>This fix:<ol><li>Corrects grid rendering behavior when outer edges are enabled<li>Maintains backward compatibility with existing API usage<li>Provides clear visual verification through enhanced examples<li>Improves the reliability of grid gizmos for debugging purposes</ol><p>The solution demonstrates how localized calculations can have significant visual impact, and how systematic testing of configuration combinations can effectively validate rendering logic.<h3 id=visual-representation>Visual Representation</h3><pre class=language-mermaid data-lang=mermaid style=color:#61676c;background-color:#fafafa><code class=language-mermaid data-lang=mermaid><span>graph TD
</span><span>    A[Gizmo Grid API] --> B[draw_grid function]
</span><span>    B --> C[Line Count Calculation]
</span><span>    C --> D[Per-Axis Helper Function]
</span><span>    D --> E[Cell Count Processing]
</span><span>    E --> F[Line Rendering]
</span><span>    B --> G[Example Validation]
</span><span>    G --> H[2D Test Cases]
</span><span>    G --> I[3D Test Cases]
</span></code></pre><h3 id=key-files-changed>Key Files Changed</h3><ol><li><strong>crates/bevy_gizmos/src/grid.rs</strong> (+31/-12) <ul><li>Fixed line count calculation logic for grid rendering<li>Added helper function for proper edge handling<li>Improved documentation clarity</ul></ol><pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before: Incorrect vectorized calculation
</span><span style=color:#fa6e32>let</span><span> outer_edges_u32 </span><span style=color:#ed9366>= </span><span>UVec3</span><span style=color:#ed9366>::</span><span>from(outer_edges</span><span style=color:#ed9366>.</span><span style=color:#f07171>map</span><span>(|</span><span style=color:#ff8f40>v</span><span>| v </span><span style=color:#ed9366>as </span><span style=color:#fa6e32>u32</span><span>))</span><span style=color:#61676ccc>;
</span><span style=color:#fa6e32>let</span><span> line_count </span><span style=color:#ed9366>=</span><span> outer_edges_u32 </span><span style=color:#ed9366>*</span><span> cell_count</span><span style=color:#ed9366>.</span><span style=color:#f07171>saturating_add</span><span>(UVec3</span><span style=color:#ed9366>::</span><span style=color:#ff8f40>ONE</span><span>)
</span><span>    </span><span style=color:#ed9366>+ </span><span>(UVec3</span><span style=color:#ed9366>::</span><span style=color:#ff8f40>ONE </span><span style=color:#ed9366>-</span><span> outer_edges_u32) </span><span style=color:#ed9366>*</span><span> cell_count</span><span style=color:#ed9366>.</span><span style=color:#f07171>saturating_sub</span><span>(UVec3</span><span style=color:#ed9366>::</span><span style=color:#ff8f40>ONE</span><span>)</span><span style=color:#61676ccc>;
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After: Correct per-axis calculation
</span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>inline</span><span>]
</span><span style=color:#fa6e32>fn </span><span style=color:#f29718>cell_count_to_line_count</span><span>(</span><span style=color:#ff8f40>include_outer</span><span style=color:#61676ccc>: </span><span style=color:#fa6e32>bool</span><span>, </span><span style=color:#ff8f40>cell_count</span><span style=color:#61676ccc>: </span><span style=color:#fa6e32>u32</span><span>) </span><span style=color:#61676ccc>-> </span><span style=color:#fa6e32>u32 </span><span>{
</span><span>    </span><span style=color:#fa6e32>if</span><span> include_outer {
</span><span>        cell_count</span><span style=color:#ed9366>.</span><span style=color:#f07171>saturating_add</span><span>(</span><span style=color:#ff8f40>1</span><span>)
</span><span>    } </span><span style=color:#fa6e32>else </span><span>{
</span><span>        cell_count</span><span style=color:#ed9366>.</span><span style=color:#f07171>saturating_sub</span><span>(</span><span style=color:#ff8f40>1</span><span>)</span><span style=color:#ed9366>.</span><span style=color:#f07171>max</span><span>(</span><span style=color:#ff8f40>1</span><span>)
</span><span>    }
</span><span>}
</span><span>
</span><span style=color:#fa6e32>let</span><span> x_line_count </span><span style=color:#ed9366>= </span><span>UVec2</span><span style=color:#ed9366>::</span><span>new(
</span><span>    </span><span style=color:#f07171>cell_count_to_line_count</span><span>(outer_edges[</span><span style=color:#ff8f40>0</span><span>]</span><span style=color:#61676ccc>,</span><span> cell_count</span><span style=color:#ed9366>.</span><span>y)</span><span style=color:#61676ccc>,
</span><span>    </span><span style=color:#f07171>cell_count_to_line_count</span><span>(outer_edges[</span><span style=color:#ff8f40>0</span><span>]</span><span style=color:#61676ccc>,</span><span> cell_count</span><span style=color:#ed9366>.</span><span>z)</span><span style=color:#61676ccc>,
</span><span>)</span><span style=color:#61676ccc>;
</span></code></pre><ol start=2><li><strong>examples/testbed/2d.rs</strong> (+28/-2) <ul><li>Added comprehensive grid tests with all outer edge combinations<li>Positioned grids for visual comparison</ul></ol><pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Added test code
</span><span style=color:#fa6e32>for</span><span> i </span><span style=color:#ed9366>in </span><span style=color:#ff8f40>0</span><span style=color:#ed9366>..</span><span style=color:#ff8f40>4 </span><span>{
</span><span>    </span><span style=color:#fa6e32>let</span><span> x </span><span style=color:#ed9366>= </span><span style=color:#ff8f40>200.0 </span><span style=color:#ed9366>* </span><span>(</span><span style=color:#ff8f40>1.0 </span><span style=color:#ed9366>+ </span><span>(i </span><span style=color:#ed9366>% </span><span style=color:#ff8f40>2</span><span>) </span><span style=color:#ed9366>as </span><span style=color:#fa6e32>f32</span><span>)</span><span style=color:#61676ccc>;
</span><span>    </span><span style=color:#fa6e32>let</span><span> y </span><span style=color:#ed9366>= </span><span style=color:#ff8f40>150.0 </span><span style=color:#ed9366>* </span><span>(</span><span style=color:#ff8f40>0.5 </span><span style=color:#ed9366>- </span><span>(i </span><span style=color:#ed9366>/ </span><span style=color:#ff8f40>2</span><span>) </span><span style=color:#ed9366>as </span><span style=color:#fa6e32>f32</span><span>)</span><span style=color:#61676ccc>;
</span><span>    </span><span style=color:#fa6e32>let mut</span><span> grid </span><span style=color:#ed9366>=</span><span> gizmos</span><span style=color:#ed9366>.</span><span style=color:#f07171>grid</span><span>(</span><span style=color:#ed9366>...</span><span>)</span><span style=color:#61676ccc>;
</span><span>    </span><span style=color:#fa6e32>if</span><span> i </span><span style=color:#ed9366>& </span><span style=color:#ff8f40>1 </span><span style=color:#ed9366>> </span><span style=color:#ff8f40>0 </span><span>{ grid </span><span style=color:#ed9366>=</span><span> grid</span><span style=color:#ed9366>.</span><span style=color:#f07171>outer_edges_x</span><span>()</span><span style=color:#61676ccc>; </span><span>}
</span><span>    </span><span style=color:#fa6e32>if</span><span> i </span><span style=color:#ed9366>& </span><span style=color:#ff8f40>2 </span><span style=color:#ed9366>> </span><span style=color:#ff8f40>0 </span><span>{ grid</span><span style=color:#ed9366>.</span><span style=color:#f07171>outer_edges_y</span><span>()</span><span style=color:#61676ccc>; </span><span>}
</span><span>}
</span></code></pre><ol start=3><li><strong>examples/testbed/3d.rs</strong> (+24/-3) <ul><li>Extended 3D grid tests with all axis flag combinations<li>Adjusted camera position for better visibility</ul></ol><pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Added test code
</span><span style=color:#fa6e32>for</span><span> i </span><span style=color:#ed9366>in </span><span style=color:#ff8f40>0</span><span style=color:#ed9366>..</span><span style=color:#ff8f40>8 </span><span>{
</span><span>    </span><span style=color:#fa6e32>let</span><span> x </span><span style=color:#ed9366>= </span><span style=color:#ff8f40>1.5 </span><span style=color:#ed9366>* </span><span>(i </span><span style=color:#ed9366>% </span><span style=color:#ff8f40>4</span><span>) </span><span style=color:#ed9366>as </span><span style=color:#fa6e32>f32</span><span style=color:#61676ccc>;
</span><span>    </span><span style=color:#fa6e32>let</span><span> y </span><span style=color:#ed9366>= </span><span style=color:#ff8f40>1.0 </span><span style=color:#ed9366>* </span><span>(</span><span style=color:#ff8f40>0.5 </span><span style=color:#ed9366>- </span><span>(i </span><span style=color:#ed9366>/ </span><span style=color:#ff8f40>4</span><span>) </span><span style=color:#ed9366>as </span><span style=color:#fa6e32>f32</span><span>)</span><span style=color:#61676ccc>;
</span><span>    </span><span style=color:#fa6e32>let mut</span><span> grid </span><span style=color:#ed9366>=</span><span> gizmos</span><span style=color:#ed9366>.</span><span style=color:#f07171>grid_3d</span><span>(</span><span style=color:#ed9366>...</span><span>)</span><span style=color:#61676ccc>;
</span><span>    </span><span style=color:#fa6e32>if</span><span> i </span><span style=color:#ed9366>& </span><span style=color:#ff8f40>1 </span><span style=color:#ed9366>> </span><span style=color:#ff8f40>0 </span><span>{ grid </span><span style=color:#ed9366>=</span><span> grid</span><span style=color:#ed9366>.</span><span style=color:#f07171>outer_edges_x</span><span>()</span><span style=color:#61676ccc>; </span><span>}
</span><span>    </span><span style=color:#fa6e32>if</span><span> i </span><span style=color:#ed9366>& </span><span style=color:#ff8f40>2 </span><span style=color:#ed9366>> </span><span style=color:#ff8f40>0 </span><span>{ grid </span><span style=color:#ed9366>=</span><span> grid</span><span style=color:#ed9366>.</span><span style=color:#f07171>outer_edges_y</span><span>()</span><span style=color:#61676ccc>; </span><span>}
</span><span>    </span><span style=color:#fa6e32>if</span><span> i </span><span style=color:#ed9366>& </span><span style=color:#ff8f40>4 </span><span style=color:#ed9366>> </span><span style=color:#ff8f40>0 </span><span>{ grid</span><span style=color:#ed9366>.</span><span style=color:#f07171>outer_edges_z</span><span>()</span><span style=color:#61676ccc>; </span><span>}
</span><span>}
</span></code></pre><h3 id=further-reading>Further Reading</h3><ol><li><a rel="noopener nofollow noreferrer" href=https://github.com/bevyengine/bevy/issues/19480 target=_blank>Original Issue #19480</a> - Details the bug report and reproduction steps<li><a rel="noopener nofollow noreferrer" href=https://docs.rs/bevy_gizmos/latest/bevy_gizmos/ target=_blank>Bevy Gizmos Documentation</a> - Official API reference<li><a rel="noopener nofollow noreferrer" href=https://doc.rust-lang.org/std/primitive.u32.html#method.saturating_add target=_blank>Saturating Arithmetic in Rust</a> - Explanation of overflow-safe operations<li><a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/Combinatorial_testing target=_blank>Combinatorial Testing Techniques</a> - Background on systematic configuration testing</ol></div><div data-is-md-page=true data-patch-exists=true data-patch-path=/pull_request/bevy/2025-07/pr_19697.patch id=patch-info style=display:none></div><div class=bottom-spacer></div></div></div>