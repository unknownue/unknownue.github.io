<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://unknownue.github.io name=base><title>
         #20228 Add quick notes about Allows
        
    </title><meta content="#20228 Add quick notes about Allows" property=og:title><meta content="A personal blog built with Zola and Apollo theme" property=og:description><meta content="A personal blog built with Zola and Apollo theme" name=description><link href=/icons/favicon.png rel=icon type=image/png><link href=https://unknownue.github.io/fonts.css rel=stylesheet><script src=https://unknownue.github.io/js/codeblock.js></script><script src=https://unknownue.github.io/js/toc.js></script><script src=https://unknownue.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Unknownue's Blog" href=https://unknownue.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://unknownue.github.io/theme/light.css rel=stylesheet><link href=https://unknownue.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://unknownue.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://unknownue.github.io/main.css media=screen rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js></script><script>// Initialize mermaid once DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            mermaid.initialize({
                startOnLoad: false,
                theme: document.body && document.body.classList.contains('dark') ? 'dark' : 'default',
                securityLevel: 'loose',
                flowchart: {
                    useMaxWidth: true,
                    htmlLabels: true
                },
                sequence: {
                    diagramMarginX: 50,
                    diagramMarginY: 10,
                    actorMargin: 50,
                    width: 150,
                    height: 65
                }
            });
        });</script><script src=https://unknownue.github.io/js/main.js></script><script defer src=https://unknownue.github.io/js/label-colors.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/rust.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/typescript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/go.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/cpp.min.js></script><script>// Ensure highlight.js is properly configured
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof hljs !== 'undefined') {
                hljs.configure({
                    languages: ['rust', 'javascript', 'python', 'cpp', 'go', 'typescript'],
                    ignoreUnescapedHTML: true
                });
                console.log('Highlight.js configured in header');
            }
        });</script><link href=https://cdn.jsdelivr.net/npm/diff2html/bundles/css/diff2html.min.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/diff2html/bundles/js/diff2html-ui.min.js></script><script src=https://unknownue.github.io/js/syntax-highlight.js></script><script src=https://unknownue.github.io/js/diff-sidebar.js></script><script src="https://unknownue.github.io/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><div class=content><header><div class=main><a href=https://unknownue.github.io>Unknownue's Blog</a><div class=socials><a class=social href=https://github.com/unknownue rel=me> <img alt=github src=https://unknownue.github.io/icons/social/github.svg> </a><a class=social href=https://github.com/unknownue/unknownue.github.io rel=me> <img alt=github-io src=https://unknownue.github.io/icons/social/rss.svg> </a></div></div><nav><a href=https://unknownue.github.io/posts style=margin-left:.25em>/posts</a><a href=https://unknownue.github.io/projects style=margin-left:.25em>/projects</a><a href=https://unknownue.github.io/about style=margin-left:.25em>/about</a><a href=https://unknownue.github.io/tags style=margin-left:.25em>/tags</a><button title="$SHORTCUT to open search" class=search-button id=search-button><img alt=Search class=search-icon src=https://unknownue.github.io/icons/search.svg></button><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><div id=modal-content><h1 class=page-header id=modalTitle>Search</h1><div id=searchBar><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search... role=combobox spellcheck=false><button title="Clear search" class=clear-button id=clear-search><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></button></div><div id=results-container><div id=results-info><span id=zero_results style=display:none>No results</span><span id=one_result style=display:none>1 result</span><span id=many_results style=display:none>$NUMBER results</span></div><div id=results role=listbox></div></div></div></div><a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://unknownue.github.io/icons/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://unknownue.github.io/icons/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><div class=pull-request-page><article class=md-content-page style=display:none></article><div class=back-link><a href=/pull_request/bevy/2025-07/>← Back to Pull Requests</a></div><div class=pr-metadata><span class=pr-date>2025-07-22</span><div class=language-switcher><span class="lang-link active" data-lang=en>English</span> / <a class=lang-link data-lang=zh-cn href=/pull_request/bevy/2025-07/pr-20228-zh-cn-20250722>中文</a></div></div><div class=pr-content><h1 id=pr-analysis-add-quick-notes-about-allows>PR Analysis: Add quick notes about Allows</h1><h2 id=basic-information>Basic Information</h2><ul><li><strong>Title</strong>: Add quick notes about Allows<li><strong>PR Link</strong>: https://github.com/bevyengine/bevy/pull/20228<li><strong>Author</strong>: alice-i-cecile<li><strong>Status</strong>: MERGED<li><strong>Labels</strong>: C-Docs, D-Trivial, A-ECS, S-Ready-For-Final-Review<li><strong>Created</strong>: 2025-07-21T18:20:02Z<li><strong>Merged</strong>: 2025-07-21T23:56:52Z<li><strong>Merged By</strong>: alice-i-cecile</ul><h2 id=description-translation>Description Translation</h2><h1 id=objective>Objective</h1><ul><li><code>Allows</code> was added as a handy tool to work with default query filters.<li>It wasn’t in the docs though, and I had to hunt it down while reviewing #20204.</ul><h2 id=solution>Solution</h2><ul><li>Add some breadcrumbs to the docs in the expected places.</ul><h2 id=the-story-of-this-pull-request>The Story of This Pull Request</h2><h3 id=the-problem-and-context>The Problem and Context</h3><p>When reviewing PR #20204, the author discovered that the <code>Allows</code> query filter - a utility designed to work with Bevy’s default query filters - wasn’t properly documented. This posed a discoverability issue for developers working with entity disabling patterns in Bevy’s ECS. Without explicit documentation references, developers might not know about this tool when reading about entity disabling functionality, potentially leading them to reinvent solutions or use less optimal patterns.<h3 id=the-solution-approach>The Solution Approach</h3><p>The author addressed this documentation gap by adding concise references to <code>Allows</code> in two strategic locations within Bevy’s entity disabling documentation. The approach was straightforward: insert clear, self-contained documentation blocks that explain <code>Allows</code> in relation to its relevant context. No code changes were needed since this was purely a documentation update. The author focused on placing these notes where developers would naturally encounter them while reading about entity disabling patterns.<h3 id=the-implementation>The Implementation</h3><p>The implementation consisted of two documentation additions in <code>entity_disabling.rs</code>:<ol><li><strong>Module-level documentation</strong>: Added a brief note about <code>Allows</code> in the high-level entity disabling overview<li><strong>DisablingComponent documentation</strong>: Added a more detailed explanation comparing <code>Allows</code> to the <code>Has</code> filter</ol><p>Both additions include cross-references to relevant types in Bevy’s API documentation. The changes are minimal but strategically placed to maximize discoverability.<h3 id=technical-insights>Technical Insights</h3><p>The documentation highlights two important distinctions:<ol><li><code>Allows</code> is designed specifically for use with default query filters, ensuring queries include entities both with and without disabling components<li><code>Allows</code> operates as a <code>QueryFilter</code> (affecting which entities are returned) while <code>Has</code> is <code>QueryData</code> (providing information about each entity)</ol><p>This distinction is crucial because:<ul><li>Default query filters automatically exclude entities with disabling components<li><code>Allows</code> provides an explicit opt-out from this behavior<li><code>Has</code> allows conditional logic based on an entity’s disabled status</ul><h3 id=the-impact>The Impact</h3><p>These documentation updates improve developer experience by:<ol><li>Making <code>Allows</code> discoverable in the context where it’s most relevant<li>Clarifying when to use <code>Allows</code> versus <code>Has</code><li>Providing immediate context about how <code>Allows</code> interacts with default query filters<li>Reducing the need for developers to search through source code to find this utility</ol><p>The changes maintain consistency with Bevy’s existing documentation style while filling a specific knowledge gap. No performance or functional changes were made to the codebase.<h2 id=visual-representation>Visual Representation</h2><pre class=language-mermaid data-lang=mermaid style=color:#61676c;background-color:#fafafa><code class=language-mermaid data-lang=mermaid><span>graph LR
</span><span>    A[Entity Disabling Documentation] --> B[Module-level Docs]
</span><span>    A --> C[DisablingComponent Docs]
</span><span>    B --> D[Added Allows reference]
</span><span>    C --> E[Added Allows/Has comparison]
</span></code></pre><h2 id=key-files-changed>Key Files Changed</h2><h3 id=crates-bevy-ecs-src-entity-disabling-rs-9-0><code>crates/bevy_ecs/src/entity_disabling.rs</code> (+9/-0)</h3><p>Added documentation references to <code>Allows</code> in two locations to improve discoverability.<p><strong>Change 1: Module-level documentation addition</strong><pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>//! even if they have a `Position` component,
</span><span style=color:#abb0b6;font-style:italic>//! but `Query<&Position, With&LTDisabled>>` or `Query<(&Position, Has&LTDisabled>)>` will see them.
</span><span style=color:#abb0b6;font-style:italic>//!
</span><span style=color:#abb0b6;font-style:italic>//! The [`Allows`](crate::query::Allows) query filter is designed to be used with default query filters,
</span><span style=color:#abb0b6;font-style:italic>//! and ensures that the query will include entities both with and without the specified disabling component.
</span><span style=color:#abb0b6;font-style:italic>//!
</span><span style=color:#abb0b6;font-style:italic>//! Entities with disabling components are still present in the [`World`] and can be accessed directly,
</span></code></pre><p><strong>Change 2: DisablingComponent documentation addition</strong><pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>/// To be more precise, this checks if the query's [`FilteredAccess`] contains the component,
</span><span style=color:#abb0b6;font-style:italic>/// and if it does not, adds a [`Without`](crate::prelude::Without) filter for that component to the query.
</span><span style=color:#abb0b6;font-style:italic>///
</span><span style=color:#abb0b6;font-style:italic>/// [`Allows`](crate::query::Allows) and [`Has`](crate::prelude::Has) can be used to include entities
</span><span style=color:#abb0b6;font-style:italic>/// with and without the disabling component.
</span><span style=color:#abb0b6;font-style:italic>/// [`Allows`](crate::query::Allows) is a [`QueryFilter`](crate::query::QueryFilter) and will simply change
</span><span style=color:#abb0b6;font-style:italic>/// the list of shown entities, while [`Has`](crate::prelude::Has) is a [`QueryData`](crate::query::QueryData)
</span><span style=color:#abb0b6;font-style:italic>/// and will allow you to see if each entity has the disabling component or not.
</span><span style=color:#abb0b6;font-style:italic>///
</span><span style=color:#abb0b6;font-style:italic>/// This resource is initialized in the [`World`] whenever a new world is created,
</span></code></pre><h2 id=further-reading>Further Reading</h2><ol><li><a rel="noopener nofollow noreferrer" href=https://bevyengine.org/learn/book/ecs/queries/ target=_blank>Bevy ECS Query System Documentation</a><li><a rel="noopener nofollow noreferrer" href=https://docs.rs/bevy_ecs/latest/bevy_ecs/query/struct.Allows.html target=_blank><code>Allows</code> API Reference</a><li><a rel="noopener nofollow noreferrer" href=https://docs.rs/bevy_ecs/latest/bevy_ecs/query/struct.Query.html#default-query-filters target=_blank>Default Query Filters in Bevy</a><li><a rel="noopener nofollow noreferrer" href=https://github.com/bevyengine/bevy/blob/main/crates/bevy_ecs/src/entity_disabling.rs target=_blank>Entity Disabling Patterns</a></ol><h2 id=full-code-diff>Full Code Diff</h2><pre class=language-diff data-lang=diff style=color:#61676c;background-color:#fafafa><code class=language-diff data-lang=diff><span>diff --git a/crates/bevy_ecs/src/entity_disabling.rs b/crates/bevy_ecs/src/entity_disabling.rs
</span><span>index 39d2aa27e8837..3b735a7607d73 100644
</span><span style=color:#c594c5>--- a/crates/bevy_ecs/src/entity_disabling.rs
</span><span style=color:#c594c5>+++ b/crates/bevy_ecs/src/entity_disabling.rs
</span><span style=color:#c594c5>@@ -44,6 +44,9 @@
</span><span> //! even if they have a `Position` component,
</span><span> //! but `Query<&Position, With&LTDisabled>>` or `Query<(&Position, Has&LTDisabled>)>` will see them.
</span><span> //!
</span><span style=color:#86b300>+//! The [`Allows`](crate::query::Allows) query filter is designed to be used with default query filters,
</span><span style=color:#86b300>+//! and ensures that the query will include entities both with and without the specified disabling component.
</span><span style=color:#86b300>+//!
</span><span> //! Entities with disabling components are still present in the [`World`] and can be accessed directly,
</span><span> //! using methods on [`World`] or [`Commands`](crate::prelude::Commands).
</span><span> //!
</span><span style=color:#c594c5>@@ -111,6 +114,12 @@ </span><span style=color:#399ee6>pub struct Disabled;
</span><span> /// To be more precise, this checks if the query's [`FilteredAccess`] contains the component,
</span><span> /// and if it does not, adds a [`Without`](crate::prelude::Without) filter for that component to the query.
</span><span> ///
</span><span style=color:#86b300>+/// [`Allows`](crate::query::Allows) and [`Has`](crate::prelude::Has) can be used to include entities
</span><span style=color:#86b300>+/// with and without the disabling component.
</span><span style=color:#86b300>+/// [`Allows`](crate::query::Allows) is a [`QueryFilter`](crate::query::QueryFilter) and will simply change
</span><span style=color:#86b300>+/// the list of shown entities, while [`Has`](crate::prelude::Has) is a [`QueryData`](crate::query::QueryData)
</span><span style=color:#86b300>+/// and will allow you to see if each entity has the disabling component or not.
</span><span style=color:#86b300>+///
</span><span> /// This resource is initialized in the [`World`] whenever a new world is created,
</span><span> /// with the [`Disabled`] component as a disabling component.
</span><span> ///
</span></code></pre></div><div data-is-md-page=true data-patch-exists=true data-patch-path=/pull_request/bevy/2025-07/pr_20228.patch id=patch-info style=display:none></div><div class=bottom-spacer></div></div></div>