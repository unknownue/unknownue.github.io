<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://unknownue.github.io name=base><title>
         #20232 Rework one-to-one relationships to remove existing instead of panicking
        
    </title><meta content="#20232 Rework one-to-one relationships to remove existing instead of panicking" property=og:title><meta content="A personal blog built with Zola and Apollo theme" property=og:description><meta content="A personal blog built with Zola and Apollo theme" name=description><link href=/icons/favicon.png rel=icon type=image/png><link href=https://unknownue.github.io/fonts.css rel=stylesheet><script src=https://unknownue.github.io/js/codeblock.js></script><script src=https://unknownue.github.io/js/toc.js></script><script src=https://unknownue.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Unknownue's Blog" href=https://unknownue.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://unknownue.github.io/theme/light.css rel=stylesheet><link href=https://unknownue.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://unknownue.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://unknownue.github.io/main.css media=screen rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js></script><script>// Initialize mermaid once DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            mermaid.initialize({
                startOnLoad: false,
                theme: document.body && document.body.classList.contains('dark') ? 'dark' : 'default',
                securityLevel: 'loose',
                flowchart: {
                    useMaxWidth: true,
                    htmlLabels: true
                },
                sequence: {
                    diagramMarginX: 50,
                    diagramMarginY: 10,
                    actorMargin: 50,
                    width: 150,
                    height: 65
                }
            });
        });</script><script src=https://unknownue.github.io/js/main.js></script><script defer src=https://unknownue.github.io/js/label-colors.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/rust.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/typescript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/go.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/cpp.min.js></script><script>// Ensure highlight.js is properly configured
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof hljs !== 'undefined') {
                hljs.configure({
                    languages: ['rust', 'javascript', 'python', 'cpp', 'go', 'typescript'],
                    ignoreUnescapedHTML: true
                });
                console.log('Highlight.js configured in header');
            }
        });</script><link href=https://cdn.jsdelivr.net/npm/diff2html/bundles/css/diff2html.min.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/diff2html/bundles/js/diff2html-ui.min.js></script><script src=https://unknownue.github.io/js/syntax-highlight.js></script><script src=https://unknownue.github.io/js/diff-sidebar.js></script><script src="https://unknownue.github.io/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><div class=content><header><div class=main><a href=https://unknownue.github.io>Unknownue's Blog</a><div class=socials><a class=social href=https://github.com/unknownue rel=me> <img alt=github src=https://unknownue.github.io/icons/social/github.svg> </a><a class=social href=https://github.com/unknownue/unknownue.github.io rel=me> <img alt=github-io src=https://unknownue.github.io/icons/social/rss.svg> </a></div></div><nav><a href=https://unknownue.github.io/posts style=margin-left:.25em>/posts</a><a href=https://unknownue.github.io/projects style=margin-left:.25em>/projects</a><a href=https://unknownue.github.io/about style=margin-left:.25em>/about</a><a href=https://unknownue.github.io/tags style=margin-left:.25em>/tags</a><button title="$SHORTCUT to open search" class=search-button id=search-button><img alt=Search class=search-icon src=https://unknownue.github.io/icons/search.svg></button><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><div id=modal-content><h1 class=page-header id=modalTitle>Search</h1><div id=searchBar><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search... role=combobox spellcheck=false><button title="Clear search" class=clear-button id=clear-search><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></button></div><div id=results-container><div id=results-info><span id=zero_results style=display:none>No results</span><span id=one_result style=display:none>1 result</span><span id=many_results style=display:none>$NUMBER results</span></div><div id=results role=listbox></div></div></div></div><a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://unknownue.github.io/icons/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://unknownue.github.io/icons/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><div class=pull-request-page><article class=md-content-page style=display:none></article><div class=back-link><a href=/pull_request/bevy/2025-07/>← Back to Pull Requests</a></div><div class=pr-metadata><span class=pr-date>2025-07-23</span><div class=language-switcher><span class="lang-link active" data-lang=en>English</span> / <a class=lang-link data-lang=zh-cn href=/pull_request/bevy/2025-07/pr-20232-zh-cn-20250723>中文</a></div></div><div class=pr-content><h1 id=analysis-of-pr-20232-rework-one-to-one-relationships-to-remove-existing-instead-of-panicking>Analysis of PR #20232: Rework one-to-one relationships to remove existing instead of panicking</h1><h2 id=basic-information>Basic Information</h2><ul><li><strong>Title</strong>: Rework one-to-one relationships to remove existing instead of panicking<li><strong>PR Link</strong>: https://github.com/bevyengine/bevy/pull/20232<li><strong>Author</strong>: muddxyii<li><strong>Status</strong>: MERGED<li><strong>Labels</strong>: C-Bug, A-ECS, P-Crash, S-Ready-For-Final-Review, X-Uncontroversial<li><strong>Created</strong>: 2025-07-21T19:13:01Z<li><strong>Merged</strong>: 2025-07-23T18:13:46Z<li><strong>Merged By</strong>: alice-i-cecile</ul><h2 id=description-translation>Description Translation</h2><h1 id=objective>Objective</h1><ul><li>Issue: #18847<li>Resolves panic when establishing a one-to-one relationship to an entity that already has an existing relationship from another entity.</ul><h2 id=solution>Solution</h2><ul><li>Modified the <code>on_insert</code> hook in the <code>Relationship</code> trait to detect one-to-one relationships (where the target collection type is <code>Entity</code>) and automatically remove any existing relationship before establishing the new one.<li>Uses runtime type checking with <code>TypeId</code> to identify one-to-one vs one-to-many relationships.<li>Safely removes the existing source relationship using <code>try_remove()</code> to handle edge cases gracefully.</ul><h2 id=testing>Testing</h2><ul><li>Removed panic assertions from <code>Entity::add()</code> and <code>Entity::extend_from_iter()</code> methods that would previously crash when attempting to establish overlapping one-to-one relationships<li>Modified existing test <code>one_to_one_relationship_shared_target</code> by removing <code>#[should_panic]</code> and adding assertions to verify: <ul><li>Original relationship is properly removed<li>New relationship is correctly established<li>Target entity points to the new source</ul></ul><h2 id=the-story-of-this-pull-request>The Story of This Pull Request</h2><h3 id=the-problem>The Problem</h3><p>The ECS relationship system had a critical flaw in handling one-to-one relationships. When multiple entities attempted to establish relationships with the same target entity, the system would panic due to an assertion failure. This violated the principle of least surprise and caused crashes in real-world scenarios where relationships needed to be dynamically reassigned.<p>The root cause was in the relationship source collection implementation for one-to-one relationships (represented by <code>Entity</code>). The <code>add()</code> and <code>extend_from_iter()</code> methods contained assertions that enforced the target must not have an existing relationship:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before implementation
</span><span style=color:#fa6e32>fn </span><span style=color:#f29718>add</span><span>(</span><span style=color:#ed9366>&</span><span style=color:#fa6e32>mut </span><span style=color:#ff8f40>self</span><span>, </span><span style=color:#ff8f40>entity</span><span style=color:#61676ccc>:</span><span> Entity) </span><span style=color:#61676ccc>-> </span><span style=color:#fa6e32>bool </span><span>{
</span><span>    </span><span style=color:#f07171>assert_eq!</span><span>(
</span><span>        </span><span style=color:#ed9366>*</span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#61676ccc>,
</span><span>        Entity</span><span style=color:#ed9366>::</span><span style=color:#ff8f40>PLACEHOLDER</span><span style=color:#61676ccc>,
</span><span>        </span><span style=color:#86b300>"Entity {entity} attempted to target an entity with a one-to-one relationship..."
</span><span>    )</span><span style=color:#61676ccc>;
</span><span>    </span><span style=color:#ed9366>*</span><span style=color:#55b4d4;font-style:italic>self </span><span style=color:#ed9366>=</span><span> entity</span><span style=color:#61676ccc>;
</span><span>    </span><span style=color:#ff8f40>true
</span><span>}
</span></code></pre><p>These assertions were overly restrictive and didn’t match common use cases where relationships need to be transferred between entities.<h3 id=the-solution-approach>The Solution Approach</h3><p>Instead of panicking, the solution automatically removes conflicting relationships before establishing new ones. The approach:<ol><li>Identifies one-to-one relationships at runtime by checking if the target collection type is <code>Entity</code><li>Locates any existing relationship source for the target entity<li>Safely removes the previous relationship using <code>try_remove()</code> (gracefully handling missing entities)<li>Establishes the new relationship</ol><p>The implementation uses a new method <code>source_to_remove_before_add()</code> in the <code>RelationshipSourceCollection</code> trait to abstract the difference between one-to-one and one-to-many relationships.<h3 id=implementation-details>Implementation Details</h3><p>The core changes happen in two key areas:<ol><li><strong>Relationship hook modification</strong> (<code>relationship/mod.rs</code>):<br> Added logic in <code>on_insert</code> to detect and remove conflicting relationships:</ol><pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// New logic in on_insert hook
</span><span style=color:#fa6e32>let</span><span> current_source_to_remove </span><span style=color:#ed9366>=</span><span> world
</span><span>    </span><span style=color:#ed9366>.</span><span style=color:#f07171>get_entity</span><span>(target_entity)
</span><span>    </span><span style=color:#ed9366>.</span><span style=color:#f07171>ok</span><span>()
</span><span>    </span><span style=color:#ed9366>.</span><span style=color:#f07171>and_then</span><span>(|</span><span style=color:#ff8f40>target_entity_ref</span><span>| target_entity_ref</span><span style=color:#ed9366>.</span><span>get</span><span style=color:#ed9366>::</span><span><</span><span style=color:#fa6e32>Self</span><span style=color:#ed9366>::</span><span>RelationshipTarget>())
</span><span>    </span><span style=color:#ed9366>.</span><span style=color:#f07171>and_then</span><span>(|</span><span style=color:#ff8f40>relationship_target</span><span>| {
</span><span>        relationship_target
</span><span>            </span><span style=color:#ed9366>.</span><span style=color:#f07171>collection</span><span>()
</span><span>            </span><span style=color:#ed9366>.</span><span style=color:#f07171>source_to_remove_before_add</span><span>()
</span><span>    })</span><span style=color:#61676ccc>;
</span><span>
</span><span style=color:#fa6e32>if let </span><span style=color:#55b4d4;font-style:italic>Some</span><span>(current_source) </span><span style=color:#ed9366>=</span><span> current_source_to_remove {
</span><span>    world</span><span style=color:#ed9366>.</span><span style=color:#f07171>commands</span><span>()</span><span style=color:#ed9366>.</span><span style=color:#f07171>entity</span><span>(current_source)</span><span style=color:#ed9366>.</span><span>try_remove</span><span style=color:#ed9366>::</span><span><</span><span style=color:#fa6e32>Self</span><span>>()</span><span style=color:#61676ccc>;
</span><span>}
</span></code></pre><ol start=2><li><strong>Relationship source behavior</strong> (<code>relationship_source_collection.rs</code>):<br> Implemented the new method for <code>Entity</code> (one-to-one) and removed panic assertions:</ol><pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before: Panic on conflict
</span><span style=color:#fa6e32>fn </span><span style=color:#f29718>add</span><span>(</span><span style=color:#ed9366>&</span><span style=color:#fa6e32>mut </span><span style=color:#ff8f40>self</span><span>, </span><span style=color:#ff8f40>entity</span><span style=color:#61676ccc>:</span><span> Entity) </span><span style=color:#61676ccc>-> </span><span style=color:#fa6e32>bool </span><span>{
</span><span>    </span><span style=color:#f07171>assert_eq!</span><span>(</span><span style=color:#ed9366>...</span><span>)</span><span style=color:#61676ccc>; </span><span style=color:#abb0b6;font-style:italic>// Removed
</span><span>    </span><span style=color:#ed9366>*</span><span style=color:#55b4d4;font-style:italic>self </span><span style=color:#ed9366>=</span><span> entity</span><span style=color:#61676ccc>;
</span><span>    </span><span style=color:#ff8f40>true
</span><span>}
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After: New conflict detection
</span><span style=color:#fa6e32>fn </span><span style=color:#f29718>source_to_remove_before_add</span><span>(</span><span style=color:#ed9366>&</span><span style=color:#ff8f40>self</span><span>) </span><span style=color:#61676ccc>-> </span><span style=color:#55b4d4;font-style:italic>Option</span><span>&LTEntity> {
</span><span>    </span><span style=color:#fa6e32>if </span><span style=color:#ed9366>*</span><span style=color:#55b4d4;font-style:italic>self </span><span style=color:#ed9366>!= </span><span>Entity</span><span style=color:#ed9366>::</span><span style=color:#ff8f40>PLACEHOLDER </span><span>{
</span><span>        </span><span style=color:#55b4d4;font-style:italic>Some</span><span>(</span><span style=color:#ed9366>*</span><span style=color:#55b4d4;font-style:italic>self</span><span>)
</span><span>    } </span><span style=color:#fa6e32>else </span><span>{
</span><span>        </span><span style=color:#55b4d4;font-style:italic>None
</span><span>    }
</span><span>}
</span></code></pre><h3 id=testing-strategy>Testing Strategy</h3><p>The test case was refactored to verify the new behavior instead of expecting a panic:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>test</span><span>]
</span><span style=color:#fa6e32>fn </span><span style=color:#f29718>one_to_one_relationship_shared_target</span><span>() {
</span><span>    </span><span style=color:#abb0b6;font-style:italic>// ...setup...
</span><span>    world</span><span style=color:#ed9366>.</span><span style=color:#f07171>entity_mut</span><span>(a)</span><span style=color:#ed9366>.</span><span style=color:#f07171>insert</span><span>(Above(c))</span><span style=color:#61676ccc>;
</span><span>    world</span><span style=color:#ed9366>.</span><span style=color:#f07171>entity_mut</span><span>(b)</span><span style=color:#ed9366>.</span><span style=color:#f07171>insert</span><span>(Above(c))</span><span style=color:#61676ccc>;
</span><span>    
</span><span>    </span><span style=color:#abb0b6;font-style:italic>// Verification
</span><span>    </span><span style=color:#f07171>assert!</span><span>(world</span><span style=color:#ed9366>.</span><span>get</span><span style=color:#ed9366>::</span><span>&LTAbove>(a)</span><span style=color:#ed9366>.</span><span style=color:#f07171>is_none</span><span>())</span><span style=color:#61676ccc>;
</span><span>    </span><span style=color:#f07171>assert_eq!</span><span>(world</span><span style=color:#ed9366>.</span><span>get</span><span style=color:#ed9366>::</span><span>&LTAbove>(b)</span><span style=color:#ed9366>.</span><span style=color:#f07171>unwrap</span><span>()</span><span style=color:#ed9366>.</span><span style=color:#ff8f40>0</span><span style=color:#61676ccc>,</span><span> c)</span><span style=color:#61676ccc>;
</span><span>    </span><span style=color:#f07171>assert_eq!</span><span>(world</span><span style=color:#ed9366>.</span><span>get</span><span style=color:#ed9366>::</span><span>&LTBelow>(c)</span><span style=color:#ed9366>.</span><span style=color:#f07171>unwrap</span><span>()</span><span style=color:#ed9366>.</span><span style=color:#ff8f40>0</span><span style=color:#61676ccc>,</span><span> b)</span><span style=color:#61676ccc>;
</span><span>}
</span></code></pre><h3 id=technical-insights>Technical Insights</h3><p>Key design decisions:<ul><li><strong>Runtime type checking</strong>: Using <code>TypeId</code> avoids complex trait specialization while maintaining clear separation between one-to-one and one-to-many relationships<li><strong>Graceful removal</strong>: <code>try_remove()</code> prevents cascading failures if the previous source entity was despawned<li><strong>Command deferral</strong>: Works correctly with Bevy’s command queue system<li><strong>Placeholder handling</strong>: Maintains the <code>Entity::PLACEHOLDER</code> convention for unset relationships</ul><h3 id=impact>Impact</h3><p>This change:<ol><li>Eliminates a common panic scenario in relationship management<li>Makes relationship assignment more intuitive (last writer wins)<li>Maintains backward compatibility while fixing behavior<li>Preserves the existing API surface area</ol><p>The solution demonstrates good use of trait composition to extend functionality without breaking existing contracts. The <code>try_remove()</code> approach shows thoughtful error handling where complete validation would be impractical.<h2 id=visual-representation>Visual Representation</h2><pre class=language-mermaid data-lang=mermaid style=color:#61676c;background-color:#fafafa><code class=language-mermaid data-lang=mermaid><span>graph TD
</span><span>    A[Relationship.on_insert] --> B{Is one-to-one?}
</span><span>    B -->|Yes| C[Find existing source]
</span><span>    C --> D{Existing relationship?}
</span><span>    D -->|Yes| E[Remove old relationship]
</span><span>    D -->|No| F[Add new relationship]
</span><span>    E --> F
</span><span>    B -->|No| F
</span></code></pre><h2 id=key-files-changed>Key Files Changed</h2><h3 id=crates-bevy-ecs-src-relationship-mod-rs-30-14><code>crates/bevy_ecs/src/relationship/mod.rs</code> (+30/-14)</h3><p>Added conflict resolution logic to relationship insertion:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// New conflict detection and removal
</span><span style=color:#fa6e32>let</span><span> current_source_to_remove </span><span style=color:#ed9366>=</span><span> world
</span><span>    </span><span style=color:#ed9366>.</span><span style=color:#f07171>get_entity</span><span>(target_entity)
</span><span>    </span><span style=color:#ed9366>.</span><span style=color:#f07171>ok</span><span>()
</span><span>    </span><span style=color:#ed9366>.</span><span style=color:#f07171>and_then</span><span>(|</span><span style=color:#ff8f40>target_entity_ref</span><span>| target_entity_ref</span><span style=color:#ed9366>.</span><span>get</span><span style=color:#ed9366>::</span><span><</span><span style=color:#fa6e32>Self</span><span style=color:#ed9366>::</span><span>RelationshipTarget>())
</span><span>    </span><span style=color:#ed9366>.</span><span style=color:#f07171>and_then</span><span>(|</span><span style=color:#ff8f40>relationship_target</span><span>| {
</span><span>        relationship_target
</span><span>            </span><span style=color:#ed9366>.</span><span style=color:#f07171>collection</span><span>()
</span><span>            </span><span style=color:#ed9366>.</span><span style=color:#f07171>source_to_remove_before_add</span><span>()
</span><span>    })</span><span style=color:#61676ccc>;
</span><span>
</span><span style=color:#fa6e32>if let </span><span style=color:#55b4d4;font-style:italic>Some</span><span>(current_source) </span><span style=color:#ed9366>=</span><span> current_source_to_remove {
</span><span>    world</span><span style=color:#ed9366>.</span><span style=color:#f07171>commands</span><span>()</span><span style=color:#ed9366>.</span><span style=color:#f07171>entity</span><span>(current_source)</span><span style=color:#ed9366>.</span><span>try_remove</span><span style=color:#ed9366>::</span><span><</span><span style=color:#fa6e32>Self</span><span>>()</span><span style=color:#61676ccc>;
</span><span>}
</span></code></pre><h3 id=crates-bevy-ecs-src-relationship-relationship-source-collection-rs-15-0><code>crates/bevy_ecs/src/relationship/relationship_source_collection.rs</code> (+15/-0)</h3><p>Modified one-to-one relationship handling:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before (removed):
</span><span style=color:#f07171>assert_eq!</span><span>(</span><span style=color:#ed9366>*</span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#61676ccc>, </span><span>Entity</span><span style=color:#ed9366>::</span><span style=color:#ff8f40>PLACEHOLDER</span><span style=color:#61676ccc>, </span><span style=color:#ed9366>...</span><span>)</span><span style=color:#61676ccc>;
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After (new method):
</span><span style=color:#fa6e32>fn </span><span style=color:#f29718>source_to_remove_before_add</span><span>(</span><span style=color:#ed9366>&</span><span style=color:#ff8f40>self</span><span>) </span><span style=color:#61676ccc>-> </span><span style=color:#55b4d4;font-style:italic>Option</span><span>&LTEntity> {
</span><span>    </span><span style=color:#fa6e32>if </span><span style=color:#ed9366>*</span><span style=color:#55b4d4;font-style:italic>self </span><span style=color:#ed9366>!= </span><span>Entity</span><span style=color:#ed9366>::</span><span style=color:#ff8f40>PLACEHOLDER </span><span>{
</span><span>        </span><span style=color:#55b4d4;font-style:italic>Some</span><span>(</span><span style=color:#ed9366>*</span><span style=color:#55b4d4;font-style:italic>self</span><span>)
</span><span>    } </span><span style=color:#fa6e32>else </span><span>{
</span><span>        </span><span style=color:#55b4d4;font-style:italic>None
</span><span>    }
</span><span>}
</span></code></pre><h2 id=further-reading>Further Reading</h2><ol><li><a rel="noopener nofollow noreferrer" href=https://bevyengine.org/learn/book/ecs/relationships/ target=_blank>Bevy ECS Relationships Documentation</a><li><a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/Entity_component_system target=_blank>Entity Component System Pattern</a><li><a rel="noopener nofollow noreferrer" href=https://doc.rust-lang.org/std/any/struct.TypeId.html target=_blank>Rust TypeId Documentation</a></ol></div><div data-is-md-page=true data-patch-exists=true data-patch-path=/pull_request/bevy/2025-07/pr_20232.patch id=patch-info style=display:none></div><div class=bottom-spacer></div></div></div>