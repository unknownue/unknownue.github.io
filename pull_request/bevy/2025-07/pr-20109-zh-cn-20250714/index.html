<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://unknownue.github.io name=base><title>
         #20109 Mitigate Tracy dep version woes
        
    </title><meta content="#20109 Mitigate Tracy dep version woes" property=og:title><meta content="A personal blog built with Zola and Apollo theme" property=og:description><meta content="A personal blog built with Zola and Apollo theme" name=description><link href=/icons/favicon.png rel=icon type=image/png><link href=https://unknownue.github.io/fonts.css rel=stylesheet><script src=https://unknownue.github.io/js/codeblock.js></script><script src=https://unknownue.github.io/js/toc.js></script><script src=https://unknownue.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Unknownue's Blog" href=https://unknownue.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://unknownue.github.io/theme/light.css rel=stylesheet><link href=https://unknownue.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://unknownue.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://unknownue.github.io/main.css media=screen rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js></script><script>// Initialize mermaid once DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            mermaid.initialize({
                startOnLoad: false,
                theme: document.body && document.body.classList.contains('dark') ? 'dark' : 'default',
                securityLevel: 'loose',
                flowchart: {
                    useMaxWidth: true,
                    htmlLabels: true
                },
                sequence: {
                    diagramMarginX: 50,
                    diagramMarginY: 10,
                    actorMargin: 50,
                    width: 150,
                    height: 65
                }
            });
        });</script><script src=https://unknownue.github.io/js/main.js></script><script defer src=https://unknownue.github.io/js/label-colors.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/rust.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/typescript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/go.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/cpp.min.js></script><script>// Ensure highlight.js is properly configured
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof hljs !== 'undefined') {
                hljs.configure({
                    languages: ['rust', 'javascript', 'python', 'cpp', 'go', 'typescript'],
                    ignoreUnescapedHTML: true
                });
                console.log('Highlight.js configured in header');
            }
        });</script><link href=https://cdn.jsdelivr.net/npm/diff2html/bundles/css/diff2html.min.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/diff2html/bundles/js/diff2html-ui.min.js></script><script src=https://unknownue.github.io/js/syntax-highlight.js></script><script src=https://unknownue.github.io/js/diff-sidebar.js></script><script src="https://unknownue.github.io/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><div class=content><header><div class=main><a href=https://unknownue.github.io>Unknownue's Blog</a><div class=socials><a class=social href=https://github.com/unknownue rel=me> <img alt=github src=https://unknownue.github.io/icons/social/github.svg> </a><a class=social href=https://github.com/unknownue/unknownue.github.io rel=me> <img alt=github-io src=https://unknownue.github.io/icons/social/rss.svg> </a></div></div><nav><a href=https://unknownue.github.io/posts style=margin-left:.25em>/posts</a><a href=https://unknownue.github.io/projects style=margin-left:.25em>/projects</a><a href=https://unknownue.github.io/about style=margin-left:.25em>/about</a><a href=https://unknownue.github.io/tags style=margin-left:.25em>/tags</a><button title="$SHORTCUT to open search" class=search-button id=search-button><img alt=Search class=search-icon src=https://unknownue.github.io/icons/search.svg></button><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><div id=modal-content><h1 class=page-header id=modalTitle>Search</h1><div id=searchBar><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search... role=combobox spellcheck=false><button title="Clear search" class=clear-button id=clear-search><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></button></div><div id=results-container><div id=results-info><span id=zero_results style=display:none>No results</span><span id=one_result style=display:none>1 result</span><span id=many_results style=display:none>$NUMBER results</span></div><div id=results role=listbox></div></div></div></div><a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://unknownue.github.io/icons/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://unknownue.github.io/icons/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><div class=pull-request-page><article class=md-content-page style=display:none></article><div class=back-link><a href=/pull_request/bevy/2025-07/>← Back to Pull Requests</a></div><div class=pr-metadata><span class=pr-date>2025-07-14</span><div class=language-switcher><a class=lang-link data-lang=en href=/pull_request/bevy/2025-07/pr-20109-en-20250714>English</a> / <span class="lang-link active" data-lang=zh-cn>中文</span></div></div><div class=pr-content><h1 id=prfen-xi-bao-gao-mitigate-tracy-dep-version-woes>PR分析报告：Mitigate Tracy dep version woes</h1><h2 id=ji-chu-xin-xi>基础信息</h2><ul><li><strong>标题</strong>: Mitigate Tracy dep version woes<li><strong>PR链接</strong>: https://github.com/bevyengine/bevy/pull/20109<li><strong>作者</strong>: liamaharon<li><strong>状态</strong>: 已合并<li><strong>标签</strong>: C-Docs, C-Performance, S-Ready-For-Final-Review, A-Diagnostics<li><strong>创建时间</strong>: 2025-07-13T06:14:40Z<li><strong>合并时间</strong>: 2025-07-14T21:18:55Z<li><strong>合并人</strong>: mockersf</ul><h2 id=miao-shu-fan-yi>描述翻译</h2><h3 id=mu-biao>目标</h3><p>Tracy依赖版本兼容性问题可能成为开发痛点。作者在遵循<a rel="noopener nofollow noreferrer" href=https://github.com/bevyengine/bevy/blob/1525dff7ada14714b35c8908381d534a7833faa3/docs/profiling.md#tracy-profiler target=_blank>Profiling Tracy文档</a>时遇到以下连接错误：</p><img alt="Screenshot 2025-07-13 at 14 39 27" height=154 src=https://github.com/user-attachments/assets/97634b37-253c-40ab-86ca-6eba02985638 width=473><p>检查<a rel="noopener nofollow noreferrer" href=https://github.com/bevyengine/bevy/blob/1525dff7ada14714b35c8908381d534a7833faa3/crates/bevy_log/Cargo.toml#L32-L35 target=_blank>tracy-client版本</a>后，作者误以为需要Tracy <code>0.11.1</code>。但实际是Cargo自动拉取了<code>tracy-client 0.18.2</code>而非<code>0.18.0</code>，真正需要的Tracy版本是<code>0.12.2</code>（该版本尚未在<code>brew</code>发布）。<h3 id=jie-jue-fang-an>解决方案</h3><ol><li>在文档中明确说明如何确定兼容的Tracy版本<li>添加说明：当brew未提供所需版本时，macOS用户需从源码编译<li>修复文档中图片缩进问题</ol><h3 id=ce-shi-yan-zheng>测试验证</h3><ul><li>在macOS本地运行Tracy验证<li>更改具有跨平台普适性<li>测试建议：按更新后的文档说明操作即可</ul><h2 id=prji-shu-fen-xi>PR技术分析</h2><h3 id=wen-ti-bei-jing>问题背景</h3><p>Tracy是Bevy引擎的性能分析工具，但版本兼容性问题导致开发者配置困难。核心问题在于：<ol><li>Tracy客户端(tracy-client)与服务端(Tracy)需严格版本匹配<li>Cargo的依赖解析可能自动升级tracy-client版本<li>Homebrew的Tracy版本更新滞后<li>现有文档未提供明确的版本确定方法</ol><p>这导致开发者按文档操作时出现版本不匹配错误，尤其影响macOS用户通过brew安装的场景。<h3 id=jie-jue-fang-an-shi-xian>解决方案实现</h3><p>文档更新聚焦两个关键改进：<p><strong>1. 添加版本确定流程</strong><pre class=language-markdown data-lang=markdown style=color:#61676c;background-color:#fafafa><code class=language-markdown data-lang=markdown><span>To determine which Tracy version to install
</span><span>
</span><span style=color:#4cbf99>1. </span><span>Run </span><span style=color:#ed9366;background-color:#61676c10>`cargo tree --features bevy/trace_tracy | grep tracy`</span><span> in your Bevy workspace root to see which tracy dep versions are used
</span><span style=color:#4cbf99>2.</span><span> Cross reference the tracy dep versions with the [Version Support Table](</span><span style=color:#4cbf99;font-style:italic;text-decoration:underline>https://github.com/nagisa/rust_tracy_client?tab=readme-ov-file#version-support-table</span><span>)
</span></code></pre><p>此变更通过<code>cargo tree</code>命令动态获取实际依赖版本，替代了之前依赖静态Cargo.toml文件的方式。开发者可精确匹配<a href="https://github.com/nagisa/rust_tracy_client?tab=readme-ov-file#version-support-table" rel="noopener nofollow noreferrer" target=_blank>Tracy版本支持表</a>，避免手动检查带来的误差。<p><strong>2. 明确macOS编译说明</strong><pre class=language-markdown data-lang=markdown style=color:#61676c;background-color:#fafafa><code class=language-markdown data-lang=markdown><span>On macOS, Tracy can be installed through Homebrew by running </span><span style=color:#ed9366;background-color:#61676c10>`brew install tracy`</span><span>... 
</span><span>Note that </span><span style=color:#ed9366;background-color:#61676c10>`brew`</span><span> does not always have the latest version of Tracy available, 
</span><span>in which cases you may be required to build from source.
</span></code></pre><p>此补充解决了brew版本滞后的实际问题，给出明确的应对方案。<p><strong>3. 修复文档格式</strong><pre class=language-diff data-lang=diff style=color:#61676c;background-color:#fafafa><code class=language-diff data-lang=diff><span style=color:#f07171>-    ![Xcode's menu bar open to Debug > Debug Executable...](https://github.com/user-attachments/assets/efdc5037-0957-4227-b29d-9a789ba17a0a)
</span><span style=color:#86b300>+   ![Xcode's menu bar open to Debug > Debug Executable...](https://github.com/user-attachments/assets/efdc5037-0957-4227-b29d-9a789ba17a0a)
</span></code></pre><p>移除图片链接前的多余空格，修复了Markdown渲染问题。<h3 id=ji-shu-dong-cha>技术洞察</h3><ol><li><strong>动态依赖检测</strong>：使用<code>cargo tree</code>替代静态文件检查，更准确反映实际依赖关系<li><strong>版本矩阵引用</strong>：直接链接到官方<a href="https://github.com/nagisa/rust_tracy_client?tab=readme-ov-file#version-support-table" rel="noopener nofollow noreferrer" target=_blank>Version Support Table</a>，确保信息可持续更新<li><strong>跨平台考量</strong>：明确区分macOS的特殊处理，避免一刀切方案<li><strong>错误预防</strong>：通过清晰步骤指导，减少用户配置错误可能性</ol><h3 id=ying-xiang-fen-xi>影响分析</h3><ol><li><strong>开发者体验提升</strong>：减少Tracy配置时的试错时间<li><strong>问题排查标准化</strong>：提供明确的版本诊断路径<li><strong>文档可维护性</strong>：链接外部版本表，降低Bevy文档更新负担<li><strong>跨平台一致性</strong>：统一macOS/Linux/Windows的配置认知</ol><h2 id=guan-jian-wen-jian-bian-geng>关键文件变更</h2><h3 id=docs-profiling-md>docs/profiling.md</h3><p><strong>变更说明</strong>：更新Tracy配置指南，解决版本兼容性问题<pre class=language-diff data-lang=diff style=color:#61676c;background-color:#fafafa><code class=language-diff data-lang=diff><span style=color:#c594c5>@@ -67,9 +67,14 @@ </span><span style=color:#399ee6>The [Tracy profiling tool](https://github.com/wolfpld/tracy) is:
</span><span> 
</span><span> There are binaries available for Windows, and installation / build instructions for other operating systems can be found in the [Tracy documentation PDF](https://github.com/wolfpld/tracy/releases/latest/download/tracy.pdf).
</span><span> 
</span><span style=color:#86b300>+To determine which Tracy version to install
</span><span style=color:#86b300>+
</span><span style=color:#86b300>+1. Run `cargo tree --features bevy/trace_tracy | grep tracy` in your Bevy workspace root to see which tracy dep versions are used
</span><span style=color:#86b300>+2. Cross reference the tracy dep versions with the [Version Support Table](https://github.com/nagisa/rust_tracy_client?tab=readme-ov-file#version-support-table)
</span><span style=color:#86b300>+
</span><span> It has a command line capture tool that can record the execution of graphical applications, saving it as a profile file. Tracy has a GUI to inspect these profile files. The GUI app also supports live capture, showing you in real time the trace of your app. The version of tracy must be matched to the version of tracing-tracy used in bevy. A compatibility table can be found on [crates.io](https://crates.io/crates/tracing-tracy) and the version used can be found [here](https://github.com/bevyengine/bevy/blob/latest/crates/bevy_log/Cargo.toml).
</span><span> 
</span><span style=color:#f07171>-On macOS, Tracy can be installed through Homebrew by running `brew install tracy`, and the GUI client can be launched by running `tracy`.
</span><span style=color:#86b300>+On macOS, Tracy can be installed through Homebrew by running `brew install tracy`, and the GUI client can be launched by running `tracy`. Note that `brew` does not always have the latest version of Tracy available, in which cases you may be required to build from source.
</span><span> 
</span><span> In one terminal, run:
</span><span> `./capture-release -o my_capture.tracy`
</span><span style=color:#c594c5>@@ -154,20 +159,20 @@ </span><span style=color:#399ee6>Follow the steps below to start GPU debugging on macOS. There is no need to crea
</span><span> 
</span><span> 1. In the menu bar click on Debug > Debug Executable…
</span><span> 
</span><span style=color:#f07171>-    ![Xcode's menu bar open to Debug > Debug Executable...](https://github.com/user-attachments/assets/efdc5037-0957-4227-b29d-9a789ba17a0a)
</span><span style=color:#86b300>+   ![Xcode's menu bar open to Debug > Debug Executable...](https://github.com/user-attachments/assets/efdc5037-0957-4227-b29d-9a789ba17a0a)
</span><span> 
</span><span> 2. Select your executable from your project’s target folder.
</span><span> 3. The Scheme Editor will open. If your assets are not located next to your executable, you can go to the Arguments tab and set `BEVY_ASSET_ROOT` to the absolute path for your project (the parent of your assets folder). The rest of the defaults should be fine.
</span><span> 
</span><span style=color:#f07171>-    ![Xcode's Schema Editor opened to an environment variable configuration](https://github.com/user-attachments/assets/29cafb05-0c49-4777-8d41-8643812e8f6a)
</span><span style=color:#86b300>+   ![Xcode's Schema Editor opened to an environment variable configuration](https://github.com/user-attachments/assets/29cafb05-0c49-4777-8d41-8643812e8f6a)
</span><span> 
</span><span> 4. Click the play button in the top left and this should start your bevy app.
</span><span> 
</span><span style=color:#f07171>-    ![A cursor hovering over the play button in XCode](https://github.com/user-attachments/assets/859580e2-779b-4db8-8ea6-73cf4ef696c9)
</span><span style=color:#86b300>+   ![A cursor hovering over the play button in XCode](https://github.com/user-attachments/assets/859580e2-779b-4db8-8ea6-73cf4ef696c9)
</span><span> 
</span><span> 5. Go back to Xcode and click on the Metal icon in the bottom drawer and then Capture in the following the popup menu.
</span><span> 
</span><span style=color:#f07171>-    ![A cursor hovering over the Capture button in the Metal debugging popup menu](https://github.com/user-attachments/assets/c0ce1591-0a53-499b-bd1b-4d89538ea248)
</span><span style=color:#86b300>+   ![A cursor hovering over the Capture button in the Metal debugging popup menu](https://github.com/user-attachments/assets/c0ce1591-0a53-499b-bd1b-4d89538ea248)
</span><span> 
</span><span> 6. Start debugging and profiling!
</span><span> 
</span></code></pre><h2 id=ji-shu-guan-xi-tu>技术关系图</h2><pre class=language-mermaid data-lang=mermaid style=color:#61676c;background-color:#fafafa><code class=language-mermaid data-lang=mermaid><span>graph TD
</span><span>    A[开发者遇到 Tracy 版本错误] --> B[检查现有文档]
</span><span>    B --> C[发现版本匹配问题]
</span><span>    C --> D[分析依赖解析机制]
</span><span>    D --> E[添加版本检测命令]
</span><span>    E --> F[明确brew限制说明]
</span><span>    F --> G[修复文档格式]
</span><span>    G --> H[验证配置流程]
</span></code></pre><h2 id=yan-shen-yue-du>延伸阅读</h2><ol><li><a rel="noopener nofollow noreferrer" href=https://github.com/wolfpld/tracy/releases/latest/download/tracy.pdf target=_blank>Tracy官方文档</a> - 完整安装和使用指南<li><a href="https://github.com/nagisa/rust_tracy_client?tab=readme-ov-file#version-support-table" rel="noopener nofollow noreferrer" target=_blank>rust_tracy_client版本支持表</a> - 客户端/服务端兼容性参考<li><a rel="noopener nofollow noreferrer" href=https://doc.rust-lang.org/cargo/commands/cargo-tree.html target=_blank>Cargo tree命令文档</a> - 依赖树分析工具<li><a rel="noopener nofollow noreferrer" href=https://github.com/bevyengine/bevy/blob/main/docs/profiling.md target=_blank>Bevy性能分析指南</a> - 完整性能工具链配置</ol><p>此PR通过精准的文档改进，系统性解决了Tracy版本配置痛点，体现了优秀开发者文档应具备的：准确的技术细节、可操作的步骤说明、对潜在问题的预见性提示。</div><div data-is-md-page=true data-patch-exists=true data-patch-path=/pull_request/bevy/2025-07/pr_20109.patch id=patch-info style=display:none></div><div class=bottom-spacer></div></div></div>