<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://unknownue.github.io name=base><title>
         #20032 SliderPrecision component
        
    </title><meta content="#20032 SliderPrecision component" property=og:title><meta content="A personal blog built with Zola and Apollo theme" property=og:description><meta content="A personal blog built with Zola and Apollo theme" name=description><link href=/icons/favicon.png rel=icon type=image/png><link href=https://unknownue.github.io/fonts.css rel=stylesheet><script src=https://unknownue.github.io/js/codeblock.js></script><script src=https://unknownue.github.io/js/toc.js></script><script src=https://unknownue.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Unknownue's Blog" href=https://unknownue.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://unknownue.github.io/theme/light.css rel=stylesheet><link href=https://unknownue.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://unknownue.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://unknownue.github.io/main.css media=screen rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js></script><script>// Initialize mermaid once DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            mermaid.initialize({
                startOnLoad: false,
                theme: document.body && document.body.classList.contains('dark') ? 'dark' : 'default',
                securityLevel: 'loose',
                flowchart: {
                    useMaxWidth: true,
                    htmlLabels: true
                },
                sequence: {
                    diagramMarginX: 50,
                    diagramMarginY: 10,
                    actorMargin: 50,
                    width: 150,
                    height: 65
                }
            });
        });</script><script src=https://unknownue.github.io/js/main.js></script><script defer src=https://unknownue.github.io/js/label-colors.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/rust.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/typescript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/go.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/cpp.min.js></script><script>// Ensure highlight.js is properly configured
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof hljs !== 'undefined') {
                hljs.configure({
                    languages: ['rust', 'javascript', 'python', 'cpp', 'go', 'typescript'],
                    ignoreUnescapedHTML: true
                });
                console.log('Highlight.js configured in header');
            }
        });</script><link href=https://cdn.jsdelivr.net/npm/diff2html/bundles/css/diff2html.min.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/diff2html/bundles/js/diff2html-ui.min.js></script><script src=https://unknownue.github.io/js/syntax-highlight.js></script><script src=https://unknownue.github.io/js/diff-sidebar.js></script><script src="https://unknownue.github.io/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><div class=content><header><div class=main><a href=https://unknownue.github.io>Unknownue's Blog</a><div class=socials><a class=social href=https://github.com/unknownue rel=me> <img alt=github src=https://unknownue.github.io/icons/social/github.svg> </a><a class=social href=https://github.com/unknownue/unknownue.github.io rel=me> <img alt=github-io src=https://unknownue.github.io/icons/social/rss.svg> </a></div></div><nav><a href=https://unknownue.github.io/posts style=margin-left:.25em>/posts</a><a href=https://unknownue.github.io/projects style=margin-left:.25em>/projects</a><a href=https://unknownue.github.io/about style=margin-left:.25em>/about</a><a href=https://unknownue.github.io/tags style=margin-left:.25em>/tags</a><button title="$SHORTCUT to open search" class=search-button id=search-button><img alt=Search class=search-icon src=https://unknownue.github.io/icons/search.svg></button><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><div id=modal-content><h1 class=page-header id=modalTitle>Search</h1><div id=searchBar><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search... role=combobox spellcheck=false><button title="Clear search" class=clear-button id=clear-search><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></button></div><div id=results-container><div id=results-info><span id=zero_results style=display:none>No results</span><span id=one_result style=display:none>1 result</span><span id=many_results style=display:none>$NUMBER results</span></div><div id=results role=listbox></div></div></div></div><a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://unknownue.github.io/icons/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://unknownue.github.io/icons/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><div class=pull-request-page><article class=md-content-page style=display:none></article><div class=back-link><a href=/pull_request/bevy/2025-07/>← Back to Pull Requests</a></div><div class=pr-metadata><span class=pr-date>2025-07-09</span><div class=language-switcher><span class="lang-link active" data-lang=en>English</span> / <a class=lang-link data-lang=zh-cn href=/pull_request/bevy/2025-07/pr-20032-zh-cn-20250709>中文</a></div></div><div class=pr-content><h1 id=sliderprecision-component>SliderPrecision component</h1><h2 id=basic-information>Basic Information</h2><ul><li><strong>Title</strong>: SliderPrecision component<li><strong>PR Link</strong>: https://github.com/bevyengine/bevy/pull/20032<li><strong>Author</strong>: viridia<li><strong>Status</strong>: MERGED<li><strong>Labels</strong>: C-Feature, A-UI, S-Ready-For-Final-Review, X-Uncontroversial, D-Modest<li><strong>Created</strong>: 2025-07-08T16:37:29Z<li><strong>Merged</strong>: 2025-07-09T20:26:38Z<li><strong>Merged By</strong>: alice-i-cecile</ul><h2 id=description-translation>Description Translation</h2><p>This PR adds a <code>SliderPrecision</code> component that lets you control the rounding when dragging a slider.<p>Part of #19236<h2 id=the-story-of-this-pull-request>The Story of This Pull Request</h2><p>The slider widgets in Bevy’s UI system lacked control over value precision during user interaction. When users dragged a slider thumb or clicked on the track, the calculated value would often have excessive decimal places that weren’t meaningful for the specific use case. This was particularly problematic for sliders controlling discrete values or values requiring specific precision levels.<p>To address this, the PR introduces a new <code>SliderPrecision</code> component. This component allows developers to specify the rounding behavior during slider interactions. The implementation approach was straightforward: add a new component that stores the desired precision level as an integer representing decimal places, then apply rounding in the slider’s interaction systems.<p>The precision is implemented using a rounding function that operates based on powers of 10. The component’s integer value determines the rounding factor:<ul><li>Positive values round to decimal places (e.g., 2 rounds to hundredths)<li>Zero rounds to integers<li>Negative values round to powers of ten (e.g., -1 rounds to tens)</ul><p>The component was designed to be optional and backward compatible. When present, it modifies the slider’s value calculation during two interaction points:<ol><li>Track clicks (when clicking outside the thumb)<li>Thumb dragging</ol><p>The rounding is applied after calculating the raw value but before clamping to the slider’s range and before triggering any value change callbacks. This ensures the final value respects both the precision setting and the valid range.<p>Performance impact is minimal since the rounding operation is a simple mathematical calculation applied only during user interactions. The component was added to the existing slider systems with minimal disruption to the existing logic.<p>This change provides more control over slider behavior without breaking existing functionality. Developers can now ensure slider values align with their application’s precision requirements during direct manipulation.<h2 id=visual-representation>Visual Representation</h2><pre class=language-mermaid data-lang=mermaid style=color:#61676c;background-color:#fafafa><code class=language-mermaid data-lang=mermaid><span>graph TD
</span><span>    A[SliderPrecision] --> B[slider_on_pointer_down]
</span><span>    A --> C[slider_on_drag]
</span><span>    B --> D[Round value on track click]
</span><span>    C --> E[Round value during drag]
</span></code></pre><h2 id=key-files-changed>Key Files Changed</h2><ol><li><code>crates/bevy_core_widgets/src/core_slider.rs</code> (+69/-8) <ul><li>Added <code>SliderPrecision</code> component and rounding logic<li>Modified interaction systems to use precision<li>Added unit tests for rounding behavior</ul></ol><pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before (track click handling):
</span><span>TrackClick</span><span style=color:#ed9366>::</span><span>Snap </span><span style=color:#ed9366>=></span><span> click_val</span><span style=color:#61676ccc>,
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After (with precision rounding):
</span><span>TrackClick</span><span style=color:#ed9366>::</span><span>Snap </span><span style=color:#ed9366>=></span><span> precision
</span><span>    </span><span style=color:#ed9366>.</span><span style=color:#f07171>map</span><span>(|</span><span style=color:#ff8f40>prec</span><span>| prec</span><span style=color:#ed9366>.</span><span style=color:#f07171>round</span><span>(click_val))
</span><span>    </span><span style=color:#ed9366>.</span><span style=color:#f07171>unwrap_or</span><span>(click_val)</span><span style=color:#61676ccc>,
</span></code></pre><pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before (drag handling):
</span><span style=color:#fa6e32>let</span><span> new_value </span><span style=color:#ed9366>= ...</span><span style=color:#61676ccc>;
</span><span>commands</span><span style=color:#ed9366>.</span><span style=color:#f07171>notify_with</span><span>(</span><span style=color:#ed9366>&</span><span>slider</span><span style=color:#ed9366>.</span><span>on_change</span><span style=color:#61676ccc>,</span><span> new_value)</span><span style=color:#61676ccc>;
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After (with precision rounding):
</span><span style=color:#fa6e32>let</span><span> rounded_value </span><span style=color:#ed9366>=</span><span> range</span><span style=color:#ed9366>.</span><span style=color:#f07171>clamp</span><span>(
</span><span>    precision
</span><span>        </span><span style=color:#ed9366>.</span><span style=color:#f07171>map</span><span>(|</span><span style=color:#ff8f40>prec</span><span>| prec</span><span style=color:#ed9366>.</span><span style=color:#f07171>round</span><span>(new_value))
</span><span>        </span><span style=color:#ed9366>.</span><span style=color:#f07171>unwrap_or</span><span>(new_value)</span><span style=color:#61676ccc>,
</span><span>)</span><span style=color:#61676ccc>;
</span><span>commands</span><span style=color:#ed9366>.</span><span style=color:#f07171>notify_with</span><span>(</span><span style=color:#ed9366>&</span><span>slider</span><span style=color:#ed9366>.</span><span>on_change</span><span style=color:#61676ccc>,</span><span> rounded_value)</span><span style=color:#61676ccc>;
</span></code></pre><pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// New component definition:
</span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>derive</span><span>(Component</span><span style=color:#61676ccc>,</span><span> Debug</span><span style=color:#61676ccc>,</span><span> Default</span><span style=color:#61676ccc>,</span><span> Clone</span><span style=color:#61676ccc>,</span><span> Copy)]
</span><span style=color:#fa6e32>pub struct </span><span style=color:#399ee6>SliderPrecision</span><span>(pub </span><span style=color:#fa6e32>i32</span><span>)</span><span style=color:#61676ccc>;
</span><span>
</span><span style=color:#fa6e32>impl </span><span style=color:#399ee6>SliderPrecision </span><span>{
</span><span>    </span><span style=color:#fa6e32>fn </span><span style=color:#f29718>round</span><span>(</span><span style=color:#ed9366>&</span><span style=color:#ff8f40>self</span><span>, </span><span style=color:#ff8f40>value</span><span style=color:#61676ccc>: </span><span style=color:#fa6e32>f32</span><span>) </span><span style=color:#61676ccc>-> </span><span style=color:#fa6e32>f32 </span><span>{
</span><span>        </span><span style=color:#fa6e32>let</span><span> factor </span><span style=color:#ed9366>= </span><span>ops</span><span style=color:#ed9366>::</span><span>powf(</span><span style=color:#ff8f40>10.0_</span><span style=color:#fa6e32>f32</span><span style=color:#61676ccc>, </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span style=color:#ff8f40>0 </span><span style=color:#ed9366>as </span><span style=color:#fa6e32>f32</span><span>)</span><span style=color:#61676ccc>;
</span><span>        (value </span><span style=color:#ed9366>*</span><span> factor)</span><span style=color:#ed9366>.</span><span style=color:#f07171>round</span><span>() </span><span style=color:#ed9366>/</span><span> factor
</span><span>    }
</span><span>}
</span></code></pre><ol start=2><li><code>examples/ui/feathers.rs</code> (+4/-2) <ul><li>Updated example to demonstrate precision usage</ul></ol><pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before:
</span><span>SliderStep(</span><span style=color:#ff8f40>10.</span><span>)
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After:
</span><span>(SliderStep(</span><span style=color:#ff8f40>10.</span><span>)</span><span style=color:#61676ccc>,</span><span> SliderPrecision(</span><span style=color:#ff8f40>2</span><span>))</span><span style=color:#61676ccc>,
</span></code></pre><ol start=3><li><code>crates/bevy_core_widgets/src/lib.rs</code> (+1/-1) <ul><li>Exported new component for public use</ul></ol><pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before:
</span><span style=color:#fa6e32>pub use </span><span>core_slider</span><span style=color:#ed9366>::</span><span>{ </span><span style=color:#ed9366>...</span><span> SliderStep</span><span style=color:#61676ccc>,</span><span> SliderValue </span><span style=color:#ed9366>... </span><span>}</span><span style=color:#61676ccc>;
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After:
</span><span style=color:#fa6e32>pub use </span><span>core_slider</span><span style=color:#ed9366>::</span><span>{ </span><span style=color:#ed9366>...</span><span> SliderPrecision</span><span style=color:#61676ccc>,</span><span> SliderStep</span><span style=color:#61676ccc>,</span><span> SliderValue </span><span style=color:#ed9366>... </span><span>}</span><span style=color:#61676ccc>;
</span></code></pre><ol start=4><li><code>release-content/release-notes/headless-widgets.md</code> (+1/-1) <ul><li>Added PR to release notes</ul></ol><pre class=language-markdown data-lang=markdown style=color:#61676c;background-color:#fafafa><code class=language-markdown data-lang=markdown><span>// Before:
</span><span>pull_requests: [19366, 19584, 19665, 19778, 19803, 20036]
</span><span>
</span><span>// After:
</span><span>pull_requests: [19366, 19584, 19665, 19778, 19803, 20032, 20036]
</span></code></pre><h2 id=further-reading>Further Reading</h2><ol><li><a rel="noopener nofollow noreferrer" href=https://docs.rs/bevy_ui/latest/bevy_ui/ target=_blank>Bevy UI System Documentation</a><li><a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/Floating-point_arithmetic#Precision_limitations target=_blank>Floating-Point Precision Concepts</a><li><a rel="noopener nofollow noreferrer" href=https://material.io/components/sliders target=_blank>Slider Widget Design Patterns</a></ol></div><div data-is-md-page=true data-patch-exists=true data-patch-path=/pull_request/bevy/2025-07/pr_20032.patch id=patch-info style=display:none></div><div class=bottom-spacer></div></div></div>