<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://unknownue.github.io name=base><title>
         #21056 Improve suggestion when old name for `Justify` is used
        
    </title><meta content="#21056 Improve suggestion when old name for `Justify` is used" property=og:title><meta content="A personal blog built with Zola and Apollo theme" property=og:description><meta content="A personal blog built with Zola and Apollo theme" name=description><link href=/icons/favicon.png rel=icon type=image/png><link href=https://unknownue.github.io/fonts.css rel=stylesheet><script src=https://unknownue.github.io/js/codeblock.js></script><script src=https://unknownue.github.io/js/toc.js></script><script src=https://unknownue.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Unknownue's Blog" href=https://unknownue.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://unknownue.github.io/theme/light.css rel=stylesheet><link href=https://unknownue.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://unknownue.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://unknownue.github.io/main.css media=screen rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js></script><script>// Initialize mermaid once DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            mermaid.initialize({
                startOnLoad: false,
                theme: document.body && document.body.classList.contains('dark') ? 'dark' : 'default',
                securityLevel: 'loose',
                flowchart: {
                    useMaxWidth: true,
                    htmlLabels: true
                },
                sequence: {
                    diagramMarginX: 50,
                    diagramMarginY: 10,
                    actorMargin: 50,
                    width: 150,
                    height: 65
                }
            });
        });</script><script src=https://unknownue.github.io/js/main.js></script><script defer src=https://unknownue.github.io/js/label-colors.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/rust.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/typescript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/go.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/cpp.min.js></script><script>// Ensure highlight.js is properly configured
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof hljs !== 'undefined') {
                hljs.configure({
                    languages: ['rust', 'javascript', 'python', 'cpp', 'go', 'typescript'],
                    ignoreUnescapedHTML: true
                });
                console.log('Highlight.js configured in header');
            }
        });</script><link href=https://cdn.jsdelivr.net/npm/diff2html/bundles/css/diff2html.min.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/diff2html/bundles/js/diff2html-ui.min.js></script><script src=https://unknownue.github.io/js/syntax-highlight.js></script><script src=https://unknownue.github.io/js/diff-sidebar.js></script><script src="https://unknownue.github.io/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><div class=content><header><div class=main><a href=https://unknownue.github.io>Unknownue's Blog</a><div class=socials><a class=social href=https://github.com/unknownue rel=me> <img alt=github src=https://unknownue.github.io/icons/social/github.svg> </a><a class=social href=https://github.com/unknownue/unknownue.github.io rel=me> <img alt=github-io src=https://unknownue.github.io/icons/social/rss.svg> </a></div></div><nav><a href=https://unknownue.github.io/posts style=margin-left:.25em>/posts</a><a href=https://unknownue.github.io/projects style=margin-left:.25em>/projects</a><a href=https://unknownue.github.io/about style=margin-left:.25em>/about</a><a href=https://unknownue.github.io/tags style=margin-left:.25em>/tags</a><button title="$SHORTCUT to open search" class=search-button id=search-button><img alt=Search class=search-icon src=https://unknownue.github.io/icons/search.svg></button><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><div id=modal-content><h1 class=page-header id=modalTitle>Search</h1><div id=searchBar><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search... role=combobox spellcheck=false><button title="Clear search" class=clear-button id=clear-search><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></button></div><div id=results-container><div id=results-info><span id=zero_results style=display:none>No results</span><span id=one_result style=display:none>1 result</span><span id=many_results style=display:none>$NUMBER results</span></div><div id=results role=listbox></div></div></div></div><a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://unknownue.github.io/icons/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://unknownue.github.io/icons/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><div class=pull-request-page><article class=md-content-page style=display:none></article><div class=back-link><a href=/pull_request/bevy/2025-09/>← Back to Pull Requests</a></div><div class=pr-metadata><span class=pr-date>2025-09-15</span><div class=language-switcher><span class="lang-link active" data-lang=en>English</span> / <a class=lang-link data-lang=zh-cn href=/pull_request/bevy/2025-09/pr-21056-zh-cn-20250915>中文</a></div></div><div class=pr-content><h1 id=improve-suggestion-when-old-name-for-justify-is-used>Improve suggestion when old name for <code>Justify</code> is used</h1><h2 id=basic-information>Basic Information</h2><ul><li><strong>Title</strong>: Improve suggestion when old name for <code>Justify</code> is used<li><strong>PR Link</strong>: https://github.com/bevyengine/bevy/pull/21056<li><strong>Author</strong>: rparrett<li><strong>Status</strong>: MERGED<li><strong>Labels</strong>: A-UI, C-Usability, S-Ready-For-Final-Review<li><strong>Created</strong>: 2025-09-15T14:21:24Z<li><strong>Merged</strong>: 2025-09-15T19:07:00Z<li><strong>Merged By</strong>: alice-i-cecile</ul><h2 id=description-translation>Description Translation</h2><h1 id=objective>Objective</h1><p>Rust currently suggests that users try <code>JustifySelf</code> when <code>JustifyText</code> (which has been renamed to <code>Justify</code>) is used.<h2 id=solution>Solution</h2><p>Add an alias for the old name<h2 id=before>Before</h2><pre style=color:#61676c;background-color:#fafafa><code><span>warning: `bevy-alt-ui-navigation-lite` (lib) generated 2 warnings
</span><span>error[E0433]: failed to resolve: use of undeclared type `JustifyText`
</span><span>   --> examples/infinite_upgrades.rs:526:46
</span><span>    |
</span><span>526 |                 TextLayout::new_with_justify(JustifyText::Center),
</span><span>    |                                              ^^^^^^^^^^^
</span><span>    |                                              |
</span><span>    |                                              use of undeclared type `JustifyText`
</span><span>    |                                              help: an enum with a similar name exists: `JustifySelf`
</span></code></pre><h2 id=after>After</h2><pre style=color:#61676c;background-color:#fafafa><code><span>warning: `bevy-alt-ui-navigation-lite` (lib) generated 2 warnings
</span><span>error[E0433]: failed to resolve: use of undeclared type `JustifyText`
</span><span>   --> examples/infinite_upgrades.rs:526:46
</span><span>    |
</span><span>526 |                 TextLayout::new_with_justify(JustifyText::Center),
</span><span>    |                                              ^^^^^^^^^^^ use of undeclared type `JustifyText`
</span><span>    |
</span><span>help: `Justify` has a name defined in the doc alias attribute as `JustifyText`
</span><span>    |
</span><span>526 -                 TextLayout::new_with_justify(JustifyText::Center),
</span><span>526 +                 TextLayout::new_with_justify(Justify::Center),
</span></code></pre><h2 id=testing>Testing</h2><p>Testing with local bevy dependency in a library I am migrating<h2 id=alternatives>Alternatives</h2><p>Add deprecated type alias<h2 id=the-story-of-this-pull-request>The Story of This Pull Request</h2><p>This PR addresses a specific usability issue in the Bevy engine’s text system. The core problem stems from a previous renaming of the <code>JustifyText</code> enum to <code>Justify</code>. While this renaming improved consistency within the codebase, it created a poor developer experience for users who were still referencing the old name.<p>When developers attempted to use <code>JustifyText</code> after the rename, the Rust compiler would generate an unhelpful error message suggesting <code>JustifySelf</code> instead of the correct <code>Justify</code> type. This misleading suggestion occurred because <code>JustifySelf</code> was the closest matching name in the namespace, even though it’s a completely different type with different functionality.<p>The solution implemented in this PR leverages Rust’s <code>#[doc(alias)]</code> attribute to create a connection between the old and new names. By adding <code>#[doc(alias = "JustifyText")]</code> to the <code>Justify</code> enum, the compiler can now provide a targeted suggestion that directs users to the correct replacement. This approach maintains clean code while significantly improving the developer experience during migration.<p>The change is minimal but impactful. It doesn’t affect runtime behavior or add any technical debt - it simply enhances the compiler’s ability to guide developers toward the correct solution. The before-and-after error messages demonstrate the dramatic improvement in usability, with the new error message clearly indicating both the problem and the exact solution.<p>This approach was chosen over alternatives like adding a deprecated type alias because it doesn’t introduce any actual code that needs to be maintained or eventually removed. The doc alias serves purely as metadata for documentation and compiler suggestions, making it a clean, maintenance-free solution.<h2 id=visual-representation>Visual Representation</h2><pre class=language-mermaid data-lang=mermaid style=color:#61676c;background-color:#fafafa><code class=language-mermaid data-lang=mermaid><span>graph LR
</span><span>    A[Developer uses JustifyText] --> B[Compiler Error]
</span><span>    B --> C[Old: Suggest JustifySelf]
</span><span>    B --> D[New: Suggest Justify via doc alias]
</span><span>    C --> E[Developer confusion]
</span><span>    D --> F[Clear migration path]
</span></code></pre><h2 id=key-files-changed>Key Files Changed</h2><p><strong>File: <code>crates/bevy_text/src/text.rs</code></strong><p>This file contains the definition of the <code>Justify</code> enum, which controls text justification in Bevy’s UI system. The change adds a single doc alias attribute to improve error messages when developers use the old enum name.<p><strong>Code Change:</strong><pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before:
</span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>derive</span><span>(Debug</span><span style=color:#61676ccc>,</span><span> Default</span><span style=color:#61676ccc>,</span><span> Clone</span><span style=color:#61676ccc>,</span><span> Copy</span><span style=color:#61676ccc>,</span><span> PartialEq</span><span style=color:#61676ccc>,</span><span> Eq</span><span style=color:#61676ccc>,</span><span> Hash</span><span style=color:#61676ccc>,</span><span> Reflect</span><span style=color:#61676ccc>,</span><span> Serialize</span><span style=color:#61676ccc>,</span><span> Deserialize)]
</span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>reflect</span><span>(Serialize</span><span style=color:#61676ccc>,</span><span> Deserialize</span><span style=color:#61676ccc>,</span><span> Clone</span><span style=color:#61676ccc>,</span><span> PartialEq</span><span style=color:#61676ccc>,</span><span> Hash)]
</span><span style=color:#fa6e32>pub enum </span><span style=color:#399ee6>Justify </span><span>{
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After:
</span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>derive</span><span>(Debug</span><span style=color:#61676ccc>,</span><span> Default</span><span style=color:#61676ccc>,</span><span> Clone</span><span style=color:#61676ccc>,</span><span> Copy</span><span style=color:#61676ccc>,</span><span> PartialEq</span><span style=color:#61676ccc>,</span><span> Eq</span><span style=color:#61676ccc>,</span><span> Hash</span><span style=color:#61676ccc>,</span><span> Reflect</span><span style=color:#61676ccc>,</span><span> Serialize</span><span style=color:#61676ccc>,</span><span> Deserialize)]
</span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>reflect</span><span>(Serialize</span><span style=color:#61676ccc>,</span><span> Deserialize</span><span style=color:#61676ccc>,</span><span> Clone</span><span style=color:#61676ccc>,</span><span> PartialEq</span><span style=color:#61676ccc>,</span><span> Hash)]
</span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>doc</span><span>(alias </span><span style=color:#ed9366>= </span><span style=color:#86b300>"JustifyText"</span><span>)]
</span><span style=color:#fa6e32>pub enum </span><span style=color:#399ee6>Justify </span><span>{
</span></code></pre><p>The addition of <code>#[doc(alias = "JustifyText")]</code> creates a documented alias that the Rust compiler can use to provide better error suggestions when someone references the old <code>JustifyText</code> name.<h2 id=further-reading>Further Reading</h2><ul><li><a rel="noopener nofollow noreferrer" href=https://doc.rust-lang.org/reference/attributes/doc.html target=_blank>Rust Documentation: The <code>doc</code> attribute</a><li><a rel="noopener nofollow noreferrer" href=https://doc.rust-lang.org/edition-guide/rustdoc/aliases.html target=_blank>Rust Edition Guide: Rustdoc Aliases</a><li><a rel="noopener nofollow noreferrer" href=https://bevyengine.org/learn/books/introduction/ target=_blank>Bevy Engine: Text and UI Systems</a></ul><h1 id=full-code-diff>Full Code Diff</h1><pre class=language-diff data-lang=diff style=color:#61676c;background-color:#fafafa><code class=language-diff data-lang=diff><span>diff --git a/crates/bevy_text/src/text.rs b/crates/bevy_text/src/text.rs
</span><span>index 3c04cbd1d68d1..e4da3288d43c0 100644
</span><span style=color:#c594c5>--- a/crates/bevy_text/src/text.rs
</span><span style=color:#c594c5>+++ b/crates/bevy_text/src/text.rs
</span><span style=color:#c594c5>@@ -214,6 +214,7 @@ </span><span style=color:#399ee6>impl From&LTString> for TextSpan {
</span><span> /// [`TextBounds`](super::bounds::TextBounds) component with an explicit `width` value.
</span><span> #[derive(Debug, Default, Clone, Copy, PartialEq, Eq, Hash, Reflect, Serialize, Deserialize)]
</span><span> #[reflect(Serialize, Deserialize, Clone, PartialEq, Hash)]
</span><span style=color:#86b300>+#[doc(alias = "JustifyText")]
</span><span> pub enum Justify {
</span><span>     /// Leftmost character is immediately to the right of the render position.
</span><span>     /// Bounds start from the render position and advance rightwards.
</span></code></pre></div><div data-is-md-page=true data-patch-exists=true data-patch-path=/pull_request/bevy/2025-09/pr_21056.patch id=patch-info style=display:none></div><div class=bottom-spacer></div></div></div>