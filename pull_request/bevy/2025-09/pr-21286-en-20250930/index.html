<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://unknownue.github.io name=base><title>
         #21286 Delete animation graph migration code.
        
    </title><meta content="#21286 Delete animation graph migration code." property=og:title><meta content="A personal blog built with Zola and Apollo theme" property=og:description><meta content="A personal blog built with Zola and Apollo theme" name=description><link href=/icons/favicon.png rel=icon type=image/png><link href=https://unknownue.github.io/fonts.css rel=stylesheet><script src=https://unknownue.github.io/js/codeblock.js></script><script src=https://unknownue.github.io/js/toc.js></script><script src=https://unknownue.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Unknownue's Blog" href=https://unknownue.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://unknownue.github.io/theme/light.css rel=stylesheet><link href=https://unknownue.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://unknownue.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://unknownue.github.io/main.css media=screen rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js></script><script>// Initialize mermaid once DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            mermaid.initialize({
                startOnLoad: false,
                theme: document.body && document.body.classList.contains('dark') ? 'dark' : 'default',
                securityLevel: 'loose',
                flowchart: {
                    useMaxWidth: true,
                    htmlLabels: true
                },
                sequence: {
                    diagramMarginX: 50,
                    diagramMarginY: 10,
                    actorMargin: 50,
                    width: 150,
                    height: 65
                }
            });
        });</script><script src=https://unknownue.github.io/js/main.js></script><script defer src=https://unknownue.github.io/js/label-colors.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/rust.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/typescript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/go.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/cpp.min.js></script><script>// Ensure highlight.js is properly configured
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof hljs !== 'undefined') {
                hljs.configure({
                    languages: ['rust', 'javascript', 'python', 'cpp', 'go', 'typescript'],
                    ignoreUnescapedHTML: true
                });
                console.log('Highlight.js configured in header');
            }
        });</script><link href=https://cdn.jsdelivr.net/npm/diff2html/bundles/css/diff2html.min.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/diff2html/bundles/js/diff2html-ui.min.js></script><script src=https://unknownue.github.io/js/syntax-highlight.js></script><script src=https://unknownue.github.io/js/diff-sidebar.js></script><script src="https://unknownue.github.io/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><div class=content><header><div class=main><a href=https://unknownue.github.io>Unknownue's Blog</a><div class=socials><a class=social href=https://github.com/unknownue rel=me> <img alt=github src=https://unknownue.github.io/icons/social/github.svg> </a><a class=social href=https://github.com/unknownue/unknownue.github.io rel=me> <img alt=github-io src=https://unknownue.github.io/icons/social/rss.svg> </a></div></div><nav><a href=https://unknownue.github.io/posts style=margin-left:.25em>/posts</a><a href=https://unknownue.github.io/projects style=margin-left:.25em>/projects</a><a href=https://unknownue.github.io/about style=margin-left:.25em>/about</a><a href=https://unknownue.github.io/tags style=margin-left:.25em>/tags</a><button title="$SHORTCUT to open search" class=search-button id=search-button><img alt=Search class=search-icon src=https://unknownue.github.io/icons/search.svg></button><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><div id=modal-content><h1 class=page-header id=modalTitle>Search</h1><div id=searchBar><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search... role=combobox spellcheck=false><button title="Clear search" class=clear-button id=clear-search><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></button></div><div id=results-container><div id=results-info><span id=zero_results style=display:none>No results</span><span id=one_result style=display:none>1 result</span><span id=many_results style=display:none>$NUMBER results</span></div><div id=results role=listbox></div></div></div></div><a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://unknownue.github.io/icons/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://unknownue.github.io/icons/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><div class=pull-request-page><article class=md-content-page style=display:none></article><div class=back-link><a href=/pull_request/bevy/2025-09/>← Back to Pull Requests</a></div><div class=pr-metadata><span class=pr-date>2025-09-30</span><div class=language-switcher><span class="lang-link active" data-lang=en>English</span> / <a class=lang-link data-lang=zh-cn href=/pull_request/bevy/2025-09/pr-21286-zh-cn-20250930>中文</a></div></div><div class=pr-content><h1 id=title>Title</h1><p>Delete animation graph migration code<h2 id=basic-information>Basic Information</h2><ul><li><strong>Title</strong>: Delete animation graph migration code.<li><strong>PR Link</strong>: https://github.com/bevyengine/bevy/pull/21286<li><strong>Author</strong>: andriyDev<li><strong>Status</strong>: MERGED<li><strong>Labels</strong>: D-Trivial, C-Code-Quality, A-Animation, S-Needs-Review<li><strong>Created</strong>: 2025-09-29T23:28:51Z<li><strong>Merged</strong>: 2025-09-30T01:17:03Z<li><strong>Merged By</strong>: james7132</ul><h2 id=description-translation>Description Translation</h2><h1 id=objective>Objective</h1><ul><li>Finish the migration from #19615.</ul><h2 id=solution>Solution</h2><ul><li>Delete all the serialization shenanigans that allowed loading both old and new animation graphs.</ul><h2 id=testing>Testing</h2><ul><li>Ran the <code>animation_graph</code> example and it works without changing anything.</ul><h2 id=the-story-of-this-pull-request>The Story of This Pull Request</h2><p>This PR represents a clean-up operation in the Bevy animation system, specifically targeting migration code that had served its purpose and was ready for removal. The changes follow a common pattern in software development where temporary compatibility layers are introduced during major refactors, then removed once the migration period has ended.<p>The core issue was that PR #19615 had introduced a new serialization format for animation graphs, but needed to maintain backward compatibility with the old format during the transition period. This required maintaining dual code paths - one for the modern format and one for the legacy format. The migration code acted as a bridge, allowing systems to load both old and new animation graph formats while users updated their assets.<p>The implementation used a clever serde pattern with untagged enums to handle the dual format loading:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>derive</span><span>(Serialize</span><span style=color:#61676ccc>,</span><span> Deserialize)]
</span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>serde</span><span>(untagged)]
</span><span style=color:#fa6e32>pub enum </span><span style=color:#399ee6>MigrationSerializedAnimationClip </span><span>{
</span><span>    Modern(AssetPath<</span><span style=color:#fa6e32>'static</span><span>>)</span><span style=color:#61676ccc>,
</span><span>    Legacy(SerializedAnimationClip)</span><span style=color:#61676ccc>,
</span><span>}
</span></code></pre><p>This approach allowed the system to attempt deserialization using the modern format first, then fall back to the legacy format if that failed. However, this came with technical debt - the code was more complex, included warning mechanisms for deprecated usage, and required maintaining types that were no longer part of the core design.<p>The removal process was straightforward but significant. The developer eliminated the entire migration infrastructure, including:<ul><li>The <code>MigrationSerializedAnimationClip</code> enum that handled dual-format deserialization<li>The legacy <code>SerializedAnimationClip</code> type that supported asset ID-based references<li>The warning system that alerted users about legacy format usage<li>The complex match logic in the asset loader that handled both formats</ul><p>The asset loading logic was simplified from a multi-branch approach to a direct path-based loading:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before: Complex migration logic
</span><span>SerializedAnimationNodeType</span><span style=color:#ed9366>::</span><span>Clip(</span><span style=color:#fa6e32>ref</span><span> clip) </span><span style=color:#ed9366>=> </span><span style=color:#fa6e32>match</span><span> clip {
</span><span>    MigrationSerializedAnimationClip</span><span style=color:#ed9366>::</span><span>Modern(path) </span><span style=color:#ed9366>=> </span><span>{
</span><span>        AnimationNodeType</span><span style=color:#ed9366>::</span><span>Clip(load_context</span><span style=color:#ed9366>.</span><span style=color:#f07171>load</span><span>(path</span><span style=color:#ed9366>.</span><span style=color:#f07171>clone</span><span>()))
</span><span>    }
</span><span>    MigrationSerializedAnimationClip</span><span style=color:#ed9366>::</span><span>Legacy(SerializedAnimationClip</span><span style=color:#ed9366>::</span><span>AssetPath(path)) </span><span style=color:#ed9366>=> </span><span>{
</span><span>        </span><span style=color:#abb0b6;font-style:italic>// Warning logic and fallback loading
</span><span>        AnimationNodeType</span><span style=color:#ed9366>::</span><span>Clip(load_context</span><span style=color:#ed9366>.</span><span style=color:#f07171>load</span><span>(path</span><span style=color:#ed9366>.</span><span style=color:#f07171>clone</span><span>()))
</span><span>    }
</span><span>    </span><span style=color:#abb0b6;font-style:italic>// ... more legacy cases
</span><span>}
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After: Direct loading
</span><span>SerializedAnimationNodeType</span><span style=color:#ed9366>::</span><span>Clip(</span><span style=color:#fa6e32>ref</span><span> path) </span><span style=color:#ed9366>=> </span><span>{
</span><span>    AnimationNodeType</span><span style=color:#ed9366>::</span><span>Clip(load_context</span><span style=color:#ed9366>.</span><span style=color:#f07171>load</span><span>(path</span><span style=color:#ed9366>.</span><span style=color:#f07171>clone</span><span>()))
</span><span>}
</span></code></pre><p>This simplification reduces the codebase by approximately 55 lines while making the animation graph loading more maintainable and less error-prone. The change demonstrates a common pattern in software engineering where temporary migration code is intentionally designed to be removable once its purpose is served.<p>From an architectural perspective, this change solidifies the animation system’s commitment to asset path-based references over asset ID-based references, which aligns with Bevy’s overall asset management strategy. Asset paths provide more stable references that survive asset reimports and ID changes.<p>The testing approach was pragmatic - running the existing <code>animation_graph</code> example verified that the core functionality remained intact without the migration layer. This demonstrates confidence that the migration period had successfully completed and all relevant assets had been updated to the new format.<h2 id=visual-representation>Visual Representation</h2><pre class=language-mermaid data-lang=mermaid style=color:#61676c;background-color:#fafafa><code class=language-mermaid data-lang=mermaid><span>graph TD
</span><span>    A[Legacy Animation Format] --> B[Migration Layer]
</span><span>    C[Modern Animation Format] --> B
</span><span>    B --> D[Animation Graph Loader]
</span><span>    
</span><span>    E[PR #21286] --> F[Remove Migration Layer]
</span><span>    C --> G[Simplified Loader]
</span><span>    G --> D
</span></code></pre><h2 id=key-files-changed>Key Files Changed</h2><h3 id=crates-bevy-animation-src-graph-rs-5-60><code>crates/bevy_animation/src/graph.rs</code> (+5/-60)</h3><p>This file contained the core migration logic that was removed. The changes focused on eliminating the temporary compatibility layer between old and new animation graph formats.<p><strong>Key modifications:</strong><ol><li><strong>Removed migration enum types:</strong></ol><pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before - Removed types:
</span><span style=color:#fa6e32>pub enum </span><span style=color:#399ee6>MigrationSerializedAnimationClip </span><span>{
</span><span>    Modern(AssetPath<</span><span style=color:#fa6e32>'static</span><span>>)</span><span style=color:#61676ccc>,
</span><span>    Legacy(SerializedAnimationClip)</span><span style=color:#61676ccc>,
</span><span>}
</span><span>
</span><span style=color:#fa6e32>pub enum </span><span style=color:#399ee6>SerializedAnimationClip </span><span>{
</span><span>    AssetPath(AssetPath<</span><span style=color:#fa6e32>'static</span><span>>)</span><span style=color:#61676ccc>,
</span><span>    AssetId(AssetId&LTAnimationClip>)</span><span style=color:#61676ccc>,
</span><span>}
</span></code></pre><ol start=2><li><strong>Simplified serialized node type:</strong></ol><pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before:
</span><span style=color:#fa6e32>pub enum </span><span style=color:#399ee6>SerializedAnimationNodeType </span><span>{
</span><span>    Clip(MigrationSerializedAnimationClip)</span><span style=color:#61676ccc>,
</span><span>    </span><span style=color:#abb0b6;font-style:italic>// ...
</span><span>}
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After:
</span><span style=color:#fa6e32>pub enum </span><span style=color:#399ee6>SerializedAnimationNodeType </span><span>{
</span><span>    Clip(AssetPath<</span><span style=color:#fa6e32>'static</span><span>>)</span><span style=color:#61676ccc>,
</span><span>    </span><span style=color:#abb0b6;font-style:italic>// ...
</span><span>}
</span></code></pre><ol start=3><li><strong>Streamlined asset loading logic:</strong></ol><pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before - Complex migration handling:
</span><span style=color:#fa6e32>match</span><span> serialized_node</span><span style=color:#ed9366>.</span><span>node_type {
</span><span>    SerializedAnimationNodeType</span><span style=color:#ed9366>::</span><span>Clip(</span><span style=color:#fa6e32>ref</span><span> clip) </span><span style=color:#ed9366>=> </span><span style=color:#fa6e32>match</span><span> clip {
</span><span>        MigrationSerializedAnimationClip</span><span style=color:#ed9366>::</span><span>Modern(path) </span><span style=color:#ed9366>=> </span><span>{
</span><span>            AnimationNodeType</span><span style=color:#ed9366>::</span><span>Clip(load_context</span><span style=color:#ed9366>.</span><span style=color:#f07171>load</span><span>(path</span><span style=color:#ed9366>.</span><span style=color:#f07171>clone</span><span>()))
</span><span>        }
</span><span>        MigrationSerializedAnimationClip</span><span style=color:#ed9366>::</span><span>Legacy(SerializedAnimationClip</span><span style=color:#ed9366>::</span><span>AssetPath(path)) </span><span style=color:#ed9366>=> </span><span>{
</span><span>            </span><span style=color:#abb0b6;font-style:italic>// Warning logic and fallback
</span><span>            AnimationNodeType</span><span style=color:#ed9366>::</span><span>Clip(load_context</span><span style=color:#ed9366>.</span><span style=color:#f07171>load</span><span>(path</span><span style=color:#ed9366>.</span><span style=color:#f07171>clone</span><span>()))
</span><span>        }
</span><span>        </span><span style=color:#abb0b6;font-style:italic>// More legacy cases...
</span><span>    }</span><span style=color:#61676ccc>,
</span><span>    </span><span style=color:#abb0b6;font-style:italic>// ...
</span><span>}
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After - Direct loading:
</span><span style=color:#fa6e32>match</span><span> serialized_node</span><span style=color:#ed9366>.</span><span>node_type {
</span><span>    SerializedAnimationNodeType</span><span style=color:#ed9366>::</span><span>Clip(</span><span style=color:#fa6e32>ref</span><span> path) </span><span style=color:#ed9366>=> </span><span>{
</span><span>        AnimationNodeType</span><span style=color:#ed9366>::</span><span>Clip(load_context</span><span style=color:#ed9366>.</span><span style=color:#f07171>load</span><span>(path</span><span style=color:#ed9366>.</span><span style=color:#f07171>clone</span><span>()))
</span><span>    }
</span><span>    </span><span style=color:#abb0b6;font-style:italic>// ...
</span><span>}
</span></code></pre><p>These changes directly support the PR’s objective by removing the migration infrastructure while maintaining the core animation graph functionality.<h2 id=further-reading>Further Reading</h2><ul><li><a rel="noopener nofollow noreferrer" href=https://github.com/bevyengine/bevy/pull/19615 target=_blank>PR #19615</a> - The original migration PR that introduced the now-removed compatibility layer<li><a rel="noopener nofollow noreferrer" href=https://bevyengine.org/learn/books/0.13/animation/ target=_blank>Bevy Animation System Documentation</a> - Official documentation on Bevy’s animation system<li><a rel="noopener nofollow noreferrer" href=https://serde.rs/enum-representations.html#untagged target=_blank>Serde Untagged Enums</a> - Documentation on the serde pattern used in the migration code<li><a rel="noopener nofollow noreferrer" href=https://bevyengine.org/learn/migration-guides/0.12-0.13/ target=_blank>Asset System Migration Patterns</a> - Examples of similar migration patterns in Bevy’s history</ul><h1 id=full-code-diff>Full Code Diff</h1><pre class=language-diff data-lang=diff style=color:#61676c;background-color:#fafafa><code class=language-diff data-lang=diff><span>diff --git a/crates/bevy_animation/src/graph.rs b/crates/bevy_animation/src/graph.rs
</span><span>index 159e689ccf26c..e101e11209a2b 100644
</span><span style=color:#c594c5>--- a/crates/bevy_animation/src/graph.rs
</span><span style=color:#c594c5>+++ b/crates/bevy_animation/src/graph.rs
</span><span style=color:#c594c5>@@ -29,7 +29,6 @@ </span><span style=color:#399ee6>use ron::de::SpannedError;
</span><span> use serde::{Deserialize, Serialize};
</span><span> use smallvec::SmallVec;
</span><span> use thiserror::Error;
</span><span style=color:#f07171>-use tracing::warn;
</span><span> 
</span><span> use crate::{AnimationClip, AnimationTargetId};
</span><span> 
</span><span style=color:#c594c5>@@ -408,42 +407,13 @@ </span><span style=color:#399ee6>pub struct SerializedAnimationGraphNode {
</span><span> #[derive(Serialize, Deserialize)]
</span><span> pub enum SerializedAnimationNodeType {
</span><span>     /// Corresponds to [`AnimationNodeType::Clip`].
</span><span style=color:#f07171>-    Clip(MigrationSerializedAnimationClip),
</span><span style=color:#86b300>+    Clip(AssetPath<'static>),
</span><span>     /// Corresponds to [`AnimationNodeType::Blend`].
</span><span>     Blend,
</span><span>     /// Corresponds to [`AnimationNodeType::Add`].
</span><span>     Add,
</span><span> }
</span><span> 
</span><span style=color:#f07171>-/// A type to facilitate migration from the legacy format of [`SerializedAnimationGraph`] to the
</span><span style=color:#f07171>-/// new format.
</span><span style=color:#f07171>-///
</span><span style=color:#f07171>-/// By using untagged serde deserialization, we can try to deserialize the modern form, then
</span><span style=color:#f07171>-/// fallback to the legacy form. Users must migrate to the modern form by Bevy 0.18.
</span><span style=color:#f07171>-// TODO: Delete this after Bevy 0.17.
</span><span style=color:#f07171>-#[derive(Serialize, Deserialize)]
</span><span style=color:#f07171>-#[serde(untagged)]
</span><span style=color:#f07171>-pub enum MigrationSerializedAnimationClip {
</span><span style=color:#f07171>-    /// This is the new type of this field.
</span><span style=color:#f07171>-    Modern(AssetPath<'static>),
</span><span style=color:#f07171>-    /// This is the legacy type of this field. Users must migrate away from this.
</span><span style=color:#f07171>-    #[serde(skip_serializing)]
</span><span style=color:#f07171>-    Legacy(SerializedAnimationClip),
</span><span style=color:#f07171>-}
</span><span style=color:#f07171>-
</span><span style=color:#f07171>-/// The legacy form of serialized animation clips. This allows raw asset IDs to be deserialized.
</span><span style=color:#f07171>-// TODO: Delete this after Bevy 0.17.
</span><span style=color:#f07171>-#[derive(Deserialize)]
</span><span style=color:#f07171>-pub enum SerializedAnimationClip {
</span><span style=color:#f07171>-    /// Records an asset path.
</span><span style=color:#f07171>-    AssetPath(AssetPath<'static>),
</span><span style=color:#f07171>-    /// The fallback that records an asset ID.
</span><span style=color:#f07171>-    ///
</span><span style=color:#f07171>-    /// Because asset IDs can change, this should not be relied upon. Prefer to
</span><span style=color:#f07171>-    /// use asset paths where possible.
</span><span style=color:#f07171>-    AssetId(AssetId&LTAnimationClip>),
</span><span style=color:#f07171>-}
</span><span style=color:#f07171>-
</span><span> /// The type of an animation mask bitfield.
</span><span> ///
</span><span> /// Bit N corresponds to mask group N.
</span><span style=color:#c594c5>@@ -801,35 +771,12 @@ </span><span style=color:#399ee6>impl AssetLoader for AnimationGraphAssetLoader {
</span><span>             serialized_animation_graph.graph.edge_count(),
</span><span>         );
</span><span> 
</span><span style=color:#f07171>-        let mut already_warned = false;
</span><span>         for serialized_node in serialized_animation_graph.graph.node_weights() {
</span><span>             animation_graph.add_node(AnimationGraphNode {
</span><span>                 node_type: match serialized_node.node_type {
</span><span style=color:#f07171>-                    SerializedAnimationNodeType::Clip(ref clip) => match clip {
</span><span style=color:#f07171>-                        MigrationSerializedAnimationClip::Modern(path) => {
</span><span style=color:#f07171>-                            AnimationNodeType::Clip(load_context.load(path.clone()))
</span><span style=color:#f07171>-                        }
</span><span style=color:#f07171>-                        MigrationSerializedAnimationClip::Legacy(
</span><span style=color:#f07171>-                            SerializedAnimationClip::AssetPath(path),
</span><span style=color:#f07171>-                        ) => {
</span><span style=color:#f07171>-                            if !already_warned {
</span><span style=color:#f07171>-                                let path = load_context.asset_path();
</span><span style=color:#f07171>-                                warn!(
</span><span style=color:#f07171>-                                    "Loaded an AnimationGraph asset at \"{path}\" which contains a \
</span><span style=color:#f07171>-                                    legacy-style SerializedAnimationClip. Please re-save the asset \
</span><span style=color:#f07171>-                                    using AnimationGraph::save to automatically migrate to the new \
</span><span style=color:#f07171>-                                    format"
</span><span style=color:#f07171>-                                );
</span><span style=color:#f07171>-                                already_warned = true;
</span><span style=color:#f07171>-                            }
</span><span style=color:#f07171>-                            AnimationNodeType::Clip(load_context.load(path.clone()))
</span><span style=color:#f07171>-                        }
</span><span style=color:#f07171>-                        MigrationSerializedAnimationClip::Legacy(
</span><span style=color:#f07171>-                            SerializedAnimationClip::AssetId(_),
</span><span style=color:#f07171>-                        ) => {
</span><span style=color:#f07171>-                            return Err(AnimationGraphLoadError::GraphContainsLegacyAssetId);
</span><span style=color:#f07171>-                        }
</span><span style=color:#f07171>-                    },
</span><span style=color:#86b300>+                    SerializedAnimationNodeType::Clip(ref path) => {
</span><span style=color:#86b300>+                        AnimationNodeType::Clip(load_context.load(path.clone()))
</span><span style=color:#86b300>+                    }
</span><span>                     SerializedAnimationNodeType::Blend => AnimationNodeType::Blend,
</span><span>                     SerializedAnimationNodeType::Add => AnimationNodeType::Add,
</span><span>                 },
</span><span style=color:#c594c5>@@ -870,9 +817,7 @@ </span><span style=color:#399ee6>impl TryFrom&LTAnimationGraph> for SerializedAnimationGraph {
</span><span>                 mask: node.mask,
</span><span>                 node_type: match node.node_type {
</span><span>                     AnimationNodeType::Clip(ref clip) => match clip.path() {
</span><span style=color:#f07171>-                        Some(path) => SerializedAnimationNodeType::Clip(
</span><span style=color:#f07171>-                            MigrationSerializedAnimationClip::Modern(path.clone()),
</span><span style=color:#f07171>-                        ),
</span><span style=color:#86b300>+                        Some(path) => SerializedAnimationNodeType::Clip(path.clone()),
</span><span>                         None => return Err(NonPathHandleError),
</span><span>                     },
</span><span>                     AnimationNodeType::Blend => SerializedAnimationNodeType::Blend,
</span></code></pre></div><div data-is-md-page=true data-patch-exists=true data-patch-path=/pull_request/bevy/2025-09/pr_21286.patch id=patch-info style=display:none></div><div class=bottom-spacer></div></div></div>