<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://unknownue.github.io name=base><title>
         #20750 Make loading GLTF animations optional
        
    </title><meta content="#20750 Make loading GLTF animations optional" property=og:title><meta content="A personal blog built with Zola and Apollo theme" property=og:description><meta content="A personal blog built with Zola and Apollo theme" name=description><link href=/icons/favicon.png rel=icon type=image/png><link href=https://unknownue.github.io/fonts.css rel=stylesheet><script src=https://unknownue.github.io/js/codeblock.js></script><script src=https://unknownue.github.io/js/toc.js></script><script src=https://unknownue.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Unknownue's Blog" href=https://unknownue.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://unknownue.github.io/theme/light.css rel=stylesheet><link href=https://unknownue.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://unknownue.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://unknownue.github.io/main.css media=screen rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js></script><script>// Initialize mermaid once DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            mermaid.initialize({
                startOnLoad: false,
                theme: document.body && document.body.classList.contains('dark') ? 'dark' : 'default',
                securityLevel: 'loose',
                flowchart: {
                    useMaxWidth: true,
                    htmlLabels: true
                },
                sequence: {
                    diagramMarginX: 50,
                    diagramMarginY: 10,
                    actorMargin: 50,
                    width: 150,
                    height: 65
                }
            });
        });</script><script src=https://unknownue.github.io/js/main.js></script><script defer src=https://unknownue.github.io/js/label-colors.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/rust.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/typescript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/go.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/cpp.min.js></script><script>// Ensure highlight.js is properly configured
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof hljs !== 'undefined') {
                hljs.configure({
                    languages: ['rust', 'javascript', 'python', 'cpp', 'go', 'typescript'],
                    ignoreUnescapedHTML: true
                });
                console.log('Highlight.js configured in header');
            }
        });</script><link href=https://cdn.jsdelivr.net/npm/diff2html/bundles/css/diff2html.min.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/diff2html/bundles/js/diff2html-ui.min.js></script><script src=https://unknownue.github.io/js/syntax-highlight.js></script><script src=https://unknownue.github.io/js/diff-sidebar.js></script><script src="https://unknownue.github.io/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><div class=content><header><div class=main><a href=https://unknownue.github.io>Unknownue's Blog</a><div class=socials><a class=social href=https://github.com/unknownue rel=me> <img alt=github src=https://unknownue.github.io/icons/social/github.svg> </a><a class=social href=https://github.com/unknownue/unknownue.github.io rel=me> <img alt=github-io src=https://unknownue.github.io/icons/social/rss.svg> </a></div></div><nav><a href=https://unknownue.github.io/posts style=margin-left:.25em>/posts</a><a href=https://unknownue.github.io/projects style=margin-left:.25em>/projects</a><a href=https://unknownue.github.io/about style=margin-left:.25em>/about</a><a href=https://unknownue.github.io/tags style=margin-left:.25em>/tags</a><button title="$SHORTCUT to open search" class=search-button id=search-button><img alt=Search class=search-icon src=https://unknownue.github.io/icons/search.svg></button><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><div id=modal-content><h1 class=page-header id=modalTitle>Search</h1><div id=searchBar><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search... role=combobox spellcheck=false><button title="Clear search" class=clear-button id=clear-search><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></button></div><div id=results-container><div id=results-info><span id=zero_results style=display:none>No results</span><span id=one_result style=display:none>1 result</span><span id=many_results style=display:none>$NUMBER results</span></div><div id=results role=listbox></div></div></div></div><a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://unknownue.github.io/icons/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://unknownue.github.io/icons/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><div class=pull-request-page><article class=md-content-page style=display:none></article><div class=back-link><a href=/pull_request/bevy/2025-09/>← Back to Pull Requests</a></div><div class=pr-metadata><span class=pr-date>2025-09-09</span><div class=language-switcher><span class="lang-link active" data-lang=en>English</span> / <a class=lang-link data-lang=zh-cn href=/pull_request/bevy/2025-09/pr-20750-zh-cn-20250909>中文</a></div></div><div class=pr-content><h1 id=make-loading-gltf-animations-optional>Make loading GLTF animations optional</h1><h2 id=basic-information>Basic Information</h2><ul><li><strong>Title</strong>: Make loading GLTF animations optional<li><strong>PR Link</strong>: https://github.com/bevyengine/bevy/pull/20750<li><strong>Author</strong>: atlv24<li><strong>Status</strong>: MERGED<li><strong>Labels</strong>: C-Usability, S-Ready-For-Final-Review, A-Animation, X-Contentious, A-glTF<li><strong>Created</strong>: 2025-08-25T13:57:00Z<li><strong>Merged</strong>: 2025-09-09T20:56:49Z<li><strong>Merged By</strong>: alice-i-cecile</ul><h2 id=description-translation>Description Translation</h2><h1 id=objective>Objective</h1><ul><li>There was a mistaken belief in #20714 that it is possible to use bevy_gltf and bevy_animation without loading the animations of a gltf. This is not the case, the animation loading is gated by the presence of the bevy_animation crate. (And I believe this is how it should be.)<li>We want to be able to control gltf animation loading though, and I think it should be at the asset granularity. You may want some loaded with animation and some without, or maybe even load the same asset sometimes with animation and sometimes without.</ul><h2 id=solution>Solution</h2><ul><li>Just add a flag to the load settings</ul><h2 id=testing>Testing</h2><ul><li>many_foxes works, and setting the flag to false makes the foxes not animate</ul><h2 id=the-story-of-this-pull-request>The Story of This Pull Request</h2><p>This PR addresses a gap in Bevy’s glTF loading capabilities where animation loading was an all-or-nothing proposition tied to the presence of the <code>bevy_animation</code> crate feature. While the feature flag controlled whether animation support was compiled in, users couldn’t control animation loading at the asset level.<p>The core issue was that some users wanted to load glTF assets without animations in certain scenarios - either to reduce memory usage, avoid unnecessary processing, or because they planned to drive animations through other means. Previously, this wasn’t possible without completely disabling the animation feature, which affected all assets.<p>The solution implemented here adds granular control through a new <code>load_animations</code> boolean field in <code>GltfLoaderSettings</code>. When set to <code>false</code>, the loader skips animation processing entirely while still loading the rest of the glTF content (meshes, materials, etc.). This maintains backward compatibility by defaulting to <code>true</code>.<p>The implementation required conditional execution of animation-related code blocks. The loader now checks <code>settings.load_animations</code> before processing animation paths, curves, and players. When animations are disabled, it simply uses default values for the animation-related variables that would normally be populated.<p>This approach maintains clean separation of concerns - the animation loading logic remains encapsulated within conditional blocks, and the rest of the glTF loading process continues unchanged. The change is minimal and focused, reducing the risk of introducing new bugs.<p>The testing approach was straightforward: verify that the existing <code>many_foxes</code> example continues to work with the default settings, and confirm that setting <code>load_animations</code> to <code>false</code> prevents the foxes from animating while keeping the rest of the scene intact.<h2 id=visual-representation>Visual Representation</h2><pre class=language-mermaid data-lang=mermaid style=color:#61676c;background-color:#fafafa><code class=language-mermaid data-lang=mermaid><span>graph TD
</span><span>    A[GltfLoaderSettings] --> B[load_animations: bool]
</span><span>    B --> C{GltfLoader process}
</span><span>    C -->|true| D[Load animations]
</span><span>    C -->|false| E[Skip animation loading]
</span><span>    D --> F[Create AnimationClip assets]
</span><span>    D --> G[Add AnimationPlayer components]
</span><span>    E --> H[Use default values]
</span></code></pre><h2 id=key-files-changed>Key Files Changed</h2><h3 id=crates-bevy-gltf-src-loader-mod-rs><code>crates/bevy_gltf/src/loader/mod.rs</code></h3><p>Added a new <code>load_animations</code> field to <code>GltfLoaderSettings</code> and modified the animation loading logic to respect this setting.<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before:
</span><span style=color:#fa6e32>pub struct </span><span style=color:#399ee6>GltfLoaderSettings </span><span>{
</span><span>    </span><span style=color:#fa6e32>pub </span><span>load_cameras</span><span style=color:#61676ccc>: </span><span style=color:#fa6e32>bool</span><span>,
</span><span>    </span><span style=color:#fa6e32>pub </span><span>load_lights</span><span style=color:#61676ccc>: </span><span style=color:#fa6e32>bool</span><span>,
</span><span>    </span><span style=color:#abb0b6;font-style:italic>// ... other fields
</span><span>}
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After:
</span><span style=color:#fa6e32>pub struct </span><span style=color:#399ee6>GltfLoaderSettings </span><span>{
</span><span>    </span><span style=color:#fa6e32>pub </span><span>load_cameras</span><span style=color:#61676ccc>: </span><span style=color:#fa6e32>bool</span><span>,
</span><span>    </span><span style=color:#fa6e32>pub </span><span>load_lights</span><span style=color:#61676ccc>: </span><span style=color:#fa6e32>bool</span><span>,
</span><span>    </span><span style=color:#abb0b6;font-style:italic>/// If true, the loader will load `AnimationClip` assets, and also add
</span><span>    </span><span style=color:#abb0b6;font-style:italic>/// `AnimationTarget` and `AnimationPlayer` components to hierarchies
</span><span>    </span><span style=color:#abb0b6;font-style:italic>/// affected by animation. Requires the `bevy_animation` feature.
</span><span>    </span><span style=color:#fa6e32>pub </span><span>load_animations</span><span style=color:#61676ccc>: </span><span style=color:#fa6e32>bool</span><span>,
</span><span>    </span><span style=color:#abb0b6;font-style:italic>// ... other fields
</span><span>}
</span></code></pre><pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Animation loading is now conditional:
</span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>cfg</span><span>(feature </span><span style=color:#ed9366>= </span><span style=color:#86b300>"bevy_animation"</span><span>)]
</span><span style=color:#fa6e32>let</span><span> paths </span><span style=color:#ed9366>= </span><span style=color:#fa6e32>if</span><span> settings</span><span style=color:#ed9366>.</span><span>load_animations {
</span><span>    </span><span style=color:#abb0b6;font-style:italic>// Animation path processing
</span><span>} </span><span style=color:#fa6e32>else </span><span>{
</span><span>    </span><span style=color:#55b4d4;font-style:italic>Default</span><span style=color:#ed9366>::</span><span>default()
</span><span>}</span><span style=color:#61676ccc>;
</span></code></pre><h3 id=release-content-migration-guides-gltf-animation-load-optional-md><code>release-content/migration-guides/gltf-animation-load-optional.md</code></h3><p>Added a migration guide to inform users about the new optional animation loading capability.<pre class=language-markdown data-lang=markdown style=color:#61676c;background-color:#fafafa><code class=language-markdown data-lang=markdown><span style=color:#abb0b6;background-color:#61676c10;font-weight:700>---
</span><span>title: glTF animation loading is now optional
</span><span>pull_requests: [20750]
</span><span style=color:#fa6e32;font-weight:700>---
</span><span>
</span><span style=color:#ed9366;background-color:#61676c10>`GltfLoaderSettings`</span><span> now has a </span><span style=color:#ed9366;background-color:#61676c10>`load_animations`</span><span> field which allows controlling whether animations should load.
</span></code></pre><h2 id=further-reading>Further Reading</h2><ul><li><a rel="noopener nofollow noreferrer" href=https://bevyengine.org/learn/books/bevy-gltf-loading/ target=_blank>Bevy glTF Loading Documentation</a><li><a rel="noopener nofollow noreferrer" href=https://bevyengine.org/learn/books/bevy-animation-system/ target=_blank>Bevy Animation System</a><li><a rel="noopener nofollow noreferrer" href=https://www.khronos.org/registry/glTF/specs/2.0/glTF-2.0.html target=_blank>glTF 2.0 Specification</a><li><a rel="noopener nofollow noreferrer" href=https://github.com/bevyengine/bevy/issues/20714 target=_blank>Original Issue Discussion (#20714)</a></ul></div><div data-is-md-page=true data-patch-exists=true data-patch-path=/pull_request/bevy/2025-09/pr_20750.patch id=patch-info style=display:none></div><div class=bottom-spacer></div></div></div>