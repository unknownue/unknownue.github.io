<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://unknownue.github.io name=base><title>
         #21245 run codeql on PRs to automatically detect security vulnerabilities
        
    </title><meta content="#21245 run codeql on PRs to automatically detect security vulnerabilities" property=og:title><meta content="A personal blog built with Zola and Apollo theme" property=og:description><meta content="A personal blog built with Zola and Apollo theme" name=description><link href=/icons/favicon.png rel=icon type=image/png><link href=https://unknownue.github.io/fonts.css rel=stylesheet><script src=https://unknownue.github.io/js/codeblock.js></script><script src=https://unknownue.github.io/js/toc.js></script><script src=https://unknownue.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Unknownue's Blog" href=https://unknownue.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://unknownue.github.io/theme/light.css rel=stylesheet><link href=https://unknownue.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://unknownue.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://unknownue.github.io/main.css media=screen rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js></script><script>// Initialize mermaid once DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            mermaid.initialize({
                startOnLoad: false,
                theme: document.body && document.body.classList.contains('dark') ? 'dark' : 'default',
                securityLevel: 'loose',
                flowchart: {
                    useMaxWidth: true,
                    htmlLabels: true
                },
                sequence: {
                    diagramMarginX: 50,
                    diagramMarginY: 10,
                    actorMargin: 50,
                    width: 150,
                    height: 65
                }
            });
        });</script><script src=https://unknownue.github.io/js/main.js></script><script defer src=https://unknownue.github.io/js/label-colors.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/rust.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/typescript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/go.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/cpp.min.js></script><script>// Ensure highlight.js is properly configured
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof hljs !== 'undefined') {
                hljs.configure({
                    languages: ['rust', 'javascript', 'python', 'cpp', 'go', 'typescript'],
                    ignoreUnescapedHTML: true
                });
                console.log('Highlight.js configured in header');
            }
        });</script><link href=https://cdn.jsdelivr.net/npm/diff2html/bundles/css/diff2html.min.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/diff2html/bundles/js/diff2html-ui.min.js></script><script src=https://unknownue.github.io/js/syntax-highlight.js></script><script src=https://unknownue.github.io/js/diff-sidebar.js></script><script src="https://unknownue.github.io/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><div class=content><header><div class=main><a href=https://unknownue.github.io>Unknownue's Blog</a><div class=socials><a class=social href=https://github.com/unknownue rel=me> <img alt=github src=https://unknownue.github.io/icons/social/github.svg> </a><a class=social href=https://github.com/unknownue/unknownue.github.io rel=me> <img alt=github-io src=https://unknownue.github.io/icons/social/rss.svg> </a></div></div><nav><a href=https://unknownue.github.io/posts style=margin-left:.25em>/posts</a><a href=https://unknownue.github.io/projects style=margin-left:.25em>/projects</a><a href=https://unknownue.github.io/about style=margin-left:.25em>/about</a><a href=https://unknownue.github.io/tags style=margin-left:.25em>/tags</a><button title="$SHORTCUT to open search" class=search-button id=search-button><img alt=Search class=search-icon src=https://unknownue.github.io/icons/search.svg></button><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><div id=modal-content><h1 class=page-header id=modalTitle>Search</h1><div id=searchBar><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search... role=combobox spellcheck=false><button title="Clear search" class=clear-button id=clear-search><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></button></div><div id=results-container><div id=results-info><span id=zero_results style=display:none>No results</span><span id=one_result style=display:none>1 result</span><span id=many_results style=display:none>$NUMBER results</span></div><div id=results role=listbox></div></div></div></div><a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://unknownue.github.io/icons/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://unknownue.github.io/icons/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><div class=pull-request-page><article class=md-content-page style=display:none></article><div class=back-link><a href=/pull_request/bevy/2025-09/>← Back to Pull Requests</a></div><div class=pr-metadata><span class=pr-date>2025-09-28</span><div class=language-switcher><span class="lang-link active" data-lang=en>English</span> / <a class=lang-link data-lang=zh-cn href=/pull_request/bevy/2025-09/pr-21245-zh-cn-20250928>中文</a></div></div><div class=pr-content><h1 id=title>Title</h1><p>run codeql on PRs to automatically detect security vulnerabilities<h2 id=basic-information>Basic Information</h2><ul><li><strong>Title</strong>: run codeql on PRs to automatically detect security vulnerabilities<li><strong>PR Link</strong>: https://github.com/bevyengine/bevy/pull/21245<li><strong>Author</strong>: mockersf<li><strong>Status</strong>: MERGED<li><strong>Labels</strong>: C-Feature, A-Build-System, S-Ready-For-Final-Review<li><strong>Created</strong>: 2025-09-27T16:29:39Z<li><strong>Merged</strong>: 2025-09-28T18:01:08Z<li><strong>Merged By</strong>: alice-i-cecile</ul><h2 id=description-translation>Description Translation</h2><h1 id=objective>Objective</h1><ul><li>CodeQL for Rust is now stable and fast<li>Run it on PRs</ul><blockquote><p>Discover vulnerabilities across a codebase with CodeQL, our industry-leading semantic code analysis engine. CodeQL lets you query code as though it were data. Write a query to find all variants of a vulnerability, eradicating it forever. Then share your query to help others do the same.</blockquote><h2 id=the-story-of-this-pull-request>The Story of This Pull Request</h2><p>This PR addresses a gap in the Bevy engine’s continuous integration pipeline by enabling CodeQL security scanning on pull requests. Previously, the CodeQL workflow was configured to run only on pushes to the main branch, which meant potential security vulnerabilities could be introduced via PRs without being caught by automated security scanning.<p>The core issue was timing - CodeQL for Rust had previously been in a beta state where it was slower and less reliable. With the tool now reaching stable status and improved performance, the team could confidently enable it for PR workflows without significantly impacting development velocity.<p>The solution involved modifying the GitHub Actions workflow trigger configuration to include pull requests targeting the main branch. This change ensures that every PR undergoes the same security scanning that occurs on main branch commits, providing early detection of potential vulnerabilities before they’re merged.<p>From an engineering perspective, this change represents a shift-left security approach - moving security checks earlier in the development lifecycle rather than relying solely on post-merge scanning. This aligns with modern DevOps practices where security is integrated into the development workflow rather than being a separate, later-stage activity.<p>The implementation required minimal changes because the underlying CodeQL analysis configuration remained the same. The workflow already contained the necessary steps for Rust code analysis; it just needed to be triggered at the appropriate time in the development process. This demonstrates good CI/CD design where the same security checks are applied consistently across different trigger events.<p>The removal of the scheduled cron job suggests the team determined that PR-based scanning provides sufficient coverage without needing periodic full-codebase scans. This decision likely balances security coverage with resource efficiency, as PR-triggered scans are more targeted and timely than scheduled scans.<h2 id=visual-representation>Visual Representation</h2><pre class=language-mermaid data-lang=mermaid style=color:#61676c;background-color:#fafafa><code class=language-mermaid data-lang=mermaid><span>graph LR
</span><span>    A[Push to main] --> B[CodeQL Analysis]
</span><span>    C[Pull Request] --> B
</span><span>    B --> D[Security Report]
</span><span>    B --> E[Vulnerability Detection]
</span></code></pre><h2 id=key-files-changed>Key Files Changed</h2><h3 id=github-workflows-codeql-yml-2-5><code>.github/workflows/codeql.yml</code> (+2/-5)</h3><p>This file configures GitHub’s CodeQL security scanning workflow. The changes enable the workflow to run on pull requests targeting the main branch, providing earlier security vulnerability detection.<pre class=language-yaml data-lang=yaml style=color:#61676c;background-color:#fafafa><code class=language-yaml data-lang=yaml><span style=color:#abb0b6;font-style:italic># File: .github/workflows/codeql.yml
</span><span style=color:#abb0b6;font-style:italic># Before:
</span><span style=color:#ff8f40>on</span><span style=color:#61676ccc>:
</span><span>  </span><span style=color:#399ee6>push</span><span style=color:#61676ccc>:
</span><span>    </span><span style=color:#399ee6>branches</span><span style=color:#61676ccc>: </span><span>[</span><span style=color:#86b300>"main"</span><span>]
</span><span style=color:#abb0b6;font-style:italic># Commented for now to test
</span><span style=color:#abb0b6;font-style:italic>#  pull_request:
</span><span style=color:#abb0b6;font-style:italic>#    branches: [ "main" ]
</span><span style=color:#abb0b6;font-style:italic>#  schedule:
</span><span style=color:#abb0b6;font-style:italic>#    - cron: '22 14 * * 4'
</span><span>
</span><span style=color:#abb0b6;font-style:italic># After:
</span><span style=color:#ff8f40>on</span><span style=color:#61676ccc>:
</span><span>  </span><span style=color:#399ee6>push</span><span style=color:#61676ccc>:
</span><span>    </span><span style=color:#399ee6>branches</span><span style=color:#61676ccc>: </span><span>[</span><span style=color:#86b300>"main"</span><span>]
</span><span>  </span><span style=color:#399ee6>pull_request</span><span style=color:#61676ccc>:
</span><span>    </span><span style=color:#399ee6>branches</span><span style=color:#61676ccc>: </span><span>[</span><span style=color:#86b300>"main"</span><span>]
</span></code></pre><p>The key changes:<ol><li><strong>Enabled PR triggers</strong>: Uncommented the <code>pull_request</code> section to activate security scanning on all PRs targeting main<li><strong>Removed scheduled runs</strong>: Eliminated the weekly cron job, likely because PR-based scanning provides more timely coverage<li><strong>Simplified configuration</strong>: Removed commented-out code that was no longer needed</ol><p>These changes ensure that security scanning occurs during code review rather than after merge, allowing developers to address vulnerabilities before they enter the codebase.<h2 id=further-reading>Further Reading</h2><ul><li><a rel="noopener nofollow noreferrer" href=https://docs.github.com/en/code-security/codeql-cli/getting-started-with-the-codeql-cli/about-codeql-cli target=_blank>GitHub CodeQL Documentation</a><li><a rel="noopener nofollow noreferrer" href=https://docs.github.com/en/code-security/code-scanning/automatically-scanning-your-code-for-vulnerabilities-and-errors/configuring-code-scanning-for-a-repository#configuring-code-scanning-for-a-repository target=_blank>CodeQL for Rust</a><li><a rel="noopener nofollow noreferrer" href=https://docs.github.com/en/actions/using-workflows/workflow-syntax-for-github-actions target=_blank>GitHub Actions Workflow Syntax</a><li><a rel="noopener nofollow noreferrer" href=https://www.synopsys.com/glossary/what-is-shift-left-testing.html target=_blank>Shift-Left Security Principles</a></ul><h1 id=full-code-diff>Full Code Diff</h1><pre style=color:#61676c;background-color:#fafafa><code><span>diff --git a/.github/workflows/codeql.yml b/.github/workflows/codeql.yml
</span><span>index f82dedc81d4f0..167d35565d426 100644
</span><span>--- a/.github/workflows/codeql.yml
</span><span>+++ b/.github/workflows/codeql.yml
</span><span>@@ -3,11 +3,8 @@ name: "CodeQL"
</span><span> on:
</span><span>   push:
</span><span>     branches: ["main"]
</span><span>-# Commented for now to test
</span><span>-#  pull_request:
</span><span>-#    branches: [ "main" ]
</span><span>-#  schedule:
</span><span>-#    - cron: '22 14 * * 4'
</span><span>+  pull_request:
</span><span>+    branches: ["main"]
</span><span> 
</span><span> jobs:
</span><span>   analyze:
</span></code></pre></div><div data-is-md-page=true data-patch-exists=true data-patch-path=/pull_request/bevy/2025-09/pr_21245.patch id=patch-info style=display:none></div><div class=bottom-spacer></div></div></div>