<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://unknownue.github.io name=base><title>
         #20658 Solari PicaPica scene
        
    </title><meta content="#20658 Solari PicaPica scene" property=og:title><meta content="A personal blog built with Zola and Apollo theme" property=og:description><meta content="A personal blog built with Zola and Apollo theme" name=description><link href=/icons/favicon.png rel=icon type=image/png><link href=https://unknownue.github.io/fonts.css rel=stylesheet><script src=https://unknownue.github.io/js/codeblock.js></script><script src=https://unknownue.github.io/js/toc.js></script><script src=https://unknownue.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Unknownue's Blog" href=https://unknownue.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://unknownue.github.io/theme/light.css rel=stylesheet><link href=https://unknownue.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://unknownue.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://unknownue.github.io/main.css media=screen rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js></script><script>// Initialize mermaid once DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            mermaid.initialize({
                startOnLoad: false,
                theme: document.body && document.body.classList.contains('dark') ? 'dark' : 'default',
                securityLevel: 'loose',
                flowchart: {
                    useMaxWidth: true,
                    htmlLabels: true
                },
                sequence: {
                    diagramMarginX: 50,
                    diagramMarginY: 10,
                    actorMargin: 50,
                    width: 150,
                    height: 65
                }
            });
        });</script><script src=https://unknownue.github.io/js/main.js></script><script defer src=https://unknownue.github.io/js/label-colors.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/rust.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/typescript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/go.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/cpp.min.js></script><script>// Ensure highlight.js is properly configured
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof hljs !== 'undefined') {
                hljs.configure({
                    languages: ['rust', 'javascript', 'python', 'cpp', 'go', 'typescript'],
                    ignoreUnescapedHTML: true
                });
                console.log('Highlight.js configured in header');
            }
        });</script><link href=https://cdn.jsdelivr.net/npm/diff2html/bundles/css/diff2html.min.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/diff2html/bundles/js/diff2html-ui.min.js></script><script src=https://unknownue.github.io/js/syntax-highlight.js></script><script src=https://unknownue.github.io/js/diff-sidebar.js></script><script src="https://unknownue.github.io/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><div class=content><header><div class=main><a href=https://unknownue.github.io>Unknownue's Blog</a><div class=socials><a class=social href=https://github.com/unknownue rel=me> <img alt=github src=https://unknownue.github.io/icons/social/github.svg> </a><a class=social href=https://github.com/unknownue/unknownue.github.io rel=me> <img alt=github-io src=https://unknownue.github.io/icons/social/rss.svg> </a></div></div><nav><a href=https://unknownue.github.io/posts style=margin-left:.25em>/posts</a><a href=https://unknownue.github.io/projects style=margin-left:.25em>/projects</a><a href=https://unknownue.github.io/about style=margin-left:.25em>/about</a><a href=https://unknownue.github.io/tags style=margin-left:.25em>/tags</a><button title="$SHORTCUT to open search" class=search-button id=search-button><img alt=Search class=search-icon src=https://unknownue.github.io/icons/search.svg></button><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><div id=modal-content><h1 class=page-header id=modalTitle>Search</h1><div id=searchBar><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search... role=combobox spellcheck=false><button title="Clear search" class=clear-button id=clear-search><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></button></div><div id=results-container><div id=results-info><span id=zero_results style=display:none>No results</span><span id=one_result style=display:none>1 result</span><span id=many_results style=display:none>$NUMBER results</span></div><div id=results role=listbox></div></div></div></div><a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://unknownue.github.io/icons/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://unknownue.github.io/icons/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><div class=pull-request-page><article class=md-content-page style=display:none></article><div class=back-link><a href=/pull_request/bevy/2025-09/>← Back to Pull Requests</a></div><div class=pr-metadata><span class=pr-date>2025-09-03</span><div class=language-switcher><span class="lang-link active" data-lang=en>English</span> / <a class=lang-link data-lang=zh-cn href=/pull_request/bevy/2025-09/pr-20658-zh-cn-20250903>中文</a></div></div><div class=pr-content><h1 id=solari-picapica-scene>Solari PicaPica scene</h1><h2 id=basic-information>Basic Information</h2><ul><li><strong>Title</strong>: Solari PicaPica scene<li><strong>PR Link</strong>: https://github.com/bevyengine/bevy/pull/20658<li><strong>Author</strong>: JMS55<li><strong>Status</strong>: MERGED<li><strong>Labels</strong>: A-Rendering, C-Examples, S-Ready-For-Final-Review<li><strong>Created</strong>: 2025-08-19T18:15:57Z<li><strong>Merged</strong>: 2025-09-03T02:56:45Z<li><strong>Merged By</strong>: alice-i-cecile</ul><h2 id=description-translation>Description Translation</h2><h1 id=objective>Objective</h1><ul><li>Improve the Solari example to showcase the feature’s strengths better (emissive meshes, dynamic lighting conditions)</ul><p>I used the SEED PicaPica project, which besides being a great fit and compact, is pretty cool as it’s also was one of the first demos for realtime raytracing :)<h2 id=showcase>Showcase</h2><img alt=image height=1875 src=https://github.com/user-attachments/assets/be93211e-d2d0-4c7d-8f1d-1aa960087d9a width=3206><h2 id=the-story-of-this-pull-request>The Story of This Pull Request</h2><p>This PR enhances Bevy’s Solari raytracing example by replacing the basic Cornell Box scene with a more sophisticated PicaPica scene that better demonstrates Solari’s capabilities. The original example was limited in showcasing dynamic lighting conditions and emissive materials, so the developer selected the SEED PicaPica project - a compact scene that was historically significant as one of the first realtime raytracing demos.<p>The implementation required several technical changes. First, the asset loading was modified to fetch GLTF models from remote GitHub repositories instead of local files, necessitating the addition of the “https” feature flag. The WebAssetPlugin warning message was also fixed with proper spacing.<p>The core changes involved completely replacing the scene setup. Instead of a single Cornell Box, the example now loads two GLTF scenes: a diorama environment and an animated robot. The robot follows a predefined patrol path using a new <code>PatrolPath</code> component that cycles through waypoints with specific positions and rotations.<p>Significant material adjustments were made to optimize the scene for raytracing:<ul><li>Emissive materials were enhanced with extremely high intensity values (1,000,000x multiplier)<li>Glass materials were made opaque to avoid transparency issues<li>Specific materials like “Lights” and “Glass_Dark_01” received custom treatments<li>Mesh compatibility was ensured by generating missing UV and tangent attributes</ul><p>The camera controller was reconfigured with more appropriate movement speeds for the new scene scale, and the initial camera position was carefully set to provide an optimal viewing angle.<p>New interactive features were added:<ul><li>Space bar to pause/resume the scene<li>Number keys (1, 2) to toggle directional lighting and robot emissive lights<li>Real-time UI text showing current control options and denoising status</ul><p>The implementation demonstrates several advanced Bevy patterns:<ul><li>Complex scene loading and material manipulation<li>Custom component systems for animation (<code>PatrolPath</code>)<li>Conditional system registration based on feature flags<li>Resource-based material referencing (<code>RobotLightMaterial</code>)<li>Comprehensive input handling with multiple interaction modes</ul><h2 id=visual-representation>Visual Representation</h2><pre class=language-mermaid data-lang=mermaid style=color:#61676c;background-color:#fafafa><code class=language-mermaid data-lang=mermaid><span>graph TB
</span><span>    A[Solari Example] --> B[PicaPica Scene]
</span><span>    A --> C[Robot Model]
</span><span>    B --> D[Material Adjustments]
</span><span>    C --> E[PatrolPath Animation]
</span><span>    A --> F[Interactive Controls]
</span><span>    F --> G[Light Toggling]
</span><span>    F --> H[Scene Pausing]
</span><span>    F --> I[UI Status Updates]
</span><span>    A --> J[Asset Loading]
</span><span>    J --> K[Remote HTTPS Assets]
</span></code></pre><h2 id=key-files-changed>Key Files Changed</h2><h3 id=examples-3d-solari-rs-231-31><code>examples/3d/solari.rs</code> (+231/-31)</h3><p><strong>Purpose</strong>: Complete overhaul of the Solari example scene and functionality<p><strong>Key Changes</strong>:<ul><li>Replaced Cornell Box with PicaPica diorama and robot scenes loaded from remote URLs<li>Added patrol path animation system for the robot<li>Implemented interactive light toggling and scene pausing<li>Enhanced material handling for better raytracing demonstration<li>Added UI text system for control instructions</ul><pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Added patrol path component and system
</span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>derive</span><span>(Component)]
</span><span style=color:#fa6e32>struct </span><span style=color:#399ee6>PatrolPath </span><span>{
</span><span>    path</span><span style=color:#61676ccc>: </span><span style=color:#55b4d4;font-style:italic>Vec</span><span><(Vec3, Quat)>,
</span><span>    i</span><span style=color:#61676ccc>: </span><span style=color:#fa6e32>usize</span><span>,
</span><span>}
</span><span>
</span><span style=color:#fa6e32>fn </span><span style=color:#f29718>patrol_path</span><span>(</span><span style=color:#fa6e32>mut </span><span style=color:#ff8f40>query</span><span style=color:#61676ccc>: </span><span>Query<(</span><span style=color:#ed9366>&</span><span style=color:#fa6e32>mut</span><span> PatrolPath, </span><span style=color:#ed9366>&</span><span style=color:#fa6e32>mut</span><span> Transform)>, </span><span style=color:#ff8f40>time</span><span style=color:#61676ccc>: </span><span>Res&LTTime&LTVirtual>>) {
</span><span>    </span><span style=color:#fa6e32>for </span><span>(</span><span style=color:#fa6e32>mut</span><span> path</span><span style=color:#61676ccc>, </span><span style=color:#fa6e32>mut</span><span> transform) </span><span style=color:#ed9366>in</span><span> query</span><span style=color:#ed9366>.</span><span style=color:#f07171>iter_mut</span><span>() {
</span><span>        </span><span style=color:#abb0b6;font-style:italic>// Path following implementation
</span><span>    }
</span><span>}
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// Enhanced material handling in scene loading
</span><span style=color:#fa6e32>if</span><span> material_name</span><span style=color:#ed9366>.</span><span style=color:#f07171>map</span><span>(|</span><span style=color:#ff8f40>s</span><span>| s</span><span style=color:#ed9366>.</span><span style=color:#ff8f40>0.</span><span style=color:#f07171>as_str</span><span>()) </span><span style=color:#ed9366>== </span><span style=color:#55b4d4;font-style:italic>Some</span><span>(</span><span style=color:#86b300>"Lights"</span><span>) {
</span><span>    </span><span style=color:#fa6e32>let</span><span> material </span><span style=color:#ed9366>=</span><span> materials</span><span style=color:#ed9366>.</span><span style=color:#f07171>get_mut</span><span>(material_handle)</span><span style=color:#ed9366>.</span><span style=color:#f07171>unwrap</span><span>()</span><span style=color:#61676ccc>;
</span><span>    material</span><span style=color:#ed9366>.</span><span>emissive </span><span style=color:#ed9366>= </span><span>LinearRgba</span><span style=color:#ed9366>::</span><span>from(Color</span><span style=color:#ed9366>::</span><span>srgb(</span><span style=color:#ff8f40>0.941</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>0.714</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>0.043</span><span>)) </span><span style=color:#ed9366>* </span><span style=color:#ff8f40>1_000_000.0</span><span style=color:#61676ccc>;
</span><span>    material</span><span style=color:#ed9366>.</span><span>alpha_mode </span><span style=color:#ed9366>= </span><span>AlphaMode</span><span style=color:#ed9366>::</span><span>Opaque</span><span style=color:#61676ccc>;
</span><span>    material</span><span style=color:#ed9366>.</span><span>specular_transmission </span><span style=color:#ed9366>= </span><span style=color:#ff8f40>0.0</span><span style=color:#61676ccc>;
</span><span>    commands</span><span style=color:#ed9366>.</span><span style=color:#f07171>insert_resource</span><span>(RobotLightMaterial(material_handle</span><span style=color:#ed9366>.</span><span style=color:#f07171>clone</span><span>()))</span><span style=color:#61676ccc>;
</span><span>}
</span></code></pre><h3 id=cargo-toml-1-1><code>Cargo.toml</code> (+1/-1)</h3><p><strong>Purpose</strong>: Enable HTTPS asset loading for the example<p><strong>Change</strong>: Added “https” feature requirement to solari example<pre class=language-toml data-lang=toml style=color:#61676c;background-color:#fafafa><code class=language-toml data-lang=toml><span style=color:#399ee6>required-features </span><span>= [</span><span style=color:#86b300>"bevy_solari"</span><span style=color:#61676ccc>, </span><span style=color:#86b300>"https"</span><span>]
</span></code></pre><h3 id=crates-bevy-asset-src-io-web-rs-2-2><code>crates/bevy_asset/src/io/web.rs</code> (+2/-2)</h3><p><strong>Purpose</strong>: Fix warning message formatting<p><strong>Change</strong>: Added missing spaces in warning message<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before:
</span><span style=color:#f07171>warn!</span><span>(</span><span style=color:#86b300>"WebAssetPlugin is potentially insecure! Make sure to verify asset URLs are safe to load before loading them.</span><span style=color:#61676ccc>\
</span><span style=color:#86b300>            If you promise you know what you're doing, you can silence this warning by setting silence_startup_warning: true</span><span style=color:#61676ccc>\
</span><span style=color:#86b300>            in the WebAssetPlugin construction."</span><span>)</span><span style=color:#61676ccc>;
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After:
</span><span style=color:#f07171>warn!</span><span>(</span><span style=color:#86b300>"WebAssetPlugin is potentially insecure! Make sure to verify asset URLs are safe to load before loading them. </span><span style=color:#61676ccc>\
</span><span style=color:#86b300>            If you promise you know what you're doing, you can silence this warning by setting silence_startup_warning: true </span><span style=color:#61676ccc>\
</span><span style=color:#86b300>            in the WebAssetPlugin construction."</span><span>)</span><span style=color:#61676ccc>;
</span></code></pre><h3 id=examples-helpers-camera-controller-rs-1-1><code>examples/helpers/camera_controller.rs</code> (+1/-1)</h3><p><strong>Purpose</strong>: Fix time resource type for camera controller<p><strong>Change</strong>: Updated time resource type from <code>Time</code> to <code>Time&LTReal></code><pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before:
</span><span style=color:#fa6e32>fn </span><span style=color:#f29718>run_camera_controller</span><span>(</span><span style=color:#ff8f40>time</span><span style=color:#61676ccc>: </span><span>Res&LTTime>, ...)
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After:
</span><span style=color:#fa6e32>fn </span><span style=color:#f29718>run_camera_controller</span><span>(</span><span style=color:#ff8f40>time</span><span style=color:#61676ccc>: </span><span>Res&LTTime&LTReal>>, ...)
</span></code></pre><h2 id=further-reading>Further Reading</h2><ul><li><a rel="noopener nofollow noreferrer" href=https://github.com/bevyengine/bevy/tree/main/crates/bevy_solari target=_blank>Bevy Solari Documentation</a><li><a rel="noopener nofollow noreferrer" href=https://gpuweb.github.io/gpuweb/wgsl/ target=_blank>WGSL Shader Language</a><li><a rel="noopener nofollow noreferrer" href=https://github.com/KhronosGroup/glTF/tree/main/specification/2.0#materials target=_blank>GLTF Material System</a><li><a rel="noopener nofollow noreferrer" href=https://developer.nvidia.com/rtx/raytracing target=_blank>Realtime Raytracing Techniques</a></ul></div><div data-is-md-page=true data-patch-exists=true data-patch-path=/pull_request/bevy/2025-09/pr_20658.patch id=patch-info style=display:none></div><div class=bottom-spacer></div></div></div>