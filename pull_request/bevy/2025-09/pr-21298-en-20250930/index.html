<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://unknownue.github.io name=base><title>
         #21298 Register unit type alongside the other primitives
        
    </title><meta content="#21298 Register unit type alongside the other primitives" property=og:title><meta content="A personal blog built with Zola and Apollo theme" property=og:description><meta content="A personal blog built with Zola and Apollo theme" name=description><link href=/icons/favicon.png rel=icon type=image/png><link href=https://unknownue.github.io/fonts.css rel=stylesheet><script src=https://unknownue.github.io/js/codeblock.js></script><script src=https://unknownue.github.io/js/toc.js></script><script src=https://unknownue.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Unknownue's Blog" href=https://unknownue.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://unknownue.github.io/theme/light.css rel=stylesheet><link href=https://unknownue.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://unknownue.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://unknownue.github.io/main.css media=screen rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js></script><script>// Initialize mermaid once DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            mermaid.initialize({
                startOnLoad: false,
                theme: document.body && document.body.classList.contains('dark') ? 'dark' : 'default',
                securityLevel: 'loose',
                flowchart: {
                    useMaxWidth: true,
                    htmlLabels: true
                },
                sequence: {
                    diagramMarginX: 50,
                    diagramMarginY: 10,
                    actorMargin: 50,
                    width: 150,
                    height: 65
                }
            });
        });</script><script src=https://unknownue.github.io/js/main.js></script><script defer src=https://unknownue.github.io/js/label-colors.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/rust.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/typescript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/go.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/cpp.min.js></script><script>// Ensure highlight.js is properly configured
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof hljs !== 'undefined') {
                hljs.configure({
                    languages: ['rust', 'javascript', 'python', 'cpp', 'go', 'typescript'],
                    ignoreUnescapedHTML: true
                });
                console.log('Highlight.js configured in header');
            }
        });</script><link href=https://cdn.jsdelivr.net/npm/diff2html/bundles/css/diff2html.min.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/diff2html/bundles/js/diff2html-ui.min.js></script><script src=https://unknownue.github.io/js/syntax-highlight.js></script><script src=https://unknownue.github.io/js/diff-sidebar.js></script><script src="https://unknownue.github.io/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><div class=content><header><div class=main><a href=https://unknownue.github.io>Unknownue's Blog</a><div class=socials><a class=social href=https://github.com/unknownue rel=me> <img alt=github src=https://unknownue.github.io/icons/social/github.svg> </a><a class=social href=https://github.com/unknownue/unknownue.github.io rel=me> <img alt=github-io src=https://unknownue.github.io/icons/social/rss.svg> </a></div></div><nav><a href=https://unknownue.github.io/posts style=margin-left:.25em>/posts</a><a href=https://unknownue.github.io/projects style=margin-left:.25em>/projects</a><a href=https://unknownue.github.io/about style=margin-left:.25em>/about</a><a href=https://unknownue.github.io/tags style=margin-left:.25em>/tags</a><button title="$SHORTCUT to open search" class=search-button id=search-button><img alt=Search class=search-icon src=https://unknownue.github.io/icons/search.svg></button><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><div id=modal-content><h1 class=page-header id=modalTitle>Search</h1><div id=searchBar><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search... role=combobox spellcheck=false><button title="Clear search" class=clear-button id=clear-search><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></button></div><div id=results-container><div id=results-info><span id=zero_results style=display:none>No results</span><span id=one_result style=display:none>1 result</span><span id=many_results style=display:none>$NUMBER results</span></div><div id=results role=listbox></div></div></div></div><a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://unknownue.github.io/icons/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://unknownue.github.io/icons/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><div class=pull-request-page><article class=md-content-page style=display:none></article><div class=back-link><a href=/pull_request/bevy/2025-09/>← Back to Pull Requests</a></div><div class=pr-metadata><span class=pr-date>2025-09-30</span><div class=language-switcher><span class="lang-link active" data-lang=en>English</span> / <a class=lang-link data-lang=zh-cn href=/pull_request/bevy/2025-09/pr-21298-zh-cn-20250930>中文</a></div></div><div class=pr-content><h1 id=title>Title</h1><p>Register unit type alongside the other primitives<h2 id=basic-information>Basic Information</h2><ul><li><strong>Title</strong>: Register unit type alongside the other primitives<li><strong>PR Link</strong>: https://github.com/bevyengine/bevy/pull/21298<li><strong>Author</strong>: MichalGniadek<li><strong>Status</strong>: MERGED<li><strong>Labels</strong>: C-Bug, S-Ready-For-Final-Review, A-Reflection<li><strong>Created</strong>: 2025-09-30T15:50:53Z<li><strong>Merged</strong>: 2025-09-30T22:06:56Z<li><strong>Merged By</strong>: james7132</ul><h2 id=description-translation>Description Translation</h2><h1 id=objective>Objective</h1><p>Primitive types are automatically registered when a <code>TypeRegistry</code> is created, except for unit type <code>()</code>.<h2 id=solution>Solution</h2><p>Register <code>()</code> alongside other primitives.<h2 id=testing>Testing</h2><p>Run tests in <code>bevy_reflect</code>, tested with my code that <code>()</code> is being registered.<h2 id=the-story-of-this-pull-request>The Story of This Pull Request</h2><p>This PR addresses a consistency issue in Bevy’s reflection system where the unit type <code>()</code> was being treated differently from other primitive types. The problem emerged when developers working with Bevy’s reflection capabilities discovered that while all other primitive types were automatically registered in the <code>TypeRegistry</code>, the unit type was conspicuously absent.<p>The unit type <code>()</code> is a fundamental type in Rust that represents a value with no meaningful data - essentially a zero-sized type used when a function returns nothing or when a value is needed but no data is required. In reflection systems, even zero-sized types need registration because they may appear in type signatures, generic parameters, or as field types in structs.<p>The implementation approach was straightforward and consistent with existing patterns. The developer identified that the <code>TypeRegistry::new()</code> method already contained registrations for all other primitive types including <code>bool</code>, <code>char</code>, and various numeric types. The solution was simply to add the missing registration for <code>()</code> alongside these existing registrations.<p>This change ensures that the unit type can be properly reflected and manipulated through Bevy’s reflection APIs, maintaining consistency with how other primitive types are handled. Without this registration, code that attempted to reflect on types containing unit types would encounter missing type information, potentially causing runtime errors or incorrect behavior in reflection-based systems.<p>The fix is minimal and low-risk because it follows the exact same pattern already established for other primitive types. The unit type registration uses the same <code>registry.register::<()></code> call that’s used for all other types in the registry initialization.<h2 id=visual-representation>Visual Representation</h2><pre class=language-mermaid data-lang=mermaid style=color:#61676c;background-color:#fafafa><code class=language-mermaid data-lang=mermaid><span>graph TD
</span><span>    A[TypeRegistry::new] --> B[Register Unit Type]
</span><span>    A --> C[Register bool]
</span><span>    A --> D[Register char]
</span><span>    A --> E[Register numeric types]
</span><span>    B --> F[Consistent Primitive Registration]
</span><span>    C --> F
</span><span>    D --> F
</span><span>    E --> F
</span></code></pre><h2 id=key-files-changed>Key Files Changed</h2><p><strong>File: <code>crates/bevy_reflect/src/type_registry.rs</code></strong><p>This file contains the core implementation of Bevy’s type registry system. The change adds one line to ensure the unit type <code>()</code> is registered alongside other primitive types when a new <code>TypeRegistry</code> is created.<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// File: crates/bevy_reflect/src/type_registry.rs
</span><span style=color:#abb0b6;font-style:italic>// Before:
</span><span style=color:#fa6e32>pub fn </span><span style=color:#f29718>new</span><span>() </span><span style=color:#61676ccc>-> </span><span style=color:#fa6e32>Self </span><span>{
</span><span>    </span><span style=color:#fa6e32>let mut</span><span> registry </span><span style=color:#ed9366>= </span><span style=color:#fa6e32>Self</span><span style=color:#ed9366>::</span><span>empty()</span><span style=color:#61676ccc>;
</span><span>    registry</span><span style=color:#ed9366>.</span><span>register</span><span style=color:#ed9366>::</span><span><</span><span style=color:#fa6e32>bool</span><span>>()</span><span style=color:#61676ccc>;
</span><span>    registry</span><span style=color:#ed9366>.</span><span>register</span><span style=color:#ed9366>::</span><span><</span><span style=color:#fa6e32>char</span><span>>()</span><span style=color:#61676ccc>;
</span><span>    registry</span><span style=color:#ed9366>.</span><span>register</span><span style=color:#ed9366>::</span><span><</span><span style=color:#fa6e32>u8</span><span>>()</span><span style=color:#61676ccc>;
</span><span>    </span><span style=color:#abb0b6;font-style:italic>// ... other primitive registrations
</span><span>}
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After:
</span><span style=color:#fa6e32>pub fn </span><span style=color:#f29718>new</span><span>() </span><span style=color:#61676ccc>-> </span><span style=color:#fa6e32>Self </span><span>{
</span><span>    </span><span style=color:#fa6e32>let mut</span><span> registry </span><span style=color:#ed9366>= </span><span style=color:#fa6e32>Self</span><span style=color:#ed9366>::</span><span>empty()</span><span style=color:#61676ccc>;
</span><span>    registry</span><span style=color:#ed9366>.</span><span>register</span><span style=color:#ed9366>::</span><span><()>()</span><span style=color:#61676ccc>;  </span><span style=color:#abb0b6;font-style:italic>// Added this line
</span><span>    registry</span><span style=color:#ed9366>.</span><span>register</span><span style=color:#ed9366>::</span><span><</span><span style=color:#fa6e32>bool</span><span>>()</span><span style=color:#61676ccc>;
</span><span>    registry</span><span style=color:#ed9366>.</span><span>register</span><span style=color:#ed9366>::</span><span><</span><span style=color:#fa6e32>char</span><span>>()</span><span style=color:#61676ccc>;
</span><span>    registry</span><span style=color:#ed9366>.</span><span>register</span><span style=color:#ed9366>::</span><span><</span><span style=color:#fa6e32>u8</span><span>>()</span><span style=color:#61676ccc>;
</span><span>    </span><span style=color:#abb0b6;font-style:italic>// ... other primitive registrations
</span><span>}
</span></code></pre><p>The change is minimal but important for consistency. The <code>registry.register::<()></code> call follows the exact same pattern as the existing primitive type registrations, ensuring that the unit type is available for reflection operations just like other fundamental types.<h2 id=further-reading>Further Reading</h2><ul><li><a rel="noopener nofollow noreferrer" href=https://doc.rust-lang.org/std/primitive.unit.html target=_blank>Rust Unit Type Documentation</a><li><a rel="noopener nofollow noreferrer" href=https://docs.rs/bevy_reflect/latest/bevy_reflect/ target=_blank>Bevy Reflection Documentation</a><li><a rel="noopener nofollow noreferrer" href=https://bevy-cheatbook.github.io/programming/reflection.html#type-registry target=_blank>Type Registration in Bevy</a></ul><h1 id=full-code-diff>Full Code Diff</h1><pre class=language-diff data-lang=diff style=color:#61676c;background-color:#fafafa><code class=language-diff data-lang=diff><span>diff --git a/crates/bevy_reflect/src/type_registry.rs b/crates/bevy_reflect/src/type_registry.rs
</span><span>index d6248db82c8b9..5c79a7bd77840 100644
</span><span style=color:#c594c5>--- a/crates/bevy_reflect/src/type_registry.rs
</span><span style=color:#c594c5>+++ b/crates/bevy_reflect/src/type_registry.rs
</span><span style=color:#c594c5>@@ -100,6 +100,7 @@ </span><span style=color:#399ee6>impl TypeRegistry {
</span><span>     /// Create a type registry with default registrations for primitive types.
</span><span>     pub fn new() -> Self {
</span><span>         let mut registry = Self::empty();
</span><span style=color:#86b300>+        registry.register::<()>();
</span><span>         registry.register::&LTbool>();
</span><span>         registry.register::&LTchar>();
</span><span>         registry.register::&LTu8>();
</span></code></pre></div><div data-is-md-page=true data-patch-exists=true data-patch-path=/pull_request/bevy/2025-09/pr_21298.patch id=patch-info style=display:none></div><div class=bottom-spacer></div></div></div>