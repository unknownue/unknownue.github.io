<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://unknownue.github.io name=base><title>
         #20851 Remove `desktop_app` setting from `feathers` example (and other UI examples)
        
    </title><meta content="#20851 Remove `desktop_app` setting from `feathers` example (and other UI examples)" property=og:title><meta content="A personal blog built with Zola and Apollo theme" property=og:description><meta content="A personal blog built with Zola and Apollo theme" name=description><link href=/icons/favicon.png rel=icon type=image/png><link href=https://unknownue.github.io/fonts.css rel=stylesheet><script src=https://unknownue.github.io/js/codeblock.js></script><script src=https://unknownue.github.io/js/toc.js></script><script src=https://unknownue.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Unknownue's Blog" href=https://unknownue.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://unknownue.github.io/theme/light.css rel=stylesheet><link href=https://unknownue.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://unknownue.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://unknownue.github.io/main.css media=screen rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js></script><script>// Initialize mermaid once DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            mermaid.initialize({
                startOnLoad: false,
                theme: document.body && document.body.classList.contains('dark') ? 'dark' : 'default',
                securityLevel: 'loose',
                flowchart: {
                    useMaxWidth: true,
                    htmlLabels: true
                },
                sequence: {
                    diagramMarginX: 50,
                    diagramMarginY: 10,
                    actorMargin: 50,
                    width: 150,
                    height: 65
                }
            });
        });</script><script src=https://unknownue.github.io/js/main.js></script><script defer src=https://unknownue.github.io/js/label-colors.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/rust.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/typescript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/go.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/cpp.min.js></script><script>// Ensure highlight.js is properly configured
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof hljs !== 'undefined') {
                hljs.configure({
                    languages: ['rust', 'javascript', 'python', 'cpp', 'go', 'typescript'],
                    ignoreUnescapedHTML: true
                });
                console.log('Highlight.js configured in header');
            }
        });</script><link href=https://cdn.jsdelivr.net/npm/diff2html/bundles/css/diff2html.min.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/diff2html/bundles/js/diff2html-ui.min.js></script><script src=https://unknownue.github.io/js/syntax-highlight.js></script><script src=https://unknownue.github.io/js/diff-sidebar.js></script><script src="https://unknownue.github.io/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><div class=content><header><div class=main><a href=https://unknownue.github.io>Unknownue's Blog</a><div class=socials><a class=social href=https://github.com/unknownue rel=me> <img alt=github src=https://unknownue.github.io/icons/social/github.svg> </a><a class=social href=https://github.com/unknownue/unknownue.github.io rel=me> <img alt=github-io src=https://unknownue.github.io/icons/social/rss.svg> </a></div></div><nav><a href=https://unknownue.github.io/posts style=margin-left:.25em>/posts</a><a href=https://unknownue.github.io/projects style=margin-left:.25em>/projects</a><a href=https://unknownue.github.io/about style=margin-left:.25em>/about</a><a href=https://unknownue.github.io/tags style=margin-left:.25em>/tags</a><button title="$SHORTCUT to open search" class=search-button id=search-button><img alt=Search class=search-icon src=https://unknownue.github.io/icons/search.svg></button><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><div id=modal-content><h1 class=page-header id=modalTitle>Search</h1><div id=searchBar><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search... role=combobox spellcheck=false><button title="Clear search" class=clear-button id=clear-search><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></button></div><div id=results-container><div id=results-info><span id=zero_results style=display:none>No results</span><span id=one_result style=display:none>1 result</span><span id=many_results style=display:none>$NUMBER results</span></div><div id=results role=listbox></div></div></div></div><a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://unknownue.github.io/icons/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://unknownue.github.io/icons/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><div class=pull-request-page><article class=md-content-page style=display:none></article><div class=back-link><a href=/pull_request/bevy/2025-09/>← Back to Pull Requests</a></div><div class=pr-metadata><span class=pr-date>2025-09-03</span><div class=language-switcher><span class="lang-link active" data-lang=en>English</span> / <a class=lang-link data-lang=zh-cn href=/pull_request/bevy/2025-09/pr-20851-zh-cn-20250903>中文</a></div></div><div class=pr-content><h1 id=remove-desktop-app-setting-from-feathers-example-and-other-ui-examples>Remove <code>desktop_app</code> setting from <code>feathers</code> example (and other UI examples)</h1><h2 id=basic-information>Basic Information</h2><ul><li><strong>Title</strong>: Remove <code>desktop_app</code> setting from <code>feathers</code> example (and other UI examples)<li><strong>PR Link</strong>: https://github.com/bevyengine/bevy/pull/20851<li><strong>Author</strong>: alice-i-cecile<li><strong>Status</strong>: MERGED<li><strong>Labels</strong>: C-Examples, A-UI, S-Ready-For-Final-Review, X-Contentious<li><strong>Created</strong>: 2025-09-03T17:43:46Z<li><strong>Merged</strong>: 2025-09-03T21:19:01Z<li><strong>Merged By</strong>: alice-i-cecile</ul><h2 id=description-translation>Description Translation</h2><h1 id=objective>Objective</h1><p>While <code>desktop_app</code> is arguably correct for a UI focused example, in practice, it doesn’t work well currently. The intermittent updates lead to “buggy” behavior: partial loads, stutters and so on.<p>We should fix those problems, and make the desktop_app setting more useful! But “last minute before release” is not a good time to do so. And simply leaving these apparent bugs in our showcase of the new UI toolkit will both mislead users about the quality and trick them into doing bad things for their own project.<p>Closes #20796. Fixes (kind of) the problem that motivated #20849.<h2 id=solution>Solution</h2><p>Remove the <code>desktop_app</code> setting from this example.<p>This will cause problems for <code>accesskit</code> users (at least on Mac) unfortunately, but that problem is <em>another</em> bug: #20515. Telling visually impaired users that they can only use screen readers on low CPU utilization apps in our game framework is not acceptable either.<p>I’ve also removed this from the other UI examples for the same reasons. The <code>low_power</code> example exists to demonstrate this: we shouldn’t clutter the others without good justification.<h2 id=testing>Testing</h2><p>I’ve run the <code>feathers</code> example locally: the bad behavior is no longer observed.<h2 id=the-story-of-this-pull-request>The Story of This Pull Request</h2><p>The problem began with Bevy’s UI examples exhibiting buggy behavior - partial loads, stutters, and inconsistent rendering. These issues were particularly problematic because they appeared in showcase examples for Bevy’s new UI toolkit, potentially misleading users about the framework’s quality.<p>The root cause was the <code>WinitSettings::desktop_app()</code> configuration, which enables a low-power mode that only updates the application when there’s user input. While this setting is theoretically appropriate for UI-focused applications that don’t need continuous rendering, the current implementation caused intermittent updates that resulted in visual artifacts and performance issues.<p>The developer faced a timing constraint: with an upcoming release, there wasn’t sufficient time to properly fix the underlying issues with the <code>desktop_app</code> implementation. However, leaving the buggy behavior in the examples was not acceptable, as it would both misrepresent the UI toolkit’s capabilities and encourage users to implement problematic patterns in their own projects.<p>The solution approach was straightforward but impactful: remove the <code>desktop_app</code> setting from all affected UI examples. This approach acknowledged that while the low-power mode is conceptually correct for UI applications, the current implementation’s flaws made it unsuitable for demonstration purposes. The existing <code>low_power</code> example would remain to showcase this functionality when working properly.<p>The implementation involved modifying 20 UI example files to remove two key elements:<ol><li>The import of <code>WinitSettings</code> from <code>bevy::winit</code><li>The insertion of <code>WinitSettings::desktop_app()</code> as a resource</ol><p>For example, in the <code>feathers</code> example:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before:
</span><span style=color:#fa6e32>use </span><span>bevy</span><span style=color:#ed9366>::</span><span>{
</span><span>    </span><span style=color:#abb0b6;font-style:italic>// ... other imports ...
</span><span>    winit</span><span style=color:#ed9366>::</span><span>WinitSettings</span><span style=color:#61676ccc>,
</span><span>}</span><span style=color:#61676ccc>;
</span><span>
</span><span style=color:#fa6e32>fn </span><span style=color:#f29718>main</span><span>() {
</span><span>    App</span><span style=color:#ed9366>::</span><span>new()
</span><span>        </span><span style=color:#ed9366>.</span><span style=color:#f07171>add_plugins</span><span>(DefaultPlugins)
</span><span>        </span><span style=color:#abb0b6;font-style:italic>// Only run the app when there is user input. This will significantly reduce CPU/GPU use.
</span><span>        </span><span style=color:#ed9366>.</span><span style=color:#f07171>insert_resource</span><span>(WinitSettings</span><span style=color:#ed9366>::</span><span>desktop_app())
</span><span>        </span><span style=color:#abb0b6;font-style:italic>// ... other configuration ...
</span><span>        </span><span style=color:#ed9366>.</span><span style=color:#f07171>run</span><span>()</span><span style=color:#61676ccc>;
</span><span>}
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After:
</span><span style=color:#fa6e32>use </span><span>bevy</span><span style=color:#ed9366>::</span><span>{
</span><span>    </span><span style=color:#abb0b6;font-style:italic>// ... other imports (without winit::WinitSettings) ...
</span><span>}</span><span style=color:#61676ccc>;
</span><span>
</span><span style=color:#fa6e32>fn </span><span style=color:#f29718>main</span><span>() {
</span><span>    App</span><span style=color:#ed9366>::</span><span>new()
</span><span>        </span><span style=color:#ed9366>.</span><span style=color:#f07171>add_plugins</span><span>(DefaultPlugins)
</span><span>        </span><span style=color:#abb0b6;font-style:italic>// ... other configuration (without WinitSettings) ...
</span><span>        </span><span style=color:#ed9366>.</span><span style=color:#f07171>run</span><span>()</span><span style=color:#61676ccc>;
</span><span>}
</span></code></pre><p>This change ensures the examples use Bevy’s default update mode (continuous rendering) instead of the low-power event-driven mode, eliminating the visual artifacts while maintaining all functional behavior.<p>The technical insight here is about the trade-off between power efficiency and rendering consistency. The <code>desktop_app</code> mode uses <code>EventLoop::run</code> with <code>ControlFlow::Wait</code>, which only processes events when they occur rather than continuously rendering. While this reduces CPU/GPU usage, it can cause issues with partial rendering and stuttering in complex UI scenarios.<p>The impact of these changes is immediate: UI examples now render smoothly without visual artifacts, providing a better demonstration of Bevy’s UI capabilities. The trade-off is increased CPU/GPU usage in idle states, but this is acceptable for example code that’s typically run for short periods.<p>This change also highlights an important accessibility consideration. The developer noted that removing <code>desktop_app</code> might cause issues for AccessKit users on macOS (tracked in #20515), but considered this preferable to suggesting that screen readers only work well in low-power applications.<h2 id=visual-representation>Visual Representation</h2><pre class=language-mermaid data-lang=mermaid style=color:#61676c;background-color:#fafafa><code class=language-mermaid data-lang=mermaid><span>graph TD
</span><span>    A[UI Examples] --> B[Remove WinitSettings import]
</span><span>    A --> C[Remove desktop_app resource]
</span><span>    B --> D[Continuous rendering mode]
</span><span>    C --> D
</span><span>    D --> E[Smooth UI performance]
</span><span>    D --> F[Eliminated visual artifacts]
</span></code></pre><h2 id=key-files-changed>Key Files Changed</h2><p>The PR modified 20 UI example files with similar changes. Here are representative examples:<p><strong>File: examples/ui/feathers.rs</strong><pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before:
</span><span style=color:#fa6e32>use </span><span>bevy</span><span style=color:#ed9366>::</span><span>{
</span><span>    </span><span style=color:#abb0b6;font-style:italic>// ... other imports ...
</span><span>    winit</span><span style=color:#ed9366>::</span><span>WinitSettings</span><span style=color:#61676ccc>,
</span><span>}</span><span style=color:#61676ccc>;
</span><span>
</span><span style=color:#fa6e32>fn </span><span style=color:#f29718>main</span><span>() {
</span><span>    App</span><span style=color:#ed9366>::</span><span>new()
</span><span>        </span><span style=color:#ed9366>.</span><span style=color:#f07171>add_plugins</span><span>(DefaultPlugins)
</span><span>        </span><span style=color:#abb0b6;font-style:italic>// Only run the app when there is user input. This will significantly reduce CPU/GPU use.
</span><span>        </span><span style=color:#ed9366>.</span><span style=color:#f07171>insert_resource</span><span>(WinitSettings</span><span style=color:#ed9366>::</span><span>desktop_app())
</span><span>        </span><span style=color:#abb0b6;font-style:italic>// ... other configuration ...
</span><span>        </span><span style=color:#ed9366>.</span><span style=color:#f07171>run</span><span>()</span><span style=color:#61676ccc>;
</span><span>}
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After:
</span><span style=color:#fa6e32>use </span><span>bevy</span><span style=color:#ed9366>::</span><span>{
</span><span>    </span><span style=color:#abb0b6;font-style:italic>// ... other imports (without winit::WinitSettings) ...
</span><span>}</span><span style=color:#61676ccc>;
</span><span>
</span><span style=color:#fa6e32>fn </span><span style=color:#f29718>main</span><span>() {
</span><span>    App</span><span style=color:#ed9366>::</span><span>new()
</span><span>        </span><span style=color:#ed9366>.</span><span style=color:#f07171>add_plugins</span><span>(DefaultPlugins)
</span><span>        </span><span style=color:#abb0b6;font-style:italic>// ... other configuration (without WinitSettings) ...
</span><span>        </span><span style=color:#ed9366>.</span><span style=color:#f07171>run</span><span>()</span><span style=color:#61676ccc>;
</span><span>}
</span></code></pre><p><strong>File: examples/ui/button.rs</strong><pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before:
</span><span style=color:#fa6e32>use </span><span>bevy</span><span style=color:#ed9366>::</span><span>{color</span><span style=color:#ed9366>::</span><span>palettes</span><span style=color:#ed9366>::</span><span>basic</span><span style=color:#ed9366>::*</span><span style=color:#61676ccc>, </span><span>input_focus</span><span style=color:#ed9366>::</span><span>InputFocus</span><span style=color:#61676ccc>, </span><span>prelude</span><span style=color:#ed9366>::*</span><span style=color:#61676ccc>, </span><span>winit</span><span style=color:#ed9366>::</span><span>WinitSettings}</span><span style=color:#61676ccc>;
</span><span>
</span><span style=color:#fa6e32>fn </span><span style=color:#f29718>main</span><span>() {
</span><span>    App</span><span style=color:#ed9366>::</span><span>new()
</span><span>        </span><span style=color:#ed9366>.</span><span style=color:#f07171>add_plugins</span><span>(DefaultPlugins)
</span><span>        </span><span style=color:#abb0b6;font-style:italic>// Only run the app when there is user input. This will significantly reduce CPU/GPU use.
</span><span>        </span><span style=color:#ed9366>.</span><span style=color:#f07171>insert_resource</span><span>(WinitSettings</span><span style=color:#ed9366>::</span><span>desktop_app())
</span><span>        </span><span style=color:#ed9366>.</span><span>init_resource</span><span style=color:#ed9366>::</span><span>&LTInputFocus>()
</span><span>        </span><span style=color:#ed9366>.</span><span style=color:#f07171>add_systems</span><span>(Startup</span><span style=color:#61676ccc>,</span><span> setup)
</span><span>        </span><span style=color:#ed9366>.</span><span style=color:#f07171>run</span><span>()</span><span style=color:#61676ccc>;
</span><span>}
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After:
</span><span style=color:#fa6e32>use </span><span>bevy</span><span style=color:#ed9366>::</span><span>{color</span><span style=color:#ed9366>::</span><span>palettes</span><span style=color:#ed9366>::</span><span>basic</span><span style=color:#ed9366>::*</span><span style=color:#61676ccc>, </span><span>input_focus</span><span style=color:#ed9366>::</span><span>InputFocus</span><span style=color:#61676ccc>, </span><span>prelude</span><span style=color:#ed9366>::*</span><span>}</span><span style=color:#61676ccc>;
</span><span>
</span><span style=color:#fa6e32>fn </span><span style=color:#f29718>main</span><span>() {
</span><span>    App</span><span style=color:#ed9366>::</span><span>new()
</span><span>        </span><span style=color:#ed9366>.</span><span style=color:#f07171>add_plugins</span><span>(DefaultPlugins)
</span><span>        </span><span style=color:#ed9366>.</span><span>init_resource</span><span style=color:#ed9366>::</span><span>&LTInputFocus>()
</span><span>        </span><span style=color:#ed9366>.</span><span style=color:#f07171>add_systems</span><span>(Startup</span><span style=color:#61676ccc>,</span><span> setup)
</span><span>        </span><span style=color:#ed9366>.</span><span style=color:#f07171>run</span><span>()</span><span style=color:#61676ccc>;
</span><span>}
</span></code></pre><p>These changes remove the problematic low-power mode while maintaining all functional behavior, ensuring smooth rendering in UI examples.<h2 id=further-reading>Further Reading</h2><ul><li><a rel="noopener nofollow noreferrer" href=https://docs.rs/bevy/latest/bevy/winit/struct.WinitSettings.html target=_blank>Bevy Winit Settings Documentation</a><li><a rel="noopener nofollow noreferrer" href=https://github.com/bevyengine/bevy/tree/main/examples/ui target=_blank>Bevy UI Examples</a><li><a rel="noopener nofollow noreferrer" href=https://developer.nvidia.com/blog/making-games-accessible-designing-for-motor-disabilities/ target=_blank>Accessibility in Game Development</a><li><a rel="noopener nofollow noreferrer" href=https://docs.rs/winit/latest/winit/event_loop/enum.ControlFlow.html target=_blank>Event Loop Control Flow Patterns</a></ul></div><div data-is-md-page=true data-patch-exists=true data-patch-path=/pull_request/bevy/2025-09/pr_20851.patch id=patch-info style=display:none></div><div class=bottom-spacer></div></div></div>