<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://unknownue.github.io name=base><title>
         #21018 fix sprite gizmo feature
        
    </title><meta content="#21018 fix sprite gizmo feature" property=og:title><meta content="A personal blog built with Zola and Apollo theme" property=og:description><meta content="A personal blog built with Zola and Apollo theme" name=description><link href=/icons/favicon.png rel=icon type=image/png><link href=https://unknownue.github.io/fonts.css rel=stylesheet><script src=https://unknownue.github.io/js/codeblock.js></script><script src=https://unknownue.github.io/js/toc.js></script><script src=https://unknownue.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Unknownue's Blog" href=https://unknownue.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://unknownue.github.io/theme/light.css rel=stylesheet><link href=https://unknownue.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://unknownue.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://unknownue.github.io/main.css media=screen rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js></script><script>// Initialize mermaid once DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            mermaid.initialize({
                startOnLoad: false,
                theme: document.body && document.body.classList.contains('dark') ? 'dark' : 'default',
                securityLevel: 'loose',
                flowchart: {
                    useMaxWidth: true,
                    htmlLabels: true
                },
                sequence: {
                    diagramMarginX: 50,
                    diagramMarginY: 10,
                    actorMargin: 50,
                    width: 150,
                    height: 65
                }
            });
        });</script><script src=https://unknownue.github.io/js/main.js></script><script defer src=https://unknownue.github.io/js/label-colors.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/rust.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/typescript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/go.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/cpp.min.js></script><script>// Ensure highlight.js is properly configured
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof hljs !== 'undefined') {
                hljs.configure({
                    languages: ['rust', 'javascript', 'python', 'cpp', 'go', 'typescript'],
                    ignoreUnescapedHTML: true
                });
                console.log('Highlight.js configured in header');
            }
        });</script><link href=https://cdn.jsdelivr.net/npm/diff2html/bundles/css/diff2html.min.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/diff2html/bundles/js/diff2html-ui.min.js></script><script src=https://unknownue.github.io/js/syntax-highlight.js></script><script src=https://unknownue.github.io/js/diff-sidebar.js></script><script src="https://unknownue.github.io/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><div class=content><header><div class=main><a href=https://unknownue.github.io>Unknownue's Blog</a><div class=socials><a class=social href=https://github.com/unknownue rel=me> <img alt=github src=https://unknownue.github.io/icons/social/github.svg> </a><a class=social href=https://github.com/unknownue/unknownue.github.io rel=me> <img alt=github-io src=https://unknownue.github.io/icons/social/rss.svg> </a></div></div><nav><a href=https://unknownue.github.io/posts style=margin-left:.25em>/posts</a><a href=https://unknownue.github.io/projects style=margin-left:.25em>/projects</a><a href=https://unknownue.github.io/about style=margin-left:.25em>/about</a><a href=https://unknownue.github.io/tags style=margin-left:.25em>/tags</a><button title="$SHORTCUT to open search" class=search-button id=search-button><img alt=Search class=search-icon src=https://unknownue.github.io/icons/search.svg></button><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><div id=modal-content><h1 class=page-header id=modalTitle>Search</h1><div id=searchBar><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search... role=combobox spellcheck=false><button title="Clear search" class=clear-button id=clear-search><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></button></div><div id=results-container><div id=results-info><span id=zero_results style=display:none>No results</span><span id=one_result style=display:none>1 result</span><span id=many_results style=display:none>$NUMBER results</span></div><div id=results role=listbox></div></div></div></div><a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://unknownue.github.io/icons/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://unknownue.github.io/icons/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><div class=pull-request-page><article class=md-content-page style=display:none></article><div class=back-link><a href=/pull_request/bevy/2025-09/>← Back to Pull Requests</a></div><div class=pr-metadata><span class=pr-date>2025-09-14</span><div class=language-switcher><span class="lang-link active" data-lang=en>English</span> / <a class=lang-link data-lang=zh-cn href=/pull_request/bevy/2025-09/pr-21018-zh-cn-20250914>中文</a></div></div><div class=pr-content><h1 id=title>Title</h1><p>fix sprite gizmo feature<h2 id=basic-information>Basic Information</h2><ul><li><strong>Title</strong>: fix sprite gizmo feature<li><strong>PR Link</strong>: https://github.com/bevyengine/bevy/pull/21018<li><strong>Author</strong>: atlv24<li><strong>Status</strong>: MERGED<li><strong>Labels</strong>: A-Rendering, S-Ready-For-Final-Review, A-Gizmos<li><strong>Created</strong>: 2025-09-13T18:12:19Z<li><strong>Merged</strong>: 2025-09-14T20:20:24Z<li><strong>Merged By</strong>: alice-i-cecile</ul><h2 id=description-translation>Description Translation</h2><h1 id=objective>Objective</h1><ul><li>Fix #21008</ul><h2 id=solution>Solution</h2><ul><li>I missed this during review of the sprite render split, bevy_gizmos should only care about bevy_sprite_render’s presence.</ul><h2 id=testing>Testing</h2><ul><li>repro in linked issue</ul><h2 id=the-story-of-this-pull-request>The Story of This Pull Request</h2><p>This PR addresses a build breakage that occurred after a recent architectural change in Bevy’s rendering system. The core issue was that the gizmos system was incorrectly checking for the presence of the <code>bevy_sprite</code> feature when it should have been checking for <code>bevy_sprite_render</code> instead.<p>The problem stemmed from a previous sprite render split where the rendering functionality was separated from the broader sprite system. During this split, the gizmos system needed to be updated to depend on the new <code>bevy_sprite_render</code> component rather than the full <code>bevy_sprite</code> module, but this dependency was missed during review.<p>The fix involved updating multiple locations where feature flags and conditional compilation were checking for the wrong module. The changes ensure that:<ol><li>The dependency on <code>bevy_sprite</code> is completely removed from the gizmos system<li>All feature conditionals now correctly check for <code>bevy_sprite_render</code> instead of <code>bevy_sprite</code><li>Warning messages and documentation are updated to reference the correct plugin (<code>SpriteRenderPlugin</code> instead of <code>SpritePlugin</code>)</ol><p>This is a straightforward but important fix that maintains the architectural separation established by the sprite render split while ensuring the gizmos system continues to work correctly with both 2D and 3D rendering pipelines.<h2 id=visual-representation>Visual Representation</h2><pre class=language-mermaid data-lang=mermaid style=color:#61676c;background-color:#fafafa><code class=language-mermaid data-lang=mermaid><span>graph LR
</span><span>    A[bevy_gizmos] --> B[bevy_sprite_render]
</span><span>    A --> C[bevy_pbr]
</span><span>    B --> D[2D Gizmo Rendering]
</span><span>    C --> E[3D Gizmo Rendering]
</span></code></pre><h2 id=key-files-changed>Key Files Changed</h2><h3 id=crates-bevy-gizmos-cargo-toml><code>crates/bevy_gizmos/Cargo.toml</code></h3><p>Removed the unnecessary dependency on <code>bevy_sprite</code>:<pre class=language-toml data-lang=toml style=color:#61676c;background-color:#fafafa><code class=language-toml data-lang=toml><span style=color:#abb0b6;font-style:italic># Before:
</span><span style=color:#399ee6>bevy_sprite </span><span>= { </span><span style=color:#399ee6>path </span><span>= </span><span style=color:#86b300>"../bevy_sprite"</span><span style=color:#61676ccc>, </span><span style=color:#399ee6>version </span><span>= </span><span style=color:#86b300>"0.17.0-dev"</span><span style=color:#61676ccc>, </span><span style=color:#399ee6>optional </span><span>= </span><span style=color:#ff8f40>true </span><span>}
</span><span>
</span><span style=color:#abb0b6;font-style:italic># After:
</span><span style=color:#abb0b6;font-style:italic># (dependency removed entirely)
</span></code></pre><h3 id=crates-bevy-gizmos-src-config-rs><code>crates/bevy_gizmos/src/config.rs</code></h3><p>Updated feature conditionals to use <code>bevy_sprite_render</code>:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before:
</span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>cfg</span><span>(</span><span style=color:#f29718>all</span><span>(
</span><span>    feature </span><span style=color:#ed9366>= </span><span style=color:#86b300>"bevy_render"</span><span style=color:#61676ccc>,
</span><span>    </span><span style=color:#f29718>any</span><span>(feature </span><span style=color:#ed9366>= </span><span style=color:#86b300>"bevy_pbr"</span><span style=color:#61676ccc>,</span><span> feature </span><span style=color:#ed9366>= </span><span style=color:#86b300>"bevy_sprite"</span><span>)
</span><span>))]
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After:
</span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>cfg</span><span>(</span><span style=color:#f29718>all</span><span>(
</span><span>    feature </span><span style=color:#ed9366>= </span><span style=color:#86b300>"bevy_render"</span><span style=color:#61676ccc>,
</span><span>    </span><span style=color:#f29718>any</span><span>(feature </span><span style=color:#ed9366>= </span><span style=color:#86b300>"bevy_pbr"</span><span style=color:#61676ccc>,</span><span> feature </span><span style=color:#ed9366>= </span><span style=color:#86b300>"bevy_sprite_render"</span><span>)
</span><span>))]
</span></code></pre><h3 id=crates-bevy-gizmos-src-lib-rs><code>crates/bevy_gizmos/src/lib.rs</code></h3><p>Multiple updates to feature flags and plugin detection:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before:
</span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>cfg</span><span>(feature </span><span style=color:#ed9366>= </span><span style=color:#86b300>"bevy_sprite"</span><span>)]
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After:
</span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>cfg</span><span>(feature </span><span style=color:#ed9366>= </span><span style=color:#86b300>"bevy_sprite_render"</span><span>)]
</span></code></pre><p>Updated plugin detection and warning message:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before:
</span><span style=color:#fa6e32>if</span><span> app</span><span style=color:#ed9366>.</span><span>is_plugin_added</span><span style=color:#ed9366>::</span><span>&LTbevy_sprite</span><span style=color:#ed9366>::</span><span>SpritePlugin>() {
</span><span>    </span><span style=color:#abb0b6;font-style:italic>// ...
</span><span>} </span><span style=color:#fa6e32>else </span><span>{
</span><span>    tracing</span><span style=color:#ed9366>::</span><span>warn</span><span style=color:#ed9366>!</span><span>(</span><span style=color:#86b300>"bevy_sprite feature is enabled but bevy_sprite::SpritePlugin was not detected"</span><span>)</span><span style=color:#61676ccc>;
</span><span>}
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After:
</span><span style=color:#fa6e32>if</span><span> app</span><span style=color:#ed9366>.</span><span>is_plugin_added</span><span style=color:#ed9366>::</span><span>&LTbevy_sprite_render</span><span style=color:#ed9366>::</span><span>SpriteRenderPlugin>() {
</span><span>    </span><span style=color:#abb0b6;font-style:italic>// ...
</span><span>} </span><span style=color:#fa6e32>else </span><span>{
</span><span>    tracing</span><span style=color:#ed9366>::</span><span>warn</span><span style=color:#ed9366>!</span><span>(</span><span style=color:#86b300>"bevy_sprite_render feature is enabled but bevy_sprite_render::SpriteRenderPlugin was not detected"</span><span>)</span><span style=color:#61676ccc>;
</span><span>}
</span></code></pre><h3 id=crates-bevy-internal-cargo-toml><code>crates/bevy_internal/Cargo.toml</code></h3><p>Updated feature dependencies:<pre class=language-toml data-lang=toml style=color:#61676c;background-color:#fafafa><code class=language-toml data-lang=toml><span style=color:#f51818>// Before:
</span><span style=color:#399ee6>bevy_sprite </span><span>= [</span><span style=color:#86b300>"dep:bevy_sprite"</span><span style=color:#61676ccc>, </span><span style=color:#86b300>"bevy_camera"</span><span style=color:#61676ccc>, </span><span style=color:#86b300>"bevy_gizmos?/bevy_sprite"</span><span>]
</span><span>
</span><span style=color:#f51818>// After:
</span><span style=color:#399ee6>bevy_sprite </span><span>= [</span><span style=color:#86b300>"dep:bevy_sprite"</span><span style=color:#61676ccc>, </span><span style=color:#86b300>"bevy_camera"</span><span>]
</span></code></pre><h2 id=further-reading>Further Reading</h2><ul><li><a rel="noopener nofollow noreferrer" href=https://docs.rs/bevy_gizmos/latest/bevy_gizmos/ target=_blank>Bevy Gizmos Documentation</a><li><a rel="noopener nofollow noreferrer" href=https://doc.rust-lang.org/reference/conditional-compilation.html target=_blank>Conditional Compilation in Rust</a><li><a rel="noopener nofollow noreferrer" href=https://bevyengine.org/learn/architecture/render-graph/ target=_blank>Bevy’s Render Graph Architecture</a></ul></div><div data-is-md-page=true data-patch-exists=true data-patch-path=/pull_request/bevy/2025-09/pr_21018.patch id=patch-info style=display:none></div><div class=bottom-spacer></div></div></div>