<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://unknownue.github.io name=base><title>
         #20889 Move WgpuWrapper back to where it was
        
    </title><meta content="#20889 Move WgpuWrapper back to where it was" property=og:title><meta content="A personal blog built with Zola and Apollo theme" property=og:description><meta content="A personal blog built with Zola and Apollo theme" name=description><link href=/icons/favicon.png rel=icon type=image/png><link href=https://unknownue.github.io/fonts.css rel=stylesheet><script src=https://unknownue.github.io/js/codeblock.js></script><script src=https://unknownue.github.io/js/toc.js></script><script src=https://unknownue.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Unknownue's Blog" href=https://unknownue.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://unknownue.github.io/theme/light.css rel=stylesheet><link href=https://unknownue.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://unknownue.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://unknownue.github.io/main.css media=screen rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js></script><script>// Initialize mermaid once DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            mermaid.initialize({
                startOnLoad: false,
                theme: document.body && document.body.classList.contains('dark') ? 'dark' : 'default',
                securityLevel: 'loose',
                flowchart: {
                    useMaxWidth: true,
                    htmlLabels: true
                },
                sequence: {
                    diagramMarginX: 50,
                    diagramMarginY: 10,
                    actorMargin: 50,
                    width: 150,
                    height: 65
                }
            });
        });</script><script src=https://unknownue.github.io/js/main.js></script><script defer src=https://unknownue.github.io/js/label-colors.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/rust.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/typescript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/go.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/cpp.min.js></script><script>// Ensure highlight.js is properly configured
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof hljs !== 'undefined') {
                hljs.configure({
                    languages: ['rust', 'javascript', 'python', 'cpp', 'go', 'typescript'],
                    ignoreUnescapedHTML: true
                });
                console.log('Highlight.js configured in header');
            }
        });</script><link href=https://cdn.jsdelivr.net/npm/diff2html/bundles/css/diff2html.min.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/diff2html/bundles/js/diff2html-ui.min.js></script><script src=https://unknownue.github.io/js/syntax-highlight.js></script><script src=https://unknownue.github.io/js/diff-sidebar.js></script><script src="https://unknownue.github.io/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><div class=content><header><div class=main><a href=https://unknownue.github.io>Unknownue's Blog</a><div class=socials><a class=social href=https://github.com/unknownue rel=me> <img alt=github src=https://unknownue.github.io/icons/social/github.svg> </a><a class=social href=https://github.com/unknownue/unknownue.github.io rel=me> <img alt=github-io src=https://unknownue.github.io/icons/social/rss.svg> </a></div></div><nav><a href=https://unknownue.github.io/posts style=margin-left:.25em>/posts</a><a href=https://unknownue.github.io/projects style=margin-left:.25em>/projects</a><a href=https://unknownue.github.io/about style=margin-left:.25em>/about</a><a href=https://unknownue.github.io/tags style=margin-left:.25em>/tags</a><button title="$SHORTCUT to open search" class=search-button id=search-button><img alt=Search class=search-icon src=https://unknownue.github.io/icons/search.svg></button><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><div id=modal-content><h1 class=page-header id=modalTitle>Search</h1><div id=searchBar><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search... role=combobox spellcheck=false><button title="Clear search" class=clear-button id=clear-search><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></button></div><div id=results-container><div id=results-info><span id=zero_results style=display:none>No results</span><span id=one_result style=display:none>1 result</span><span id=many_results style=display:none>$NUMBER results</span></div><div id=results role=listbox></div></div></div></div><a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://unknownue.github.io/icons/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://unknownue.github.io/icons/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><div class=pull-request-page><article class=md-content-page style=display:none></article><div class=back-link><a href=/pull_request/bevy/2025-09/>← Back to Pull Requests</a></div><div class=pr-metadata><span class=pr-date>2025-09-05</span><div class=language-switcher><span class="lang-link active" data-lang=en>English</span> / <a class=lang-link data-lang=zh-cn href=/pull_request/bevy/2025-09/pr-20889-zh-cn-20250905>中文</a></div></div><div class=pr-content><h1 id=move-wgpuwrapper-back-to-where-it-was>Move WgpuWrapper back to where it was</h1><h2 id=basic-information>Basic Information</h2><ul><li><strong>Title</strong>: Move WgpuWrapper back to where it was<li><strong>PR Link</strong>: https://github.com/bevyengine/bevy/pull/20889<li><strong>Author</strong>: atlv24<li><strong>Status</strong>: MERGED<li><strong>Labels</strong>: A-Rendering, S-Ready-For-Final-Review<li><strong>Created</strong>: 2025-09-05T16:17:21Z<li><strong>Merged</strong>: 2025-09-05T20:35:27Z<li><strong>Merged By</strong>: mockersf</ul><h2 id=description-translation>Description Translation</h2><h1 id=objective>Objective</h1><ul><li>Fixes #20861</ul><h2 id=solution>Solution</h2><ul><li>When i moved wgpu wrapper back to bevy_render, i didn’t notice it was actually somewhere else originally. Lets keep it there to avoid a breaking change. Sorry again for juggling around this thing between different places lmao</ul><h2 id=testing>Testing</h2><ul><li>ci</ul><h2 id=the-story-of-this-pull-request>The Story of This Pull Request</h2><p>This PR addresses a straightforward but important issue: maintaining backward compatibility in the Bevy renderer’s module structure. The problem originated when the <code>WgpuWrapper</code> type was moved from its original location in <code>bevy_render/src/renderer/</code> to the root <code>bevy_render/src/</code> directory. While this might seem like a minor organizational change, it actually constituted a breaking change for any external code that imported <code>WgpuWrapper</code> from its original path.<p>The developer realized this mistake after the fact and created this PR to revert the change. The core issue was that moving the type broke existing imports in downstream code, which is a significant concern for a game engine like Bevy that needs to maintain stable APIs for its users.<p>The solution approach was simple but effective: move <code>WgpuWrapper</code> back to its original location in the renderer module and update all the import statements throughout the codebase to reference the correct path. This involved:<ol><li>Moving the <code>wgpu_wrapper.rs</code> file from <code>crates/bevy_render/src/</code> to <code>crates/bevy_render/src/renderer/</code><li>Updating the module declaration in <code>lib.rs</code> to reflect the new location<li>Fixing import statements across 14 different files that referenced <code>WgpuWrapper</code></ol><p>The implementation shows a consistent pattern across all modified files. Import statements that previously referenced <code>crate::WgpuWrapper</code> were updated to use <code>crate::renderer::WgpuWrapper</code>. For example:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before:
</span><span style=color:#fa6e32>use crate</span><span style=color:#ed9366>::</span><span>WgpuWrapper</span><span style=color:#61676ccc>;
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After:
</span><span style=color:#fa6e32>use crate</span><span style=color:#ed9366>::</span><span>renderer</span><span style=color:#ed9366>::</span><span>WgpuWrapper</span><span style=color:#61676ccc>;
</span></code></pre><p>Similarly, in module files where <code>WgpuWrapper</code> was re-exported, the export path was updated:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// In crates/bevy_render/src/renderer/mod.rs
</span><span style=color:#abb0b6;font-style:italic>// Added:
</span><span style=color:#fa6e32>pub use </span><span>wgpu_wrapper</span><span style=color:#ed9366>::</span><span>WgpuWrapper</span><span style=color:#61676ccc>;
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// Removed from crates/bevy_render/src/lib.rs:
</span><span style=color:#fa6e32>pub use </span><span>wgpu_wrapper</span><span style=color:#ed9366>::</span><span>WgpuWrapper</span><span style=color:#61676ccc>;
</span></code></pre><p>The technical insight here is about maintaining API stability in a large codebase. Even seemingly innocuous file moves can have significant downstream effects when types are publicly exported. The Bevy team correctly prioritizes backward compatibility, recognizing that breaking changes should be intentional and well-communicated, not accidental.<p>The impact of this change is purely structural - no functionality was modified. However, it prevents breaking existing code that depends on the original import path for <code>WgpuWrapper</code>. This demonstrates good software engineering practices around API stability and version management.<h2 id=visual-representation>Visual Representation</h2><pre class=language-mermaid data-lang=mermaid style=color:#61676c;background-color:#fafafa><code class=language-mermaid data-lang=mermaid><span>graph LR
</span><span>    A[bevy_render/src/lib.rs] --> B[bevy_render/src/renderer/mod.rs]
</span><span>    B --> C[bevy_render/src/renderer/wgpu_wrapper.rs]
</span><span>    C --> D[Multiple Importing Files]
</span><span>    
</span><span>    style A fill:#e6f3ff
</span><span>    style B fill:#e6f3ff
</span><span>    style C fill:#e6f3ff
</span></code></pre><h2 id=key-files-changed>Key Files Changed</h2><p>The most significant files changed in this PR:<p><strong>1. <code>crates/bevy_render/src/lib.rs</code> (+0/-2)</strong><ul><li>Removed the module declaration and re-export for <code>wgpu_wrapper</code><li>This file no longer directly exposes <code>WgpuWrapper</code> from the root</ul><p><strong>2. <code>crates/bevy_render/src/renderer/mod.rs</code> (+2/-1)</strong><ul><li>Added module declaration for <code>wgpu_wrapper</code><li>Added re-export of <code>WgpuWrapper</code> from the renderer module<li>Updated the import structure to maintain internal consistency</ul><p><strong>3. <code>crates/bevy_render/src/renderer/wgpu_wrapper.rs</code> (moved)</strong><ul><li>File physically moved from <code>crates/bevy_render/src/wgpu_wrapper.rs</code><li>No content changes, just location change</ul><p><strong>4. Multiple import files (14 files total)</strong><ul><li>Updated import statements to use the correct path<li>Consistent pattern of changing <code>use crate::WgpuWrapper</code> to <code>use crate::renderer::WgpuWrapper</code></ul><p>Example of import changes:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// File: crates/bevy_render/src/render_resource/bind_group.rs
</span><span style=color:#abb0b6;font-style:italic>// Before:
</span><span style=color:#fa6e32>use crate</span><span style=color:#ed9366>::</span><span>WgpuWrapper</span><span style=color:#61676ccc>;
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After:
</span><span style=color:#fa6e32>use crate</span><span style=color:#ed9366>::</span><span>renderer</span><span style=color:#ed9366>::</span><span>{RenderDevice</span><span style=color:#61676ccc>,</span><span> WgpuWrapper}</span><span style=color:#61676ccc>;
</span></code></pre><h2 id=further-reading>Further Reading</h2><ul><li><a rel="noopener nofollow noreferrer" href=https://doc.rust-lang.org/book/ch07-02-defining-modules-to-control-scope-and-privacy.html target=_blank>Rust Module System</a><li><a rel="noopener nofollow noreferrer" href=https://semver.org/ target=_blank>Semantic Versioning and Breaking Changes</a><li><a rel="noopener nofollow noreferrer" href=https://bevyengine.org/learn/architecture/ target=_blank>Bevy Engine Architecture</a><li><a rel="noopener nofollow noreferrer" href=https://docs.rs/wgpu/latest/wgpu/ target=_blank>wgpu Documentation</a> (the underlying graphics API that WgpuWrapper abstracts)</ul></div><div data-is-md-page=true data-patch-exists=true data-patch-path=/pull_request/bevy/2025-09/pr_20889.patch id=patch-info style=display:none></div><div class=bottom-spacer></div></div></div>