<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://unknownue.github.io name=base><title>
         #21262 Rename "raw" in entity methods into "row"
        
    </title><meta content='#21262 Rename "raw" in entity methods into "row"' property=og:title><meta content="A personal blog built with Zola and Apollo theme" property=og:description><meta content="A personal blog built with Zola and Apollo theme" name=description><link href=/icons/favicon.png rel=icon type=image/png><link href=https://unknownue.github.io/fonts.css rel=stylesheet><script src=https://unknownue.github.io/js/codeblock.js></script><script src=https://unknownue.github.io/js/toc.js></script><script src=https://unknownue.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Unknownue's Blog" href=https://unknownue.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://unknownue.github.io/theme/light.css rel=stylesheet><link href=https://unknownue.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://unknownue.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://unknownue.github.io/main.css media=screen rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js></script><script>// Initialize mermaid once DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            mermaid.initialize({
                startOnLoad: false,
                theme: document.body && document.body.classList.contains('dark') ? 'dark' : 'default',
                securityLevel: 'loose',
                flowchart: {
                    useMaxWidth: true,
                    htmlLabels: true
                },
                sequence: {
                    diagramMarginX: 50,
                    diagramMarginY: 10,
                    actorMargin: 50,
                    width: 150,
                    height: 65
                }
            });
        });</script><script src=https://unknownue.github.io/js/main.js></script><script defer src=https://unknownue.github.io/js/label-colors.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/rust.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/typescript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/go.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/cpp.min.js></script><script>// Ensure highlight.js is properly configured
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof hljs !== 'undefined') {
                hljs.configure({
                    languages: ['rust', 'javascript', 'python', 'cpp', 'go', 'typescript'],
                    ignoreUnescapedHTML: true
                });
                console.log('Highlight.js configured in header');
            }
        });</script><link href=https://cdn.jsdelivr.net/npm/diff2html/bundles/css/diff2html.min.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/diff2html/bundles/js/diff2html-ui.min.js></script><script src=https://unknownue.github.io/js/syntax-highlight.js></script><script src=https://unknownue.github.io/js/diff-sidebar.js></script><script src="https://unknownue.github.io/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><div class=content><header><div class=main><a href=https://unknownue.github.io>Unknownue's Blog</a><div class=socials><a class=social href=https://github.com/unknownue rel=me> <img alt=github src=https://unknownue.github.io/icons/social/github.svg> </a><a class=social href=https://github.com/unknownue/unknownue.github.io rel=me> <img alt=github-io src=https://unknownue.github.io/icons/social/rss.svg> </a></div></div><nav><a href=https://unknownue.github.io/posts style=margin-left:.25em>/posts</a><a href=https://unknownue.github.io/projects style=margin-left:.25em>/projects</a><a href=https://unknownue.github.io/about style=margin-left:.25em>/about</a><a href=https://unknownue.github.io/tags style=margin-left:.25em>/tags</a><button title="$SHORTCUT to open search" class=search-button id=search-button><img alt=Search class=search-icon src=https://unknownue.github.io/icons/search.svg></button><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><div id=modal-content><h1 class=page-header id=modalTitle>Search</h1><div id=searchBar><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search... role=combobox spellcheck=false><button title="Clear search" class=clear-button id=clear-search><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></button></div><div id=results-container><div id=results-info><span id=zero_results style=display:none>No results</span><span id=one_result style=display:none>1 result</span><span id=many_results style=display:none>$NUMBER results</span></div><div id=results role=listbox></div></div></div></div><a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://unknownue.github.io/icons/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://unknownue.github.io/icons/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><div class=pull-request-page><article class=md-content-page style=display:none></article><div class=back-link><a href=/pull_request/bevy/2025-09/>← Back to Pull Requests</a></div><div class=pr-metadata><span class=pr-date>2025-09-28</span><div class=language-switcher><a class=lang-link data-lang=en href=/pull_request/bevy/2025-09/pr-21262-en-20250928>English</a> / <span class="lang-link active" data-lang=zh-cn>中文</span></div></div><div class=pr-content><h1 id=title>Title</h1><p>Rename “raw” in entity methods into “row”<h2 id=basic-information>Basic Information</h2><ul><li><strong>Title</strong>: Rename “raw” in entity methods into “row”<li><strong>PR Link</strong>: https://github.com/bevyengine/bevy/pull/21262<li><strong>Author</strong>: Shatur<li><strong>Status</strong>: MERGED<li><strong>Labels</strong>: D-Trivial, A-ECS, C-Usability, S-Ready-For-Final-Review<li><strong>Created</strong>: 2025-09-28T20:40:57Z<li><strong>Merged</strong>: 2025-09-28T21:23:15Z<li><strong>Merged By</strong>: alice-i-cecile</ul><h2 id=description-translation>Description Translation</h2><h1 id=objective>Objective</h1><p>我认为“raw“是从旧的Entity方法中遗留下来的，当时接受的是原始u32值。既然我们现在传递的是_row_，我认为值得重命名。<h2 id=solution>Solution</h2><ul><li>在2个方法中调整了一个字母 😅<li>与此同时，调整了关于generation的注释，因为自从#19121之后它可以是零。</ul><h2 id=the-story-of-this-pull-request>The Story of This Pull Request</h2><p>这个PR的故事始于对Bevy ECS中Entity API命名一致性的关注。开发者Shatur注意到在Entity相关的代码中，“raw“这个术语不再准确反映当前的数据结构设计。<p>在早期的Bevy版本中，Entity的构造方法确实接受原始u32值。但随着代码库的演进，Entity现在使用EntityRow类型来包装索引值，这使得“raw“这个命名变得有些误导性。EntityRow类型提供了更强的类型安全性，确保索引值不会溢出，这是通过NonMaxU32类型实现的。<p>这个PR的核心改动很小但很精确：将<code>from_raw_and_generation</code>重命名为<code>from_row_and_generation</code>，将<code>from_raw</code>重命名为<code>from_row</code>。这种命名变更更好地反映了方法实际接受的参数类型 - EntityRow而不是原始u32值。<p>在修改过程中，作者还发现了一个相关的文档问题。关于generation的注释提到它不能为零，但实际上自从PR #19121之后，generation可以是零。这是一个重要的技术细节更新，因为generation为零现在是一个有效的状态。<p>从工程角度看，这个PR展示了良好的API设计原则：命名应该准确反映功能和参数类型。虽然改动很小，但它提高了代码的可读性和自文档化程度。当其他开发者看到<code>from_row_and_generation</code>时，能更清楚地理解这个方法需要什么参数。<p>修改影响了Entity构造的多个方面：<ul><li>核心构造方法的重命名<li>相关文档的更新<li>测试用例中方法调用的更新<li>其他模块中对Entity构造的调用</ul><p>这种一致性的改进使得代码库更加整洁，减少了新开发者的认知负担。他们不再需要疑惑为什么方法名为“raw“却接受EntityRow参数。<h2 id=visual-representation>Visual Representation</h2><pre class=language-mermaid data-lang=mermaid style=color:#61676c;background-color:#fafafa><code class=language-mermaid data-lang=mermaid><span>graph LR
</span><span>    A[Entity Construction] --> B[from_row_and_generation]
</span><span>    A --> C[from_row]
</span><span>    B --> D[EntityRow + Generation]
</span><span>    C --> E[EntityRow only]
</span><span>    D --> F[Final Entity]
</span><span>    E --> F
</span></code></pre><h2 id=key-files-changed>Key Files Changed</h2><h3 id=crates-bevy-ecs-src-entity-mod-rs-55-55><code>crates/bevy_ecs/src/entity/mod.rs</code> (+55/-55)</h3><p>这是主要的修改文件，包含了Entity类型定义和相关的构造方法。<p><strong>关键修改：</strong><pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before:
</span><span style=color:#fa6e32>pub const fn </span><span style=color:#f29718>from_raw_and_generation</span><span>(</span><span style=color:#ff8f40>row</span><span style=color:#61676ccc>:</span><span> EntityRow, </span><span style=color:#ff8f40>generation</span><span style=color:#61676ccc>:</span><span> EntityGeneration) </span><span style=color:#61676ccc>-></span><span> Entity {
</span><span>    </span><span style=color:#fa6e32>Self </span><span>{ row</span><span style=color:#61676ccc>,</span><span> generation }
</span><span>}
</span><span>
</span><span style=color:#fa6e32>pub const fn </span><span style=color:#f29718>from_raw</span><span>(</span><span style=color:#ff8f40>row</span><span style=color:#61676ccc>:</span><span> EntityRow) </span><span style=color:#61676ccc>-></span><span> Entity {
</span><span>    </span><span style=color:#fa6e32>Self</span><span style=color:#ed9366>::</span><span>from_raw_and_generation(row</span><span style=color:#61676ccc>, </span><span>EntityGeneration</span><span style=color:#ed9366>::</span><span style=color:#ff8f40>FIRST</span><span>)
</span><span>}
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After:
</span><span style=color:#fa6e32>pub const fn </span><span style=color:#f29718>from_row_and_generation</span><span>(</span><span style=color:#ff8f40>row</span><span style=color:#61676ccc>:</span><span> EntityRow, </span><span style=color:#ff8f40>generation</span><span style=color:#61676ccc>:</span><span> EntityGeneration) </span><span style=color:#61676ccc>-></span><span> Entity {
</span><span>    </span><span style=color:#fa6e32>Self </span><span>{ row</span><span style=color:#61676ccc>,</span><span> generation }
</span><span>}
</span><span>
</span><span style=color:#fa6e32>pub const fn </span><span style=color:#f29718>from_row</span><span>(</span><span style=color:#ff8f40>row</span><span style=color:#61676ccc>:</span><span> EntityRow) </span><span style=color:#61676ccc>-></span><span> Entity {
</span><span>    </span><span style=color:#fa6e32>Self</span><span style=color:#ed9366>::</span><span>from_row_and_generation(row</span><span style=color:#61676ccc>, </span><span>EntityGeneration</span><span style=color:#ed9366>::</span><span style=color:#ff8f40>FIRST</span><span>)
</span><span>}
</span></code></pre><h3 id=crates-bevy-ecs-src-entity-map-entities-rs-1-1><code>crates/bevy_ecs/src/entity/map_entities.rs</code> (+1/-1)</h3><p>更新了场景实体映射器中对Entity构造方法的调用。<p><strong>关键修改：</strong><pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before:
</span><span style=color:#fa6e32>let</span><span> new </span><span style=color:#ed9366>= </span><span>Entity</span><span style=color:#ed9366>::</span><span>from_raw_and_generation(
</span><span>    </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>dead_start</span><span style=color:#ed9366>.</span><span style=color:#f07171>row</span><span>()</span><span style=color:#61676ccc>,
</span><span>    </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>dead_start</span><span style=color:#ed9366>.</span><span>generation</span><span style=color:#ed9366>.</span><span style=color:#f07171>after_versions</span><span>(</span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>generations)</span><span style=color:#61676ccc>,
</span><span>)</span><span style=color:#61676ccc>;
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After:
</span><span style=color:#fa6e32>let</span><span> new </span><span style=color:#ed9366>= </span><span>Entity</span><span style=color:#ed9366>::</span><span>from_row_and_generation(
</span><span>    </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>dead_start</span><span style=color:#ed9366>.</span><span style=color:#f07171>row</span><span>()</span><span style=color:#61676ccc>,
</span><span>    </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>dead_start</span><span style=color:#ed9366>.</span><span>generation</span><span style=color:#ed9366>.</span><span style=color:#f07171>after_versions</span><span>(</span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>generations)</span><span style=color:#61676ccc>,
</span><span>)</span><span style=color:#61676ccc>;
</span></code></pre><h3 id=crates-bevy-ecs-src-storage-sparse-set-rs-5-5><code>crates/bevy_ecs/src/storage/sparse_set.rs</code> (+5/-5)</h3><p>更新了稀疏集合测试中对Entity构造方法的调用。<h3 id=crates-bevy-ecs-src-storage-table-mod-rs-1-1><code>crates/bevy_ecs/src/storage/table/mod.rs</code> (+1/-1)</h3><p>更新了表格测试中对Entity构造方法的调用。<h2 id=further-reading>Further Reading</h2><ul><li><a rel="noopener nofollow noreferrer" href=https://docs.rs/bevy_ecs/latest/bevy_ecs/entity/struct.Entity.html target=_blank>Bevy ECS Entity Documentation</a><li><a rel="noopener nofollow noreferrer" href=https://github.com/bevyengine/bevy/pull/19121 target=_blank>PR #19121 - Allow zero generation entities</a><li><a rel="noopener nofollow noreferrer" href=https://rust-lang.github.io/api-guidelines/naming.html target=_blank>Rust API Guidelines - Naming</a></ul><h1 id=full-code-diff>Full Code Diff</h1><pre class=language-diff data-lang=diff style=color:#61676c;background-color:#fafafa><code class=language-diff data-lang=diff><span>diff --git a/crates/bevy_ecs/src/entity/map_entities.rs b/crates/bevy_ecs/src/entity/map_entities.rs
</span><span>index 2c596552757f0..0ac3ed52fd676 100644
</span><span style=color:#c594c5>--- a/crates/bevy_ecs/src/entity/map_entities.rs
</span><span style=color:#c594c5>+++ b/crates/bevy_ecs/src/entity/map_entities.rs
</span><span style=color:#c594c5>@@ -276,7 +276,7 @@ </span><span style=color:#399ee6>impl EntityMapper for SceneEntityMapper<'_> {
</span><span>         }
</span><span> 
</span><span>         // this new entity reference is specifically designed to never represent any living entity
</span><span style=color:#f07171>-        let new = Entity::from_raw_and_generation(
</span><span style=color:#86b300>+        let new = Entity::from_row_and_generation(
</span><span>             self.dead_start.row(),
</span><span>             self.dead_start.generation.after_versions(self.generations),
</span><span>         );
</span><span>diff --git a/crates/bevy_ecs/src/entity/mod.rs b/crates/bevy_ecs/src/entity/mod.rs
</span><span>index 55b8ae19434ef..3e0ee0a813492 100644
</span><span style=color:#c594c5>--- a/crates/bevy_ecs/src/entity/mod.rs
</span><span style=color:#c594c5>+++ b/crates/bevy_ecs/src/entity/mod.rs
</span><span style=color:#c594c5>@@ -455,9 +455,9 @@ </span><span style=color:#399ee6>impl Hash for Entity {
</span><span> }
</span><span> 
</span><span> impl Entity {
</span><span style=color:#f07171>-    /// Constructs an [`Entity`] from a raw `row` value and a non-zero `generation` value.
</span><span style=color:#86b300>+    /// Creates a new instance with the given index and generation.
</span><span>     #[inline(always)]
</span><span style=color:#f07171>-    pub const fn from_raw_and_generation(row: EntityRow, generation: EntityGeneration) -> Entity {
</span><span style=color:#86b300>+    pub const fn from_row_and_generation(row: EntityRow, generation: EntityGeneration) -> Entity {
</span><span>         Self { row, generation }
</span><span>     }
</span><span> 
</span><span style=color:#c594c5>@@ -495,7 +495,7 @@ </span><span style=color:#399ee6>impl Entity {
</span><span>     ///     }
</span><span>     /// }
</span><span>     /// ```
</span><span style=color:#f07171>-    pub const PLACEHOLDER: Self = Self::from_raw(EntityRow::PLACEHOLDER);
</span><span style=color:#86b300>+    pub const PLACEHOLDER: Self = Self::from_row(EntityRow::PLACEHOLDER);
</span><span> 
</span><span>     /// Creates a new entity ID with the specified `row` and a generation of 1.
</span><span>     ///
</span><span style=color:#c594c5>@@ -510,17 +510,17 @@ </span><span style=color:#399ee6>impl Entity {
</span><span>     /// `Entity` lines up between instances, but instead insert a secondary identifier as
</span><span>     /// a component.
</span><span>     #[inline(always)]
</span><span style=color:#f07171>-    pub const fn from_raw(row: EntityRow) -> Entity {
</span><span style=color:#f07171>-        Self::from_raw_and_generation(row, EntityGeneration::FIRST)
</span><span style=color:#86b300>+    pub const fn from_row(row: EntityRow) -> Entity {
</span><span style=color:#86b300>+        Self::from_row_and_generation(row, EntityGeneration::FIRST)
</span><span>     }
</span><span> 
</span><span style=color:#f07171>-    /// This is equivalent to [`from_raw`](Self::from_raw) except that it takes a `u32` instead of an [`EntityRow`].
</span><span style=color:#86b300>+    /// This is equivalent to [`from_row`](Self::from_row) except that it takes a `u32` instead of an [`EntityRow`].
</span><span>     ///
</span><span>     /// Returns `None` if the row is `u32::MAX`.
</span><span>     #[inline(always)]
</span><span>     pub const fn from_raw_u32(row: u32) -> Option&LTEntity> {
</span><span>         match NonMaxU32::new(row) {
</span><span style=color:#f07171>-            Some(row) => Some(Self::from_raw(EntityRow::new(row))),
</span><span style=color:#86b300>+            Some(row) => Some(Self::from_row(EntityRow::new(row))),
</span><span>             None => None,
</span><span>         }
</span><span>     }
</span><span style=color:#c594c5>@@ -657,7 +657,7 @@ </span><span style=color:#399ee6>impl SparseSetIndex for Entity {
</span><span> 
</span><span>     #[inline]
</span><span>     fn get_sparse_set_index(value: usize) -> Self {
</span><span style=color:#f07171>-        Entity::from_raw(EntityRow::get_sparse_set_index(value))
</span><span style=color:#86b300>+        Entity::from_row(EntityRow::get_sparse_set_index(value))
</span><span>     }
</span><span> }
</span><span> 
</span><span style=color:#c594c5>@@ -680,13 +680,13 @@ </span><span style=color:#399ee6>impl<'a> Iterator for ReserveEntitiesIterator<'a> {
</span><span>         self.freelist_indices
</span><span>             .next()
</span><span>             .map(|&row| {
</span><span style=color:#f07171>-                Entity::from_raw_and_generation(row, self.meta[row.index() as usize].generation)
</span><span style=color:#86b300>+                Entity::from_row_and_generation(row, self.meta[row.index() as usize].generation)
</span><span>             })
</span><span>             .or_else(|| {
</span><span>                 self.new_indices.next().map(|index| {
</span><span>                     // SAFETY: This came from an exclusive range so the max can't be hit.
</span><span>                     let row = unsafe { EntityRow::new(NonMaxU32::new_unchecked(index)) };
</span><span style=color:#f07171>-                    Entity::from_raw(row)
</span><span style=color:#86b300>+                    Entity::from_row(row)
</span><span>                 })
</span><span>             })
</span><span>     }
</span><span style=color:#c594c5>@@ -833,7 +833,7 @@ </span><span style=color:#399ee6>impl Entities {
</span><span>         if n > 0 {
</span><span>             // Allocate from the freelist.
</span><span>             let row = self.pending[(n - 1) as usize];
</span><span style=color:#f07171>-            Entity::from_raw_and_generation(row, self.meta[row.index() as usize].generation)
</span><span style=color:#86b300>+            Entity::from_row_and_generation(row, self.meta[row.index() as usize].generation)
</span><span>         } else {
</span><span>             // Grab a new ID, outside the range of `meta.len()`. `flush()` must
</span><span>             // eventually be called to make it valid.
</span><span style=color:#c594c5>@@ -846,7 +846,7 @@ </span><span style=color:#399ee6>impl Entities {
</span><span>             }
</span><span>             // SAFETY: We just checked the bounds
</span><span>             let row = unsafe { EntityRow::new(NonMaxU32::new_unchecked(raw as u32)) };
</span><span style=color:#f07171>-            Entity::from_raw(row)
</span><span style=color:#86b300>+            Entity::from_row(row)
</span><span>         }
</span><span>     }
</span><span> 
</span><span style=color:#c594c5>@@ -864,14 +864,14 @@ </span><span style=color:#399ee6>impl Entities {
</span><span>         if let Some(row) = self.pending.pop() {
</span><span>             let new_free_cursor = self.pending.len() as IdCursor;
</span><span>             *self.free_cursor.get_mut() = new_free_cursor;
</span><span style=color:#f07171>-            Entity::from_raw_and_generation(row, self.meta[row.index() as usize].generation)
</span><span style=color:#86b300>+            Entity::from_row_and_generation(row, self.meta[row.index() as usize].generation)
</span><span>         } else {
</span><span>             let index = u32::try_from(self.meta.len())
</span><span>                 .ok()
</span><span>                 .and_then(NonMaxU32::new)
</span><span>                 .expect("too many entities");
</span><span>             self.meta.push(EntityMeta::EMPTY);
</span><span style=color:#f07171>-            Entity::from_raw(EntityRow::new(index))
</span><span style=color:#86b300>+            Entity::from_row(EntityRow::new(index))
</span><span>         }
</span><span>     }
</span><span> 
</span><span style=color:#c594c5>@@ -1012,14 +1012,14 @@ </span><span style=color:#399ee6>impl Entities {
</span><span>     pub fn resolve_from_id(&self, row: EntityRow) -> Option&LTEntity> {
</span><span>         let idu = row.index() as usize;
</span><span>         if let Some(&EntityMeta { generation, .. }) = self.meta.get(idu) {
</span><span style=color:#f07171>-            Some(Entity::from_raw_and_generation(row, generation))
</span><span style=color:#86b300>+            Some(Entity::from_row_and_generation(row, generation))
</span><span>         } else {
</span><span>             // `id` is outside of the meta list - check whether it is reserved but not yet flushed.
</span><span>             let free_cursor = self.free_cursor.load(Ordering::Relaxed);
</span><span>             // If this entity was manually created, then free_cursor might be positive
</span><span>             // Returning None handles that case correctly
</span><span>             let num_pending = usize::try_from(-free_cursor).ok()?;
</span><span style=color:#f07171>-            (idu < self.meta.len() + num_pending).then_some(Entity::from_raw(row))
</span><span style=color:#86b300>+            (idu < self.meta.len() + num_pending).then_some(Entity::from_row(row))
</span><span>         }
</span><span>     }
</span><span> 
</span><span style=color:#c594c5>@@ -1058,7 +1058,7 @@ </span><span style=color:#399ee6>impl Entities {
</span><span>                 // SAFETY: the index is less than the meta length, which can not exceeded u32::MAX
</span><span>                 let row = EntityRow::new(unsafe { NonMaxU32::new_unchecked(index as u32) });
</span><span>                 init(
</span><span style=color:#f07171>-                    Entity::from_raw_and_generation(row, meta.generation),
</span><span style=color:#86b300>+                    Entity::from_row_and_generation(row, meta.generation),
</span><span>                     &mut meta.location,
</span><span>                 );
</span><span>                 meta.spawned_or_despawned = SpawnedOrDespawned { by, tick };
</span><span style=color:#c594c5>@@ -1071,7 +1071,7 @@ </span><span style=color:#399ee6>impl Entities {
</span><span>         for row in self.pending.drain(new_free_cursor..) {
</span><span>             let meta = &mut self.meta[row.index() as usize];
</span><span>             init(
</span><span style=color:#f07171>-                Entity::from_raw_and_generation(row, meta.generation),
</span><span style=color:#86b300>+                Entity::from_row_and_generation(row, meta.generation),
</span><span>                 &mut meta.location,
</span><span>             );
</span><span>             meta.spawned_or_despawned = SpawnedOrDespawned { by, tick };
</span><span style=color:#c594c5>@@ -1333,7 +1333,7 @@ </span><span style=color:#399ee6>mod tests {
</span><span>         let r = EntityRow::from_raw_u32(0xDEADBEEF).unwrap();
</span><span>         assert_eq!(EntityRow::from_bits(r.to_bits()), r);
</span><span> 
</span><span style=color:#f07171>-        let e = Entity::from_raw_and_generation(
</span><span style=color:#86b300>+        let e = Entity::from_row_and_generation(
</span><span>             EntityRow::from_raw_u32(0xDEADBEEF).unwrap(),
</span><span>             EntityGeneration::from_bits(0x5AADF00D),
</span><span>         );
</span><span style=color:#c594c5>@@ -1373,7 +1373,7 @@ </span><span style=color:#399ee6>mod tests {
</span><span> 
</span><span>     #[test]
</span><span>     fn entity_const() {
</span><span style=color:#f07171>-        const C1: Entity = Entity::from_raw(EntityRow::from_raw_u32(42).unwrap());
</span><span style=color:#86b300>+        const C1: Entity = Entity::from_row(EntityRow::from_raw_u32(42).unwrap());
</span><span>         assert_eq!(42, C1.index());
</span><span>         assert_eq!(0, C1.generation().to_bits());
</span><span> 
</span><span style=color:#c594c5>@@ -1381,7 +1381,7 @@ </span><span style=color:#399ee6>mod tests {
</span><span>         assert_eq!(!0x0000_00cc, C2.index());
</span><span>         assert_eq!(0x0000_00ff, C2.generation().to_bits());
</span><span> 
</span><span style=color:#f07171>-        const C3: u32 = Entity::from_raw(EntityRow::from_raw_u32(33).unwrap()).index();
</span><span style=color:#86b300>+        const C3: u32 = Entity::from_row(EntityRow::from_raw_u32(33).unwrap()).index();
</span><span>         assert_eq!(33, C3);
</span><span> 
</span><span>         const C4: u32 = Entity::from_bits(0x00dd_00ff_1111_1111)
</span><span style=color:#c594c5>@@ -1425,41 +1425,41 @@ </span><span style=color:#399ee6>mod tests {
</span><span>     )]
</span><span>     fn entity_comparison() {
</span><span>         assert_eq!(
</span><span style=color:#f07171>-            Entity::from_raw_and_generation(
</span><span style=color:#86b300>+            Entity::from_row_and_generation(
</span><span>                 EntityRow::from_raw_u32(123).unwrap(),
</span><span>                 EntityGeneration::from_bits(456)
</span><span>             ),
</span><span style=color:#f07171>-            Entity::from_raw_and_generation(
</span><span style=color:#86b300>+            Entity::from_row_and_generation(
</span><span>                 EntityRow::from_raw_u32(123).unwrap(),
</span><span>                 EntityGeneration::from_bits(456)
</span><span>             )
</span><span>         );
</span><span>         assert_ne!(
</span><span style=color:#f07171>-            Entity::from_raw_and_generation(
</span><span style=color:#86b300>+            Entity::from_row_and_generation(
</span><span>                 EntityRow::from_raw_u32(123).unwrap(),
</span><span>                 EntityGeneration::from_bits(789)
</span><span>             ),
</span><span style=color:#f07171>-            Entity::from_raw_and_generation(
</span><span style=color:#86b300>+            Entity::from_row_and_generation(
</span><span>                 EntityRow::from_raw_u32(123).unwrap(),
</span><span>                 EntityGeneration::from_bits(456)
</span><span>             )
</span><span>         );
</span><span>         assert_ne!(
</span><span style=color:#f07171>-            Entity::from_raw_and_generation(
</span><span style=color:#86b300>+            Entity::from_row_and_generation(
</span><span>                 EntityRow::from_raw_u32(123).unwrap(),
</span><span>                 EntityGeneration::from_bits(456)
</span><span>             ),
</span><span style=color:#f07171>-            Entity::from_raw_and_generation(
</span><span style=color:#86b300>+            Entity::from_row_and_generation(
</span><span>                 EntityRow::from_raw_u32(123).unwrap(),
</span><span>                 EntityGeneration::from_bits(789)
</span><span>             )
</span><span>         );
</span><span>         assert_ne!(
</span><span style=color:#f07171>-            Entity::from_raw_and_generation(
</span><span style=color:#86b300>+            Entity::from_row_and_generation(
</span><span>                 EntityRow::from_raw_u32(123).unwrap(),
</span><span>                 EntityGeneration::from_bits(456)
</span><span>             ),
</span><span style=color:#f07171>-            Entity::from_raw_and_generation(
</span><span style=color:#86b300>+            Entity::from_row_and_generation(
</span><span>                 EntityRow::from_raw_u32(456).unwrap(),
</span><span>                 EntityGeneration::from_bits(123)
</span><span>             )
</span><span style=color:#c594c5>@@ -1468,93 +1468,93 @@ </span><span style=color:#399ee6>mod tests {
</span><span>         // ordering is by generation then by index
</span><span> 
</span><span>         assert!(
</span><span style=color:#f07171>-            Entity::from_raw_and_generation(
</span><span style=color:#86b300>+            Entity::from_row_and_generation(
</span><span>                 EntityRow::from_raw_u32(123).unwrap(),
</span><span>                 EntityGeneration::from_bits(456)
</span><span style=color:#f07171>-            ) >= Entity::from_raw_and_generation(
</span><span style=color:#86b300>+            ) >= Entity::from_row_and_generation(
</span><span>                 EntityRow::from_raw_u32(123).unwrap(),
</span><span>                 EntityGeneration::from_bits(456)
</span><span>             )
</span><span>         );
</span><span>         assert!(
</span><span style=color:#f07171>-            Entity::from_raw_and_generation(
</span><span style=color:#86b300>+            Entity::from_row_and_generation(
</span><span>                 EntityRow::from_raw_u32(123).unwrap(),
</span><span>                 EntityGeneration::from_bits(456)
</span><span style=color:#f07171>-            ) <= Entity::from_raw_and_generation(
</span><span style=color:#86b300>+            ) <= Entity::from_row_and_generation(
</span><span>                 EntityRow::from_raw_u32(123).unwrap(),
</span><span>                 EntityGeneration::from_bits(456)
</span><span>             )
</span><span>         );
</span><span>         assert!(
</span><span style=color:#f07171>-            !(Entity::from_raw_and_generation(
</span><span style=color:#86b300>+            !(Entity::from_row_and_generation(
</span><span>                 EntityRow::from_raw_u32(123).unwrap(),
</span><span>                 EntityGeneration::from_bits(456)
</span><span style=color:#f07171>-            ) < Entity::from_raw_and_generation(
</span><span style=color:#86b300>+            ) < Entity::from_row_and_generation(
</span><span>                 EntityRow::from_raw_u32(123).unwrap(),
</span><span>                 EntityGeneration::from_bits(456)
</span><span>             ))
</span><span>         );
</span><span>         assert!(
</span><span style=color:#f07171>-            !(Entity::from_raw_and_generation(
</span><span style=color:#86b300>+            !(Entity::from_row_and_generation(
</span><span>                 EntityRow::from_raw_u32(123).unwrap(),
</span><span>                 EntityGeneration::from_bits(456)
</span><span style=color:#f07171>-            ) > Entity::from_raw_and_generation(
</span><span style=color:#86b300>+            ) > Entity::from_row_and_generation(
</span><span>                 EntityRow::from_raw_u32(123).unwrap(),
</span><span>                 EntityGeneration::from_bits(456)
</span><span>             ))
</span><span>         );
</span><span> 
</span><span>         assert!(
</span><span style=color:#f07171>-            Entity::from_raw_and_generation(
</span><span style=color:#86b300>+            Entity::from_row_and_generation(
</span><span>                 EntityRow::from_raw_u32(9).unwrap(),
</span><span>                 EntityGeneration::from_bits(1)
</span><span style=color:#f07171>-            ) < Entity::from_raw_and_generation(
</span><span style=color:#86b300>+            ) < Entity::from_row_and_generation(
</span><span>                 EntityRow::from_raw_u32(1).unwrap(),
</span><span>                 EntityGeneration::from_bits(9)
</span><span>             )
</span><span>         );
</span><span>         assert!(
</span><span style=color:#f07171>-            Entity::from_raw_and_generation(
</span><span style=color:#86b300>+            Entity::from_row_and_generation(
</span><span>                 EntityRow::from_raw_u32(1).unwrap(),
</span><span>                 EntityGeneration::from_bits(9)
</span><span style=color:#f07171>-            ) > Entity::from_raw_and_generation(
</span><span style=color:#86b300>+            ) > Entity::from_row_and_generation(
</span><span>                 EntityRow::from_raw_u32(9).unwrap(),
</span><span>                 EntityGeneration::from_bits(1)
</span><span>             )
</span><span>         );
</span><span> 
</span><span>         assert!(
</span><span style=color:#f07171>-            Entity::from_raw_and_generation(
</span><span style=color:#86b300>+            Entity::from_row_and_generation(
</span><span>                 EntityRow::from_raw_u32(1).unwrap(),
</span><span>                 EntityGeneration::from_bits(1)
</span><span style=color:#f07171>-            ) > Entity::from_raw_and_generation(
</span><span style=color:#86b300>+            ) > Entity::from_row_and_generation(
</span><span>                 EntityRow::from_raw_u32(2).unwrap(),
</span><span>                 EntityGeneration::from_bits(1)
</span><span>             )
</span><span>         );
</span><span>         assert!(
</span><span style=color:#f07171>-            Entity::from_raw_and_generation(
</span><span style=color:#86b300>+            Entity::from_row_and_generation(
</span><span>                 EntityRow::from_raw_u32(1).unwrap(),
</span><span>                 EntityGeneration::from_bits(1)
</span><span style=color:#f07171>-            ) >= Entity::from_raw_and_generation(
</span><span style=color:#86b300>+            ) >= Entity::from_row_and_generation(
</span><span>                 EntityRow::from_raw_u32(2).unwrap(),
</span><span>                 EntityGeneration::from_bits(1)
</span><span>             )
</span><span>         );
</span><span>         assert!(
</span><span style=color:#f07171>-            Entity::from_raw_and_generation(
</span><span style=color:#86b300>+            Entity::from_row_and_generation(
</span><span>                 EntityRow::from_raw_u32(2).unwrap(),
</span><span>                 EntityGeneration::from_bits(2)
</span><span style=color:#f07171>-            ) < Entity::from_raw_and_generation(
</span><span style=color:#86b300>+            ) < Entity::from_row_and_generation(
</span><span>                 EntityRow::from_raw_u32(1).unwrap(),
</span><span>                 EntityGeneration::from_bits(2)
</span><span>             )
</span><span>         );
</span><span>         assert!(
</span><span style=color:#f07171>-            Entity::from_raw_and_generation(
</span><span style=color:#86b300>+            Entity::from_row_and_generation(
</span><span>                 EntityRow::from_raw_u32(2).unwrap(),
</span><span>                 EntityGeneration::from_bits(2)
</span><span style=color:#f07171>-            ) <= Entity::from_raw_and_generation(
</span><span style=color:#86b300>+            ) <= Entity::from_row_and_generation(
</span><span>                 EntityRow::from_raw_u32(1).unwrap(),
</span><span>                 EntityGeneration::from_bits(2)
</span><span>             )
</span><span style=color:#c594c5>@@ -1570,11 +1570,11 @@ </span><span style=color:#399ee6>mod tests {
</span><span> 
</span><span>         let first_id = 0xC0FFEE << 8;
</span><span>         let first_hash =
</span><span style=color:#f07171>-            hash.hash_one(Entity::from_raw(EntityRow::from_raw_u32(first_id).unwrap()));
</span><span style=color:#86b300>+            hash.hash_one(Entity::from_row(EntityRow::from_raw_u32(first_id).unwrap()));
</span><span> 
</span><span>         for i in 1..=255 {
</span><span>             let id = first_id + i;
</span><span style=color:#f07171>-            let hash = hash.hash_one(Entity::from_raw(EntityRow::from_raw_u32(id).unwrap()));
</span><span style=color:#86b300>+            let hash = hash.hash_one(Entity::from_row(EntityRow::from_raw_u32(id).unwrap()));
</span><span>             assert_eq!(first_hash.wrapping_sub(hash) as u32, i);
</span><span>         }
</span><span>     }
</span><span style=color:#c594c5>@@ -1587,11 +1587,11 @@ </span><span style=color:#399ee6>mod tests {
</span><span> 
</span><span>         let first_id = 0xC0FFEE;
</span><span>         let first_hash =
</span><span style=color:#f07171>-            hash.hash_one(Entity::from_raw(EntityRow::from_raw_u32(first_id).unwrap())) >> 57;
</span><span style=color:#86b300>+            hash.hash_one(Entity::from_row(EntityRow::from_raw_u32(first_id).unwrap())) >> 57;
</span><span> 
</span><span>         for bit in 0..u32::BITS {
</span><span>             let id = first_id ^ (1 << bit);
</span><span style=color:#f07171>-            let hash = hash.hash_one(Entity::from_raw(EntityRow::from_raw_u32(id).unwrap())) >> 57;
</span><span style=color:#86b300>+            let hash = hash.hash_one(Entity::from_row(EntityRow::from_raw_u32(id).unwrap())) >> 57;
</span><span>             assert_ne!(hash, first_hash);
</span><span>         }
</span><span>     }
</span><span style=color:#c594c5>@@ -1616,7 +1616,7 @@ </span><span style=color:#399ee6>mod tests {
</span><span> 
</span><span>     #[test]
</span><span>     fn entity_debug() {
</span><span style=color:#f07171>-        let entity = Entity::from_raw(EntityRow::from_raw_u32(42).unwrap());
</span><span style=color:#86b300>+        let entity = Entity::from_row(EntityRow::from_raw_u32(42).unwrap());
</span><span>         let string = format!("{entity:?}");
</span><span>         assert_eq!(string, "42v0");
</span><span> 
</span><span style=color:#c594c5>@@ -1627,7 +1627,7 @@ </span><span style=color:#399ee6>mod tests {
</span><span> 
</span><span>     #[test]
</span><span>     fn entity_display() {
</span><span style=color:#f07171>-        let entity = Entity::from_raw(EntityRow::from_raw_u32(42).unwrap());
</span><span style=color:#86b300>+        let entity = Entity::from_row(EntityRow::from_raw_u32(42).unwrap());
</span><span>         let string = format!("{entity}");
</span><span>         assert_eq!(string, "42v0");
</span><span> 
</span><span>diff --git a/crates/bevy_ecs/src/storage/sparse_set.rs b/crates/bevy_ecs/src/storage/sparse_set.rs
</span><span>index ffc2aff0d6248..cda28c1597a01 100644
</span><span style=color:#c594c5>--- a/crates/bevy_ecs/src/storage/sparse_set.rs
</span><span style=color:#c594c5>+++ b/crates/bevy_ecs/src/storage/sparse_set.rs
</span><span style=color:#c594c5>@@ -673,11 +673,11 @@ </span><span style=color:#399ee6>mod tests {
</span><span>     #[test]
</span><span>     fn sparse_set() {
</span><span>         let mut set = SparseSet::&LTEntity, Foo>::default();
</span><span style=color:#f07171>-        let e0 = Entity::from_raw(EntityRow::from_raw_u32(0).unwrap());
</span><span style=color:#f07171>-        let e1 = Entity::from_raw(EntityRow::from_raw_u32(1).unwrap());
</span><span style=color:#f07171>-        let e2 = Entity::from_raw(EntityRow::from_raw_u32(2).unwrap());
</span><span style=color:#f07171>-        let e3 = Entity::from_raw(EntityRow::from_raw_u32(3).unwrap());
</span><span style=color:#f07171>-        let e4 = Entity::from_raw(EntityRow::from_raw_u32(4).unwrap());
</span><span style=color:#86b300>+        let e0 = Entity::from_row(EntityRow::from_raw_u32(0).unwrap());
</span><span style=color:#86b300>+        let e1 = Entity::from_row(EntityRow::from_raw_u32(1).unwrap());
</span><span style=color:#86b300>+        let e2 = Entity::from_row(EntityRow::from_raw_u32(2).unwrap());
</span><span style=color:#86b300>+        let e3 = Entity::from_row(EntityRow::from_raw_u32(3).unwrap());
</span><span style=color:#86b300>+        let e4 = Entity::from_row(EntityRow::from_raw_u32(4).unwrap());
</span><span> 
</span><span>         set.insert(e1, Foo(1));
</span><span>         set.insert(e2, Foo(2));
</span><span>diff --git a/crates/bevy_ecs/src/storage/table/mod.rs b/crates/bevy_ecs/src/storage/table/mod.rs
</span><span>index 5698481060b1b..90c1027233232 100644
</span><span style=color:#c594c5>--- a/crates/bevy_ecs/src/storage/table/mod.rs
</span><span style=color:#c594c5>+++ b/crates/bevy_ecs/src/storage/table/mod.rs
</span><span style=color:#c594c5>@@ -888,7 +888,7 @@ </span><span style=color:#399ee6>mod tests {
</span><span>             .add_column(components.get_info(component_id).unwrap())
</span><span>             .build();
</span><span>         let entities = (0..200)
</span><span style=color:#f07171>-            .map(|index| Entity::from_raw(EntityRow::from_raw_u32(index).unwrap()))
</span><span style=color:#86b300>+            .map(|index| Entity::from_row(EntityRow::from_raw_u32(index).unwrap()))
</span><span>             .collect::&LTVec<_>>();
</span><span>         for entity in &entities {
</span><span>             // SAFETY: we allocate and immediately set data afterwards
</span></code></pre></div><div data-is-md-page=true data-patch-exists=true data-patch-path=/pull_request/bevy/2025-09/pr_21262.patch id=patch-info style=display:none></div><div class=bottom-spacer></div></div></div>