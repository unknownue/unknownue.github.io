<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://unknownue.github.io name=base><title>
         #21721 Make building asset sources infallible.
        
    </title><meta content="#21721 Make building asset sources infallible." property=og:title><meta content="A personal blog built with Zola and Apollo theme" property=og:description><meta content="A personal blog built with Zola and Apollo theme" name=description><link href=/icons/favicon.png rel=icon type=image/png><link href=https://unknownue.github.io/fonts.css rel=stylesheet><script src=https://unknownue.github.io/js/codeblock.js></script><script src=https://unknownue.github.io/js/toc.js></script><script src=https://unknownue.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Unknownue's Blog" href=https://unknownue.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://unknownue.github.io/theme/light.css rel=stylesheet><link href=https://unknownue.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://unknownue.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://unknownue.github.io/main.css media=screen rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js></script><script>// Initialize mermaid once DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            mermaid.initialize({
                startOnLoad: false,
                theme: document.body && document.body.classList.contains('dark') ? 'dark' : 'default',
                securityLevel: 'loose',
                flowchart: {
                    useMaxWidth: true,
                    htmlLabels: true
                },
                sequence: {
                    diagramMarginX: 50,
                    diagramMarginY: 10,
                    actorMargin: 50,
                    width: 150,
                    height: 65
                }
            });
        });</script><script src=https://unknownue.github.io/js/main.js></script><script defer src=https://unknownue.github.io/js/label-colors.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/rust.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/typescript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/go.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/cpp.min.js></script><script>// Ensure highlight.js is properly configured
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof hljs !== 'undefined') {
                hljs.configure({
                    languages: ['rust', 'javascript', 'python', 'cpp', 'go', 'typescript'],
                    ignoreUnescapedHTML: true
                });
                console.log('Highlight.js configured in header');
            }
        });</script><link href=https://cdn.jsdelivr.net/npm/diff2html/bundles/css/diff2html.min.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/diff2html/bundles/js/diff2html-ui.min.js></script><script src=https://unknownue.github.io/js/syntax-highlight.js></script><script src=https://unknownue.github.io/js/diff-sidebar.js></script><script src="https://unknownue.github.io/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><div class=content><header><div class=main><a href=https://unknownue.github.io>Unknownue's Blog</a><div class=socials><a class=social href=https://github.com/unknownue rel=me> <img alt=github src=https://unknownue.github.io/icons/social/github.svg> </a><a class=social href=https://github.com/unknownue/unknownue.github.io rel=me> <img alt=github-io src=https://unknownue.github.io/icons/social/rss.svg> </a></div></div><nav><a href=https://unknownue.github.io/posts style=margin-left:.25em>/posts</a><a href=https://unknownue.github.io/projects style=margin-left:.25em>/projects</a><a href=https://unknownue.github.io/about style=margin-left:.25em>/about</a><a href=https://unknownue.github.io/tags style=margin-left:.25em>/tags</a><button title="$SHORTCUT to open search" class=search-button id=search-button><img alt=Search class=search-icon src=https://unknownue.github.io/icons/search.svg></button><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><div id=modal-content><h1 class=page-header id=modalTitle>Search</h1><div id=searchBar><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search... role=combobox spellcheck=false><button title="Clear search" class=clear-button id=clear-search><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></button></div><div id=results-container><div id=results-info><span id=zero_results style=display:none>No results</span><span id=one_result style=display:none>1 result</span><span id=many_results style=display:none>$NUMBER results</span></div><div id=results role=listbox></div></div></div></div><a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://unknownue.github.io/icons/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://unknownue.github.io/icons/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><div class=pull-request-page><article class=md-content-page style=display:none></article><div class=back-link><a href=/pull_request/bevy/2025-11/>← Back to Pull Requests</a></div><div class=pr-metadata><span class=pr-date>2025-11-03</span><div class=language-switcher><span class="lang-link active" data-lang=en>English</span> / <a class=lang-link data-lang=zh-cn href=/pull_request/bevy/2025-11/pr-21721-zh-cn-20251103>中文</a></div></div><div class=pr-content><h1 id=title>Title</h1><h2 id=basic-information>Basic Information</h2><ul><li><strong>Title</strong>: Make building asset sources infallible.<li><strong>PR Link</strong>: https://github.com/bevyengine/bevy/pull/21721<li><strong>Author</strong>: andriyDev<li><strong>Status</strong>: MERGED<li><strong>Labels</strong>: A-Assets, C-Usability, S-Ready-For-Final-Review, M-Migration-Guide, D-Straightforward<li><strong>Created</strong>: 2025-11-02T19:04:50Z<li><strong>Merged</strong>: 2025-11-03T19:31:14Z<li><strong>Merged By</strong>: alice-i-cecile</ul><h2 id=description-translation>Description Translation</h2><h1 id=objective>Objective</h1><ul><li>Creating an asset source without a reader results in entirely skipping the asset source.</ul><h2 id=solution>Solution</h2><ul><li>Make the <code>AssetSourceBuilder</code> take a reader builder fn in a <code>new</code> method.<li>Remove <code>AssetSource::build</code> - users should just call the builder directly.</ul><h2 id=testing>Testing</h2><ul><li>Tests still pass.</ul><h2 id=the-story-of-this-pull-request>The Story of This Pull Request</h2><p>This PR addresses a subtle but important issue in Bevy’s asset system where asset sources could be created without a reader, leading to those asset sources being silently skipped during initialization. The problem stemmed from the previous design where <code>AssetSourceBuilder</code> had an optional reader field, and if no reader was provided, the <code>build</code> method would return <code>None</code>, effectively ignoring the asset source without any warning to the developer.<p>The solution involved making the asset source construction process infallible by requiring a reader at construction time. This was achieved through several key changes:<p>First, the <code>AssetSourceBuilder</code> struct was redesigned to no longer derive <code>Default</code> and instead require a reader function through a new constructor method. This ensures that every asset source must have at least a reader:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before: reader was Option<...>
</span><span style=color:#fa6e32>pub struct </span><span style=color:#399ee6>AssetSourceBuilder </span><span>{
</span><span>    </span><span style=color:#fa6e32>pub </span><span>reader</span><span style=color:#61676ccc>: </span><span style=color:#55b4d4;font-style:italic>Option</span><span><</span><span style=color:#55b4d4;font-style:italic>Box</span><span>&LTdyn </span><span style=color:#55b4d4;font-style:italic>FnMut</span><span>() </span><span style=color:#61676ccc>-> </span><span style=color:#55b4d4;font-style:italic>Box</span><span>&LTdyn ErasedAssetReader> </span><span style=color:#ed9366>+ </span><span style=color:#55b4d4;font-style:italic>Send </span><span style=color:#ed9366>+ </span><span style=color:#55b4d4;font-style:italic>Sync</span><span>>>,
</span><span>    </span><span style=color:#abb0b6;font-style:italic>// ...
</span><span>}
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After: reader is required
</span><span style=color:#fa6e32>pub struct </span><span style=color:#399ee6>AssetSourceBuilder </span><span>{
</span><span>    </span><span style=color:#fa6e32>pub </span><span>reader</span><span style=color:#61676ccc>: </span><span style=color:#55b4d4;font-style:italic>Box</span><span>&LTdyn </span><span style=color:#55b4d4;font-style:italic>FnMut</span><span>() </span><span style=color:#61676ccc>-> </span><span style=color:#55b4d4;font-style:italic>Box</span><span>&LTdyn ErasedAssetReader> </span><span style=color:#ed9366>+ </span><span style=color:#55b4d4;font-style:italic>Send </span><span style=color:#ed9366>+ </span><span style=color:#55b4d4;font-style:italic>Sync</span><span>>,
</span><span>    </span><span style=color:#abb0b6;font-style:italic>// ...
</span><span>}
</span><span>
</span><span style=color:#fa6e32>impl </span><span style=color:#399ee6>AssetSourceBuilder </span><span>{
</span><span>    </span><span style=color:#fa6e32>pub fn </span><span style=color:#f29718>new</span><span>(
</span><span>        </span><span style=color:#ff8f40>reader</span><span style=color:#61676ccc>:</span><span> impl FnMut() -> </span><span style=color:#55b4d4;font-style:italic>Box</span><span>&LTdyn ErasedAssetReader> + Send + Sync + </span><span style=color:#fa6e32>'static</span><span>,
</span><span>    ) </span><span style=color:#61676ccc>-></span><span> AssetSourceBuilder {
</span><span>        </span><span style=color:#fa6e32>Self </span><span>{
</span><span>            reader</span><span style=color:#61676ccc>: </span><span style=color:#55b4d4;font-style:italic>Box</span><span style=color:#ed9366>::</span><span>new(reader)</span><span style=color:#61676ccc>,
</span><span>            writer</span><span style=color:#61676ccc>: </span><span style=color:#55b4d4;font-style:italic>None</span><span style=color:#61676ccc>,
</span><span>            </span><span style=color:#abb0b6;font-style:italic>// ... other fields initialized to None
</span><span>        }
</span><span>    }
</span><span>}
</span></code></pre><p>Second, the <code>AssetSource::build</code> method was removed entirely, and all code was updated to use <code>AssetSourceBuilder::new</code> directly. This change simplifies the API surface and eliminates the possibility of creating an incomplete asset source builder:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before
</span><span style=color:#fa6e32>let</span><span> source </span><span style=color:#ed9366>= </span><span>AssetSource</span><span style=color:#ed9366>::</span><span>build()
</span><span>    </span><span style=color:#ed9366>.</span><span style=color:#f07171>with_reader</span><span>(|| </span><span style=color:#55b4d4;font-style:italic>Box</span><span style=color:#ed9366>::</span><span>new(reader))
</span><span>    </span><span style=color:#ed9366>.</span><span style=color:#f07171>with_writer</span><span>(|| </span><span style=color:#55b4d4;font-style:italic>Some</span><span>(</span><span style=color:#55b4d4;font-style:italic>Box</span><span style=color:#ed9366>::</span><span>new(writer)))</span><span style=color:#61676ccc>;
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After  
</span><span style=color:#fa6e32>let</span><span> source </span><span style=color:#ed9366>= </span><span>AssetSourceBuilder</span><span style=color:#ed9366>::</span><span>new(|| </span><span style=color:#55b4d4;font-style:italic>Box</span><span style=color:#ed9366>::</span><span>new(reader))
</span><span>    </span><span style=color:#ed9366>.</span><span style=color:#f07171>with_writer</span><span>(|| </span><span style=color:#55b4d4;font-style:italic>Some</span><span>(</span><span style=color:#55b4d4;font-style:italic>Box</span><span style=color:#ed9366>::</span><span>new(writer)))</span><span style=color:#61676ccc>;
</span></code></pre><p>The <code>AssetSourceBuilder::build</code> method was also updated to always return an <code>AssetSource</code> instead of <code>Option&LTAssetSource></code>, since the reader is now guaranteed to exist:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before: returned Option&LTAssetSource>
</span><span style=color:#fa6e32>pub fn </span><span style=color:#f29718>build</span><span>(...) </span><span style=color:#61676ccc>-> </span><span style=color:#55b4d4;font-style:italic>Option</span><span>&LTAssetSource> {
</span><span>    </span><span style=color:#fa6e32>let</span><span> reader </span><span style=color:#ed9366>= </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>reader</span><span style=color:#ed9366>.</span><span style=color:#f07171>as_mut</span><span>()</span><span style=color:#ed9366>?</span><span>()</span><span style=color:#61676ccc>; </span><span style=color:#abb0b6;font-style:italic>// Could return None
</span><span>    </span><span style=color:#abb0b6;font-style:italic>// ...
</span><span>}
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After: always returns AssetSource  
</span><span style=color:#fa6e32>pub fn </span><span style=color:#f29718>build</span><span>(...) </span><span style=color:#61676ccc>-></span><span> AssetSource {
</span><span>    </span><span style=color:#fa6e32>let</span><span> reader </span><span style=color:#ed9366>= </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>reader</span><span style=color:#ed9366>.</span><span style=color:#f07171>as_mut</span><span>()()</span><span style=color:#61676ccc>; </span><span style=color:#abb0b6;font-style:italic>// Always succeeds
</span><span>    </span><span style=color:#abb0b6;font-style:italic>// ...
</span><span>}
</span></code></pre><p>This change cascaded through the entire asset system, requiring updates to all places where asset sources are created, including the embedded asset system, web asset system, and numerous test cases. The consistency of this change is evident in how uniformly the migration was applied across the codebase.<p>From an engineering perspective, this change improves the robustness of the asset system by eliminating a silent failure mode. Developers can no longer accidentally create asset sources that are silently ignored, which was particularly problematic because the failure occurred at initialization time without clear error messages. The new design makes the requirement explicit at the type system level, leveraging Rust’s type safety to prevent invalid configurations.<p>The PR also includes a comprehensive migration guide that clearly explains the required changes for users who have implemented custom asset sources, demonstrating good maintainer practices for breaking changes.<h2 id=visual-representation>Visual Representation</h2><pre class=language-mermaid data-lang=mermaid style=color:#61676c;background-color:#fafafa><code class=language-mermaid data-lang=mermaid><span>graph TD
</span><span>    A[AssetSourceBuilder] --> B[AssetSource]
</span><span>    C[Reader Function] --> A
</span><span>    D[Writer Function] --> A
</span><span>    E[Watcher Function] --> A
</span><span>    F[Processed Reader] --> A
</span><span>    G[Processed Writer] --> A
</span><span>    H[Processed Watcher] --> A
</span><span>    
</span><span>    style C fill:#9f9
</span><span>    style A fill:#ccf
</span></code></pre><h2 id=key-files-changed>Key Files Changed</h2><h3 id=crates-bevy-asset-src-io-source-rs-26-18><code>crates/bevy_asset/src/io/source.rs</code> (+26/-18)</h3><p>This file contains the core changes to the <code>AssetSourceBuilder</code> struct and its methods.<p><strong>Key changes:</strong><ul><li>Removed <code>Default</code> derivation from <code>AssetSourceBuilder</code><li>Added <code>new</code> constructor that requires a reader function<li>Updated <code>build</code> method to always return <code>AssetSource</code> instead of <code>Option&LTAssetSource></code><li>Removed optional wrapper from reader field</ul><pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before:
</span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>derive</span><span>(Default)]
</span><span style=color:#fa6e32>pub struct </span><span style=color:#399ee6>AssetSourceBuilder </span><span>{
</span><span>    </span><span style=color:#fa6e32>pub </span><span>reader</span><span style=color:#61676ccc>: </span><span style=color:#55b4d4;font-style:italic>Option</span><span><</span><span style=color:#55b4d4;font-style:italic>Box</span><span>&LTdyn </span><span style=color:#55b4d4;font-style:italic>FnMut</span><span>() </span><span style=color:#61676ccc>-> </span><span style=color:#55b4d4;font-style:italic>Box</span><span>&LTdyn ErasedAssetReader> </span><span style=color:#ed9366>+ </span><span style=color:#55b4d4;font-style:italic>Send </span><span style=color:#ed9366>+ </span><span style=color:#55b4d4;font-style:italic>Sync</span><span>>>,
</span><span>    </span><span style=color:#abb0b6;font-style:italic>// ...
</span><span>}
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After:
</span><span style=color:#fa6e32>pub struct </span><span style=color:#399ee6>AssetSourceBuilder </span><span>{
</span><span>    </span><span style=color:#fa6e32>pub </span><span>reader</span><span style=color:#61676ccc>: </span><span style=color:#55b4d4;font-style:italic>Box</span><span>&LTdyn </span><span style=color:#55b4d4;font-style:italic>FnMut</span><span>() </span><span style=color:#61676ccc>-> </span><span style=color:#55b4d4;font-style:italic>Box</span><span>&LTdyn ErasedAssetReader> </span><span style=color:#ed9366>+ </span><span style=color:#55b4d4;font-style:italic>Send </span><span style=color:#ed9366>+ </span><span style=color:#55b4d4;font-style:italic>Sync</span><span>>,
</span><span>    </span><span style=color:#abb0b6;font-style:italic>// ...
</span><span>}
</span><span>
</span><span style=color:#fa6e32>impl </span><span style=color:#399ee6>AssetSourceBuilder </span><span>{
</span><span>    </span><span style=color:#abb0b6;font-style:italic>// New constructor
</span><span>    </span><span style=color:#fa6e32>pub fn </span><span style=color:#f29718>new</span><span>(</span><span style=color:#ff8f40>reader</span><span style=color:#61676ccc>:</span><span> impl FnMut() -> </span><span style=color:#55b4d4;font-style:italic>Box</span><span>&LTdyn ErasedAssetReader> + Send + Sync + </span><span style=color:#fa6e32>'static</span><span>) </span><span style=color:#61676ccc>-> </span><span style=color:#fa6e32>Self </span><span>{
</span><span>        </span><span style=color:#fa6e32>Self </span><span>{
</span><span>            reader</span><span style=color:#61676ccc>: </span><span style=color:#55b4d4;font-style:italic>Box</span><span style=color:#ed9366>::</span><span>new(reader)</span><span style=color:#61676ccc>,
</span><span>            writer</span><span style=color:#61676ccc>: </span><span style=color:#55b4d4;font-style:italic>None</span><span style=color:#61676ccc>,
</span><span>            </span><span style=color:#abb0b6;font-style:italic>// ...
</span><span>        }
</span><span>    }
</span><span>    
</span><span>    </span><span style=color:#abb0b6;font-style:italic>// build method now infallible
</span><span>    </span><span style=color:#fa6e32>pub fn </span><span style=color:#f29718>build</span><span>(...) </span><span style=color:#61676ccc>-></span><span> AssetSource { </span><span style=color:#abb0b6;font-style:italic>// Was Option&LTAssetSource>
</span><span>        </span><span style=color:#fa6e32>let</span><span> reader </span><span style=color:#ed9366>= </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>reader</span><span style=color:#ed9366>.</span><span style=color:#f07171>as_mut</span><span>()()</span><span style=color:#61676ccc>; </span><span style=color:#abb0b6;font-style:italic>// No longer checks for None
</span><span>        </span><span style=color:#abb0b6;font-style:italic>// ...
</span><span>    }
</span><span>}
</span></code></pre><h3 id=crates-bevy-asset-src-io-embedded-mod-rs-20-20><code>crates/bevy_asset/src/io/embedded/mod.rs</code> (+20/-20)</h3><p>Updated the embedded asset source to use the new builder pattern.<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before:
</span><span style=color:#fa6e32>let mut</span><span> source </span><span style=color:#ed9366>= </span><span>AssetSource</span><span style=color:#ed9366>::</span><span>build()
</span><span>    </span><span style=color:#ed9366>.</span><span style=color:#f07171>with_reader</span><span>(</span><span style=color:#fa6e32>move </span><span style=color:#ed9366>|| </span><span style=color:#55b4d4;font-style:italic>Box</span><span style=color:#ed9366>::</span><span>new(MemoryAssetReader { root</span><span style=color:#61676ccc>:</span><span> dir</span><span style=color:#ed9366>.</span><span style=color:#f07171>clone</span><span>() }))
</span><span>    </span><span style=color:#ed9366>.</span><span style=color:#f07171>with_processed_reader</span><span>(</span><span style=color:#fa6e32>move </span><span style=color:#ed9366>|| </span><span style=color:#55b4d4;font-style:italic>Box</span><span style=color:#ed9366>::</span><span>new(MemoryAssetReader { root</span><span style=color:#61676ccc>:</span><span> processed_dir</span><span style=color:#ed9366>.</span><span style=color:#f07171>clone</span><span>() }))</span><span style=color:#61676ccc>;
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After:
</span><span style=color:#fa6e32>let mut</span><span> source </span><span style=color:#ed9366>= </span><span>AssetSourceBuilder</span><span style=color:#ed9366>::</span><span>new(</span><span style=color:#fa6e32>move </span><span style=color:#ed9366>|| </span><span style=color:#55b4d4;font-style:italic>Box</span><span style=color:#ed9366>::</span><span>new(MemoryAssetReader { root</span><span style=color:#61676ccc>:</span><span> dir</span><span style=color:#ed9366>.</span><span style=color:#f07171>clone</span><span>() }))
</span><span>    </span><span style=color:#ed9366>.</span><span style=color:#f07171>with_processed_reader</span><span>(</span><span style=color:#fa6e32>move </span><span style=color:#ed9366>|| </span><span style=color:#55b4d4;font-style:italic>Box</span><span style=color:#ed9366>::</span><span>new(MemoryAssetReader { root</span><span style=color:#61676ccc>:</span><span> processed_dir</span><span style=color:#ed9366>.</span><span style=color:#f07171>clone</span><span>() }))</span><span style=color:#61676ccc>;
</span></code></pre><h3 id=crates-bevy-asset-src-lib-rs-17-18><code>crates/bevy_asset/src/lib.rs</code> (+17/-18)</h3><p>Updated multiple test cases to use the new API pattern.<h3 id=release-content-migration-guides-custom-asset-source-infallible-md-28-0><code>release-content/migration-guides/custom_asset_source_infallible.md</code> (+28/-0)</h3><p>Added comprehensive migration guide explaining the changes.<h3 id=crates-bevy-asset-src-io-web-rs-5-5><code>crates/bevy_asset/src/io/web.rs</code> (+5/-5)</h3><p>Updated web asset sources to use the new builder pattern.<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before:
</span><span>app</span><span style=color:#ed9366>.</span><span style=color:#f07171>register_asset_source</span><span>(
</span><span>    </span><span style=color:#86b300>"http"</span><span style=color:#61676ccc>,
</span><span>    AssetSource</span><span style=color:#ed9366>::</span><span>build()
</span><span>        </span><span style=color:#ed9366>.</span><span style=color:#f07171>with_reader</span><span>(</span><span style=color:#fa6e32>move </span><span style=color:#ed9366>|| </span><span style=color:#55b4d4;font-style:italic>Box</span><span style=color:#ed9366>::</span><span>new(WebAssetReader</span><span style=color:#ed9366>::</span><span>Http))
</span><span>        </span><span style=color:#ed9366>.</span><span style=color:#f07171>with_processed_reader</span><span>(</span><span style=color:#fa6e32>move </span><span style=color:#ed9366>|| </span><span style=color:#55b4d4;font-style:italic>Box</span><span style=color:#ed9366>::</span><span>new(WebAssetReader</span><span style=color:#ed9366>::</span><span>Http))</span><span style=color:#61676ccc>,
</span><span>)</span><span style=color:#61676ccc>;
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After:
</span><span>app</span><span style=color:#ed9366>.</span><span style=color:#f07171>register_asset_source</span><span>(
</span><span>    </span><span style=color:#86b300>"http"</span><span style=color:#61676ccc>, 
</span><span>    AssetSourceBuilder</span><span style=color:#ed9366>::</span><span>new(</span><span style=color:#fa6e32>move </span><span style=color:#ed9366>|| </span><span style=color:#55b4d4;font-style:italic>Box</span><span style=color:#ed9366>::</span><span>new(WebAssetReader</span><span style=color:#ed9366>::</span><span>Http))
</span><span>        </span><span style=color:#ed9366>.</span><span style=color:#f07171>with_processed_reader</span><span>(</span><span style=color:#fa6e32>move </span><span style=color:#ed9366>|| </span><span style=color:#55b4d4;font-style:italic>Box</span><span style=color:#ed9366>::</span><span>new(WebAssetReader</span><span style=color:#ed9366>::</span><span>Http))</span><span style=color:#61676ccc>,
</span><span>)</span><span style=color:#61676ccc>;
</span></code></pre><h2 id=further-reading>Further Reading</h2><ul><li><a rel="noopener nofollow noreferrer" href=https://bevyengine.org/learn/quick-start/assets/ target=_blank>Bevy Asset System Documentation</a><li><a rel="noopener nofollow noreferrer" href=https://doc.rust-lang.org/book/ch09-00-error-handling.html target=_blank>Rust Error Handling Patterns</a><li><a rel="noopener nofollow noreferrer" href=https://doc.rust-lang.org/1.0.0/style/ownership/builders.html target=_blank>Builder Pattern in Rust</a></ul></div><div data-is-md-page=true data-patch-exists=true data-patch-path=/pull_request/bevy/2025-11/pr_21721.patch id=patch-info style=display:none></div><div class=bottom-spacer></div></div></div>