<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://unknownue.github.io name=base><title>
         #19810 `core_widgets` example slider fix
        
    </title><meta content="#19810 `core_widgets` example slider fix" property=og:title><meta content="A personal blog built with Zola and Apollo theme" property=og:description><meta content="A personal blog built with Zola and Apollo theme" name=description><link href=/icons/favicon.png rel=icon type=image/png><link href=https://unknownue.github.io/fonts.css rel=stylesheet><script src=https://unknownue.github.io/js/codeblock.js></script><script src=https://unknownue.github.io/js/toc.js></script><script src=https://unknownue.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Unknownue's Blog" href=https://unknownue.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://unknownue.github.io/theme/light.css rel=stylesheet><link href=https://unknownue.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://unknownue.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://unknownue.github.io/main.css media=screen rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js></script><script>// Initialize mermaid once DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            mermaid.initialize({
                startOnLoad: false,
                theme: document.body && document.body.classList.contains('dark') ? 'dark' : 'default',
                securityLevel: 'loose',
                flowchart: {
                    useMaxWidth: true,
                    htmlLabels: true
                },
                sequence: {
                    diagramMarginX: 50,
                    diagramMarginY: 10,
                    actorMargin: 50,
                    width: 150,
                    height: 65
                }
            });
        });</script><script src=https://unknownue.github.io/js/main.js></script><script defer src=https://unknownue.github.io/js/label-colors.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/rust.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/typescript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/go.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/cpp.min.js></script><script>// Ensure highlight.js is properly configured
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof hljs !== 'undefined') {
                hljs.configure({
                    languages: ['rust', 'javascript', 'python', 'cpp', 'go', 'typescript'],
                    ignoreUnescapedHTML: true
                });
                console.log('Highlight.js configured in header');
            }
        });</script><link href=https://cdn.jsdelivr.net/npm/diff2html/bundles/css/diff2html.min.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/diff2html/bundles/js/diff2html-ui.min.js></script><script src=https://unknownue.github.io/js/syntax-highlight.js></script><script src=https://unknownue.github.io/js/diff-sidebar.js></script><script src="https://unknownue.github.io/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><div class=content><header><div class=main><a href=https://unknownue.github.io>Unknownue's Blog</a><div class=socials><a class=social href=https://github.com/unknownue rel=me> <img alt=github src=https://unknownue.github.io/icons/social/github.svg> </a><a class=social href=https://github.com/unknownue/unknownue.github.io rel=me> <img alt=github-io src=https://unknownue.github.io/icons/social/rss.svg> </a></div></div><nav><a href=https://unknownue.github.io/posts style=margin-left:.25em>/posts</a><a href=https://unknownue.github.io/projects style=margin-left:.25em>/projects</a><a href=https://unknownue.github.io/about style=margin-left:.25em>/about</a><a href=https://unknownue.github.io/tags style=margin-left:.25em>/tags</a><button title="$SHORTCUT to open search" class=search-button id=search-button><img alt=Search class=search-icon src=https://unknownue.github.io/icons/search.svg></button><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><div id=modal-content><h1 class=page-header id=modalTitle>Search</h1><div id=searchBar><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search... role=combobox spellcheck=false><button title="Clear search" class=clear-button id=clear-search><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></button></div><div id=results-container><div id=results-info><span id=zero_results style=display:none>No results</span><span id=one_result style=display:none>1 result</span><span id=many_results style=display:none>$NUMBER results</span></div><div id=results role=listbox></div></div></div></div><a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://unknownue.github.io/icons/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://unknownue.github.io/icons/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><div class=pull-request-page><article class=md-content-page style=display:none></article><div class=back-link><a href=/pull_request/bevy/2025-06/>← Back to Pull Requests</a></div><div class=pr-metadata><span class=pr-date>2025-06-29</span><div class=language-switcher><span class="lang-link active" data-lang=en>English</span> / <a class=lang-link data-lang=zh-cn href=/pull_request/bevy/2025-06/pr-19810-zh-cn-20250629>中文</a></div></div><div class=pr-content><h2 id=core-widgets-example-slider-fix><code>core_widgets</code> example slider fix</h2><h3 id=basic-information>Basic Information</h3><ul><li><strong>Title</strong>: <code>core_widgets</code> example slider fix<li><strong>PR Link</strong>: https://github.com/bevyengine/bevy/pull/19810<li><strong>Author</strong>: ickshonpe<li><strong>Status</strong>: MERGED<li><strong>Labels</strong>: C-Examples, A-UI, S-Ready-For-Final-Review, D-Straightforward<li><strong>Created</strong>: 2025-06-25T09:31:26Z<li><strong>Merged</strong>: 2025-06-29T18:01:04Z<li><strong>Merged By</strong>: alice-i-cecile</ul><h3 id=description-translation>Description Translation</h3><p><strong>Objective</strong><br> When dragging the slider thumb, the thumb is only highlighted while the pointer is hovering the widget. If the pointer moves off the widget during a drag, the thumb reverts to its normal unhovered colour.<p><strong>Solution</strong><br> Query for <code>CoreSliderDragState</code> in the slider update systems and set the lighter color if the thumb is dragged or hovered.<hr><h3 id=the-story-of-this-pull-request>The Story of This Pull Request</h3><h4 id=the-problem>The Problem</h4><p>In Bevy’s UI system, the <code>core_widgets</code> example had a visual inconsistency with slider widgets. During drag operations, the slider thumb would only maintain its “highlighted” state when the cursor was directly over the widget. If users moved their pointer outside the widget boundaries while dragging (a common interaction pattern), the thumb would revert to its default appearance. This behavior contradicted standard UI conventions where draggable elements maintain visual feedback throughout the entire drag operation.<p>The root cause was the styling logic’s sole reliance on the <code>Hovered</code> component. The hover state naturally becomes false when the cursor leaves the widget area, causing the thumb to lose its active visual state prematurely.<h4 id=the-solution-approach>The Solution Approach</h4><p>The fix required incorporating drag state into the styling logic. Rather than:<ol><li>Adding new systems<li>Creating new components<li>Modifying core widget behavior</ol><p>The solution leveraged existing state tracking via the <code>CoreSliderDragState</code> component. This component already contained a <code>dragging</code> field indicating active drag operations. By incorporating this state into the color calculation, we could maintain visual consistency throughout drag interactions.<h4 id=implementation-details>Implementation Details</h4><p>Two systems managed slider thumb styling: <code>update_slider_style</code> and <code>update_slider_style2</code>. Both were modified to:<ol><li>Include <code>CoreSliderDragState</code> in their queries<li>Combine hover and drag states for color determination<li>React to drag state changes</ol><p>The key modification was replacing the hover-only check with a combined state check:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span>thumb_bg</span><span style=color:#ed9366>.</span><span style=color:#ff8f40>0 </span><span style=color:#ed9366>= </span><span style=color:#f07171>thumb_color</span><span>(disabled</span><span style=color:#61676ccc>,</span><span> hovered</span><span style=color:#ed9366>.</span><span style=color:#ff8f40>0 </span><span style=color:#ed9366>|</span><span> drag_state</span><span style=color:#ed9366>.</span><span>dragging)</span><span style=color:#61676ccc>;
</span></code></pre><p>The logical OR (<code>|</code>) ensures the thumb appears highlighted if either:<ul><li>The cursor is hovering the widget (<code>hovered.0 == true</code>)<li>An active drag is in progress (<code>drag_state.dragging == true</code>)</ul><p>The systems now also trigger updates when drag state changes:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span>Changed&LTCoreSliderDragState>
</span></code></pre><h4 id=technical-considerations>Technical Considerations</h4><p>This approach maintains:<ul><li><strong>Data locality</strong>: Uses existing drag state without new components<li><strong>Performance</strong>: Minimal additional query complexity<li><strong>Consistency</strong>: Preserves existing color calculation logic (<code>thumb_color</code>) while enhancing its input conditions</ul><p>No architectural changes were needed since the drag state was already tracked for operational purposes - we simply exposed this state to the styling system.<h3 id=visual-representation>Visual Representation</h3><pre class=language-mermaid data-lang=mermaid style=color:#61676c;background-color:#fafafa><code class=language-mermaid data-lang=mermaid><span>graph TD
</span><span>    A[Slider Styling System] --> B[Query Hovered State]
</span><span>    A --> C[Query Drag State]
</span><span>    B --> D[Calculate Thumb Color]
</span><span>    C --> D
</span><span>    D --> E[Apply Visual Feedback]
</span></code></pre><h3 id=key-files-changed>Key Files Changed</h3><h4 id=examples-ui-core-widgets-rs><code>examples/ui/core_widgets.rs</code></h4><p><strong>Changes</strong>:<br> Modified slider styling systems to include drag state in thumb color calculation.<p><strong>Key Modifications</strong>:<ol><li>Added <code>CoreSliderDragState</code> to system queries<li>Combined hover and drag states for color determination<li>Added reactivity to drag state changes</ol><p><strong>Code Snippets</strong>:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before: Only used Hovered state
</span><span style=color:#fa6e32>fn </span><span style=color:#f29718>update_slider_style</span><span>(
</span><span>    </span><span style=color:#ff8f40>sliders</span><span style=color:#61676ccc>: </span><span>Query<
</span><span>        (Entity, </span><span style=color:#ed9366>&</span><span>SliderValue, </span><span style=color:#ed9366>&</span><span>SliderRange, </span><span style=color:#ed9366>&</span><span>Hovered, Has&LTInteractionDisabled>),
</span><span>        </span><span style=color:#f51818>.</span><span>..
</span><span>    >,
</span><span>    ...
</span><span>) {
</span><span>    </span><span style=color:#ed9366>...
</span><span>    thumb_bg</span><span style=color:#ed9366>.</span><span style=color:#ff8f40>0 </span><span style=color:#ed9366>= </span><span style=color:#f07171>thumb_color</span><span>(disabled</span><span style=color:#61676ccc>,</span><span> hovered</span><span style=color:#ed9366>.</span><span style=color:#ff8f40>0</span><span>)</span><span style=color:#61676ccc>;
</span><span>    </span><span style=color:#ed9366>...
</span><span>}
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After: Added drag state
</span><span style=color:#fa6e32>fn </span><span style=color:#f29718>update_slider_style</span><span>(
</span><span>    </span><span style=color:#ff8f40>sliders</span><span style=color:#61676ccc>: </span><span>Query<
</span><span>        (
</span><span>            Entity,
</span><span>            </span><span style=color:#ed9366>&</span><span>SliderValue,
</span><span>            </span><span style=color:#ed9366>&</span><span>SliderRange,
</span><span>            </span><span style=color:#ed9366>&</span><span>Hovered,
</span><span>            </span><span style=color:#ed9366>&</span><span>CoreSliderDragState,  // Added
</span><span>            Has&LTInteractionDisabled>,
</span><span>        ),
</span><span>        </span><span style=color:#f51818>.</span><span>..
</span><span>    >,
</span><span>    ...
</span><span>) {
</span><span>    </span><span style=color:#ed9366>...
</span><span>    </span><span style=color:#abb0b6;font-style:italic>// Combined hover and drag states
</span><span>    thumb_bg</span><span style=color:#ed9366>.</span><span style=color:#ff8f40>0 </span><span style=color:#ed9366>= </span><span style=color:#f07171>thumb_color</span><span>(disabled</span><span style=color:#61676ccc>,</span><span> hovered</span><span style=color:#ed9366>.</span><span style=color:#ff8f40>0 </span><span style=color:#ed9366>|</span><span> drag_state</span><span style=color:#ed9366>.</span><span>dragging)</span><span style=color:#61676ccc>;
</span><span>    </span><span style=color:#ed9366>...
</span><span>}
</span></code></pre><pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before: Only tracked hover state
</span><span style=color:#fa6e32>fn </span><span style=color:#f29718>update_slider_style2</span><span>(
</span><span>    </span><span style=color:#ff8f40>sliders</span><span style=color:#61676ccc>: </span><span>Query<(Entity, </span><span style=color:#ed9366>&</span><span>Hovered, Has&LTInteractionDisabled>), With&LTDemoSlider>>,
</span><span>    ...
</span><span>) {
</span><span>    </span><span style=color:#ed9366>...
</span><span>    thumb_bg</span><span style=color:#ed9366>.</span><span style=color:#ff8f40>0 </span><span style=color:#ed9366>= </span><span style=color:#f07171>thumb_color</span><span>(disabled</span><span style=color:#61676ccc>,</span><span> hovered</span><span style=color:#ed9366>.</span><span style=color:#ff8f40>0</span><span>)</span><span style=color:#61676ccc>;
</span><span>    </span><span style=color:#ed9366>...
</span><span>}
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After: Added drag state tracking
</span><span style=color:#fa6e32>fn </span><span style=color:#f29718>update_slider_style2</span><span>(
</span><span>    </span><span style=color:#ff8f40>sliders</span><span style=color:#61676ccc>: </span><span>Query<
</span><span>        (
</span><span>            Entity,
</span><span>            </span><span style=color:#ed9366>&</span><span>Hovered,
</span><span>            </span><span style=color:#ed9366>&</span><span>CoreSliderDragState,  // Added
</span><span>            Has&LTInteractionDisabled>,
</span><span>        ),
</span><span>        With&LTDemoSlider>,
</span><span>    >,
</span><span>    ...
</span><span>) {
</span><span>    </span><span style=color:#ed9366>...
</span><span>    thumb_bg</span><span style=color:#ed9366>.</span><span style=color:#ff8f40>0 </span><span style=color:#ed9366>= </span><span style=color:#f07171>thumb_color</span><span>(disabled</span><span style=color:#61676ccc>,</span><span> hovered</span><span style=color:#ed9366>.</span><span style=color:#ff8f40>0 </span><span style=color:#ed9366>|</span><span> drag_state</span><span style=color:#ed9366>.</span><span>dragging)</span><span style=color:#61676ccc>;
</span><span>    </span><span style=color:#ed9366>...
</span><span>}
</span></code></pre><h3 id=further-reading>Further Reading</h3><ol><li><a rel="noopener nofollow noreferrer" href=https://docs.rs/bevy_ui/latest/bevy_ui/ target=_blank>Bevy UI System Documentation</a><li><a rel="noopener nofollow noreferrer" href=https://bevy-cheatbook.github.io/input.html target=_blank>Bevy Input Handling Guide</a><li><a rel="noopener nofollow noreferrer" href=https://m3.material.io/foundations/interaction target=_blank>UI Interaction Patterns (Material Design)</a></ol></div><div data-is-md-page=true data-patch-exists=true data-patch-path=/pull_request/bevy/2025-06/pr_19810.patch id=patch-info style=display:none></div><div class=bottom-spacer></div></div></div>