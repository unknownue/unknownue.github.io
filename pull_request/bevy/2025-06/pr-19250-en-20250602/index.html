<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://unknownue.github.io name=base><title>
         #19250
        
    </title><meta content=#19250 property=og:title><meta content="A personal blog built with Zola and Apollo theme" property=og:description><meta content="A personal blog built with Zola and Apollo theme" name=description><link href=/icons/favicon.png rel=icon type=image/png><link href=https://unknownue.github.io/fonts.css rel=stylesheet><script src=https://unknownue.github.io/js/codeblock.js></script><script src=https://unknownue.github.io/js/toc.js></script><script src=https://unknownue.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Unknownue's Blog" href=https://unknownue.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://unknownue.github.io/theme/light.css rel=stylesheet><link href=https://unknownue.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://unknownue.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://unknownue.github.io/main.css media=screen rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js></script><script>// Initialize mermaid once DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            mermaid.initialize({
                startOnLoad: false,
                theme: document.body && document.body.classList.contains('dark') ? 'dark' : 'default',
                securityLevel: 'loose',
                flowchart: {
                    useMaxWidth: true,
                    htmlLabels: true
                },
                sequence: {
                    diagramMarginX: 50,
                    diagramMarginY: 10,
                    actorMargin: 50,
                    width: 150,
                    height: 65
                }
            });
        });</script><script src=https://unknownue.github.io/js/main.js></script><script defer src=https://unknownue.github.io/js/label-colors.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/rust.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/typescript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/go.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/cpp.min.js></script><script>// Ensure highlight.js is properly configured
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof hljs !== 'undefined') {
                hljs.configure({
                    languages: ['rust', 'javascript', 'python', 'cpp', 'go', 'typescript'],
                    ignoreUnescapedHTML: true
                });
                console.log('Highlight.js configured in header');
            }
        });</script><link href=https://cdn.jsdelivr.net/npm/diff2html/bundles/css/diff2html.min.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/diff2html/bundles/js/diff2html-ui.min.js></script><script src=https://unknownue.github.io/js/syntax-highlight.js></script><script src=https://unknownue.github.io/js/diff-sidebar.js></script><script src="https://unknownue.github.io/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><div class=content><header><div class=main><a href=https://unknownue.github.io>Unknownue's Blog</a><div class=socials><a class=social href=https://github.com/unknownue rel=me> <img alt=github src=https://unknownue.github.io/icons/social/github.svg> </a><a class=social href=https://github.com/unknownue/unknownue.github.io rel=me> <img alt=github-io src=https://unknownue.github.io/icons/social/rss.svg> </a></div></div><nav><a href=https://unknownue.github.io/posts style=margin-left:.25em>/posts</a><a href=https://unknownue.github.io/projects style=margin-left:.25em>/projects</a><a href=https://unknownue.github.io/about style=margin-left:.25em>/about</a><a href=https://unknownue.github.io/tags style=margin-left:.25em>/tags</a><button title="$SHORTCUT to open search" class=search-button id=search-button><img alt=Search class=search-icon src=https://unknownue.github.io/icons/search.svg></button><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><div id=modal-content><h1 class=page-header id=modalTitle>Search</h1><div id=searchBar><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search... role=combobox spellcheck=false><button title="Clear search" class=clear-button id=clear-search><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></button></div><div id=results-container><div id=results-info><span id=zero_results style=display:none>No results</span><span id=one_result style=display:none>1 result</span><span id=many_results style=display:none>$NUMBER results</span></div><div id=results role=listbox></div></div></div></div><a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://unknownue.github.io/icons/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://unknownue.github.io/icons/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><div class=pull-request-page><article class=md-content-page style=display:none></article><div class=back-link><a href=/pull_request/bevy/2025-06/>← Back to Pull Requests</a></div><div class=pr-metadata><span class=pr-date>2025-06-02</span><div class=language-switcher><span class="lang-link active" data-lang=en>English</span> / <a class=lang-link data-lang=zh-cn href=/pull_request/bevy/2025-06/pr-19250-zh-cn-20250602>中文</a></div></div><div class=pr-content><h3 id=the-story-of-this-pull-request>The Story of This Pull Request</h3><p>This PR addresses documentation clarity issues in Bevy’s reflection system, specifically within the <code>PartialReflect::apply</code> method. The core problem stemmed from ambiguous documentation that could mislead developers about how reflection operations work. When working with reflection APIs, precise documentation is critical since developers rely on it to understand complex runtime type manipulation behaviors.<p>The initial documentation contained two main issues:<ol><li>It used generic type parameter <code>T</code> when describing behaviors, though the method operates on the implementing type (<code>Self</code>)<li>It omitted the <code>Set</code> variant from the list of reflection subtraits, creating an incomplete picture of supported types<li>A broken link referenced “introspection subtraits” instead of the correct “reflection subtraits”</ol><p>These issues were reported in GitHub issue #18558. The solution required:<ul><li>Replacing all <code>T</code> references with <code>Self</code> to clarify we’re discussing the implementor’s type<li>Adding missing documentation for the <code>Set</code> variant’s behavior<li>Correcting the broken link to point to valid documentation</ul><p>Here’s how the changes improve clarity:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before:
</span><span style=color:#abb0b6;font-style:italic>// - If `T` is a [`Struct`], then the value of each named field of `value` is
</span><span style=color:#abb0b6;font-style:italic>//   applied to the corresponding named field of `self`.
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After:
</span><span style=color:#abb0b6;font-style:italic>// - If `Self` is a [`Struct`], then the value of each named field of `value` is
</span><span style=color:#abb0b6;font-style:italic>//   applied to the corresponding named field of `self`.
</span></code></pre><p>The <code>Set</code> variant documentation was added to maintain parity with other collection types:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Added section:
</span><span style=color:#abb0b6;font-style:italic>// - If `Self` is a [`Set`], then each element of `value` is applied to the corresponding
</span><span style=color:#abb0b6;font-style:italic>//   element of `Self`. If an element of `value` does not exist in `Self` then it is
</span><span style=color:#abb0b6;font-style:italic>//   cloned and inserted.
</span></code></pre><p>Helper function references were updated to include <code>set_apply</code>:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before:
</span><span style=color:#abb0b6;font-style:italic>// For lists and maps, use the [`list_apply`] and [`map_apply`] helper functions
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After:
</span><span style=color:#abb0b6;font-style:italic>// For lists, maps, and sets, use the [`list_apply`], [`map_apply`], and [`set_apply`]
</span></code></pre><p>The panic documentation was also updated to use <code>Self</code> consistently:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before:
</span><span style=color:#abb0b6;font-style:italic>// - If the type of `value` is not of the same kind as `T`
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After:
</span><span style=color:#abb0b6;font-style:italic>// - If the type of `value` is not of the same kind as `Self`
</span></code></pre><p>These changes ensure developers:<ol><li>Understand exactly which type’s behavior is being described (<code>Self</code> vs arbitrary <code>T</code>)<li>See complete coverage of all reflection subtrait behaviors<li>Have working documentation links<li>Receive accurate information about panic conditions</ol><p>The solution maintains backward compatibility while significantly improving documentation accuracy. Since reflection APIs often involve complex runtime behavior, these clarifications help prevent misuse and debugging headaches. The changes also make the documentation more internally consistent by standardizing on <code>Self</code> terminology throughout.<h3 id=visual-representation>Visual Representation</h3><pre class=language-mermaid data-lang=mermaid style=color:#61676c;background-color:#fafafa><code class=language-mermaid data-lang=mermaid><span>graph TD
</span><span>    A[PartialReflect::apply] --> B[Reflection Subtrait]
</span><span>    B --> C[Struct]
</span><span>    B --> D[Tuple/TupleStruct]
</span><span>    B --> E[Enum]
</span><span>    B --> F[List/Array]
</span><span>    B --> G[Map]
</span><span>    B --> H[Set]  &LT!-- Added in this PR -->
</span></code></pre><h3 id=key-files-changed>Key Files Changed</h3><p><strong>crates/bevy_reflect/src/reflect.rs</strong><ol><li>Updated documentation for <code>PartialReflect::apply</code><li>Added missing <code>Set</code> variant documentation<li>Fixed broken link and helper function references</ol><p>Key changes:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before:
</span><span style=color:#abb0b6;font-style:italic>// If a type implements an [introspection subtrait], then the semantics...
</span><span style=color:#abb0b6;font-style:italic>// - If `T` is a [`Struct`], then...
</span><span style=color:#abb0b6;font-style:italic>// [introspection subtrait]: crate#the-introspection-subtraits
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After:
</span><span style=color:#abb0b6;font-style:italic>// If `Self` implements a [reflection subtrait], then the semantics...
</span><span style=color:#abb0b6;font-style:italic>// - If `Self` is a [`Struct`], then...
</span><span style=color:#abb0b6;font-style:italic>// - If `Self` is a [`Set`], then... // New section
</span><span style=color:#abb0b6;font-style:italic>// [reflection subtrait]: crate#the-reflection-subtraits
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// Before:
</span><span style=color:#abb0b6;font-style:italic>// Note that `Reflect` must be implemented manually for [`List`]s and [`Map`]s...
</span><span style=color:#abb0b6;font-style:italic>// For lists and maps, use the [`list_apply`] and [`map_apply`] helper functions
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After:
</span><span style=color:#abb0b6;font-style:italic>// Note that `Reflect` must be implemented manually for [`List`]s, [`Map`]s, and [`Set`]s...
</span><span style=color:#abb0b6;font-style:italic>// For lists, maps, and sets, use the [`list_apply`], [`map_apply`], and [`set_apply`] helper functions
</span></code></pre><h3 id=further-reading>Further Reading</h3><ol><li><a rel="noopener nofollow noreferrer" href=https://docs.rs/bevy_reflect/latest/bevy_reflect/ target=_blank>Bevy Reflection Documentation</a><li><a rel="noopener nofollow noreferrer" href=https://doc.rust-lang.org/std/keyword.Self.html target=_blank>Rust <code>Self</code> keyword explanation</a><li><a rel="noopener nofollow noreferrer" href=https://github.com/bevyengine/bevy/blob/main/crates/bevy_reflect/src/lib.rs#L153-L185 target=_blank>Bevy Reflection Traits</a></ol></div><div data-is-md-page=true data-patch-exists=true data-patch-path=/pull_request/bevy/2025-06/pr_19250.patch id=patch-info style=display:none></div><div class=bottom-spacer></div></div></div>