<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://unknownue.github.io name=base><title>
         #19515 Allow new mismatched_lifetime_syntaxes lint
        
    </title><meta content="#19515 Allow new mismatched_lifetime_syntaxes lint" property=og:title><meta content="A personal blog built with Zola and Apollo theme" property=og:description><meta content="A personal blog built with Zola and Apollo theme" name=description><link href=/icons/favicon.png rel=icon type=image/png><link href=https://unknownue.github.io/fonts.css rel=stylesheet><script src=https://unknownue.github.io/js/codeblock.js></script><script src=https://unknownue.github.io/js/toc.js></script><script src=https://unknownue.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Unknownue's Blog" href=https://unknownue.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://unknownue.github.io/theme/light.css rel=stylesheet><link href=https://unknownue.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://unknownue.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://unknownue.github.io/main.css media=screen rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js></script><script>// Initialize mermaid once DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            mermaid.initialize({
                startOnLoad: false,
                theme: document.body && document.body.classList.contains('dark') ? 'dark' : 'default',
                securityLevel: 'loose',
                flowchart: {
                    useMaxWidth: true,
                    htmlLabels: true
                },
                sequence: {
                    diagramMarginX: 50,
                    diagramMarginY: 10,
                    actorMargin: 50,
                    width: 150,
                    height: 65
                }
            });
        });</script><script src=https://unknownue.github.io/js/main.js></script><script defer src=https://unknownue.github.io/js/label-colors.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/rust.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/typescript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/go.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/cpp.min.js></script><script>// Ensure highlight.js is properly configured
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof hljs !== 'undefined') {
                hljs.configure({
                    languages: ['rust', 'javascript', 'python', 'cpp', 'go', 'typescript'],
                    ignoreUnescapedHTML: true
                });
                console.log('Highlight.js configured in header');
            }
        });</script><link href=https://cdn.jsdelivr.net/npm/diff2html/bundles/css/diff2html.min.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/diff2html/bundles/js/diff2html-ui.min.js></script><script src=https://unknownue.github.io/js/syntax-highlight.js></script><script src=https://unknownue.github.io/js/diff-sidebar.js></script><script src="https://unknownue.github.io/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><div class=content><header><div class=main><a href=https://unknownue.github.io>Unknownue's Blog</a><div class=socials><a class=social href=https://github.com/unknownue rel=me> <img alt=github src=https://unknownue.github.io/icons/social/github.svg> </a><a class=social href=https://github.com/unknownue/unknownue.github.io rel=me> <img alt=github-io src=https://unknownue.github.io/icons/social/rss.svg> </a></div></div><nav><a href=https://unknownue.github.io/posts style=margin-left:.25em>/posts</a><a href=https://unknownue.github.io/projects style=margin-left:.25em>/projects</a><a href=https://unknownue.github.io/about style=margin-left:.25em>/about</a><a href=https://unknownue.github.io/tags style=margin-left:.25em>/tags</a><button title="$SHORTCUT to open search" class=search-button id=search-button><img alt=Search class=search-icon src=https://unknownue.github.io/icons/search.svg></button><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><div id=modal-content><h1 class=page-header id=modalTitle>Search</h1><div id=searchBar><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search... role=combobox spellcheck=false><button title="Clear search" class=clear-button id=clear-search><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></button></div><div id=results-container><div id=results-info><span id=zero_results style=display:none>No results</span><span id=one_result style=display:none>1 result</span><span id=many_results style=display:none>$NUMBER results</span></div><div id=results role=listbox></div></div></div></div><a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://unknownue.github.io/icons/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://unknownue.github.io/icons/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><div class=pull-request-page><article class=md-content-page style=display:none></article><div class=back-link><a href=/pull_request/bevy/2025-06/>← Back to Pull Requests</a></div><div class=pr-metadata><span class=pr-date>2025-06-06</span><div class=language-switcher><span class="lang-link active" data-lang=en>English</span> / <a class=lang-link data-lang=zh-cn href=/pull_request/bevy/2025-06/pr-19515-zh-cn-20250606>中文</a></div></div><div class=pr-content><h3 id=analysis-of-pr-19515-allow-new-mismatched-lifetime-syntaxes-lint>Analysis of PR #19515: Allow new mismatched_lifetime_syntaxes lint</h3><h4 id=basic-information>Basic Information</h4><ul><li><strong>Title</strong>: Allow new mismatched_lifetime_syntaxes lint<li><strong>PR Link</strong>: https://github.com/bevyengine/bevy/pull/19515<li><strong>Author</strong>: alice-i-cecile<li><strong>Status</strong>: MERGED<li><strong>Labels</strong>: D-Trivial, A-Build-System, S-Ready-For-Final-Review, P-Critical, X-Contentious<li><strong>Created</strong>: 2025-06-06T19:44:15Z<li><strong>Merged</strong>: 2025-06-06T20:32:37Z<li><strong>Merged By</strong>: alice-i-cecile</ul><h4 id=description>Description</h4><p>The new nightly lint produces <a href="http://github.com/bevyengine/bevy/actions/runs/15491867876/job/43620116435?pr=19510" rel="noopener nofollow noreferrer" target=_blank>unhelpful, noisy output</a> that makes lifetimes more prominent in our library code than we generally find helpful.<p>This needs to be fixed or allowed, in order to unbreak CI for every PR in this repo.<p>Blanket allow the lint at the workspace level.<p>Let’s see if CI passes!<hr><h3 id=the-story-of-this-pull-request>The Story of This Pull Request</h3><h4 id=the-problem-and-context>The Problem and Context</h4><p>A new lint (<code>mismatched_lifetime_syntaxes</code>) was introduced in Rust’s nightly compiler. This lint automatically triggered warnings in Bevy’s CI pipeline during builds, producing verbose output that cluttered logs and made lifetime syntax appear more prominently than necessary. The warnings were unhelpful for Bevy’s development workflow and caused CI failures for all open PRs. Since Bevy uses a deny-by-default policy for lints, any new warnings from the compiler would fail CI. This became a critical issue (P-Critical) because it blocked all development activity.<h4 id=the-solution-approach>The Solution Approach</h4><p>The most straightforward solution was to explicitly allow the new lint at the workspace level. This approach:<ol><li>Avoids the need for widespread code changes to satisfy the new lint rules<li>Maintains consistency by handling the lint configuration in a single location<li>Immediately unblocks CI without compromising existing quality standards</ol><p>The alternative – modifying lifetime syntax across the entire codebase – was rejected due to:<ul><li>The disproportionate effort required relative to the benefit<li>Potential introduction of new bugs during mass refactoring<li>Disruption to active development work</ul><h4 id=the-implementation>The Implementation</h4><p>The change was implemented in <code>Cargo.toml</code>, Bevy’s central dependency and configuration file. A single line was added to the <code>[workspace.lints.rust]</code> section:<pre class=language-toml data-lang=toml style=color:#61676c;background-color:#fafafa><code class=language-toml data-lang=toml><span>[</span><span style=color:#399ee6>workspace</span><span style=color:#61676ccc>.</span><span style=color:#399ee6>lints</span><span style=color:#61676ccc>.</span><span style=color:#399ee6>rust</span><span>]
</span><span style=color:#399ee6>missing_docs </span><span>= </span><span style=color:#86b300>"warn"
</span><span style=color:#399ee6>mismatched_lifetime_syntaxes </span><span>= </span><span style=color:#86b300>"allow"  </span><span style=color:#abb0b6;font-style:italic># New addition
</span><span style=color:#399ee6>unexpected_cfgs </span><span>= { </span><span style=color:#399ee6>level </span><span>= </span><span style=color:#86b300>"warn"</span><span style=color:#61676ccc>, </span><span style=color:#399ee6>check-cfg </span><span>= [</span><span style=color:#86b300>'cfg(docsrs_dep)'</span><span>] }
</span><span style=color:#399ee6>unsafe_code </span><span>= </span><span style=color:#86b300>"deny"
</span></code></pre><p>This modification:<ul><li>Explicitly sets the lint level to <code>allow</code><li>Affects all crates in the workspace<li>Preserves existing lint configurations (<code>deny</code> for unsafe code, <code>warn</code> for missing docs)<li>Uses Rust’s standard lint level syntax</ul><h4 id=technical-insights>Technical Insights</h4><p>The <code>mismatched_lifetime_syntaxes</code> lint detects inconsistent lifetime parameter declarations in function signatures. For example:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Might trigger the lint
</span><span style=color:#fa6e32>fn </span><span style=color:#f29718>foo</span><span><</span><span style=color:#fa6e32>'a</span><span>>(</span><span style=color:#ff8f40>x</span><span style=color:#61676ccc>: </span><span style=color:#ed9366>&</span><span style=color:#fa6e32>'a i32</span><span>, </span><span style=color:#ff8f40>y</span><span style=color:#61676ccc>: </span><span style=color:#ed9366>&</span><span style=color:#fa6e32>i32</span><span>) 
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// Preferred style
</span><span style=color:#fa6e32>fn </span><span style=color:#f29718>foo</span><span>(</span><span style=color:#ff8f40>x</span><span style=color:#61676ccc>: </span><span style=color:#ed9366>&</span><span style=color:#fa6e32>i32</span><span>, </span><span style=color:#ff8f40>y</span><span style=color:#61676ccc>: </span><span style=color:#ed9366>&</span><span style=color:#fa6e32>i32</span><span>)
</span></code></pre><p>By allowing this lint:<ul><li>Bevy maintains compatibility with nightly Rust without requiring immediate code changes<li>Developers can incrementally address lifetime syntax when modifying relevant code<li>The team preserves flexibility to re-enable the lint later if needed</ul><h4 id=the-impact>The Impact</h4><p>This change immediately:<ul><li>Restores CI functionality for all PRs<li>Eliminates noisy compiler output<li>Maintains existing code quality standards<li>Requires no modifications to application code</ul><p>The solution demonstrates pragmatic handling of compiler updates in large projects – prioritizing development velocity while maintaining control over quality standards.<hr><h3 id=visual-representation>Visual Representation</h3><pre class=language-mermaid data-lang=mermaid style=color:#61676c;background-color:#fafafa><code class=language-mermaid data-lang=mermaid><span>graph TD
</span><span>    A[New Rust Nightly Lint] --> B[CI Failures]
</span><span>    B --> C[Development Blocked]
</span><span>    C --> D[Add Lint Allowance]
</span><span>    D --> E[CI Restored]
</span></code></pre><hr><h3 id=key-files-changed>Key Files Changed</h3><h4 id=cargo-toml><code>Cargo.toml</code></h4><p><strong>Change</strong>: Added lint allowance for <code>mismatched_lifetime_syntaxes</code><br> <strong>Why</strong>: To suppress new compiler warnings and restore CI functionality<br> <strong>Impact</strong>: Affects all crates in the workspace<pre class=language-toml data-lang=toml style=color:#61676c;background-color:#fafafa><code class=language-toml data-lang=toml><span style=color:#abb0b6;font-style:italic># Before:
</span><span>[</span><span style=color:#399ee6>workspace</span><span style=color:#61676ccc>.</span><span style=color:#399ee6>lints</span><span style=color:#61676ccc>.</span><span style=color:#399ee6>rust</span><span>]
</span><span style=color:#399ee6>missing_docs </span><span>= </span><span style=color:#86b300>"warn"
</span><span style=color:#399ee6>unexpected_cfgs </span><span>= { </span><span style=color:#399ee6>level </span><span>= </span><span style=color:#86b300>"warn"</span><span style=color:#61676ccc>, </span><span style=color:#399ee6>check-cfg </span><span>= [</span><span style=color:#86b300>'cfg(docsrs_dep)'</span><span>] }
</span><span style=color:#399ee6>unsafe_code </span><span>= </span><span style=color:#86b300>"deny"
</span><span>
</span><span style=color:#abb0b6;font-style:italic># After:
</span><span>[</span><span style=color:#399ee6>workspace</span><span style=color:#61676ccc>.</span><span style=color:#399ee6>lints</span><span style=color:#61676ccc>.</span><span style=color:#399ee6>rust</span><span>]
</span><span style=color:#399ee6>missing_docs </span><span>= </span><span style=color:#86b300>"warn"
</span><span style=color:#399ee6>mismatched_lifetime_syntaxes </span><span>= </span><span style=color:#86b300>"allow"  </span><span style=color:#abb0b6;font-style:italic># Added line
</span><span style=color:#399ee6>unexpected_cfgs </span><span>= { </span><span style=color:#399ee6>level </span><span>= </span><span style=color:#86b300>"warn"</span><span style=color:#61676ccc>, </span><span style=color:#399ee6>check-cfg </span><span>= [</span><span style=color:#86b300>'cfg(docsrs_dep)'</span><span>] }
</span><span style=color:#399ee6>unsafe_code </span><span>= </span><span style=color:#86b300>"deny"
</span></code></pre><hr><h3 id=further-reading>Further Reading</h3><ol><li><a rel="noopener nofollow noreferrer" href=https://doc.rust-lang.org/rustc/lints/levels.html target=_blank>Rust Lint Levels Documentation</a><li><a rel="noopener nofollow noreferrer" href=https://github.com/rust-lang/rust/issues/121652 target=_blank>Rustc Lint Explanation</a><li><a rel="noopener nofollow noreferrer" href=https://github.com/bevyengine/bevy/blob/main/.github/workflows/ci.yml target=_blank>Bevy’s CI Configuration</a><li><a rel="noopener nofollow noreferrer" href=https://github.com/rust-lang/rfcs/blob/master/text/1234-workspace-lints.md target=_blank>Cargo Workspace Lints RFC</a></ol><hr><h3 id=full-code-diff>Full Code Diff</h3><pre class=language-diff data-lang=diff style=color:#61676c;background-color:#fafafa><code class=language-diff data-lang=diff><span>diff --git a/Cargo.toml b/Cargo.toml
</span><span>index 207259a31f111..000bebe13496d 100644
</span><span style=color:#c594c5>--- a/Cargo.toml
</span><span style=color:#c594c5>+++ b/Cargo.toml
</span><span style=color:#c594c5>@@ -72,6 +72,7 @@ </span><span style=color:#399ee6>allow_attributes_without_reason = "warn"
</span><span> 
</span><span> [workspace.lints.rust]
</span><span> missing_docs = "warn"
</span><span style=color:#86b300>+mismatched_lifetime_syntaxes = "allow"
</span><span> unexpected_cfgs = { level = "warn", check-cfg = ['cfg(docsrs_dep)'] }
</span><span> unsafe_code = "deny"
</span><span> unsafe_op_in_unsafe_fn = "warn"
</span></code></pre></div><div data-is-md-page=true data-patch-exists=true data-patch-path=/pull_request/bevy/2025-06/pr_19515.patch id=patch-info style=display:none></div><div class=bottom-spacer></div></div></div>