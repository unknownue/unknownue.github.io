<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://unknownue.github.io name=base><title>
         #19746 Add newlines before impl blocks
        
    </title><meta content="#19746 Add newlines before impl blocks" property=og:title><meta content="A personal blog built with Zola and Apollo theme" property=og:description><meta content="A personal blog built with Zola and Apollo theme" name=description><link href=/icons/favicon.png rel=icon type=image/png><link href=https://unknownue.github.io/fonts.css rel=stylesheet><script src=https://unknownue.github.io/js/codeblock.js></script><script src=https://unknownue.github.io/js/toc.js></script><script src=https://unknownue.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Unknownue's Blog" href=https://unknownue.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://unknownue.github.io/theme/light.css rel=stylesheet><link href=https://unknownue.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://unknownue.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://unknownue.github.io/main.css media=screen rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js></script><script>// Initialize mermaid once DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            mermaid.initialize({
                startOnLoad: false,
                theme: document.body && document.body.classList.contains('dark') ? 'dark' : 'default',
                securityLevel: 'loose',
                flowchart: {
                    useMaxWidth: true,
                    htmlLabels: true
                },
                sequence: {
                    diagramMarginX: 50,
                    diagramMarginY: 10,
                    actorMargin: 50,
                    width: 150,
                    height: 65
                }
            });
        });</script><script src=https://unknownue.github.io/js/main.js></script><script defer src=https://unknownue.github.io/js/label-colors.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/rust.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/typescript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/go.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/cpp.min.js></script><script>// Ensure highlight.js is properly configured
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof hljs !== 'undefined') {
                hljs.configure({
                    languages: ['rust', 'javascript', 'python', 'cpp', 'go', 'typescript'],
                    ignoreUnescapedHTML: true
                });
                console.log('Highlight.js configured in header');
            }
        });</script><link href=https://cdn.jsdelivr.net/npm/diff2html/bundles/css/diff2html.min.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/diff2html/bundles/js/diff2html-ui.min.js></script><script src=https://unknownue.github.io/js/syntax-highlight.js></script><script src=https://unknownue.github.io/js/diff-sidebar.js></script><script src="https://unknownue.github.io/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><div class=content><header><div class=main><a href=https://unknownue.github.io>Unknownue's Blog</a><div class=socials><a class=social href=https://github.com/unknownue rel=me> <img alt=github src=https://unknownue.github.io/icons/social/github.svg> </a><a class=social href=https://github.com/unknownue/unknownue.github.io rel=me> <img alt=github-io src=https://unknownue.github.io/icons/social/rss.svg> </a></div></div><nav><a href=https://unknownue.github.io/posts style=margin-left:.25em>/posts</a><a href=https://unknownue.github.io/projects style=margin-left:.25em>/projects</a><a href=https://unknownue.github.io/about style=margin-left:.25em>/about</a><a href=https://unknownue.github.io/tags style=margin-left:.25em>/tags</a><button title="$SHORTCUT to open search" class=search-button id=search-button><img alt=Search class=search-icon src=https://unknownue.github.io/icons/search.svg></button><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><div id=modal-content><h1 class=page-header id=modalTitle>Search</h1><div id=searchBar><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search... role=combobox spellcheck=false><button title="Clear search" class=clear-button id=clear-search><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></button></div><div id=results-container><div id=results-info><span id=zero_results style=display:none>No results</span><span id=one_result style=display:none>1 result</span><span id=many_results style=display:none>$NUMBER results</span></div><div id=results role=listbox></div></div></div></div><a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://unknownue.github.io/icons/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://unknownue.github.io/icons/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><div class=pull-request-page><article class=md-content-page style=display:none></article><div class=back-link><a href=/pull_request/bevy/2025-06/>← Back to Pull Requests</a></div><div class=pr-metadata><span class=pr-date>2025-06-22</span><div class=language-switcher><a class=lang-link data-lang=en href=/pull_request/bevy/2025-06/pr-19746-en-20250622>English</a> / <span class="lang-link active" data-lang=zh-cn>中文</span></div></div><div class=pr-content><h1 id=tian-jia-impl-kuai-qian-de-huan-xing-fu>添加 <code>impl</code> 块前的换行符</h1><h2 id=ji-chu-xin-xi>基础信息</h2><ul><li><strong>标题</strong>: Add newlines before impl blocks<li><strong>PR 链接</strong>: https://github.com/bevyengine/bevy/pull/19746<li><strong>作者</strong>: theotherphil<li><strong>状态</strong>: MERGED<li><strong>标签</strong>: D-Trivial, C-Code-Quality, S-Ready-For-Final-Review, A-Cross-Cutting<li><strong>创建时间</strong>: 2025-06-19T21:06:42Z<li><strong>合并时间</strong>: 2025-06-22T23:25:08Z<li><strong>合并者</strong>: alice-i-cecile</ul><h2 id=miao-shu-fan-yi>描述翻译</h2><h3 id=objective>Objective</h3><p>修复 https://github.com/bevyengine/bevy/issues/19617<h3 id=solution>Solution</h3><p>在所有 impl 块前添加换行符。<p>我怀疑其中至少有些改动可能引起争议！如果有特定的 Bevy 代码风格要求，我将更新此 PR。如果没有，我们可以直接关闭它 - 这只是一个简单的查找替换操作。<h2 id=ben-ci-pull-request-de-ji-shu-fen-xi>本次 Pull Request 的技术分析</h2><h3 id=wen-ti-yu-bei-jing>问题与背景</h3><p>在 Bevy 代码库中，存在 <code>impl</code> 代码块前缺少空行的不一致情况。这种格式问题虽然不影响功能，但会降低代码可读性和一致性。具体表现为：<ol><li>相邻的 <code>impl</code> 块之间没有视觉分隔<li><code>impl</code> 块与其前面的代码紧密粘连<li>不同文件中的格式风格不一致</ol><p>这类问题在大型代码库中会累积成技术债，虽然每个实例都很微小，但集体修复能显著提升代码可维护性。问题 #19617 专门指出了这一格式问题，需要跨多个模块的统一修复。<h3 id=jie-jue-fang-an>解决方案</h3><p>采用最小侵入式的解决方案：<ol><li>在<strong>所有</strong> <code>impl</code> 块前添加空行<li>使用自动化工具批量处理<li>保持现有代码结构不变</ol><p>该方法选择基于：<ul><li>不需要复杂逻辑，纯文本处理即可解决<li>避免引入任何功能变更风险<li>完全解决整个代码库的不一致问题</ul><p>实现使用简单的查找替换操作：将正则表达式 <code>\nimpl</code> 替换为 <code>\n\nimpl</code>，确保每个 <code>impl</code> 关键字前都有空行分隔。<h3 id=ju-ti-shi-xian>具体实现</h3><p>修改涉及 59 个文件，主要集中在 <code>crates/</code> 目录（47 文件），典型修改模式为：<pre class=language-diff data-lang=diff style=color:#61676c;background-color:#fafafa><code class=language-diff data-lang=diff><span>// 修改前示例
</span><span>}
</span><span>impl SomeTrait for SomeType {
</span></code></pre><pre class=language-diff data-lang=diff style=color:#61676c;background-color:#fafafa><code class=language-diff data-lang=diff><span>// 修改后示例
</span><span>}
</span><span style=color:#86b300>+
</span><span style=color:#86b300>+impl SomeTrait for SomeType {
</span></code></pre><p>关键实现细节：<ol><li><p>正确处理了带属性标记的 <code>impl</code> 块</p> <pre class=language-diff data-lang=diff style=color:#61676c;background-color:#fafafa><code class=language-diff data-lang=diff><span>#[derive(Component)]
</span><span>struct MyComponent;
</span><span style=color:#86b300>+
</span><span style=color:#86b300>+impl Default for MyComponent {
</span></code></pre><li><p>处理了泛型 <code>impl</code> 块</p> <pre class=language-diff data-lang=diff style=color:#61676c;background-color:#fafafa><code class=language-diff data-lang=diff><span>}
</span><span style=color:#86b300>+
</span><span style=color:#86b300>+impl&LTT: Component> System for MySystem&LTT> {
</span></code></pre><li><p>保持了现有注释和属性标记的位置不变</p> <pre class=language-diff data-lang=diff style=color:#61676c;background-color:#fafafa><code class=language-diff data-lang=diff><span>/// 重要文档注释
</span><span>#[cfg(feature = "debug")]
</span><span style=color:#86b300>+
</span><span style=color:#86b300>+impl Debug for MyStruct {
</span></code></pre></ol><h3 id=ji-shu-ying-xiang>技术影响</h3><ol><li><strong>可读性提升</strong>：<code>impl</code> 块现在有清晰的视觉分隔<li><strong>一致性增强</strong>：整个代码库采用统一格式标准<li><strong>零功能影响</strong>：纯空白字符修改，不改变任何代码逻辑<li><strong>贡献者体验</strong>：明确了 Bevy 的代码格式规范</ol><p>该修改展示了自动化代码格式维护的价值：<ul><li>小规模一致性修复能提升长期可维护性<li>简单工具可解决广泛存在的微小问题<li>明确代码规范减少未来贡献中的格式争议</ul><h2 id=ke-shi-hua-bian-geng-fan-wei>可视化变更范围</h2><pre class=language-mermaid data-lang=mermaid style=color:#61676c;background-color:#fafafa><code class=language-mermaid data-lang=mermaid><span>graph TD
</span><span>    A[代码风格调整] --> B[bevy_ecs]
</span><span>    A --> C[bevy_math]
</span><span>    A --> D[bevy_reflect]
</span><span>    A --> E[bevy_window]
</span><span>    A --> F[bevy_asset]
</span><span>    A --> G[bevy_render]
</span><span>    A --> H[...其他43个模块]
</span></code></pre><h2 id=guan-jian-wen-jian-bian-geng>关键文件变更</h2><h3 id=crates-bevy-window-src-event-rs-26-0>crates/bevy_window/src/event.rs (+26/-0)</h3><p>添加了多个 <code>impl From&LTT> for WindowEvent</code> 实现前的空行，增强事件系统相关实现的可读性。<pre class=language-diff data-lang=diff style=color:#61676c;background-color:#fafafa><code class=language-diff data-lang=diff><span> impl From&LTAppLifecycle> for WindowEvent {
</span><span>     fn from(e: AppLifecycle) -> Self {
</span><span>         Self::AppLifecycle(e)
</span><span>     }
</span><span> }
</span><span style=color:#86b300>+
</span><span style=color:#86b300>+impl From&LTCursorEntered> for WindowEvent {
</span><span style=color:#86b300>+    fn from(e: CursorEntered) -> Self {
</span><span style=color:#86b300>+        Self::CursorEntered(e)
</span><span style=color:#86b300>+    }
</span><span style=color:#86b300>+}
</span><span style=color:#86b300>+
</span><span style=color:#86b300>+impl From&LTCursorLeft> for WindowEvent {
</span></code></pre><h3 id=crates-bevy-math-src-primitives-dim2-rs-18-0>crates/bevy_math/src/primitives/dim2.rs (+18/-0)</h3><p>在几何原语实现前添加空行，提升数学库代码的可读性。<pre class=language-diff data-lang=diff style=color:#61676c;background-color:#fafafa><code class=language-diff data-lang=diff><span> pub struct Circle {
</span><span>     pub radius: f32,
</span><span> }
</span><span style=color:#86b300>+
</span><span> impl Primitive2d for Circle {}
</span><span> 
</span><span> impl Default for Circle {
</span></code></pre><h3 id=crates-bevy-math-src-primitives-dim3-rs-14-0>crates/bevy_math/src/primitives/dim3.rs (+14/-0)</h3><p>统一 3D 原语实现的格式风格，与 2D 原语修改保持一致。<pre class=language-diff data-lang=diff style=color:#61676c;background-color:#fafafa><code class=language-diff data-lang=diff><span> pub struct Sphere {
</span><span>     pub radius: f32,
</span><span> }
</span><span style=color:#86b300>+
</span><span> impl Primitive3d for Sphere {}
</span><span> 
</span><span> impl Default for Sphere {
</span></code></pre><h3 id=crates-bevy-reflect-src-tuple-rs-12-0>crates/bevy_reflect/src/tuple.rs (+12/-0)</h3><p>在元组反射实现前添加空行，提升派生宏生成代码的可读性。<pre class=language-diff data-lang=diff style=color:#61676c;background-color:#fafafa><code class=language-diff data-lang=diff><span> impl_reflect_tuple! {}
</span><span style=color:#86b300>+
</span><span> impl_reflect_tuple! {0: A}
</span><span style=color:#86b300>+
</span><span> impl_reflect_tuple! {0: A, 1: B}
</span></code></pre><h3 id=crates-bevy-math-src-primitives-polygon-rs-8-0>crates/bevy_math/src/primitives/polygon.rs (+8/-0)</h3><p>在多边形算法实现前添加空行，提升几何处理代码的可读性。<pre class=language-diff data-lang=diff style=color:#61676c;background-color:#fafafa><code class=language-diff data-lang=diff><span> struct SweepLineEvent {
</span><span>     endpoint: Endpoint,
</span><span> }
</span><span style=color:#86b300>+
</span><span> impl SweepLineEvent {
</span><span>     #[cfg_attr(
</span><span>         not(feature = "alloc"),
</span></code></pre><h2 id=wan-zheng-dai-ma-bian-geng>完整代码变更</h2><pre class=language-diff data-lang=diff style=color:#61676c;background-color:#fafafa><code class=language-diff data-lang=diff><span>diff --git a/benches/benches/bevy_ecs/change_detection.rs b/benches/benches/bevy_ecs/change_detection.rs
</span><span>index 92f3251abc2b4..3cfa5bcbed8df 100644
</span><span style=color:#c594c5>--- a/benches/benches/bevy_ecs/change_detection.rs
</span><span style=color:#c594c5>+++ b/benches/benches/bevy_ecs/change_detection.rs
</span><span style=color:#c594c5>@@ -49,6 +49,7 @@ </span><span style=color:#399ee6>impl BenchModify for Table {
</span><span>         black_box(self.0)
</span><span>     }
</span><span> }
</span><span style=color:#86b300>+
</span><span> impl BenchModify for Sparse {
</span><span>     fn bench_modify(&mut self) -> f32 {
</span><span>         self.0 += 1f32;
</span><span>diff --git a/crates/bevy_app/src/propagate.rs b/crates/bevy_app/src/propagate.rs
</span><span>index 754ba3140ee3c..c6ac5139b92e8 100644
</span><span style=color:#c594c5>--- a/crates/bevy_app/src/propagate.rs
</span><span style=color:#c594c5>+++ b/crates/bevy_app/src/propagate.rs
</span><span style=color:#c594c5>@@ -88,6 +88,7 @@ </span><span style=color:#399ee6>impl&LTC: Component + Clone + PartialEq> core::fmt::Debug for PropagateSet&LTC> {
</span><span> }
</span><span> 
</span><span> impl&LTC: Component + Clone + PartialEq> Eq for PropagateSet&LTC> {}
</span><span style=color:#86b300>+
</span><span> impl&LTC: Component + Clone + PartialEq> core::hash::Hash for PropagateSet&LTC> {
</span><span>     fn hash&LTH: core::hash::Hasher>(&self, state: &mut H) {
</span><span>         self._p.hash(state);
</span><span>diff --git a/crates/bevy_asset/src/direct_access_ext.rs b/crates/bevy_asset/src/direct_access_ext.rs
</span><span>index 792d523a30063..e7e5b993deb85 100644
</span><span style=color:#c594c5>--- a/crates/bevy_asset/src/direct_access_ext.rs
</span><span style=color:#c594c5>+++ b/crates/bevy_asset/src/direct_access_ext.rs
</span><span style=color:#c594c5>@@ -20,6 +20,7 @@ </span><span style=color:#399ee6>pub trait DirectAssetAccessExt {
</span><span>         settings: impl Fn(&mut S) + Send + Sync + 'static,
</span><span>     ) -> Handle&LTA>;
</span><span> }
</span><span style=color:#86b300>+
</span><span> impl DirectAssetAccessExt for World {
</span><span>     /// Insert an asset similarly to [`Assets::add`].
</span><span>     ///
</span><span>diff --git a/crates/bevy_asset/src/io/embedded/embedded_watcher.rs b/crates/bevy_asset/src/io/embedded/embedded_watcher.rs
</span><span>index f7fb56be747b4..06a0791a501c0 100644
</span><span style=color:#c594c5>--- a/crates/bevy_asset/src/io/embedded/embedded_watcher.rs
</span><span style=color:#c594c5>+++ b/crates/bevy_asset/src/io/embedded/embedded_watcher.rs
</span><span style=color:#c594c5>@@ -56,6 +56,7 @@ </span><span style=color:#399ee6>pub(crate) struct EmbeddedEventHandler {
</span><span>     dir: Dir,
</span><span>     last_event: Option&LTAssetSourceEvent>,
</span><span> }
</span><span style=color:#86b300>+
</span><span> impl FilesystemEventHandler for EmbeddedEventHandler {
</span><span>     fn begin(&mut self) {
</span><span>         self.last_event = None;
</span><span>diff --git a/crates/bevy_asset/src/io/embedded/mod.rs b/crates/bevy_asset/src/io/embedded/mod.rs
</span><span>index f6c44397fc16f..c49d55ca4ab9b 100644
</span><span style=color:#c594c5>--- a/crates/bevy_asset/src/io/embedded/mod.rs
</span><span style=color:#c594c5>+++ b/crates/bevy_asset/src/io/embedded/mod.rs
</span><span style=color:#c594c5>@@ -141,16 +141,19 @@ </span><span style=color:#399ee6>impl EmbeddedAssetRegistry {
</span><span> pub trait GetAssetServer {
</span><span>     fn get_asset_server(&self) -> &AssetServer;
</span><span> }
</span><span style=color:#86b300>+
</span><span> impl GetAssetServer for App {
</span><span>     fn get_asset_server(&self) -> &AssetServer {
</span><span>         self.world().get_asset_server()
</span><span>     }
</span><span> }
</span><span style=color:#86b300>+
</span><span> impl GetAssetServer for World {
</span><span>     fn get_asset_server(&self) -> &AssetServer {
</span><span>         self.resource()
</span><span>     }
</span><span> }
</span><span style=color:#86b300>+
</span><span> impl GetAssetServer for AssetServer {
</span><span>     fn get_asset_server(&self) -> &AssetServer {
</span><span>         self
</span><span>diff --git a/crates/bevy_asset/src/reflect.rs b/crates/bevy_asset/src/reflect.rs
</span><span>index 6c470891bd59b..a3148cecb73f5 100644
</span><span style=color:#c594c5>--- a/crates/bevy_asset/src/reflect.rs
</span><span style=color:#c594c5>+++ b/crates/bevy_asset/src/reflect.rs
</span><span style=color:#c594c5>@@ -223,6 +223,7 @@ </span><span style=color:#399ee6>pub struct ReflectHandle {
</span><span>     downcast_handle_untyped: fn(&dyn Any) -> Option&LTUntypedHandle>,
</span><span>     typed: fn(UntypedHandle) -> Box&LTdyn Reflect>,
</span><span> }
</span><span style=color:#86b300>+
</span><span> impl ReflectHandle {
</span><span>     /// The [`TypeId`] of the asset
</span><span>     pub fn asset_type_id(&self) -> TypeId {
</span><span>diff --git a/crates/bevy_audio/src/audio_output.rs b/crates/bevy_audio/src/audio_output.rs
</span><span>index 9fc757af443ff..d02d326501298 100644
</span><span style=color:#c594c5>--- a/crates/bevy_audio/src/audio_output.rs
</span><span style=color:#c594c5>+++ b/crates/bevy_audio/src/audio_output.rs
</span><span style=color:#c594c5>@@ -57,6 +57,7 @@ </span><span style=color:#399ee6>pub struct PlaybackRemoveMarker;
</span><span> pub(crate) struct EarPositions<'w, 's> {
</span><span>     pub(crate) query: Query<'w, 's, (Entity, &'static GlobalTransform, &'static SpatialListener)>,
</span><span> }
</span><span style=color:#86b300>+
</span><span> impl<'w, 's> EarPositions<'w, 's> {
</span><span>     /// Gets a set of transformed ear positions.
</span><span>     ///
</span><span>diff --git a/crates/bevy_core_pipeline/src/core_3d/camera_3d.rs b/crates/bevy_core_pipeline/src/core_3d/camera_3d.rs
</span><span>index 9bcb2b4f80919..f5314c736dd40 100644
</span><span style=color:#c594c5>--- a/crates/bevy_core_pipeline/src/core_3d/camera_3d.rs
</span><span style=color:#c594c5>+++ b/crates/bevy_core_pipeline/src/core_3d/camera_3d.rs
</span><span style=color:#c594c5>@@ -80,6 +80,7 @@ </span><span style=color:#399ee6>impl From&LTTextureUsages> for Camera3dDepthTextureUsage {
</span><span>         Self(value.bits())
</span><span>     }
</span><span> }
</span><span style=color:#86b300>+
</span><span> impl From&LTCamera3dDepthTextureUsage> for TextureUsages {
</span><span>     fn from(value: Camera3dDepthTextureUsage) -> Self {
</span><span>         Self::from_bits_truncate(value.0)
</span><span>diff --git a/crates/bevy_diagnostic/src/frame_time_diagnostics_plugin.rs b/crates/bevy_diagnostic/src/frame_time_diagnostics_plugin.rs
</span><span>index a632c1b49abc4..df195a61226dc 100644
</span><span style=color:#c594c5>--- a/crates/bevy_diagnostic/src/frame_time_diagnostics_plugin.rs
</span><span style=color:#c594c5>+++ b/crates/bevy_diagnostic/src/frame_time_diagnostics_plugin.rs
</span><span style=color:#c594c5>@@ -17,11 +17,13 @@ </span><span style=color:#399ee6>pub struct FrameTimeDiagnosticsPlugin {
</span><span>     /// The smoothing factor for the exponential moving average. Usually `2.0 / (history_length + 1.0)`.
</span><span>     pub smoothing_factor: f64,
</span><span> }
</span><span style=color:#86b300>+
</span><span> impl Default for FrameTimeDiagnosticsPlugin {
</span><span>     fn default() -> Self {
</span><span>         Self::new(DEFAULT_MAX_HISTORY_LENGTH)
</span><span>     }
</span><span> }
</span><span style=color:#86b300>+
</span><span> impl FrameTimeDiagnosticsPlugin {
</span><span>     /// Creates a new `FrameTimeDiagnosticsPlugin` with the specified `max_history_length` and a
</span><span>     /// reasonable `smoothing_factor`.
</span><span>diff --git a/crates/bevy_ecs/src/archetype.rs b/crates/bevy_ecs/src/archetype.rs
</span><span>index 34a2a4c8130b8..1ecbad16a1a37 100644
</span><span style=color:#c594c5>--- a/crates/bevy_ecs/src/archetype.rs
</span><span style=color:#c594c5>+++ b/crates/bevy_ecs/src/archetype.rs
</span><span style=color:#c594c5>@@ -960,6 +960,7 @@ </span><span style=color:#399ee6>impl Index&LTRangeFrom&LTArchetypeGeneration>> for Archetypes {
</span><span>         &self.archetypes[index.start.0.index()..]
</span><span>     }
</span><span> }
</span><span style=color:#86b300>+
</span><span> impl Index&LTArchetypeId> for Archetypes {
</span><span>     type Output = Archetype;
</span><span> 
</span><span>diff --git a/crates/bevy_ecs/src/component.rs b/crates/bevy_ecs/src/component.rs
</span><span>index cfcde29ab2ff1..831402240d394 100644
</span><span style=color:#c594c5>--- a/crates/bevy_ecs/src/component.rs
</span><span style=color:#c594c5>+++ b/crates/bevy_ecs/src/component.rs
</span><span style=color:#c594c5>@@ -623,6 +623,7 @@ </span><span style=color:#399ee6>pub trait ComponentMutability: private::Seal + 'static {
</span><span> pub struct Immutable;
</span><span> 
</span><span> impl private::Seal for Immutable {}
</span><span style=color:#86b300>+
</span><span> impl ComponentMutability for Immutable {
</span><span>     const MUTABLE: bool = false;
</span><span> }
</span><span style=color:#c594c5>@@ -633,6 +634,7 @@ </span><span style=color:#399ee6>impl ComponentMutability for Immutable {
</span><span> pub struct Mutable;
</span><span> 
</span><span> impl private::Seal for Mutable {}
</span><span style=color:#86b300>+
</span><span> impl ComponentMutability for Mutable {
</span><span>     const MUTABLE: bool = true;
</span><span> }
</span><span style=color:#c594c5>@@ -2968,6 +2970,7 @@ </span><span style=color:#399ee6>impl&LTT> Default for DefaultCloneBehaviorSpecialization&LTT> {
</span><span> pub trait DefaultCloneBehaviorBase {
</span><span>     fn default_clone_behavior(&self) -> ComponentCloneBehavior;
</span><span> }
</span><span style=color:#86b300>+
</span><span> impl&LTC> DefaultCloneBehaviorBase for DefaultCloneBehaviorSpecialization&LTC> {
</span><span>     fn default_clone_behavior(&self) -> ComponentCloneBehavior {
</span><span>         ComponentCloneBehavior::Default
</span><span style=color:#c594c5>@@ -2979,6 +2982,7 @@ </span><span style=color:#399ee6>impl&LTC> DefaultCloneBehaviorBase for DefaultCloneBehaviorSpecialization&LTC> {
</span><span> pub trait DefaultCloneBehaviorViaClone {
</span><span>     fn default_clone_behavior(&self) -> ComponentCloneBehavior;
</span><span> }
</span><span style=color:#86b300>+
</span><span> impl&LTC: Clone + Component> DefaultCloneBehaviorViaClone for &DefaultCloneBehaviorSpecialization&LTC> {
</span><span>     fn default_clone_behavior(&self) -> ComponentCloneBehavior {
</span><span>         ComponentCloneBehavior::clone::&LTC>()
</span><span>diff --git a/crates/bevy_ecs/src/entity/mod.rs b/crates/bevy_ecs/src/entity/mod.rs
</span><span>index 02d9698917840..700a4e517fc3f 100644
</span><span style=color:#c594c5>--- a/crates/bevy_ecs/src/entity/mod.rs
</span><span style=color:#c594c5>+++ b/crates/bevy_ecs/src/entity/mod.rs
</span><span style=color:#c594c5>@@ -718,6 +718,7 @@ </span><span style=color:#399ee6>impl<'a> Iterator for ReserveEntitiesIterator<'a> {
</span><span> }
</span><span> 
</span><span> impl<'a> ExactSizeIterator for ReserveEntitiesIterator<'a> {}
</span><span style=color:#86b300>+
</span><span> impl<'a> core::iter::FusedIterator for ReserveEntitiesIterator<'a> {}
</span><span> 
</span><span> // SAFETY: Newly reserved entity values are unique.
</span><span>diff --git a/crates/bevy_ecs/src/entity/unique_array.rs b/crates/bevy_ecs/src/entity/unique_array.rs
</span><span>index ce31e55448f35..71df33ec5f42c 100644
</span><span style=color:#c594c5>--- a/crates/bevy_ecs/src/entity/unique_array.rs
</span><span style=color:#c594c5>+++ b/crates/bevy_ecs/src/entity/unique_array.rs
</span><span style=color:#c594c5>@@ -154,6 +154,7 @@ </span><span style=color:#399ee6>impl&LTT: EntityEquivalent, const N: usize> DerefMut for UniqueEntityEquivalentArr
</span><span>         unsafe { UniqueEntityEquivalentSlice::from_slice_unchecked_mut(&mut self.0) }
</span><span>     }
</span><span> }
</span><span style=color:#86b300>+
</span><span> impl&LTT: EntityEquivalent> Default for UniqueEntityEquivalentArray&LTT, 0> {
</span><span>     fn default() -> Self {
</span><span>         Self(Default::default())
</span><span style=color:#c594c5>@@ -527,6 +528,7 @@ </span><span style=color:#399ee6>impl&LTT: PartialEq&LTU>, U: EntityEquivalent, const N: usize>
</span><span>         self.eq(&other.0)
</span><span>     }
</span><span> }
</span><span style=color:#86b300>+
</span><span> impl&LTT: PartialEq&LTU>, U: EntityEquivalent, const N: usize>
</span><span>     PartialEq<&UniqueEntityEquivalentArray&LTU, N>> for VecDeque&LTT>
</span><span> {
</span><span style=color:#c594c5>@@ -550,6 +552,7 @@ </span><span style=color:#399ee6>impl&LTT: PartialEq&LTU>, U: EntityEquivalent, const N: usize>
</span><span>         self.eq(&other.0)
</span><span>     }
</span><span> }
</span><span style=color:#86b300>+
</span><span> impl&LTT: PartialEq&LTU>, U: EntityEquivalent, const N: usize>
</span><span>     PartialEq&LTUniqueEntityEquivalentArray&LTU, N>> for VecDeque&LTT>
</span><span> {
</span><span>diff --git a/crates/bevy_ecs/src/name.rs b/crates/bevy_ecs/src/name.rs
</span><span>index 67719ca18d1e2..317c8f5017bb5 100644
</span><span style=color:#c594c5>--- a/crates/bevy_ecs/src/name.rs
</span><span style=color:#c594c5>+++ b/crates/bevy_ecs/src/name.rs
</span><span style=color:#c594c5>@@ -159,6 +159,7 @@ </span><span style=color:#399ee6>impl From<&str> for Name {
</span><span>         Name::new(name.to_owned())
</span><span>     }
</span><span> }
</span><span style=color:#86b300>+
</span><span> impl From&LTString> for Name {
</span><span>     #[inline(always)]
</span><span>     fn from(name: String) -> Self {
</span><span style=color:#c594c5>@@ -174,12 +175,14 @@ </span><span style=color:#399ee6>impl AsRef&LTstr> for Name {
</span><span>         &self.name
</span><span>     }
</span><span> }
</span><span style=color:#86b300>+
</span><span> impl From<&Name> for String {
</span><span>     #[inline(always)]
</span><span>     fn from(val: &Name) -> String {
</span><span>         val.as_str().to_owned()
</span><span>     }
</span><span> }
</span><span style=color:#86b300>+
</span><span> impl From&LTName> for String {
</span><span>     #[inline(always)]
</span><span>     fn from(val: Name) -> String {
</span><span>diff --git a/crates/bevy_ecs/src/query/fetch.rs b/crates/bevy_ecs/src/query/fetch.rs
</span><span>index 0a13b6181974d..2564223972130 100644
</span><span style=color:#c594c5>--- a/crates/bevy_ecs/src/query/fetch.rs
</span><span style=color:#c594c5>+++ b/crates/bevy_ecs/src/query/fetch.rs
</span><span style=color:#c594c5>@@ -1489,6 +1489,7 @@ </span><span style=color:#399ee6>impl&LTT: Component> Clone for ReadFetch<'_, T> {
</span><span>         *self
</span><span>     }
</span><span> }
</span><span style=color:#86b300>+
</span><span> impl&LTT: Component> Copy for ReadFetch<'_, T> {}
</span><span> 
</span><span> /// SAFETY:
</span><span style=color:#c594c5>@@ -1665,6 +1666,7 @@ </span><span style=color:#399ee6>impl&LTT: Component> Clone for RefFetch<'_, T> {
</span><span>         *self
</span><span>     }
</span><span> }
</span><span style=color:#86b300>+
</span><span> impl&LTT: Component> Copy for RefFetch<'_, T> {}
</span><span> 
</span><span> /// SAFETY:
</span><span style=color:#c594c5>@@ -1873,6 +1875,7 @@ </span><span style=color:#399ee6>impl&LTT: Component> Clone for WriteFetch<'_, T> {
</span><span>         *self
</span><span>     }
</span><span> }
</span><span style=color:#86b300>+
</span><span> impl&LTT: Component> Copy for WriteFetch<'_, T> {}
</span><span> 
</span><span> /// SAFETY:
</span><span>diff --git a/crates/bevy_ecs/src/query/filter.rs b/crates/bevy_ecs/src/query/filter.rs
</span><span>index 312b330e04c3b..f9f4861b796ee 100644
</span><span style=color:#c594c5>--- a/crates/bevy_ecs/src/query/filter.rs
</span><span style=color:#c594c5>+++ b/crates/bevy_ecs/src/query/filter.rs
</span><span style=color:#c594c5>@@ -1240,6 +1240,7 @@ </span><span style=color:#399ee6>unsafe impl QueryFilter for Spawned {
</span><span> pub trait ArchetypeFilter: QueryFilter {}
</span><span> 
</span><span> impl&LTT: Component> ArchetypeFilter for With&LTT> {}
</span><span style=color:#86b300>+
</span><span> impl&LTT: Component> ArchetypeFilter for Without&LTT> {}
</span><span> 
</span><span> macro_rules! impl_archetype_filter_tuple {
</span><span>diff --git a/crates/bevy_ecs/src/schedule/pass.rs b/crates/bevy_ecs/src/schedule/pass.rs
</span><span>index 20680e04e032c..a602877d65de2 100644
</span><span style=color:#c594c5>--- a/crates/bevy_ecs/src/schedule/pass.rs
</span><span style=color:#c594c5>+++ b/crates/bevy_ecs/src/schedule/pass.rs
</span><span style=color:#c594c5>@@ -51,6 +51,7 @@ </span><span style=color:#399ee6>pub(super) trait ScheduleBuildPassObj: Send + Sync + Debug {
</span><span>     );
</span><span>     fn add_dependency(&mut self, from: NodeId, to: NodeId, all_options: &TypeIdMap&LTBox&LTdyn Any>>);
</span><span> }
</span><span style=color:#86b300>+
</span><span> impl&LTT: ScheduleBuildPass> ScheduleBuildPassObj for T {
</span><span>     fn build(
</span><span>         &mut self,
</span><span>diff --git a/crates/bevy_ecs/src/schedule/schedule.rs b/crates/bevy_ecs/src/schedule/schedule.rs
</span><span>index 3c67f1ea0782e..4455aba2fe3a7 100644
</span><span style=color:#c594c5>--- a/crates/bevy_ecs/src/schedule/schedule.rs
</span><span style=color:#c594c5>+++ b/crates/bevy_ecs/src/schedule/schedule.rs
</span><span style=color:#c594c5>@@ -235,6 +235,7 @@ </span><span style=color:#399ee6>pub enum Chain {
</span><span>     /// will be added between the successive elements.
</span><span>     Chained(TypeIdMap&LTBox&LTdyn Any>>),
</span><span> }
</span><span style=color:#86b300>+
</span><span> impl Chain {
</span><span>     /// Specify that the systems must be chained.
</span><span>     pub fn set_chained(&mut self) {
</span><span>diff --git a/crates/bevy_ecs/src/spawn.rs b/crates/bevy_ecs/src/spawn.rs
</span><span>index d5014f22409fd..0c30c14b9cc54 100644
</span><span style=color:#c594c5>--- a/crates/bevy_ecs/src/spawn.rs
</span><span style=color:#c594c5>+++ b/crates/bevy_ecs/src/spawn.rs
</span><span style=color:#c594c5>@@ -210,6 +210,7 @@ </span><span style=color:#399ee6>unsafe impl&LTR: Relationship, L: SpawnableList&LTR> + Send + Sync + 'static> Bundle
</span><span>         );
</span><span>     }
</span><span> }
</span><span style=color:#86b300>+
</span><span> impl&LTR: Relationship, L: SpawnableList&LTR>> DynamicBundle for SpawnRelatedBundle&LTR, L> {
</span><span>     type Effect = Self;
</span><span> 
</span><span>diff --git a/crates/bevy_ecs/src/system/observer_system.rs b/crates/bevy_ecs/src/system/observer_system.rs
</span><span>index 8e927d9529a32..243c2c3c3f6ae 100644
</span><span style=color:#c594c5>--- a/crates/bevy_ecs/src/system/observer_system.rs
</span><span style=color:#c594c5>+++ b/crates/bevy_ecs/src/system/observer_system.rs
</span><span style=color:#c594c5>@@ -73,6 +73,7 @@ </span><span style=color:#399ee6>where
</span><span>         InfallibleObserverWrapper::new(IntoSystem::into_system(this))
</span><span>     }
</span><span> }
</span><span style=color:#86b300>+
</span><span> impl&LTE, B, M, S> IntoObserverSystem&LTE, B, (</span></code></pre></div><div data-is-md-page=true data-patch-exists=true data-patch-path=/pull_request/bevy/2025-06/pr_19746.patch id=patch-info style=display:none></div><div class=bottom-spacer></div></div></div>