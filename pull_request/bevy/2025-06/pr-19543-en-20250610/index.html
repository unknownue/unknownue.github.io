<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://unknownue.github.io name=base><title>
         #19543 Component lifecycle reorganization and documentation
        
    </title><meta content="#19543 Component lifecycle reorganization and documentation" property=og:title><meta content="A personal blog built with Zola and Apollo theme" property=og:description><meta content="A personal blog built with Zola and Apollo theme" name=description><link href=/icons/favicon.png rel=icon type=image/png><link href=https://unknownue.github.io/fonts.css rel=stylesheet><script src=https://unknownue.github.io/js/codeblock.js></script><script src=https://unknownue.github.io/js/toc.js></script><script src=https://unknownue.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Unknownue's Blog" href=https://unknownue.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://unknownue.github.io/theme/light.css rel=stylesheet><link href=https://unknownue.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://unknownue.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://unknownue.github.io/main.css media=screen rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js></script><script>// Initialize mermaid once DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            mermaid.initialize({
                startOnLoad: false,
                theme: document.body && document.body.classList.contains('dark') ? 'dark' : 'default',
                securityLevel: 'loose',
                flowchart: {
                    useMaxWidth: true,
                    htmlLabels: true
                },
                sequence: {
                    diagramMarginX: 50,
                    diagramMarginY: 10,
                    actorMargin: 50,
                    width: 150,
                    height: 65
                }
            });
        });</script><script src=https://unknownue.github.io/js/main.js></script><script defer src=https://unknownue.github.io/js/label-colors.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/rust.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/typescript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/go.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/cpp.min.js></script><script>// Ensure highlight.js is properly configured
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof hljs !== 'undefined') {
                hljs.configure({
                    languages: ['rust', 'javascript', 'python', 'cpp', 'go', 'typescript'],
                    ignoreUnescapedHTML: true
                });
                console.log('Highlight.js configured in header');
            }
        });</script><link href=https://cdn.jsdelivr.net/npm/diff2html/bundles/css/diff2html.min.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/diff2html/bundles/js/diff2html-ui.min.js></script><script src=https://unknownue.github.io/js/syntax-highlight.js></script><script src=https://unknownue.github.io/js/diff-sidebar.js></script><script src="https://unknownue.github.io/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><div class=content><header><div class=main><a href=https://unknownue.github.io>Unknownue's Blog</a><div class=socials><a class=social href=https://github.com/unknownue rel=me> <img alt=github src=https://unknownue.github.io/icons/social/github.svg> </a><a class=social href=https://github.com/unknownue/unknownue.github.io rel=me> <img alt=github-io src=https://unknownue.github.io/icons/social/rss.svg> </a></div></div><nav><a href=https://unknownue.github.io/posts style=margin-left:.25em>/posts</a><a href=https://unknownue.github.io/projects style=margin-left:.25em>/projects</a><a href=https://unknownue.github.io/about style=margin-left:.25em>/about</a><a href=https://unknownue.github.io/tags style=margin-left:.25em>/tags</a><button title="$SHORTCUT to open search" class=search-button id=search-button><img alt=Search class=search-icon src=https://unknownue.github.io/icons/search.svg></button><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><div id=modal-content><h1 class=page-header id=modalTitle>Search</h1><div id=searchBar><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search... role=combobox spellcheck=false><button title="Clear search" class=clear-button id=clear-search><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></button></div><div id=results-container><div id=results-info><span id=zero_results style=display:none>No results</span><span id=one_result style=display:none>1 result</span><span id=many_results style=display:none>$NUMBER results</span></div><div id=results role=listbox></div></div></div></div><a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://unknownue.github.io/icons/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://unknownue.github.io/icons/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><div class=pull-request-page><article class=md-content-page style=display:none></article><div class=back-link><a href=/pull_request/bevy/2025-06/>← Back to Pull Requests</a></div><div class=pr-metadata><span class=pr-date>2025-06-10</span><div class=language-switcher><span class="lang-link active" data-lang=en>English</span> / <a class=lang-link data-lang=zh-cn href=/pull_request/bevy/2025-06/pr-19543-zh-cn-20250610>中文</a></div></div><div class=pr-content><h2 id=component-lifecycle-reorganization-and-documentation>Component Lifecycle Reorganization and Documentation</h2><h3 id=basic-information>Basic Information</h3><ul><li><strong>Title</strong>: Component lifecycle reorganization and documentation<li><strong>PR Link</strong>: https://github.com/bevyengine/bevy/pull/19543<li><strong>Author</strong>: alice-i-cecile<li><strong>Status</strong>: MERGED<li><strong>Labels</strong>: C-Docs, A-ECS, C-Code-Quality, S-Ready-For-Final-Review, M-Needs-Migration-Guide, X-Uncontroversial, D-Straightforward<li><strong>Created</strong>: 2025-06-08T22:54:21Z<li><strong>Merged</strong>: 2025-06-10T01:17:36Z<li><strong>Merged By</strong>: alice-i-cecile</ul><h3 id=description>Description</h3><p><strong>Objective</strong><br> The primary goal was to clearly document the differences between component lifecycle events via module docs. However, no unified module existed—lifecycle code was scattered, making discovery of related types difficult and leaving no suitable location for documentation.<p><strong>Solution</strong><ol><li>Unified assorted types into a single <code>bevy_ecs::component_lifecycle</code> module<li>Added comprehensive documentation<li>Created a migration guide</ol><p><strong>Testing</strong><br> CI verification was sufficient for this organizational change.<p><strong>Follow-up</strong><ol><li>Lifecycle event names (particularly <code>OnReplace</code>) remain confusing and should be reconsidered<li>Observers require proper module documentation<li>Functional changes should be handled in separate PRs—this is purely documentation and reorganization</ol><h3 id=the-story-of-this-pull-request>The Story of This Pull Request</h3><h4 id=the-problem-and-context>The Problem and Context</h4><p>Component lifecycle events (<code>OnAdd</code>, <code>OnInsert</code>, <code>OnReplace</code>, <code>OnRemove</code>, <code>OnDespawn</code>) were scattered across multiple files (<code>component.rs</code>, <code>removal_detection.rs</code>, <code>world/component_constants.rs</code>). This fragmentation made it difficult for developers to:<ol><li>Discover related functionality<li>Understand event differences and usage<li>Maintain consistent documentation</ol><p>The lack of a central module also prevented cohesive documentation explaining critical distinctions like:<ul><li>When <code>OnAdd</code> (component newly added) vs <code>OnInsert</code> (any insertion) triggers<li>Order of operations during component replacement/removal<li>Appropriate use cases for hooks vs observers vs <code>RemovedComponents</code></ul><h4 id=the-solution-approach>The Solution Approach</h4><p>The solution focused on consolidation without functional changes:<ol><li>Create a dedicated <code>lifecycle</code> module for all event-related code<li>Migrate existing implementations preserving behavior<li>Write comprehensive module-level documentation<li>Provide clear migration instructions</ol><p>Key decisions included:<ul><li>Placing <code>RemovedComponents</code> in the same module since it addresses similar concerns<li>Keeping existing event names to avoid scope creep<li>Maintaining existing hook signatures during relocation</ul><h4 id=the-implementation>The Implementation</h4><p>The core changes centered on creating <code>crates/bevy_ecs/src/lifecycle.rs</code> (+606 LOC) and migrating functionality into it:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// New module structure in lifecycle.rs
</span><span style=color:#fa6e32>pub type </span><span style=color:#399ee6>ComponentHook </span><span style=color:#ed9366>= </span><span style=color:#fa6e32>for</span><span style=color:#ed9366><</span><span style=color:#fa6e32>'w</span><span style=color:#ed9366>> </span><span style=color:#fa6e32>fn</span><span>(DeferredWorld<</span><span style=color:#fa6e32>'w</span><span>></span><span style=color:#61676ccc>,</span><span> HookContext)</span><span style=color:#61676ccc>;
</span><span style=color:#fa6e32>pub struct </span><span style=color:#399ee6>HookContext </span><span>{ ... }
</span><span>
</span><span style=color:#fa6e32>pub struct </span><span style=color:#399ee6>ComponentHooks </span><span>{
</span><span>    </span><span style=color:#fa6e32>pub</span><span>(</span><span style=color:#fa6e32>crate</span><span>) on_add</span><span style=color:#61676ccc>: </span><span style=color:#55b4d4;font-style:italic>Option</span><span>&LTComponentHook>,
</span><span>    </span><span style=color:#fa6e32>pub</span><span>(</span><span style=color:#fa6e32>crate</span><span>) on_insert</span><span style=color:#61676ccc>: </span><span style=color:#55b4d4;font-style:italic>Option</span><span>&LTComponentHook>,
</span><span>    </span><span style=color:#abb0b6;font-style:italic>// ... other hooks
</span><span>}
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// Lifecycle event definitions
</span><span style=color:#fa6e32>pub struct </span><span style=color:#399ee6>OnAdd</span><span style=color:#61676ccc>;
</span><span style=color:#fa6e32>pub struct </span><span style=color:#399ee6>OnInsert</span><span style=color:#61676ccc>;
</span><span style=color:#fa6e32>pub struct </span><span style=color:#399ee6>OnReplace</span><span style=color:#61676ccc>;
</span><span style=color:#fa6e32>pub struct </span><span style=color:#399ee6>OnRemove</span><span style=color:#61676ccc>;
</span><span style=color:#fa6e32>pub struct </span><span style=color:#399ee6>OnDespawn</span><span style=color:#61676ccc>;
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// RemovedComponents implementation
</span><span style=color:#fa6e32>pub struct </span><span style=color:#399ee6>RemovedComponentEvents </span><span>{ ... }
</span><span style=color:#fa6e32>pub struct </span><span style=color:#399ee6>RemovedComponents</span><span><</span><span style=color:#fa6e32>'w</span><span>, </span><span style=color:#fa6e32>'s</span><span>, T</span><span style=color:#61676ccc>:</span><span> Component> { ... }
</span></code></pre><p>Key migrations included:<ol><li>Moving hook definitions from <code>component.rs</code> (-242 LOC)<li>Transferring <code>RemovedComponents</code> from <code>removal_detection.rs</code> (-268 LOC)<li>Relocating event triggers from <code>world/component_constants.rs</code> (-55 LOC)</ol><p>Documentation was added explaining event sequencing and use cases:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>//! There are five types of lifecycle events, split into two categories...
</span><span style=color:#abb0b6;font-style:italic>//!
</span><span style=color:#abb0b6;font-style:italic>//! 1. Lifecycle events triggered when a component is added:
</span><span style=color:#abb0b6;font-style:italic>//!    - `OnAdd`: Triggered when a component is added to an entity that didn't have it
</span><span style=color:#abb0b6;font-style:italic>//!    - `OnInsert`: Triggered on any insertion (runs after `OnAdd`)
</span><span style=color:#abb0b6;font-style:italic>//!
</span><span style=color:#abb0b6;font-style:italic>//! 2. Lifecycle events triggered when a component is removed:
</span><span style=color:#abb0b6;font-style:italic>//!    - `OnReplace`: Triggered before removal/replacement
</span><span style=color:#abb0b6;font-style:italic>//!    - `OnRemove`: Triggered when removed without replacement
</span><span style=color:#abb0b6;font-style:italic>//!    - `OnDespawn`: Triggered per-component during despawning
</span></code></pre><h4 id=technical-insights>Technical Insights</h4><p>The reorganization revealed several important relationships:<ol><li><strong>Event Sequencing</strong>: <ul><li><code>OnAdd</code> → <code>OnInsert</code> during additions<li><code>OnReplace</code> → <code>OnRemove</code> → <code>OnDespawn</code> during removals</ul><li><strong>Complementary Pairs</strong>: <ul><li><code>OnAdd</code>/<code>OnRemove</code> handle presence changes<li><code>OnInsert</code>/<code>OnReplace</code> handle all mutations</ul><li><strong>Cache Reliability</strong>: <ul><li><code>OnInsert</code>/<code>OnReplace</code> require immutable components for reliable cache updates<li>Mutation-only changes don’t trigger hooks</ul></ol><p>The module now serves as the authoritative source for:<ul><li>Hook registration APIs (<code>on_add()</code>, <code>on_insert()</code>, etc.)<li><code>RemovedComponents</code> system parameter usage<li>Lifecycle event semantics</ul><h4 id=the-impact>The Impact</h4><p>The changes provide three key benefits:<ol><li><strong>Improved Discoverability</strong>: All lifecycle functionality exists in one module<li><strong>Clearer Documentation</strong>: Centralized explanations of event differences<li><strong>Simplified Maintenance</strong>: Logical grouping of related functionality</ol><p>Developers can now:<ul><li>Quickly locate lifecycle-related types<li>Understand event sequencing through module docs<li>Migrate using provided instructions</ul><p>The PR also fixed inconsistent terminology in event docs (e.g., “implementors” → “implementers”).<h3 id=visual-representation>Visual Representation</h3><pre class=language-mermaid data-lang=mermaid style=color:#61676c;background-color:#fafafa><code class=language-mermaid data-lang=mermaid><span>graph TD
</span><span>    A[Lifecycle Module] --> B[Hook Definitions]
</span><span>    A --> C[Event Triggers]
</span><span>    A --> D[RemovedComponents]
</span><span>    B --> E[ComponentHooks]
</span><span>    B --> F[HookContext]
</span><span>    C --> G[OnAdd]
</span><span>    C --> H[OnInsert]
</span><span>    C --> I[OnReplace]
</span><span>    C --> J[OnRemove]
</span><span>    C --> K[OnDespawn]
</span><span>    D --> L[RemovedComponentEvents]
</span><span>    D --> M[RemovedComponents SystemParam]
</span></code></pre><h3 id=key-files-changed>Key Files Changed</h3><ol><li><p><strong>crates/bevy_ecs/src/lifecycle.rs</strong> (+606/-0)<br> New module containing all lifecycle-related code:</p> <ul><li>Component hooks and context<li>Lifecycle event types<li><code>RemovedComponents</code> implementation</ul><li><p><strong>crates/bevy_ecs/src/removal_detection.rs</strong> (+0/-268)<br> Removed in favor of consolidated lifecycle module:</p></ol><pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before: removal_detection.rs
</span><span style=color:#fa6e32>pub struct </span><span style=color:#399ee6>RemovedComponentEvents </span><span>{ ... }
</span><span style=color:#fa6e32>pub struct </span><span style=color:#399ee6>RemovedComponents</span><span><</span><span style=color:#fa6e32>'w</span><span>, </span><span style=color:#fa6e32>'s</span><span>, T</span><span style=color:#61676ccc>:</span><span> Component> { ... }
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After: Migrated to lifecycle.rs
</span></code></pre><ol start=3><li><strong>crates/bevy_ecs/src/component.rs</strong> (+6/-242)<br> Moved hook-related code to lifecycle module:</ol><pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before: component.rs
</span><span style=color:#fa6e32>pub type </span><span style=color:#399ee6>ComponentHook </span><span style=color:#ed9366>= ... 
</span><span style=color:#fa6e32>pub struct </span><span style=color:#399ee6>HookContext </span><span>{ ... }
</span><span style=color:#fa6e32>pub struct </span><span style=color:#399ee6>ComponentHooks </span><span>{ ... }
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After: Only component metadata remains
</span></code></pre><ol start=4><li><strong>crates/bevy_ecs/src/world/component_constants.rs</strong> (+0/-55)<br> Lifecycle event triggers migrated:</ol><pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before: component_constants.rs
</span><span style=color:#fa6e32>pub struct </span><span style=color:#399ee6>OnAdd</span><span style=color:#61676ccc>;
</span><span style=color:#fa6e32>pub struct </span><span style=color:#399ee6>OnInsert</span><span style=color:#61676ccc>;
</span><span style=color:#abb0b6;font-style:italic>// ... other events
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After: Defined in lifecycle.rs
</span></code></pre><ol start=5><li><strong>crates/bevy_ecs/src/world/mod.rs</strong> (+10/-8)<br> Updated to reference new module location:</ol><pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Updated world/mod.rs imports
</span><span style=color:#fa6e32>use crate</span><span style=color:#ed9366>::</span><span>lifecycle</span><span style=color:#ed9366>::</span><span>{OnAdd</span><span style=color:#61676ccc>,</span><span> OnInsert</span><span style=color:#61676ccc>,</span><span> OnReplace</span><span style=color:#61676ccc>,</span><span> OnRemove</span><span style=color:#61676ccc>,</span><span> OnDespawn}</span><span style=color:#61676ccc>;
</span></code></pre><h3 id=further-reading>Further Reading</h3><ol><li><a rel="noopener nofollow noreferrer" href=https://bevyengine.org/learn/book/ECS/component-hooks/ target=_blank>Bevy ECS Component Hooks Documentation</a><li><a rel="noopener nofollow noreferrer" href=https://github.com/bevyengine/rfcs/pull/45 target=_blank>Lifecycle Events RFC Discussion</a><li><a rel="noopener nofollow noreferrer" href=https://github.com/SanderMertens/ecs-faq#observer-pattern target=_blank>Observer Pattern in ECS Systems</a></ol><h3 id=full-code-diff>Full Code Diff</h3><details><summary>View full diff</summary> <pre class=language-diff data-lang=diff style=color:#61676c;background-color:#fafafa><code class=language-diff data-lang=diff><span>diff --git a/crates/bevy_app/src/app.rs b/crates/bevy_app/src/app.rs
</span><span>index 61bbad3aedbd6..2adf6c2857571 100644
</span><span style=color:#c594c5>--- a/crates/bevy_app/src/app.rs
</span><span style=color:#c594c5>+++ b/crates/bevy_app/src/app.rs
</span><span style=color:#c594c5>@@ -1483,8 +1483,8 @@ </span><span style=color:#399ee6>mod tests {
</span><span>         component::Component,
</span><span>         entity::Entity,
</span><span>         event::{Event, EventWriter, Events},
</span><span style=color:#86b300>+        lifecycle::RemovedComponents,
</span><span>         query::With,
</span><span style=color:#f07171>-        removal_detection::RemovedComponents,
</span><span>         resource::Resource,
</span><span>         schedule::{IntoScheduleConfigs, ScheduleLabel},
</span><span>         system::{Commands, Query},
</span><span>diff --git a/crates/bevy_app/src/propagate.rs b/crates/bevy_app/src/propagate.rs
</span><span>index 5d766a626c218..754ba3140ee3c 100644
</span><span style=color:#c594c5>--- a/crates/bevy_app/src/propagate.rs
</span><span style=color:#c594c5>+++ b/crates/bevy_app/src/propagate.rs
</span><span style=color:#c594c5>@@ -6,9 +6,9 @@ </span><span style=color:#399ee6>use bevy_ecs::{
</span><span>     component::Component,
</span><span>     entity::Entity,
</span><span>     hierarchy::ChildOf,
</span><span style=color:#86b300>+    lifecycle::RemovedComponents,
</span><span>     query::{Changed, Or, QueryFilter, With, Without},
</span><span>     relationship::{Relationship, RelationshipTarget},
</span><span style=color:#f07171>-    removal_detection::RemovedComponents,
</span><span>     schedule::{IntoScheduleConfigs, SystemSet},
</span><span>     system::{Commands, Local, Query},
</span><span> };
</span><span>diff --git a/crates/bevy_core_pipeline/src/oit/mod.rs b/crates/bevy_core_pipeline/src/oit/mod.rs
</span><span>index 3ae95d71ccf12..5b5d038fa0580 100644
</span><span style=color:#c594c5>--- a/crates/bevy_core_pipeline/src/oit/mod.rs
</span><span style=color:#c594c5>+++ b/crates/bevy_core_pipeline/src/oit/mod.rs
</span><span style=color:#c594c5>@@ -1,7 +1,7 @@
</span><span> //! Order Independent Transparency (OIT) for 3d rendering. See [`OrderIndependentTransparencyPlugin`] for more details.
</span><span> 
</span><span> use bevy_app::prelude::*;
</span><span style=color:#f07171>-use bevy_ecs::{component::*, prelude::*};
</span><span style=color:#86b300>+use bevy_ecs::{component::*, lifecycle::ComponentHook, prelude::*};
</span><span> use bevy_math::UVec2;
</span><span> use bevy_platform::collections::HashSet;
</span><span> use bevy_platform::time::Instant;
</span><span>diff --git a/crates/bevy_ecs/compile_fail/tests/ui/component_hook_relationship.rs b/crates/bevy_ecs/compile_fail/tests/ui/component_hook_relationship.rs
</span><span>index 4076819ee3d9d..79c21586441b2 100644
</span><span style=color:#c594c5>--- a/crates/bevy_ecs/compile_fail/tests/ui/component_hook_relationship.rs
</span><span style=color:#c594c5>+++ b/crates/bevy_ecs/compile_fail/tests/ui/component_hook_relationship.rs
</span><span style=color:#c594c5>@@ -60,4 +60,4 @@ </span><span style=color:#399ee6>mod case4 {
</span><span>     pub struct BarTargetOf(Entity);
</span><span> }
</span><span> 
</span><span style=color:#f07171>-fn foo_hook(_world: bevy_ecs::world::DeferredWorld, _ctx: bevy_ecs::component::HookContext) {}
</span><span style=color:#86b300>+fn foo_hook(_world: bevy_ecs::world::DeferredWorld, _ctx: bevy_ecs::lifecycle::HookContext) {}
</span><span>diff --git a/crates/bevy_ecs/macros/src/component.rs b/crates/bevy_ecs/macros/src/component.rs
</span><span>index 00268cb680050..6a693f2ce5192 100644
</span><span style=color:#c594c5>--- a/crates/bevy_ecs/macros/src/component.rs
</span><span style=color:#c594c5>+++ b/crates/bevy_ecs/macros/src/component.rs
</span><span style=color:#c594c5>@@ -434,7 +434,7 @@ </span><span style=color:#399ee6>impl HookAttributeKind {
</span><span>             HookAttributeKind::Path(path) => path.to_token_stream(),
</span><span>             HookAttributeKind::Call(call) => {
</span><span>                 quote!({
</span><span style=color:#f07171>-                    fn _internal_hook(world: #bevy_ecs_path::world::DeferredWorld, ctx: #bevy_ecs_path::component::HookContext) {
</span><span style=color:#86b300>+                    fn _internal_hook(world: #bevy_ecs_path::world::DeferredWorld, ctx: #bevy_ecs_path::lifecycle::HookContext) {
</span><span>                         (#call)(world, ctx)
</span><span>                     }
</span><span>                     _internal_hook
</span><span style=color:#c594c5>@@ -658,7 +658,7 @@ </span><span style=color:#399ee6>fn hook_register_function_call(
</span><span> ) -> Option&LTTokenStream2> {
</span><span>     function.map(|meta| {
</span><span>         quote! {
</span><span style=color:#f07171>-            fn #hook() -> ::core::option::Option<#bevy_ecs_path::component::ComponentHook> {
</span><span style=color:#86b300>+            fn #hook() -> ::core::option::Option<#bevy_ecs_path::lifecycle::ComponentHook> {
</span><span>                 ::core::option::Option::Some(#meta)
</span><span>             }
</span><span>         }
</span><span>diff --git a/crates/bevy_ecs/src/archetype.rs b/crates/bevy_ecs/src/archetype.rs
</span><span>index 4e5b28dde82e6..7369028715fbe 100644
</span><span style=color:#c594c5>--- a/crates/bevy_ecs/src/archetype.rs
</span><span style=color:#c594c5>+++ b/crates/bevy_ecs/src/archetype.rs
</span><span style=color:#c594c5>@@ -693,7 +693,7 @@ </span><span style=color:#399ee6>impl Archetype {
</span><span> 
</span><span>     /// Returns true if any of the components in this archetype have at least one [`OnAdd`] observer
</span><span>     ///
</span><span style=color:#f07171>-    /// [`OnAdd`]: crate::world::OnAdd
</span><span style=color:#86b300>+    /// [`OnAdd`]: crate::lifecycle::OnAdd
</span><span>     #[inline]
</span><span>     pub fn has_add_observer(&self) -> bool {
</span><span>         self.flags().contains(ArchetypeFlags::ON_ADD_OBSERVER)
</span><span style=color:#c594c5>@@ -701,7 +701,7 @@ </span><span style=color:#399ee6>impl Archetype {
</span><span> 
</span><span>     /// Returns true if any of the components in this archetype have at least one [`OnInsert`] observer
</span><span>     ///
</span><span style=color:#f07171>-    /// [`OnInsert`]: crate::world::OnInsert
</span><span style=color:#86b300>+    /// [`OnInsert`]: crate::lifecycle::OnInsert
</span><span>     #[inline]
</span><span>     pub fn has_insert_observer(&self) -> bool {
</span><span>         self.flags().contains(ArchetypeFlags::ON_INSERT_OBSERVER)
</span><span style=color:#c594c5>@@ -709,7 +709,7 @@ </span><span style=color:#399ee6>impl Archetype {
</span><span> 
</span><span>     /// Returns true if any of the components in this archetype have at least one [`OnReplace`] observer
</span><span>     ///
</span><span style=color:#f07171>-    /// [`OnReplace`]: crate::world::OnReplace
</span><span style=color:#86b300>+    /// [`OnReplace`]: crate::lifecycle::OnReplace
</span><span>     #[inline]
</span><span>     pub fn has_replace_observer(&self) -> bool {
</span><span>         self.flags().contains(ArchetypeFlags::ON_REPLACE_OBSERVER)
</span><span style=color:#c594c5>@@ -717,7 +717,7 @@ </span><span style=color:#399ee6>impl Archetype {
</span><span> 
</span><span>     /// Returns true if any of the components in this archetype have at least one [`OnRemove`] observer
</span><span>     ///
</span><span style=color:#f07171>-    /// [`OnRemove`]: crate::world::OnRemove
</span><span style=color:#86b300>+    /// [`OnRemove`]: crate::lifecycle::OnRemove
</span><span>     #[inline]
</span><span>     pub fn has_remove_observer(&self) -> bool {
</span><span>         self.flags().contains(ArchetypeFlags::ON_REMOVE_OBSERVER)
</span><span style=color:#c594c5>@@ -725,7 +725,7 @@ </span><span style=color:#399ee6>impl Archetype {
</span><span> 
</span><span>     /// Returns true if any of the components in this archetype have at least one [`OnDespawn`] observer
</span><span>     ///
</span><span style=color:#f07171>-    /// [`OnDespawn`]: crate::world::OnDespawn
</span><span style=color:#86b300>+    /// [`OnDespawn`]: crate::lifecycle::OnDespawn
</span><span>     #[inline]
</span><span>     pub fn has_despawn_observer(&self) -> bool {
</span><span>         self.flags().contains(ArchetypeFlags::ON_DESPAWN_OBSERVER)
</span><span>diff --git a/crates/bevy_ecs/src/bundle.rs b/crates/bevy_ecs/src/bundle.rs
</span><span>index a54406dde16ba..7d6c0129dc0a2 100644
</span><span style=color:#c594c5>--- a/crates/bevy_ecs/src/bundle.rs
</span><span style=color:#c594c5>+++ b/crates/bevy_ecs/src/bundle.rs
</span><span style=color:#c594c5>@@ -66,15 +66,13 @@ </span><span style=color:#399ee6>use crate::{
</span><span>         RequiredComponents, StorageType, Tick,
</span><span>     },
</span><span>     entity::{Entities, Entity, EntityLocation},
</span><span style=color:#86b300>+    lifecycle::{ON_ADD, ON_INSERT, ON_REMOVE, ON_REPLACE},
</span><span>     observer::Observers,
</span><span>     prelude::World,
</span><span>     query::DebugCheckedUnwrap,
</span><span>     relationship::RelationshipHookMode,
</span><span>     storage::{SparseSetIndex, SparseSets, Storages, Table, TableRow},
</span><span style=color:#f07171>-    world::{
</span><span style=color:#f07171>-        unsafe_world_cell::UnsafeWorldCell, EntityWorldMut, ON_ADD, ON_INSERT, ON_REMOVE,
</span><span style=color:#f07171>-        ON_REPLACE,
</span><span style=color:#f07171>-    },
</span><span style=color:#86b300>+    world::{unsafe_world_cell::UnsafeWorldCell, EntityWorldMut},
</span><span> };
</span><span> use alloc::{boxed::Box, vec, vec::Vec};
</span><span> use bevy_platform::collections::{HashMap, HashSet};
</span><span style=color:#c594c5>@@ -2123,7 +2121,7 @@ </span><span style=color:#399ee6>fn sorted_remove&LTT: Eq + Ord + Copy>(source: &mut Vec&LTT>, remove: &[T]) {
</span><span> #[cfg(test)]
</span><span> mod tests {
</span><span>     use crate::{
</span><span style=color:#f07171>-        archetype::ArchetypeCreated, component::HookContext, prelude::*, world::DeferredWorld,
</span><span style=color:#86b300>+        archetype::ArchetypeCreated, lifecycle::HookContext, prelude::*, world::DeferredWorld,
</span><span>     };
</span><span>     use alloc::vec;
</span><span> 
</span><span>diff --git a/crates/bevy_ecs/src/component.rs b/crates/bevy_ecs/src/component.rs
</span><span>index 96f0ffed9f666..338050f5fb748 100644
</span><span style=color:#c594c5>--- a/crates/bevy_ecs/src/component.rs
</span><span style=color:#c594c5>+++ b/crates/bevy_ecs/src/component.rs
</span><span style=color:#c594c5>@@ -5,12 +5,12 @@ </span><span style=color:#399ee6>use crate::{
</span><span>     bundle::BundleInfo,
</span><span>     change_detection::{MaybeLocation, MAX_CHANGE_AGE},
</span><span>     entity::{ComponentCloneCtx, Entity, EntityMapper, SourceComponent},
</span><span style=color:#86b300>+    lifecycle::{ComponentHook, ComponentHooks},
</span><span>     query::DebugCheckedUnwrap,
</span><span style=color:#f07171>-    relationship::RelationshipHookMode,
</span><span>     resource::Resource,
</span><span>     storage::{SparseSetIndex, SparseSets, Table, TableRow},
</span><span>     system::{Local, SystemParam},
</span><span style=color:#f07171>-    world::{DeferredWorld, FromWorld, World},
</span><span style=color:#86b300>+    world::{FromWorld, World},
</span><span> };
</span><span> use alloc::boxed::Box;
</span><span> use alloc::{borrow::Cow, format, vec::Vec};
</span><span style=color:#c594c5>@@ -376,7 +376,8 @@ </span><span style=color:#399ee6>use thiserror::Error;
</span><span> /// - `#[component(on_remove = on_remove_function)]`
</span><span> ///
</span><span> /// ```
</span><span style=color:#f07171>-/// # use bevy_ecs::component::{Component, HookContext};
</span><span style=color:#86b300>+/// # use bevy_ecs::component::Component;
</span><span style=color:#86b300>+/// # use bevy_ecs::lifecycle::HookContext;
</span><span> /// # use bevy_ecs::world::DeferredWorld;
</span><span> /// # use bevy_ecs::entity::Entity;
</span><span> /// # use bevy_ecs::component::ComponentId;
</span><span style=color:#c594c5>@@ -405,7 +406,8 @@ </span><span style=color:#399ee6>use thiserror::Error;
</span><span> /// This also supports function calls that yield closures
</span><span> ///
</span><span> /// ```
</span><span style=color:#f07171>-/// # use bevy_ecs::component::{Component, HookContext};
</span><span style=color:#86b300>+/// # use bevy_ecs::component::Component;
</span><span style=color:#86b300>+/// # use bevy_ecs::lifecycle::HookContext;
</span><span> /// # use bevy_ecs::world::DeferredWorld;
</span><span> /// #
</span><span> /// #[derive(Component)]
</span><span style=color:#c594c5>@@ -657,244 +659,6 @@ </span><span style=color:#399ee6>pub enum StorageType {
</span><span>     SparseSet,
</span><span> }
</span><span> 
</span><span style=color:#f07171>-/// The type used for [`Component`] lifecycle hooks such as `on_add`, `on_insert` or `on_remove`.
</span><span style=color:#f07171>-pub type ComponentHook = for<'w> fn(DeferredWorld<'w>, HookContext);
</span><span style=color:#f07171>-
</span><span style=color:#f07171>-/// Context provided to a [`ComponentHook`].
</span><span style=color:#f07171>-#[derive(Clone, Copy, Debug)]
</span><span style=color:#f07171>-pub struct HookContext {
</span><span style=color:#f07171>-    /// The [`Entity`] this hook was invoked for.
</span><span style=color:#f07171>-    pub entity: Entity,
</span><span style=color:#f07171>-    /// The [`ComponentId`] this hook was invoked for.
</span><span style=color:#f07171>-    pub component_id: ComponentId,
</span><span style=color:#f07171>-    /// The caller location is `Some` if the `track_caller` feature is enabled.
</span><span style=color:#f07171>-    pub caller: MaybeLocation,
</span><span style=color:#f07171>-    /// Configures how relationship hooks will run
</span><span style=color:#f07171>-    pub relationship_hook_mode: RelationshipHookMode,
</span><span style=color:#f07171>-}
</span><span style=color:#f07171>-
</span><span style=color:#f07171>-/// [`World`]-mutating functions that run as part of lifecycle events of a [`Component`].
</span><span style=color:#f07171>-///
</span><span style=color:#f07171>-/// Hooks are functions that run when a component is added, overwritten, or removed from an entity.
</span><span style=color:#f07171>-/// These are intended to be used for structural side effects that need to happen when a component is added or removed,
</span><span style=color:#f07171>-/// and are not intended for general-purpose logic.
</span><span style=color:#f07171>-///
</span><span style=color:#f07171>-/// For example, you might use a hook to update a cached index when a component is added,
</span><span style=color:#f07171>-/// to clean up resources when a component is removed,
</span><span style=color:#f07171>-/// or to keep hierarchical data structures across entities in sync.
</span><span style=color:#f07171>-///
</span><span style=color:#f07171>-/// This information is stored in the [`ComponentInfo`] of the associated component.
</span><span style=color:#f07171>-///
</span><span style=color:#f07171>-/// There is two ways of configuring hooks for a component:
</span><span style=color:#f07171>-/// 1. Defining the relevant hooks on the [`Component`] implementation
</span><span style=color:#f07171>-/// 2. Using the [`World::register_component_hooks`] method
</span><span style=color:#f07171>-///
</span><span style=color:#f07171>-/// # Example 2
</span><span style=color:#f07171>-///
</span><span style=color:#f07171>-/// ```
</span><span style=color:#f07171>-/// use bevy_ecs::prelude::*;
</span><span style=color:#f07171>-/// use bevy_platform::collections::HashSet;
</span><span style=color:#f07171>-///
</span><span style=color:#f07171>-/// #[derive(Component)]
</span><span style=color:#f07171>-/// struct MyTrackedComponent;
</span><span style=color:#f07171>-///
</span><span style=color:#f07171>-/// #[derive(Resource, Default)]
</span><span style=color:#f07171>-/// struct TrackedEntities(HashSet&LTEntity>);
</span><span style=color:#f07171>-///
</span><span style=color:#f07171>-/// let mut world = World::new();
</span><span style=color:#f07171>-/// world.init_resource::&LTTrackedEntities>();
</span><span style=color:#f07171>-///
</span><span style=color:#f07171>-/// // No entities with `MyTrackedComponent` have been added yet, so we can safely add component hooks
</span><span style=color:#f07171>-/// let mut tracked_component_query = world.query::<&MyTrackedComponent>();
</span><span style=color:#f07171>-/// assert!(tracked_component_query.iter(&world).next().is_none());
</span><span style=color:#f07171>-///
</span><span style=color:#f07171>-/// world.register_component_hooks::&LTMyTrackedComponent>().on_add(|mut world, context| {
</span><span style=color:#f07171>-///    let mut tracked_entities = world.resource_mut::&LTTrackedEntities>();
</span><span style=color:#f07171>-///   tracked_entities.0.insert(context.entity);
</span><span style=color:#f07171>-/// });
</span><span style=color:#f07171>-///
</span><span style=color:#f07171>-/// world.register_component_hooks::&LTMyTrackedComponent>().on_remove(|mut world, context| {
</span><span style=color:#f07171>-///   let mut tracked_entities = world.resource_mut::&LTTrackedEntities>();
</span><span style=color:#f07171>-///   tracked_entities.0.remove(&context.entity);
</span><span style=color:#f07171>-/// });
</span><span style=color:#f07171>-///
</span><span style=color:#f07171>-/// let entity = world.spawn(MyTrackedComponent).id();
</span><span style=color:#f07171>-/// let tracked_entities = world.resource::&LTTrackedEntities>();
</span><span style=color:#f07171>-/// assert!(tracked_entities.0.contains(&entity));
</span><span style=color:#f07171>-///
</span><span style=color:#f07171>-/// world.despawn(entity);
</span><span style=color:#f07171>-/// let tracked_entities = world.resource::&LTTrackedEntities>();
</span><span style=color:#f07171>-/// assert!(!tracked_entities.0.contains(&entity));
</span><span style=color:#f07171>-/// ```
</span><span style=color:#f07171>-#[derive(Debug, Clone, Default)]
</span><span style=color:#f07171>-pub struct ComponentHooks {
</span><span style=color:#f07171>-    pub(crate) on_add: Option&LTComponentHook>,
</span><span style=color:#f07171>-    pub(crate) on_insert: Option&LTComponentHook>,
</span><span style=color:#f07171>-    pub(crate) on_replace: Option&LTComponentHook>,
</span><span style=color:#f07171>-    pub(crate) on_remove: Option&LTComponentHook>,
</span><span style=color:#f07171>-    pub(crate) on_despawn: Option&LTComponentHook>,
</span><span style=color:#f07171>-}
</span><span style=color:#f07171>-
</span><span style=color:#f07171>-impl ComponentHooks {
</span><span style=color:#f07171>-    pub(crate) fn update_from_component&LTC: Component + ?Sized>(&mut self) -> &mut Self {
</span><span style=color:#f07171>-        if let Some(hook) = C::on_add() {
</span><span style=color:#f07171>-            self.on_add(hook);
</span><span style=color:#f07171>-        }
</span><span style=color:#f07171>-        if let Some(hook) = C::on_insert() {
</span><span style=color:#f07171>-            self.on_insert(hook);
</span><span style=color:#f07171>-        }
</span><span style=color:#f07171>-        if let Some(hook) = C::on_replace() {
</span><span style=color:#f07171>-            self.on_replace(hook);
</span><span style=color:#f07171>-        }
</span><span style=color:#f07171>-        if let Some(hook) = C::on_remove() {
</span><span style=color:#f07171>-            self.on_remove(hook);
</span><span style=color:#f07171>-        }
</span><span style=color:#f07171>-        if let Some(hook) = C::on_despawn() {
</span><span style=color:#f07171>-            self.on_despawn(hook);
</span><span style=color:#f07171>-        }
</span><span style=color:#f07171>-
</span><span style=color:#f07171>-        self
</span><span style=color:#f07171>-    }
</span><span style=color:#f07171>-
</span><span style=color:#f07171>-    /// Register a [`ComponentHook`] that will be run when this component is added to an entity.
</span><span style=color:#f07171>-    /// An `on_add` hook will always run before `on_insert` hooks. Spawning an entity counts as
</span><span style=color:#f07171>-    /// adding all of its components.
</span><span style=color:#f07171>-    ///
</span><span style=color:#f07171>-    /// # Panics
</span><span style=color:#f07171>-    ///
</span><span style=color:#f07171>-    /// Will panic if the component already has an `on_add` hook
</span><span style=color:#f07171>-    pub fn on_add(&mut self, hook: ComponentHook) -> &mut Self {
</span><span style=color:#f07171>-        self.try_on_add(hook)
</span><span style=color:#f07171>-            .expect("Component already has an on_add hook")
</span><span style=color:#f07171>-    }
</span><span style=color:#f07171>-
</span><span style=color:#f07171>-    /// Register a [`ComponentHook`] that will be run when this component is added (with `.insert`)
</span><span style=color:#f07171>-    /// or replaced.
</span><span style=color:#f07171>-    ///
</span><span style=color:#f07171>-    /// An `on_insert` hook always runs after any `on_add` hooks (if the entity didn't already have the component).
</span><span style=color:#f07171>-    ///
</span><span style=color:#f07171>-    /// # Warning
</span><span style=color:#f07171>-    ///
</span><span style=color:#f07171>-    /// The hook won't run if the component is already present and is only mutated, such as in a system via a query.
</span><span style=color:#f07171>-    /// As a result, this is *not* an appropriate mechanism for reliably updating indexes and other caches.
</span><span style=color:#f07171>-    ///
</span><span style=color:#f07171>-    /// # Panics
</span><span style=color:#f07171>-    ///
</span><span style=color:#f07171>-    /// Will panic if the component already has an `on_insert` hook
</span><span style=color:#f07171>-    pub fn on_insert(&mut self, hook: ComponentHook) -> &mut Self {
</span><span style=color:#f07171>-        self.try_on_insert(hook)
</span><span style=color:#f07171>-            .expect("Component already has an on_insert hook")
</span><span style=color:#f07171>-    }
</span><span style=color:#f07171>-
</span><span style=color:#f07171>-    /// Register a [`ComponentHook`] that will be run when this component is about to be dropped,
</span><span style=color:#f07171>-    /// such as being replaced (with `.insert`) or removed.
</span><span style=color:#f07171>-    ///
</span><span style=color:#f07171>-    /// If this component is inserted onto an entity that already has it, this hook will run before the value is replaced,
</span><span style=color:#f07171>-    /// allowing access to the previous data just before it is dropped.
</span><span style=color:#f07171>-    /// This hook does *not* run if the entity did not already have this component.
</span><span style=color:#f07171>-    ///
</span><span style=color:#f07171>-    /// An `on_replace` hook always runs before any `on_remove` hooks (if the component is being removed from the entity).
</span><span style=color:#f07171>-    ///
</span><span style=color:#f07171>-    /// # Warning
</span><span style=color:#f07171>-    ///
</span><span style=color:#f07171>-    /// The hook won't run if the component is already present and is only mutated, such as in a system via a query.
</span><span style=color:#f07171>-    /// As a result, this is *not* an appropriate mechanism for reliably updating indexes and other caches.
</span><span style=color:#f07171>-    ///
</span><span style=color:#f07171>-    /// # Panics
</span><span style=color:#f07171>-    ///
</span><span style=color:#f07171>-    /// Will panic if the component already has an `on_replace` hook
</span><span style=color:#f07171>-    pub fn on_replace(&mut self, hook: ComponentHook) -> &mut Self {
</span><span style=color:#f07171>-        self.try_on_replace(hook)
</span><span style=color:#f07171>-            .expect("Component already has an on_replace hook")
</span><span style=color:#f07171>-    }
</span><span style=color:#f07171>-
</span><span style=color:#f07171>-    /// Register a [`ComponentHook`] that will be run when this component is removed from an entity.
</span><span style=color:#f07171>-    /// Despawning an entity counts as removing all of its components.
</span><span style=color:#f07171>-    ///
</span><span style=color:#f07171>-    /// # Panics
</span><span style=color:#f07171>-    ///
</span><span style=color:#f07171>-    /// Will panic if the component already has an `on_remove` hook
</span><span style=color:#f07171>-    pub fn on_remove(&mut self, hook: ComponentHook) -> &mut Self {
</span><span style=color:#f07171>-        self.try_on_remove(hook)
</span><span style=color:#f07171>-            .expect("Component already has an on_remove hook")
</span><span style=color:#f07171>-    }
</span><span style=color:#f07171>-
</span><span style=color:#f07171>-    /// Register a [`ComponentHook`] that will be run for each component on an entity when it is despawned.
</span><span style=color:#f07171>-    ///
</span><span style=color:#f07171>-    /// # Panics
</span><span style=color:#f07171>-    ///
</span><span style=color:#f07171>-    /// Will panic if the component already has an `on_despawn` hook
</span><span style=color:#f07171>-    pub fn on_despawn(&mut self, hook: ComponentHook) -> &mut Self {
</span><span style=color:#f07171>-        self.try_on_despawn(hook)
</span><span style=color:#f07171>-            .expect("Component already has an on_despawn hook")
</span><span style=color:#f07171>-    }
</span><span style=color:#f07171>-
</span><span style=color:#f07171>-    /// Attempt to register a [`ComponentHook`] that will be run when this component is added to an entity.
</span><span style=color:#f07171>-    ///
</span><span style=color:#f07171>-    /// This is a fallible version of [`Self::on_add`].
</span><span style=color:#f07171>-    ///
</span><span style=color:#f07171>-    /// Returns `None` if the component already has an `on_add` hook.
</span><span style=color:#f07171>-    pub fn try_on_add(&mut self, hook: ComponentHook) -> Option<&mut Self> {
</span><span style=color:#f07171>-        if self.on_add.is_some() {
</span><span style=color:#f07171>-            return None;
</span><span style=color:#f07171>-        }
</span><span style=color:#f07171>-        self.on_add = Some(hook);
</span><span style=color:#f07171>-        Some(self)
</span><span style=color:#f07171>-    }
</span><span style=color:#f07171>-
</span><span style=color:#f07171>-    /// Attempt to register a [`ComponentHook`] that will be run when this component is added (with `.insert`)
</span><span style=color:#f07171>-    ///
</span><span style=color:#f07171>-    /// This is a fallible version of [`Self::on_insert`].
</span><span style=color:#f07171>-    ///
</span><span style=color:#f07171>-    /// Returns `None` if the component already has an `on_insert` hook.
</span><span style=color:#f07171>-    pub fn try_on_insert(&mut self, hook: ComponentHook) -> Option<&mut Self> {
</span><span style=color:#f07171>-        if self.on_insert.is_some() {
</span><span style=color:#f07171>-            return None;
</span><span style=color:#f07171>-        }
</span><span style=color:#f07171>-        self.on_insert = Some(hook);
</span><span style=color:#f07171>-        Some(self)
</span><span style=color:#f07171>-    }
</span><span style=color:#f07171>-
</span><span style=color:#f07171>-    /// Attempt to register a [`ComponentHook`] that will be run when this component is replaced (with `.insert`) or removed
</span><span style=color:#f07171>-    ///
</span><span style=color:#f07171>-    /// This is a fallible version of [`Self::on_replace`].
</span><span style=color:#f07171>-    ///
</span><span style=color:#f07171>-    /// Returns `None` if the component already has an `on_replace` hook.
</span><span style=color:#f07171>-    pub fn try_on_replace(&mut self, hook: ComponentHook) -> Option<&mut Self> {
</span><span style=color:#f07171>-        if self.on_replace.is_some() {
</span><span style=color:#f07171>-            return None;
</span><span style=color:#f07171>-        }
</span><span style=color:#f07171>-        self.on_replace = Some(hook);
</span><span style=color:#f07171>-        Some(self)
</span><span style=color:#f07171>-    }
</span><span style=color:#f07171>-
</span><span style=color:#f07171>-    /// Attempt to register a [`ComponentHook`] that will be run when this component is removed from an entity.
</span><span style=color:#f07171>-    ///
</span><span style=color:#f07171>-    /// This is a fallible version of [`Self::on_remove`].
</span><span style=color:#f07171>-    ///
</span><span style=color:#f07171>-    /// Returns `None` if the component already has an `on_remove` hook.
</span><span style=color:#f07171>-    pub fn try_on_remove(&mut self, hook: ComponentHook) -> Option<&mut Self> {
</span><span style=color:#f07171>-        if self.on_remove.is_some() {
</span><span style=color:#f07171>-            return None;
</span><span style=color:#f07171>-        }
</span><span style=color:#f07171>-        self.on_remove = Some(hook);
</span><span style=color:#f07171>-        Some(self)
</span><span style=color:#f07171>-    }
</span><span style=color:#f07171>-
</span><span style=color:#f07171>-    /// Attempt to register a [`ComponentHook`] that will be run for each component on an entity when it is despawned.
</span><span style=color:#f07171>-    ///
</span><span style=color:#f07171>-    /// This is a fallible version of [`Self::on_despawn`].
</span><span style=color:#f07171>-    ///
</span><span style=color:#f07171>-    /// Returns `None` if the component already has an `on_despawn` hook.
</span><span style=color:#f07171>-    pub fn try_on_despawn(&mut self, hook: ComponentHook) -> Option<&mut Self> {
</span><span style=color:#f07171>-        if self.on_despawn.is_some() {
</span><span style=color:#f07171>-            return None;
</span><span style=color:#f07171>-        }
</span><span style=color:#f07171>-        self.on_despawn = Some(hook);
</span><span style=color:#f07171>-        Some(self)
</span><span style=color:#f07171>-    }
</span><span style=color:#f07171>-}
</span><span style=color:#f07171>-
</span><span> /// Stores metadata for a type of component or resource stored in a specific [`World`].
</span><span> #[derive(Debug, Clone)]
</span><span> pub struct ComponentInfo {
</span><span>diff --git a/crates/bevy_ecs/src/event/base.rs b/crates/bevy_ecs/src/event/base.rs
</span><span>index d525ba2e57695..bb896c4f09140 100644
</span><span style=color:#c594c5>--- a/crates/bevy_ecs/src/event/base.rs
</span><span style=color:#c594c5>+++ b/crates/bevy_ecs/src/event/base.rs
</span><span style=color:#c594c5>@@ -68,7 +68,7 @@ </span><span style=color:#399ee6>pub trait Event: Send + Sync + 'static {
</span><span>     ///
</span><span>     /// # Warning
</span><span>     ///
</span><span style=color:#f07171>-    /// This method should not be overridden by implementors,
</span><span style=color:#86b300>+    /// This method should not be overridden by implementers,
</span><span>     /// and should always correspond to the implementation of [`component_id`](Event::component_id).
</span><span>     fn register_component_id(world: &mut World) -> ComponentId {
</span><span>         world.register_component::&LTEventWrapperComponent&LTSelf>>()
</span><span style=color:#c594c5>@@ -82,7 +82,7 @@ </span><span style=color:#399ee6>pub trait Event: Send + Sync + 'static {
</span><span>     ///
</span><span>     /// # Warning
</span><span>     ///
</span><span style=color:#f07171>-    /// This method should not be overridden by implementors,
</span><span style=color:#86b300>+    /// This method should not be overridden by implementers,
</span><span>     /// and should always correspond to the implementation of [`register_component_id`](Event::register_component_id).
</span><span>     fn component_id(world: &World) -> Option&LTComponentId> {
</span><span>         world.component_id::&LTEventWrapperComponent&LTSelf>>()
</span><span>diff --git a/crates/bevy_ecs/src/hierarchy.rs b/crates/bevy_ecs/src/hierarchy.rs
</span><span>index e138dfcac8bd5..dfc32e60dbd2b 100644
</span><span style=color:#c594c5>--- a/crates/bevy_ecs/src/hierarchy.rs
</span><span style=color:#c594c5>+++ b/crates/bevy_ecs/src/hierarchy.rs
</span><span style=color:#c594c5>@@ -10,8 +10,9 @@
</span><span> use crate::reflect::{ReflectComponent, ReflectFromWorld};
</span><span> use crate::{
</span><span>     bundle::Bundle,
</span><span style=color:#f07171>-    component::{Component, HookContext},
</span><span style=color:#86b300>+    component::Component,
</span><span>     entity::Entity,
</span><span style=color:#86b300>+    lifecycle::HookContext,
</span><span>     relationship::{RelatedSpawner, RelatedSpawnerCommands},
</span><span>     system::EntityCommands,
</span><span>     world::{DeferredWorld, EntityWorldMut, FromWorld, World},
</span><span>diff --git a/crates/bevy_ecs/src/lib.rs b/crates/bevy_ecs/src/lib.rs
</span><span>index 14802dfc8e69</span></code></pre>    <div data-is-md-page=true data-patch-exists=true data-patch-path=/pull_request/bevy/2025-06/pr_19543.patch id=patch-info style=display:none></div>  <div class=bottom-spacer></div>