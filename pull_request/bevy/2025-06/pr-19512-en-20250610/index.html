<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://unknownue.github.io name=base><title>
         #19512
        
    </title><meta content=#19512 property=og:title><meta content="A personal blog built with Zola and Apollo theme" property=og:description><meta content="A personal blog built with Zola and Apollo theme" name=description><link href=/icons/favicon.png rel=icon type=image/png><link href=https://unknownue.github.io/fonts.css rel=stylesheet><script src=https://unknownue.github.io/js/codeblock.js></script><script src=https://unknownue.github.io/js/toc.js></script><script src=https://unknownue.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Unknownue's Blog" href=https://unknownue.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://unknownue.github.io/theme/light.css rel=stylesheet><link href=https://unknownue.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://unknownue.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://unknownue.github.io/main.css media=screen rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js></script><script>// Initialize mermaid once DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            mermaid.initialize({
                startOnLoad: false,
                theme: document.body && document.body.classList.contains('dark') ? 'dark' : 'default',
                securityLevel: 'loose',
                flowchart: {
                    useMaxWidth: true,
                    htmlLabels: true
                },
                sequence: {
                    diagramMarginX: 50,
                    diagramMarginY: 10,
                    actorMargin: 50,
                    width: 150,
                    height: 65
                }
            });
        });</script><script src=https://unknownue.github.io/js/main.js></script><script defer src=https://unknownue.github.io/js/label-colors.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/rust.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/typescript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/go.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/cpp.min.js></script><script>// Ensure highlight.js is properly configured
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof hljs !== 'undefined') {
                hljs.configure({
                    languages: ['rust', 'javascript', 'python', 'cpp', 'go', 'typescript'],
                    ignoreUnescapedHTML: true
                });
                console.log('Highlight.js configured in header');
            }
        });</script><link href=https://cdn.jsdelivr.net/npm/diff2html/bundles/css/diff2html.min.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/diff2html/bundles/js/diff2html-ui.min.js></script><script src=https://unknownue.github.io/js/syntax-highlight.js></script><script src=https://unknownue.github.io/js/diff-sidebar.js></script><script src="https://unknownue.github.io/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><div class=content><header><div class=main><a href=https://unknownue.github.io>Unknownue's Blog</a><div class=socials><a class=social href=https://github.com/unknownue rel=me> <img alt=github src=https://unknownue.github.io/icons/social/github.svg> </a><a class=social href=https://github.com/unknownue/unknownue.github.io rel=me> <img alt=github-io src=https://unknownue.github.io/icons/social/rss.svg> </a></div></div><nav><a href=https://unknownue.github.io/posts style=margin-left:.25em>/posts</a><a href=https://unknownue.github.io/projects style=margin-left:.25em>/projects</a><a href=https://unknownue.github.io/about style=margin-left:.25em>/about</a><a href=https://unknownue.github.io/tags style=margin-left:.25em>/tags</a><button title="$SHORTCUT to open search" class=search-button id=search-button><img alt=Search class=search-icon src=https://unknownue.github.io/icons/search.svg></button><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><div id=modal-content><h1 class=page-header id=modalTitle>Search</h1><div id=searchBar><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search... role=combobox spellcheck=false><button title="Clear search" class=clear-button id=clear-search><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></button></div><div id=results-container><div id=results-info><span id=zero_results style=display:none>No results</span><span id=one_result style=display:none>1 result</span><span id=many_results style=display:none>$NUMBER results</span></div><div id=results role=listbox></div></div></div></div><a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://unknownue.github.io/icons/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://unknownue.github.io/icons/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><div class=pull-request-page><article class=md-content-page style=display:none></article><div class=back-link><a href=/pull_request/bevy/2025-06/>← Back to Pull Requests</a></div><div class=pr-metadata><span class=pr-date>2025-06-10</span><div class=language-switcher><span class="lang-link active" data-lang=en>English</span> / <a class=lang-link data-lang=zh-cn href=/pull_request/bevy/2025-06/pr-19512-zh-cn-20250610>中文</a></div></div><div class=pr-content><h2 id=the-story-of-this-pull-request>The Story of This Pull Request</h2><p>This PR addresses a performance issue in one of Bevy’s stress test examples. The problem surfaced in issue #17183, where users reported that the <code>many_cameras_lights</code> example was running slower than expected. This stress test is designed to evaluate how Bevy handles rendering with numerous cameras and lights, but its effectiveness was compromised by unnecessary performance limitations.<p>The core issue was traced to the example’s window configuration. By default, Bevy uses VSync synchronization which caps the frame rate to the monitor’s refresh rate (typically 60Hz). Additionally, the default resolution scaling could introduce unnecessary overhead. These settings were appropriate for regular applications but counterproductive for a stress test designed to push performance boundaries.<p>The solution was straightforward and practical: adopt the optimized window settings already proven effective in the <code>many_animated_sprites</code> stress test example. This approach maintains consistency across Bevy’s stress tests while solving the immediate performance limitation. No alternatives were considered since this was a direct configuration fix using established patterns from the codebase.<p>The implementation modifies a single line in the example’s setup code. Instead of using the default window settings, we now explicitly configure the window with:<ol><li><code>PresentMode::AutoNoVsync</code> to disable VSync frame rate limiting<li>A fixed 1920x1080 resolution with scale factor override to prevent dynamic scaling</ol><p>These changes eliminate artificial bottlenecks, allowing the stress test to render as many frames as possible given the hardware capabilities. This makes the example more effective for its intended purpose of stress testing Bevy’s rendering systems under heavy load. The fix demonstrates an important principle: stress tests should minimize external constraints to accurately measure engine performance.<h2 id=visual-representation>Visual Representation</h2><pre class=language-mermaid data-lang=mermaid style=color:#61676c;background-color:#fafafa><code class=language-mermaid data-lang=mermaid><span>graph LR
</span><span>    A[Issue #17183] --> B[Performance Limitation]
</span><span>    B --> C[VSync and Scaling Constraints]
</span><span>    C --> D[Adopt Settings from many_animated_sprites]
</span><span>    D --> E[PresentMode::AutoNoVsync]
</span><span>    D --> F[Fixed Resolution]
</span><span>    D --> G[Scale Factor Override]
</span><span>    E --> H[Unlocked Frame Rate]
</span><span>    F --> I[Consistent Rendering Load]
</span><span>    G --> J[Predictable Performance]
</span></code></pre><h2 id=key-files-changed>Key Files Changed</h2><h3 id=examples-stress-tests-many-cameras-lights-rs><code>examples/stress_tests/many_cameras_lights.rs</code></h3><p><strong>What changed:</strong> Modified window configuration settings to optimize for stress testing<br> <strong>Why changed:</strong> To remove VSync frame limiting and resolution scaling that artificially constrained performance<p>Before:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#fa6e32>fn </span><span style=color:#f29718>main</span><span>() {
</span><span>    App</span><span style=color:#ed9366>::</span><span>new()
</span><span>        </span><span style=color:#ed9366>.</span><span style=color:#f07171>add_plugins</span><span>(DefaultPlugins)
</span><span>        </span><span style=color:#ed9366>.</span><span style=color:#f07171>add_systems</span><span>(Startup</span><span style=color:#61676ccc>,</span><span> setup)
</span><span>        </span><span style=color:#ed9366>.</span><span style=color:#f07171>add_systems</span><span>(Update</span><span style=color:#61676ccc>,</span><span> rotate_cameras)
</span><span>        </span><span style=color:#ed9366>.</span><span style=color:#f07171>run</span><span>()</span><span style=color:#61676ccc>;
</span><span>}
</span></code></pre><p>After:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#fa6e32>fn </span><span style=color:#f29718>main</span><span>() {
</span><span>    App</span><span style=color:#ed9366>::</span><span>new()
</span><span>        </span><span style=color:#ed9366>.</span><span style=color:#f07171>add_plugins</span><span>(DefaultPlugins</span><span style=color:#ed9366>.</span><span style=color:#f07171>set</span><span>(WindowPlugin {
</span><span>            primary_window</span><span style=color:#61676ccc>: </span><span style=color:#55b4d4;font-style:italic>Some</span><span>(Window {
</span><span>                present_mode</span><span style=color:#61676ccc>: </span><span>PresentMode</span><span style=color:#ed9366>::</span><span>AutoNoVsync</span><span style=color:#61676ccc>,
</span><span>                resolution</span><span style=color:#61676ccc>: </span><span>WindowResolution</span><span style=color:#ed9366>::</span><span>new(</span><span style=color:#ff8f40>1920.0</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>1080.0</span><span>)</span><span style=color:#ed9366>.</span><span style=color:#f07171>with_scale_factor_override</span><span>(</span><span style=color:#ff8f40>1.0</span><span>)</span><span style=color:#61676ccc>,
</span><span>                </span><span style=color:#ed9366>..</span><span style=color:#f07171>default</span><span>()
</span><span>            })</span><span style=color:#61676ccc>,
</span><span>            </span><span style=color:#ed9366>..</span><span style=color:#f07171>default</span><span>()
</span><span>        }))
</span><span>        </span><span style=color:#ed9366>.</span><span style=color:#f07171>add_systems</span><span>(Startup</span><span style=color:#61676ccc>,</span><span> setup)
</span><span>        </span><span style=color:#ed9366>.</span><span style=color:#f07171>add_systems</span><span>(Update</span><span style=color:#61676ccc>,</span><span> rotate_cameras)
</span><span>        </span><span style=color:#ed9366>.</span><span style=color:#f07171>run</span><span>()</span><span style=color:#61676ccc>;
</span><span>}
</span></code></pre><p>The key changes are:<ol><li>Added <code>WindowPlugin</code> configuration to override default settings<li>Set <code>PresentMode::AutoNoVsync</code> to disable VSync frame limiting<li>Configured fixed 1080p resolution with scale factor locked to 1.0<li>Maintained all existing systems and functionality</ol><p>These changes directly implement the solution described in the PR, aligning this stress test’s configuration with others in the codebase.<h2 id=further-reading>Further Reading</h2><ol><li><a rel="noopener nofollow noreferrer" href=https://docs.rs/bevy/latest/bevy/window/struct.Window.html target=_blank>Bevy Window Settings Documentation</a><li><a rel="noopener nofollow noreferrer" href=https://docs.rs/bevy/latest/bevy/window/enum.PresentMode.html target=_blank>PresentMode Enum Reference</a><li><a rel="noopener nofollow noreferrer" href=https://docs.rs/bevy/latest/bevy/window/struct.WindowResolution.html target=_blank>WindowResolution API Documentation</a><li><a rel="noopener nofollow noreferrer" href=https://gameprogrammingpatterns.com/optimization-pattern.html target=_blank>Stress Testing Principles in Game Engines</a></ol></div><div data-is-md-page=true data-patch-exists=true data-patch-path=/pull_request/bevy/2025-06/pr_19512.patch id=patch-info style=display:none></div><div class=bottom-spacer></div></div></div>