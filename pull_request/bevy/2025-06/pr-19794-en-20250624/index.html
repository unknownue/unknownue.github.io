<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://unknownue.github.io name=base><title>
         #19794 remove unneeded dependency from bevy_render
        
    </title><meta content="#19794 remove unneeded dependency from bevy_render" property=og:title><meta content="A personal blog built with Zola and Apollo theme" property=og:description><meta content="A personal blog built with Zola and Apollo theme" name=description><link href=/icons/favicon.png rel=icon type=image/png><link href=https://unknownue.github.io/fonts.css rel=stylesheet><script src=https://unknownue.github.io/js/codeblock.js></script><script src=https://unknownue.github.io/js/toc.js></script><script src=https://unknownue.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Unknownue's Blog" href=https://unknownue.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://unknownue.github.io/theme/light.css rel=stylesheet><link href=https://unknownue.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://unknownue.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://unknownue.github.io/main.css media=screen rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js></script><script>// Initialize mermaid once DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            mermaid.initialize({
                startOnLoad: false,
                theme: document.body && document.body.classList.contains('dark') ? 'dark' : 'default',
                securityLevel: 'loose',
                flowchart: {
                    useMaxWidth: true,
                    htmlLabels: true
                },
                sequence: {
                    diagramMarginX: 50,
                    diagramMarginY: 10,
                    actorMargin: 50,
                    width: 150,
                    height: 65
                }
            });
        });</script><script src=https://unknownue.github.io/js/main.js></script><script defer src=https://unknownue.github.io/js/label-colors.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/rust.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/typescript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/go.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/cpp.min.js></script><script>// Ensure highlight.js is properly configured
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof hljs !== 'undefined') {
                hljs.configure({
                    languages: ['rust', 'javascript', 'python', 'cpp', 'go', 'typescript'],
                    ignoreUnescapedHTML: true
                });
                console.log('Highlight.js configured in header');
            }
        });</script><link href=https://cdn.jsdelivr.net/npm/diff2html/bundles/css/diff2html.min.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/diff2html/bundles/js/diff2html-ui.min.js></script><script src=https://unknownue.github.io/js/syntax-highlight.js></script><script src=https://unknownue.github.io/js/diff-sidebar.js></script><script src="https://unknownue.github.io/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><div class=content><header><div class=main><a href=https://unknownue.github.io>Unknownue's Blog</a><div class=socials><a class=social href=https://github.com/unknownue rel=me> <img alt=github src=https://unknownue.github.io/icons/social/github.svg> </a><a class=social href=https://github.com/unknownue/unknownue.github.io rel=me> <img alt=github-io src=https://unknownue.github.io/icons/social/rss.svg> </a></div></div><nav><a href=https://unknownue.github.io/posts style=margin-left:.25em>/posts</a><a href=https://unknownue.github.io/projects style=margin-left:.25em>/projects</a><a href=https://unknownue.github.io/about style=margin-left:.25em>/about</a><a href=https://unknownue.github.io/tags style=margin-left:.25em>/tags</a><button title="$SHORTCUT to open search" class=search-button id=search-button><img alt=Search class=search-icon src=https://unknownue.github.io/icons/search.svg></button><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><div id=modal-content><h1 class=page-header id=modalTitle>Search</h1><div id=searchBar><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search... role=combobox spellcheck=false><button title="Clear search" class=clear-button id=clear-search><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></button></div><div id=results-container><div id=results-info><span id=zero_results style=display:none>No results</span><span id=one_result style=display:none>1 result</span><span id=many_results style=display:none>$NUMBER results</span></div><div id=results role=listbox></div></div></div></div><a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://unknownue.github.io/icons/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://unknownue.github.io/icons/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><div class=pull-request-page><article class=md-content-page style=display:none></article><div class=back-link><a href=/pull_request/bevy/2025-06/>← Back to Pull Requests</a></div><div class=pr-metadata><span class=pr-date>2025-06-24</span><div class=language-switcher><span class="lang-link active" data-lang=en>English</span> / <a class=lang-link data-lang=zh-cn href=/pull_request/bevy/2025-06/pr-19794-zh-cn-20250624>中文</a></div></div><div class=pr-content><h2 id=remove-unneeded-dependency-from-bevy-render>remove unneeded dependency from bevy_render</h2><h3 id=basic-information>Basic Information</h3><ul><li><strong>Title</strong>: remove unneeded dependency from bevy_render<li><strong>PR Link</strong>: https://github.com/bevyengine/bevy/pull/19794<li><strong>Author</strong>: atlv24<li><strong>Status</strong>: MERGED<li><strong>Labels</strong>: D-Trivial, A-Rendering, S-Ready-For-Final-Review<li><strong>Created</strong>: 2025-06-24T04:37:37Z<li><strong>Merged</strong>: 2025-06-24T06:40:44Z<li><strong>Merged By</strong>: mockersf</ul><h3 id=description-translation>Description Translation</h3><h1 id=objective>Objective</h1><ul><li>yeet cruft</ul><h2 id=solution>Solution</h2><ul><li>yeet cruft</ul><h2 id=testing>Testing</h2><ul><li>cargo clippy</ul><h3 id=the-story-of-this-pull-request>The Story of This Pull Request</h3><p>This PR addresses a straightforward dependency management issue in the Bevy renderer. The <code>bevy_render</code> crate contained an unnecessary explicit dependency on the <code>ktx2</code> crate. This dependency was redundant because the <code>ktx2</code> functionality was already being properly managed through the <code>bevy_image</code> crate’s feature flags.<p>The problem was identified through routine dependency inspection. Maintaining duplicate dependencies increases build times, complicates dependency resolution, and introduces potential version conflict risks. Since <code>bevy_image</code> already provided the KTX2 functionality through its own feature flag, the explicit dependency in <code>bevy_render</code> served no purpose.<p>The solution involved two coordinated changes to <code>bevy_render</code>’s Cargo.toml file. First, the <code>ktx2</code> feature definition was modified to remove the explicit <code>dep:ktx2</code> requirement while preserving the <code>bevy_image/ktx2</code> feature propagation. Second, the explicit <code>ktx2</code> dependency declaration was completely removed from the dependencies section. These changes eliminate redundant dependency declarations while maintaining all existing functionality through the transitive dependency chain.<p>The implementation follows Rust’s best practices for feature management in workspace environments. By relying on <code>bevy_image</code> to manage the actual <code>ktx2</code> dependency, we maintain a single source of truth for this dependency while reducing the maintenance surface area. The changes were validated with <code>cargo clippy</code> to ensure no regressions or build issues were introduced.<p>The impact of this change is primarily in build optimization. Removing unnecessary dependencies reduces compile times, minimizes the dependency tree, and decreases the attack surface for potential security vulnerabilities. This aligns with Bevy’s ongoing efforts to maintain a lean and efficient codebase.<h3 id=visual-representation>Visual Representation</h3><pre class=language-mermaid data-lang=mermaid style=color:#61676c;background-color:#fafafa><code class=language-mermaid data-lang=mermaid><span>graph LR
</span><span>    B[bevy_render] --> I[bevy_image]
</span><span>    I --> K[ktx2 crate]
</span><span>    
</span><span>    style B stroke:#f66,stroke-width:2px
</span><span>    style K stroke-dasharray: 5 5
</span></code></pre><h3 id=key-files-changed>Key Files Changed</h3><h4 id=crates-bevy-render-cargo-toml><code>crates/bevy_render/Cargo.toml</code></h4><p><strong>Changes:</strong><ol><li>Modified <code>ktx2</code> feature definition to remove redundant <code>dep:ktx2</code><li>Removed explicit <code>ktx2</code> dependency declaration</ol><p><strong>Code Diff:</strong><pre class=language-diff data-lang=diff style=color:#61676c;background-color:#fafafa><code class=language-diff data-lang=diff><span style=color:#c594c5>--- a/crates/bevy_render/Cargo.toml
</span><span style=color:#c594c5>+++ b/crates/bevy_render/Cargo.toml
</span><span style=color:#c594c5>@@ -28,7 +28,7 @@ </span><span style=color:#399ee6>compressed_image_saver = ["bevy_image/compressed_image_saver"]
</span><span> basis-universal = ["bevy_image/basis-universal"]
</span><span> exr = ["bevy_image/exr"]
</span><span> hdr = ["bevy_image/hdr"]
</span><span style=color:#f07171>-ktx2 = ["dep:ktx2", "bevy_image/ktx2"]
</span><span style=color:#86b300>+ktx2 = ["bevy_image/ktx2"]
</span><span> 
</span><span> multi_threaded = ["bevy_tasks/multi_threaded"]
</span><span> 
</span><span style=color:#c594c5>@@ -104,7 +104,6 @@ </span><span style=color:#399ee6>downcast-rs = { version = "2", default-features = false, features = ["std"] }
</span><span> thiserror = { version = "2", default-features = false }
</span><span> derive_more = { version = "1", default-features = false, features = ["from"] }
</span><span> futures-lite = "2.0.1"
</span><span style=color:#f07171>-ktx2 = { version = "0.4.0", optional = true }
</span><span> encase = { version = "0.10", features = ["glam"] }
</span><span> # For wgpu profiling using tracing. Use `RUST_LOG=info` to also capture the wgpu spans.
</span><span> profiling = { version = "1", features = [
</span></code></pre><h3 id=further-reading>Further Reading</h3><ul><li><a rel="noopener nofollow noreferrer" href=https://doc.rust-lang.org/cargo/reference/features.html target=_blank>Cargo Features Documentation</a><li><a rel="noopener nofollow noreferrer" href=https://doc.rust-lang.org/cargo/guide/dependencies.html target=_blank>Rust Dependency Management Best Practices</a><li><a rel="noopener nofollow noreferrer" href=https://bevyengine.org/learn/book/getting-started/architecture/ target=_blank>Bevy Engine Architecture Overview</a></ul></div><div data-is-md-page=true data-patch-exists=true data-patch-path=/pull_request/bevy/2025-06/pr_19794.patch id=patch-info style=display:none></div><div class=bottom-spacer></div></div></div>