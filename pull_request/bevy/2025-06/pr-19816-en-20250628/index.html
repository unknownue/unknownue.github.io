<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://unknownue.github.io name=base><title>
         #19816 Nudge users into migrating to new default glTF coordinate conversion
        
    </title><meta content="#19816 Nudge users into migrating to new default glTF coordinate conversion" property=og:title><meta content="A personal blog built with Zola and Apollo theme" property=og:description><meta content="A personal blog built with Zola and Apollo theme" name=description><link href=/icons/favicon.png rel=icon type=image/png><link href=https://unknownue.github.io/fonts.css rel=stylesheet><script src=https://unknownue.github.io/js/codeblock.js></script><script src=https://unknownue.github.io/js/toc.js></script><script src=https://unknownue.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Unknownue's Blog" href=https://unknownue.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://unknownue.github.io/theme/light.css rel=stylesheet><link href=https://unknownue.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://unknownue.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://unknownue.github.io/main.css media=screen rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js></script><script>// Initialize mermaid once DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            mermaid.initialize({
                startOnLoad: false,
                theme: document.body && document.body.classList.contains('dark') ? 'dark' : 'default',
                securityLevel: 'loose',
                flowchart: {
                    useMaxWidth: true,
                    htmlLabels: true
                },
                sequence: {
                    diagramMarginX: 50,
                    diagramMarginY: 10,
                    actorMargin: 50,
                    width: 150,
                    height: 65
                }
            });
        });</script><script src=https://unknownue.github.io/js/main.js></script><script defer src=https://unknownue.github.io/js/label-colors.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/rust.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/typescript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/go.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/cpp.min.js></script><script>// Ensure highlight.js is properly configured
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof hljs !== 'undefined') {
                hljs.configure({
                    languages: ['rust', 'javascript', 'python', 'cpp', 'go', 'typescript'],
                    ignoreUnescapedHTML: true
                });
                console.log('Highlight.js configured in header');
            }
        });</script><link href=https://cdn.jsdelivr.net/npm/diff2html/bundles/css/diff2html.min.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/diff2html/bundles/js/diff2html-ui.min.js></script><script src=https://unknownue.github.io/js/syntax-highlight.js></script><script src=https://unknownue.github.io/js/diff-sidebar.js></script><script src="https://unknownue.github.io/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><div class=content><header><div class=main><a href=https://unknownue.github.io>Unknownue's Blog</a><div class=socials><a class=social href=https://github.com/unknownue rel=me> <img alt=github src=https://unknownue.github.io/icons/social/github.svg> </a><a class=social href=https://github.com/unknownue/unknownue.github.io rel=me> <img alt=github-io src=https://unknownue.github.io/icons/social/rss.svg> </a></div></div><nav><a href=https://unknownue.github.io/posts style=margin-left:.25em>/posts</a><a href=https://unknownue.github.io/projects style=margin-left:.25em>/projects</a><a href=https://unknownue.github.io/about style=margin-left:.25em>/about</a><a href=https://unknownue.github.io/tags style=margin-left:.25em>/tags</a><button title="$SHORTCUT to open search" class=search-button id=search-button><img alt=Search class=search-icon src=https://unknownue.github.io/icons/search.svg></button><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><div id=modal-content><h1 class=page-header id=modalTitle>Search</h1><div id=searchBar><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search... role=combobox spellcheck=false><button title="Clear search" class=clear-button id=clear-search><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></button></div><div id=results-container><div id=results-info><span id=zero_results style=display:none>No results</span><span id=one_result style=display:none>1 result</span><span id=many_results style=display:none>$NUMBER results</span></div><div id=results role=listbox></div></div></div></div><a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://unknownue.github.io/icons/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://unknownue.github.io/icons/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><div class=pull-request-page><article class=md-content-page style=display:none></article><div class=back-link><a href=/pull_request/bevy/2025-06/>← Back to Pull Requests</a></div><div class=pr-metadata><span class=pr-date>2025-06-28</span><div class=language-switcher><span class="lang-link active" data-lang=en>English</span> / <a class=lang-link data-lang=zh-cn href=/pull_request/bevy/2025-06/pr-19816-zh-cn-20250628>中文</a></div></div><div class=pr-content><h2 id=nudge-users-into-migrating-to-new-default-gltf-coordinate-conversion>Nudge users into migrating to new default glTF coordinate conversion</h2><h3 id=basic-information>Basic Information</h3><ul><li><strong>Title</strong>: Nudge users into migrating to new default glTF coordinate conversion<li><strong>PR Link</strong>: https://github.com/bevyengine/bevy/pull/19816<li><strong>Author</strong>: janhohenheim<li><strong>Status</strong>: MERGED<li><strong>Labels</strong>: A-Assets, S-Ready-For-Final-Review, M-Needs-Migration-Guide, M-Needs-Release-Note, X-Blessed, D-Straightforward, A-glTF<li><strong>Created</strong>: 2025-06-25T22:54:41Z<li><strong>Merged</strong>: 2025-06-28T18:55:41Z<li><strong>Merged By</strong>: alice-i-cecile</ul><h3 id=description-translation>Description Translation</h3><h1 id=objective>Objective</h1><p><em>Step towards https://github.com/bevyengine/bevy/issues/19686</em><p>We now have all the infrastructure in place to migrate Bevy’s default behavior when loading glTF files to respect their coordinate system. Let’s start migrating! For motivation, see the issue linked above<h2 id=solution>Solution</h2><ul><li>Introduce a feature flag called <code>gltf_convert_coordinates_default</code><li>Currently,<code>GltfPlugin::convert_coordinates</code> defaults to <code>false</code><li>If <code>gltf_convert_coordinates_default</code> is enabled, <code>GltfPlugin::convert_coordinates</code> will default to <code>true</code><li>If <code>gltf_convert_coordinates_default</code> is not enabled <em>and</em> <code>GltfPlugin::convert_coordinates</code> is false, we assume the user is implicitly using the old behavior. Print a warning <em>once</em> in that case, but only when a glTF was actually loaded<li>A user can opt into the new behavior either <ul><li>Globally, by enabling <code>gltf_convert_coordinates_default</code> in their <code>Cargo.toml</code><li>Globally, by enabling <code>GltfPlugin::convert_coordinates</code><li>Per asset, by enabling <code>GltfLoaderSettings::convert_coordinates</code></ul><li>A user can explicitly opt out of the new behavior and silence the warning by <ul><li>Enabling <code>gltf_convert_coordinates_default</code> in their <code>Cargo.toml</code> and disabling <code>GltfPlugin::convert_coordinates</code></ul><li>This PR also moves the existing release note into a migration guide</ul><p>Note that I’m very open to change any features, mechanisms, warning texts, etc. as needed :)<h2 id=future-work>Future Work</h2><ul><li>This PR leaves all examples fully functional by not enabling this flag internally yet. A followup PR will enable it as a <code>dev-dependency</code> and migrate all of our examples involving glTFs to the new behavior.<li>After 0.17 (and the RC before) lands, we’ll gather feedback to see if anything breaks or the suggested migration is inconvenient in some way<li>If all goes well, we’ll kill this flag and change the default of <code>GltfPlugin::convert_coordinates</code> to <code>true</code> in 0.18</ul><h2 id=testing>Testing</h2><ul><li>Ran examples with and without the flag</ul><h3 id=the-story-of-this-pull-request>The Story of This Pull Request</h3><p>The core issue addressed in this PR stems from the fundamental mismatch between Bevy’s coordinate system and the glTF specification. Bevy uses a Y-up, right-handed coordinate system with -Z as forward, while glTF uses Y-up, right-handed with +Z as forward. This discrepancy causes imported glTF models to appear rotated 180 degrees around the Y-axis relative to their orientation in modeling software.<p>The challenge was to migrate users to the corrected coordinate handling without breaking existing projects. Previous PRs (#19633, #19685) had implemented the technical conversion capability, but changing the default behavior would immediately break scenes for all users. A gradual migration path was needed.<p>The solution introduces a feature flag <code>gltf_convert_coordinates_default</code> that controls the default behavior of the glTF loader. When enabled, it sets <code>GltfPlugin::convert_coordinates</code> to <code>true</code> by default. More importantly, when users load glTF assets without explicitly opting into either behavior, the system detects this and issues a one-time warning:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#fa6e32>if </span><span style=color:#ed9366>!</span><span>convert_by_default </span><span style=color:#ed9366>&& !</span><span style=color:#f07171>cfg!</span><span>(feature </span><span style=color:#ed9366>= </span><span style=color:#86b300>"gltf_convert_coordinates_default"</span><span>) {
</span><span>    </span><span style=color:#f07171>warn_once!</span><span>(
</span><span>        </span><span style=color:#86b300>"Starting from Bevy 0.18, by default all imported glTF models will be rotated by 180 degrees around the Y axis to align with Bevy's coordinate system. </span><span style=color:#61676ccc>\
</span><span style=color:#86b300>        You are currently importing glTF files using the old behavior. Consider opting-in to the new import behavior by enabling the `gltf_convert_coordinates_default` feature. </span><span style=color:#61676ccc>\
</span><span style=color:#86b300>        If you encounter any issues please file a bug! </span><span style=color:#61676ccc>\
</span><span style=color:#86b300>        If you want to continue using the old behavior going forward (even when the default changes in 0.18), manually set the corresponding option in the `GltfPlugin` or `GltfLoaderSettings`. See the migration guide for more details."
</span><span>    )</span><span style=color:#61676ccc>;
</span><span>}
</span></code></pre><p>This warning serves multiple purposes: it informs users about the upcoming change, provides immediate migration options, and offers an escape hatch for those who need to maintain the old behavior. The <code>warn_once!</code> macro ensures the message appears only once per application run to avoid log spam.<p>The implementation required coordinated changes across several files. The feature flag was added to the top-level Cargo.toml and propagated through the crate hierarchy:<pre class=language-toml data-lang=toml style=color:#61676c;background-color:#fafafa><code class=language-toml data-lang=toml><span style=color:#abb0b6;font-style:italic># Cargo.toml
</span><span style=color:#399ee6>gltf_convert_coordinates_default </span><span>= [
</span><span>  </span><span style=color:#86b300>"bevy_internal/gltf_convert_coordinates_default"</span><span style=color:#61676ccc>,
</span><span>]
</span><span>
</span><span style=color:#abb0b6;font-style:italic># crates/bevy_internal/Cargo.toml
</span><span style=color:#399ee6>gltf_convert_coordinates_default </span><span>= [
</span><span>  </span><span style=color:#86b300>"bevy_gltf?/gltf_convert_coordinates_default"</span><span style=color:#61676ccc>,
</span><span>]
</span></code></pre><p>The default behavior in <code>GltfPlugin</code> was modified to respect the feature flag:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// crates/bevy_gltf/src/lib.rs
</span><span style=color:#fa6e32>impl </span><span>Default </span><span style=color:#fa6e32>for </span><span style=color:#399ee6>GltfPlugin </span><span>{
</span><span>    </span><span style=color:#fa6e32>fn </span><span style=color:#f29718>default</span><span>() </span><span style=color:#61676ccc>-> </span><span style=color:#fa6e32>Self </span><span>{
</span><span>        GltfPlugin {
</span><span>            default_sampler</span><span style=color:#61676ccc>: </span><span>ImageSamplerDescriptor</span><span style=color:#ed9366>::</span><span>linear()</span><span style=color:#61676ccc>,
</span><span>            custom_vertex_attributes</span><span style=color:#61676ccc>: </span><span>HashMap</span><span style=color:#ed9366>::</span><span>default()</span><span style=color:#61676ccc>,
</span><span>            convert_coordinates</span><span style=color:#61676ccc>: </span><span style=color:#f07171>cfg!</span><span>(feature </span><span style=color:#ed9366>= </span><span style=color:#86b300>"gltf_convert_coordinates_default"</span><span>)</span><span style=color:#61676ccc>,
</span><span>        }
</span><span>    }
</span><span>}
</span></code></pre><p>The migration guide was significantly expanded with concrete examples of both global and per-asset configuration options, providing clear migration paths:<pre class=language-markdown data-lang=markdown style=color:#61676c;background-color:#fafafa><code class=language-markdown data-lang=markdown><span style=color:#fa6e32;font-weight:700># </span><span style=color:#399ee6;font-weight:700>release-content/migration-guides/convert-coordinates.md
</span><span>As the warning says, you can opt into the new behavior by enabling the </span><span style=color:#ed9366;background-color:#61676c10>`gltf_convert_coordinates_default`</span><span> feature in your </span><span style=color:#ed9366;background-color:#61676c10>`Cargo.toml`</span><span>:
</span><span>
</span><span>```</span><span style=color:#ff8f40>toml
</span><span style=color:#61676c;background-color:#61676c07># new behavior, converts the coordinate system of all glTF assets into Bevy's coordinate system
</span><span style=color:#61676c;background-color:#61676c07>[dependencies]
</span><span style=color:#61676c;background-color:#61676c07>bevy = { version = "0.17.0", features = ["gltf_convert_coordinates_default"] }
</span></code></pre><p>You can also control this on a per-asset-level:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#fa6e32>let</span><span> handle </span><span style=color:#ed9366>=</span><span> asset_server</span><span style=color:#ed9366>.</span><span style=color:#f07171>load_with_settings</span><span>(
</span><span>    </span><span style=color:#86b300>"scene.gltf#Scene0"</span><span style=color:#61676ccc>,
</span><span>    |</span><span style=color:#ff8f40>s</span><span style=color:#61676ccc>: </span><span style=color:#ed9366>&</span><span style=color:#fa6e32>mut</span><span> GltfLoaderSettings| {
</span><span>        s</span><span style=color:#ed9366>.</span><span>convert_coordinates </span><span style=color:#ed9366>= </span><span style=color:#ff8f40>true</span><span style=color:#61676ccc>;
</span><span>    }</span><span style=color:#61676ccc>,
</span><span>)</span><span style=color:#61676ccc>;
</span></code></pre><p>The approach demonstrates several good practices for breaking changes: feature flags for gradual rollout, clear warnings with actionable advice, multiple migration paths, and comprehensive documentation. The warning system in particular is well-designed - it triggers only when actual glTF assets are loaded using the old defaults, avoiding false positives.<p>The PR maintains backward compatibility while clearly signaling future changes. The next steps include enabling the feature in examples (as a dev-dependency), gathering user feedback during the 0.17 release cycle, and finally changing the default behavior in 0.18 after sufficient testing.<h3 id=visual-representation>Visual Representation</h3><pre class=language-mermaid data-lang=mermaid style=color:#61676c;background-color:#fafafa><code class=language-mermaid data-lang=mermaid><span>graph TD
</span><span>    A[glTF Asset] --> B[GltfLoader]
</span><span>    B --> C{convert_coordinates?}
</span><span>    C -->|Default| D[Feature Flag]
</span><span>    C -->|Explicit| E[Plugin Setting]
</span><span>    C -->|Per-asset| F[LoaderSettings]
</span><span>    D --> G[Convert Coordinates]
</span><span>    E --> G
</span><span>    F --> G
</span><span>    G --> H[Adjusted Transform]
</span><span>    D -->|Not set| I[Warning Logged]
</span></code></pre><h3 id=key-files-changed>Key Files Changed</h3><ol><li><p><strong><code>release-content/migration-guides/convert-coordinates.md</code> (+26/-3)</strong><br> Expanded the migration guide with detailed instructions and examples for different migration scenarios.</p> <pre class=language-markdown data-lang=markdown style=color:#61676c;background-color:#fafafa><code class=language-markdown data-lang=markdown><span style=color:#fa6e32;font-weight:700># </span><span style=color:#399ee6;font-weight:700>Before:
</span><span>[dependencies]
</span><span>bevy = "0.17.0"
</span><span>
</span><span style=color:#fa6e32;font-weight:700># </span><span style=color:#399ee6;font-weight:700>After:
</span><span>[dependencies]
</span><span>bevy = { version = "0.17.0", features = ["gltf_convert_coordinates_default"] }
</span></code></pre><li><p><strong><code>crates/bevy_gltf/src/loader/mod.rs</code> (+13/-1)</strong><br> Added warning logic when old behavior is detected.</p> <pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before:
</span><span style=color:#fa6e32>let</span><span> convert_coordinates </span><span style=color:#ed9366>= </span><span style=color:#fa6e32>match</span><span> settings</span><span style=color:#ed9366>.</span><span>convert_coordinates {
</span><span>    </span><span style=color:#55b4d4;font-style:italic>Some</span><span>(convert_coordinates) </span><span style=color:#ed9366>=></span><span> convert_coordinates</span><span style=color:#61676ccc>,
</span><span>    </span><span style=color:#55b4d4;font-style:italic>None </span><span style=color:#ed9366>=></span><span> loader</span><span style=color:#ed9366>.</span><span>default_convert_coordinates</span><span style=color:#61676ccc>,
</span><span>}</span><span style=color:#61676ccc>;
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After:
</span><span style=color:#fa6e32>let</span><span> convert_coordinates </span><span style=color:#ed9366>= </span><span style=color:#fa6e32>match</span><span> settings</span><span style=color:#ed9366>.</span><span>convert_coordinates {
</span><span>    </span><span style=color:#55b4d4;font-style:italic>Some</span><span>(convert_coordinates) </span><span style=color:#ed9366>=></span><span> convert_coordinates</span><span style=color:#61676ccc>,
</span><span>    </span><span style=color:#55b4d4;font-style:italic>None </span><span style=color:#ed9366>=> </span><span>{
</span><span>        </span><span style=color:#fa6e32>let</span><span> convert_by_default </span><span style=color:#ed9366>=</span><span> loader</span><span style=color:#ed9366>.</span><span>default_convert_coordinates</span><span style=color:#61676ccc>;
</span><span>        </span><span style=color:#fa6e32>if </span><span style=color:#ed9366>!</span><span>convert_by_default </span><span style=color:#ed9366>&& !</span><span style=color:#f07171>cfg!</span><span>(feature </span><span style=color:#ed9366>= </span><span style=color:#86b300>"gltf_convert_coordinates_default"</span><span>) {
</span><span>            </span><span style=color:#f07171>warn_once!</span><span>(</span><span style=color:#ed9366>...</span><span>)</span><span style=color:#61676ccc>;
</span><span>        }
</span><span>        convert_by_default
</span><span>    }
</span><span>}</span><span style=color:#61676ccc>;
</span></code></pre><li><p><strong><code>Cargo.toml</code> (+5/-0)</strong><br> Added top-level feature flag definition.</p> <pre class=language-toml data-lang=toml style=color:#61676c;background-color:#fafafa><code class=language-toml data-lang=toml><span style=color:#abb0b6;font-style:italic># Added:
</span><span style=color:#399ee6>gltf_convert_coordinates_default </span><span>= [
</span><span>  </span><span style=color:#86b300>"bevy_internal/gltf_convert_coordinates_default"</span><span style=color:#61676ccc>,
</span><span>]
</span></code></pre><li><p><strong><code>crates/bevy_internal/Cargo.toml</code> (+4/-0)</strong><br> Propagated feature flag to internal crates.</p> <pre class=language-toml data-lang=toml style=color:#61676c;background-color:#fafafa><code class=language-toml data-lang=toml><span style=color:#abb0b6;font-style:italic># Added:
</span><span style=color:#399ee6>gltf_convert_coordinates_default </span><span>= [
</span><span>  </span><span style=color:#86b300>"bevy_gltf?/gltf_convert_coordinates_default"</span><span style=color:#61676ccc>,
</span><span>]
</span></code></pre><li><p><strong><code>crates/bevy_gltf/src/lib.rs</code> (+1/-1)</strong><br> Modified default behavior to respect feature flag.</p> <pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before:
</span><span>convert_coordinates</span><span style=color:#61676ccc>: </span><span style=color:#ff8f40>false</span><span style=color:#61676ccc>,
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After:
</span><span>convert_coordinates</span><span style=color:#61676ccc>: </span><span style=color:#f07171>cfg!</span><span>(feature </span><span style=color:#ed9366>= </span><span style=color:#86b300>"gltf_convert_coordinates_default"</span><span>)</span><span style=color:#61676ccc>,
</span></code></pre></ol><h3 id=further-reading>Further Reading</h3><ol><li><a rel="noopener nofollow noreferrer" href=https://registry.khronos.org/glTF/specs/2.0/glTF-2.0.html#coordinate-system-and-units target=_blank>glTF Coordinate System Specification</a><li><a rel="noopener nofollow noreferrer" href=https://github.com/bevyengine/bevy/blob/main/docs/cargo_features.md target=_blank>Bevy Feature Flags Documentation</a><li><a rel="noopener nofollow noreferrer" href=https://rust-lang.github.io/api-guidelines/future-proofing.html target=_blank>Gradual Migration Patterns in Rust</a><li><a rel="noopener nofollow noreferrer" href=https://github.com/bevyengine/bevy/issues/19686 target=_blank>Original Coordinate System Issue (#19686)</a></ol></div><div data-is-md-page=true data-patch-exists=true data-patch-path=/pull_request/bevy/2025-06/pr_19816.patch id=patch-info style=display:none></div><div class=bottom-spacer></div></div></div>