<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://unknownue.github.io name=base><title>
         #22344 Update Automatic Directional Navigation Release Notes (due to dependency rearrangement)
        
    </title><meta content="#22344 Update Automatic Directional Navigation Release Notes (due to dependency rearrangement)" property=og:title><meta content="A personal blog built with Zola and Apollo theme" property=og:description><meta content="A personal blog built with Zola and Apollo theme" name=description><link href=/icons/favicon.png rel=icon type=image/png><link href=https://unknownue.github.io/fonts.css rel=stylesheet><script src=https://unknownue.github.io/js/codeblock.js></script><script src=https://unknownue.github.io/js/toc.js></script><script src=https://unknownue.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Unknownue's Blog" href=https://unknownue.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://unknownue.github.io/theme/light.css rel=stylesheet><link href=https://unknownue.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://unknownue.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://unknownue.github.io/main.css media=screen rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js></script><script>// Initialize mermaid once DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            mermaid.initialize({
                startOnLoad: false,
                theme: document.body && document.body.classList.contains('dark') ? 'dark' : 'default',
                securityLevel: 'loose',
                flowchart: {
                    useMaxWidth: true,
                    htmlLabels: true
                },
                sequence: {
                    diagramMarginX: 50,
                    diagramMarginY: 10,
                    actorMargin: 50,
                    width: 150,
                    height: 65
                }
            });
        });</script><script src=https://unknownue.github.io/js/main.js></script><script defer src=https://unknownue.github.io/js/label-colors.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/rust.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/typescript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/go.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/cpp.min.js></script><script>// Ensure highlight.js is properly configured
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof hljs !== 'undefined') {
                hljs.configure({
                    languages: ['rust', 'javascript', 'python', 'cpp', 'go', 'typescript'],
                    ignoreUnescapedHTML: true
                });
                console.log('Highlight.js configured in header');
            }
        });</script><link href=https://cdn.jsdelivr.net/npm/diff2html/bundles/css/diff2html.min.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/diff2html/bundles/js/diff2html-ui.min.js></script><script src=https://unknownue.github.io/js/syntax-highlight.js></script><script src=https://unknownue.github.io/js/diff-sidebar.js></script><script src="https://unknownue.github.io/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><div class=content><header><div class=main><a href=https://unknownue.github.io>Unknownue's Blog</a><div class=socials><a class=social href=https://github.com/unknownue rel=me> <img alt=github src=https://unknownue.github.io/icons/social/github.svg> </a><a class=social href=https://github.com/unknownue/unknownue.github.io rel=me> <img alt=github-io src=https://unknownue.github.io/icons/social/rss.svg> </a></div></div><nav><a href=https://unknownue.github.io/posts style=margin-left:.25em>/posts</a><a href=https://unknownue.github.io/projects style=margin-left:.25em>/projects</a><a href=https://unknownue.github.io/about style=margin-left:.25em>/about</a><a href=https://unknownue.github.io/tags style=margin-left:.25em>/tags</a><button title="$SHORTCUT to open search" class=search-button id=search-button><img alt=Search class=search-icon src=https://unknownue.github.io/icons/search.svg></button><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><div id=modal-content><h1 class=page-header id=modalTitle>Search</h1><div id=searchBar><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search... role=combobox spellcheck=false><button title="Clear search" class=clear-button id=clear-search><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></button></div><div id=results-container><div id=results-info><span id=zero_results style=display:none>No results</span><span id=one_result style=display:none>1 result</span><span id=many_results style=display:none>$NUMBER results</span></div><div id=results role=listbox></div></div></div></div><a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://unknownue.github.io/icons/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://unknownue.github.io/icons/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><div class=pull-request-page><article class=md-content-page style=display:none></article><div class=back-link><a href=/pull_request/bevy/2026-01/>← Back to Pull Requests</a></div><div class=pr-metadata><span class=pr-date>2026-01-07</span><div class=language-switcher><a class=lang-link data-lang=en href=/pull_request/bevy/2026-01/pr-22344-en-20260107>English</a> / <span class="lang-link active" data-lang=zh-cn>中文</span></div></div><div class=pr-content><h1 id=biao-ti>标题</h1><h2 id=ji-ben-xin-xi>基本信息</h2><ul><li><strong>标题</strong>: Update Automatic Directional Navigation Release Notes (due to dependency rearrangement)<li><strong>PR 链接</strong>: https://github.com/bevyengine/bevy/pull/22344<li><strong>作者</strong>: kfc35<li><strong>状态</strong>: 已合并<li><strong>标签</strong>: C-Docs, A-UI, S-Needs-Review<li><strong>创建时间</strong>: 2026-01-01T23:33:47Z<li><strong>合并时间</strong>: 2026-01-07T21:38:00Z<li><strong>合并者</strong>: cart</ul><h2 id=miao-shu-fan-yi>描述翻译</h2><p>本 PR 旨在更新自动方向导航功能的发布说明，以反映 #22340 带来的依赖项重新安排。<h3 id=mu-biao>目标</h3><ul><li>记录解决 #22305 的更改<li>根据 #22340 的结果更新发布说明</ul><p>此更新依赖于 #22340 合并到 0.18 版本！<p><strong>注意：此 PR 指向合并到 release-0.18.0 分支</strong>，而非 main 分支<p>@jbuehler23 请知悉<h2 id=ben-pull-request-de-ji-shu-gu-shi>本 Pull Request 的技术故事</h2><h3 id=wen-ti-bei-jing-yu-shang-xia-wen>问题背景与上下文</h3><p>在 Bevy 0.17 版本中，自动方向导航功能通过 PR #21668 引入，为 UI 元素提供了自动生成导航图的能力。然而，在后续的开发中，团队发现原有的实现存在架构上的限制，特别是在依赖管理和系统参数使用方面。<p>PR #22340 对自动方向导航的实现进行了重构，将核心功能从一个系统（system）移动到了系统参数（SystemParam）中。这种架构变更需要同步更新相关的文档，特别是发布说明，以确保用户了解如何正确使用更新后的 API。<h3 id=jie-jue-fang-an>解决方案</h3><p>本 PR 的主要任务是更新发布说明文档，反映 API 的变化。具体来说，需要：<ol><li>更新功能描述，准确反映新的实现方式<li>提供新的代码示例，展示如何使用 <code>AutoDirectionalNavigator</code> 系统参数<li>更新迁移指南，清晰展示从 0.17 到 0.18 的变更</ol><h3 id=shi-xian-xi-jie>实现细节</h3><p>发布说明的更新主要集中在澄清自动方向导航的工作机制。在 0.17 版本中，文档暗示系统会自动维护导航图，但在 0.18 版本中，这实际上是通过 <code>AutoDirectionalNavigator</code> 系统参数在需要时动态计算的。<p>关键的技术变更点包括：<ol><li><strong>API 变更</strong>：从 <code>DirectionalNavigation</code> 系统参数迁移到 <code>AutoDirectionalNavigator</code><li><strong>工作机制变更</strong>：从持续的图维护转变为按需计算<li><strong>配置方式不变</strong>：<code>AutoDirectionalNavigation</code> 组件的配置方式保持不变</ol><h3 id=ji-shu-jian-jie>技术见解</h3><p>这种从系统到系统参数的架构重构体现了 Bevy 在 API 设计上的演进思考：<ul><li><strong>按需计算 vs 持续维护</strong>：新的实现避免了在 UI 变化时不断重新计算导航图的开销，改为在导航发生时按需计算<li><strong>系统参数的灵活性</strong>：将功能封装为系统参数提供了更好的模块化和可测试性<li><strong>向后兼容性</strong>：虽然内部实现发生了变化，但用户级别的配置接口保持不变</ul><h3 id=ying-xiang>影响</h3><ol><li><strong>性能优化</strong>：减少了不必要的计算，只在需要导航时才计算相邻元素<li><strong>API 清晰度</strong>：更准确地反映了功能的工作方式，避免了“自动维护“的误解<li><strong>迁移指导</strong>：提供了清晰的从旧版本迁移到新版本的代码示例</ol><h2 id=shi-jue-biao-shi>视觉表示</h2><pre class=language-mermaid data-lang=mermaid style=color:#61676c;background-color:#fafafa><code class=language-mermaid data-lang=mermaid><span>graph TD
</span><span>    A[AutoDirectionalNavigation 组件] --> B[自动方向导航功能]
</span><span>    C[DirectionalNavigationPlugin] --> B
</span><span>    D[AutoDirectionalNavigator 系统参数] --> B
</span><span>    B --> E[基于空间位置的导航计算]
</span><span>    E --> F[八方向邻近搜索]
</span><span>    F --> G[距离与对齐度评估]
</span></code></pre><h2 id=guan-jian-wen-jian-bian-geng>关键文件变更</h2><h3 id=release-content-release-notes-automatic-directional-navigation-md-30-10><code>release-content/release-notes/automatic_directional_navigation.md</code> (+30/-10)</h3><p>这个文件包含了自动方向导航功能的发布说明。主要变更包括：<ol><li><strong>添加了新的 PR 引用</strong>：在元数据中添加了 #22340<li><strong>更新了功能描述</strong>：更准确地描述了自动导航的工作机制<li><strong>添加了新的代码示例</strong>：展示了如何使用 <code>AutoDirectionalNavigator</code> 系统参数<li><strong>更新了迁移指南</strong>：展示了从 0.17 到 0.18 的完整迁移路径</ol><p><strong>关键代码变更</strong>：<pre class=language-markdown data-lang=markdown style=color:#61676c;background-color:#fafafa><code class=language-markdown data-lang=markdown><span style=color:#abb0b6;font-style:italic>&LT!-- Before: 原描述暗示系统会自动维护导航图 -->
</span><span>Bevy now supports </span><span style=color:#f07171;font-weight:700>**automatic directional navigation graph generation**</span><span> for UI elements!
</span><span>
</span><span style=color:#abb0b6;font-style:italic>&LT!-- After: 更准确地描述为自动方向导航 -->
</span><span>Bevy now supports </span><span style=color:#f07171;font-weight:700>**automatic directional navigation**</span><span> for UI elements!
</span></code></pre><pre class=language-markdown data-lang=markdown style=color:#61676c;background-color:#fafafa><code class=language-markdown data-lang=markdown><span style=color:#abb0b6;font-style:italic>&LT!-- Before: 简化的使用说明 -->
</span><span>That's it! The </span><span style=color:#ed9366;background-color:#61676c10>`DirectionalNavigationPlugin`</span><span> includes a system that automatically maintains the navigation graph as your UI changes.
</span><span>
</span><span style=color:#abb0b6;font-style:italic>&LT!-- After: 明确指出了系统参数的使用 -->
</span><span>That's it! The </span><span style=color:#ed9366;background-color:#61676c10>`DirectionalNavigationPlugin`</span><span> will set up the resources that </span><span style=color:#ed9366;background-color:#61676c10>`AutoDirectionalNavigator`</span><span> uses to function.
</span></code></pre><pre class=language-markdown data-lang=markdown style=color:#61676c;background-color:#fafafa><code class=language-markdown data-lang=markdown><span style=color:#abb0b6;font-style:italic>&LT!-- 添加了新的系统参数使用示例 -->
</span><span>To leverage automatic navigation, use the </span><span style=color:#ed9366;background-color:#61676c10>`AutoDirectionalNavigator`</span><span> system parameter instead of the </span><span style=color:#ed9366;background-color:#61676c10>`DirectionalNavigation`</span><span> system parameter:
</span><span>
</span><span>```</span><span style=color:#ff8f40>rust
</span><span style=color:#fa6e32;background-color:#61676c07>fn </span><span style=color:#f29718;background-color:#61676c07>my_navigation_system</span><span style=color:#61676c;background-color:#61676c07>(</span><span style=color:#fa6e32;background-color:#61676c07>mut </span><span style=color:#ff8f40;background-color:#61676c07>auto_directional_navigator</span><span style=color:#61676ccc;background-color:#61676c07>:</span><span style=color:#61676c;background-color:#61676c07> AutoDirectionalNavigator) {
</span><span style=color:#61676c;background-color:#61676c07>    </span><span style=color:#abb0b6;background-color:#61676c07;font-style:italic>// ...
</span><span style=color:#61676c;background-color:#61676c07>    auto_directional_navigator</span><span style=color:#ed9366;background-color:#61676c07>.</span><span style=color:#f07171;background-color:#61676c07>navigate</span><span style=color:#61676c;background-color:#61676c07>(CompassOctant</span><span style=color:#ed9366;background-color:#61676c07>::</span><span style=color:#61676c;background-color:#61676c07>East)</span><span style=color:#61676ccc;background-color:#61676c07>;
</span><span style=color:#61676c;background-color:#61676c07>    </span><span style=color:#abb0b6;background-color:#61676c07;font-style:italic>// ...
</span><span style=color:#61676c;background-color:#61676c07>}
</span></code></pre><pre style=color:#61676c;background-color:#fafafa><code><span>
</span><span>```markdown
</span><span>&LT!-- 更新了迁移指南，展示新旧版本对比 -->
</span><span>// 0.17
</span><span>// Use the DirectionalNavigation SystemParam to navigate in your system
</span><span>fn my_navigation_system(mut directional_navigation: DirectionalNavigation) {
</span><span>    // ...
</span><span>    directional_navigation.navigate(CompassOctant::East);
</span><span>    // ...
</span><span>}
</span><span>
</span><span>// 0.18
</span><span>// Use the AutoDirectionalNavigator SystemParam to navigate in your system
</span><span>fn my_navigation_system(mut auto_directional_navigator: AutoDirectionalNavigator) {
</span><span>    // ...
</span><span>    auto_directional_navigator.navigate(CompassOctant::East);
</span><span>    // ...
</span><span>}
</span></code></pre><h2 id=wan-zheng-dai-ma-chai-yi>完整代码差异</h2><pre class=language-diff data-lang=diff style=color:#61676c;background-color:#fafafa><code class=language-diff data-lang=diff><span>diff --git a/release-content/release-notes/automatic_directional_navigation.md b/release-content/release-notes/automatic_directional_navigation.md
</span><span>index 250d113177e39..eb4fb154527ec 100644
</span><span style=color:#c594c5>--- a/release-content/release-notes/automatic_directional_navigation.md
</span><span style=color:#c594c5>+++ b/release-content/release-notes/automatic_directional_navigation.md
</span><span style=color:#c594c5>@@ -1,16 +1,16 @@
</span><span> ---
</span><span> title: Automatic Directional Navigation
</span><span> authors: ["@jbuehler23"]
</span><span style=color:#f07171>-pull_requests: [21668]
</span><span style=color:#86b300>+pull_requests: [21668, 22340]
</span><span> ---
</span><span> 
</span><span style=color:#f07171>-Bevy now supports **automatic directional navigation graph generation** for UI elements! No more tedious manual wiring of navigation connections for your menus and UI screens.
</span><span style=color:#86b300>+Bevy now supports **automatic directional navigation** for UI elements! No more tedious manual wiring of navigation connections for your menus and UI screens.
</span><span> 
</span><span> ## What's New?
</span><span> 
</span><span> Previously, creating directional navigation for UI required manually defining every connection between focusable elements using `DirectionalNavigationMap`. For dynamic UIs or complex layouts, this was time-consuming and error-prone.
</span><span> 
</span><span style=color:#f07171>-Now, you can simply add the `AutoDirectionalNavigation` component to your UI entities, and Bevy will automatically compute navigation connections based on spatial positioning. The system intelligently finds the nearest neighbor in each of the 8 compass directions (North, Northeast, East, etc.), considering:
</span><span style=color:#86b300>+Now, you can simply add the `AutoDirectionalNavigation` component to your UI entities, and Bevy will automatically compute navigation connections based on spatial positioning. The system parameter intelligently finds the nearest neighbor in each of the 8 compass directions (North, Northeast, East, etc.), considering:
</span><span> 
</span><span> - **Distance**: Closer elements are preferred
</span><span> - **Alignment**: Elements that are more directly in line with the navigation direction are favored
</span><span style=color:#c594c5>@@ -29,7 +29,17 @@ </span><span style=color:#399ee6>commands.spawn((
</span><span> ));
</span></code></pre><p>-That’s it! The <code>DirectionalNavigationPlugin</code> includes a system that automatically maintains the navigation graph as your UI changes. +To leverage automatic navigation, use the <code>AutoDirectionalNavigator</code> system parameter instead of the <code>DirectionalNavigation</code> system parameter: + +```rust +fn my_navigation_system(mut auto_directional_navigator: AutoDirectionalNavigator) {<ul><li>// …<li>auto_directional_navigator.navigate(CompassOctant::East);<li>// … +} +```<li></ul><p>+That’s it! The <code>DirectionalNavigationPlugin</code> will set up the resources that <code>AutoDirectionalNavigator</code> uses to function.<h3 id=configuration>Configuration</h3><p>@@ -68,24 +78,34 @@ This is a non-breaking change. Existing manual navigation setups continue to wor<p>If you want to convert existing manual navigation to automatic:<h2 id=before>-<strong>Before:</strong></h2><pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#ed9366>+</span><span style=color:#abb0b6;font-style:italic>// 0.17
</span><span style=color:#abb0b6;font-style:italic>// Manually define all edges
</span><span>directional_nav_map</span><span style=color:#ed9366>.</span><span style=color:#f07171>add_looping_edges</span><span>(</span><span style=color:#ed9366>&</span><span>row_entities</span><span style=color:#61676ccc>, </span><span>CompassOctant</span><span style=color:#ed9366>::</span><span>East)</span><span style=color:#61676ccc>;
</span><span>directional_nav_map</span><span style=color:#ed9366>.</span><span style=color:#f07171>add_edges</span><span>(</span><span style=color:#ed9366>&</span><span>column_entities</span><span style=color:#61676ccc>, </span><span>CompassOctant</span><span style=color:#ed9366>::</span><span>South)</span><span style=color:#61676ccc>;
</span><span style=color:#abb0b6;font-style:italic>// ... repeat for all rows and columns
</span><span style=color:#ed9366>-</span><span>```
</span><span>
</span><span style=color:#ed9366>-**</span><span>After</span><span style=color:#61676ccc>:</span><span style=color:#ed9366>**
</span><span style=color:#ed9366>+</span><span style=color:#abb0b6;font-style:italic>// Use the DirectionalNavigation SystemParam to navigate in your system
</span><span style=color:#ed9366>+</span><span style=color:#fa6e32>fn </span><span style=color:#f29718>my_navigation_system</span><span>(</span><span style=color:#fa6e32>mut </span><span style=color:#ff8f40>directional_navigation</span><span style=color:#61676ccc>:</span><span> DirectionalNavigation) {
</span><span style=color:#ed9366>+    </span><span style=color:#abb0b6;font-style:italic>// ...
</span><span style=color:#ed9366>+</span><span>    directional_navigation</span><span style=color:#ed9366>.</span><span style=color:#f07171>navigate</span><span>(CompassOctant</span><span style=color:#ed9366>::</span><span>East)</span><span style=color:#61676ccc>;
</span><span style=color:#ed9366>+    </span><span style=color:#abb0b6;font-style:italic>// ...
</span><span style=color:#ed9366>+</span><span>}
</span><span>
</span><span style=color:#ed9366>-</span><span>```rust
</span><span style=color:#ed9366>+</span><span style=color:#abb0b6;font-style:italic>// 0.18
</span><span style=color:#abb0b6;font-style:italic>// Just add the component to your UI entities
</span><span>commands</span><span style=color:#ed9366>.</span><span style=color:#f07171>spawn</span><span>((
</span><span>    Button</span><span style=color:#61676ccc>,
</span><span>    Node { </span><span style=color:#abb0b6;font-style:italic>/* ... */ </span><span>}</span><span style=color:#61676ccc>,
</span><span>    AutoDirectionalNavigation</span><span style=color:#ed9366>::</span><span>default()</span><span style=color:#61676ccc>,
</span><span>))</span><span style=color:#61676ccc>;
</span><span style=color:#ed9366>+
</span><span style=color:#ed9366>+</span><span style=color:#abb0b6;font-style:italic>// Use the AutoDirectionalNavigator SystemParam to navigate in your system
</span><span style=color:#ed9366>+</span><span style=color:#fa6e32>fn </span><span style=color:#f29718>my_navigation_system</span><span>(</span><span style=color:#fa6e32>mut </span><span style=color:#ff8f40>auto_directional_navigator</span><span style=color:#61676ccc>:</span><span> AutoDirectionalNavigator) {
</span><span style=color:#ed9366>+    </span><span style=color:#abb0b6;font-style:italic>// ...
</span><span style=color:#ed9366>+</span><span>    auto_directional_navigator</span><span style=color:#ed9366>.</span><span style=color:#f07171>navigate</span><span>(CompassOctant</span><span style=color:#ed9366>::</span><span>East)</span><span style=color:#61676ccc>;
</span><span style=color:#ed9366>+    </span><span style=color:#abb0b6;font-style:italic>// ...
</span><span style=color:#ed9366>+</span><span>}
</span></code></pre><p>-Note: The automatic navigation system requires entities to have position and size information (<code>ComputedNode</code> and <code>UiGlobalTransform</code> for <code>bevy_ui</code> entities). +Note: Automatic navigation requires entities to have position and size information (<code>ComputedNode</code> and <code>UiGlobalTransform</code> for <code>bevy_ui</code> entities).<pre style=color:#61676c;background-color:#fafafa><code><span>
</span><span>## 扩展阅读
</span><span>1. **Bevy 系统参数文档**：了解 Bevy 中 SystemParam 的工作原理和最佳实践
</span><span>2. **UI 导航设计模式**：研究其他游戏引擎中 UI 导航的实现方式
</span><span>3. **空间算法**：深入了解邻近搜索和空间分区算法，这些是自动导航的基础
</span><span>4. **Bevy ECS 架构**：理解 Bevy 的实体组件系统如何支持这种按需计算的架构</span></code></pre></div><div data-is-md-page=true data-patch-exists=true data-patch-path=/pull_request/bevy/2026-01/pr_22344.patch id=patch-info style=display:none></div><div class=bottom-spacer></div></div></div>