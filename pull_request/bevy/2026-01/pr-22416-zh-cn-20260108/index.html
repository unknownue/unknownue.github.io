<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://unknownue.github.io name=base><title>
         #22416 Add AssetPath::resolve_path and resolve_embed_path methods
        
    </title><meta content="#22416 Add AssetPath::resolve_path and resolve_embed_path methods" property=og:title><meta content="A personal blog built with Zola and Apollo theme" property=og:description><meta content="A personal blog built with Zola and Apollo theme" name=description><link href=/icons/favicon.png rel=icon type=image/png><link href=https://unknownue.github.io/fonts.css rel=stylesheet><script src=https://unknownue.github.io/js/codeblock.js></script><script src=https://unknownue.github.io/js/toc.js></script><script src=https://unknownue.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Unknownue's Blog" href=https://unknownue.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://unknownue.github.io/theme/light.css rel=stylesheet><link href=https://unknownue.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://unknownue.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://unknownue.github.io/main.css media=screen rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js></script><script>// Initialize mermaid once DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            mermaid.initialize({
                startOnLoad: false,
                theme: document.body && document.body.classList.contains('dark') ? 'dark' : 'default',
                securityLevel: 'loose',
                flowchart: {
                    useMaxWidth: true,
                    htmlLabels: true
                },
                sequence: {
                    diagramMarginX: 50,
                    diagramMarginY: 10,
                    actorMargin: 50,
                    width: 150,
                    height: 65
                }
            });
        });</script><script src=https://unknownue.github.io/js/main.js></script><script defer src=https://unknownue.github.io/js/label-colors.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/rust.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/typescript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/go.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/cpp.min.js></script><script>// Ensure highlight.js is properly configured
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof hljs !== 'undefined') {
                hljs.configure({
                    languages: ['rust', 'javascript', 'python', 'cpp', 'go', 'typescript'],
                    ignoreUnescapedHTML: true
                });
                console.log('Highlight.js configured in header');
            }
        });</script><link href=https://cdn.jsdelivr.net/npm/diff2html/bundles/css/diff2html.min.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/diff2html/bundles/js/diff2html-ui.min.js></script><script src=https://unknownue.github.io/js/syntax-highlight.js></script><script src=https://unknownue.github.io/js/diff-sidebar.js></script><script src="https://unknownue.github.io/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><div class=content><header><div class=main><a href=https://unknownue.github.io>Unknownue's Blog</a><div class=socials><a class=social href=https://github.com/unknownue rel=me> <img alt=github src=https://unknownue.github.io/icons/social/github.svg> </a><a class=social href=https://github.com/unknownue/unknownue.github.io rel=me> <img alt=github-io src=https://unknownue.github.io/icons/social/rss.svg> </a></div></div><nav><a href=https://unknownue.github.io/posts style=margin-left:.25em>/posts</a><a href=https://unknownue.github.io/projects style=margin-left:.25em>/projects</a><a href=https://unknownue.github.io/about style=margin-left:.25em>/about</a><a href=https://unknownue.github.io/tags style=margin-left:.25em>/tags</a><button title="$SHORTCUT to open search" class=search-button id=search-button><img alt=Search class=search-icon src=https://unknownue.github.io/icons/search.svg></button><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><div id=modal-content><h1 class=page-header id=modalTitle>Search</h1><div id=searchBar><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search... role=combobox spellcheck=false><button title="Clear search" class=clear-button id=clear-search><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></button></div><div id=results-container><div id=results-info><span id=zero_results style=display:none>No results</span><span id=one_result style=display:none>1 result</span><span id=many_results style=display:none>$NUMBER results</span></div><div id=results role=listbox></div></div></div></div><a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://unknownue.github.io/icons/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://unknownue.github.io/icons/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><div class=pull-request-page><article class=md-content-page style=display:none></article><div class=back-link><a href=/pull_request/bevy/2026-01/>← Back to Pull Requests</a></div><div class=pr-metadata><span class=pr-date>2026-01-08</span><div class=language-switcher><a class=lang-link data-lang=en href=/pull_request/bevy/2026-01/pr-22416-en-20260108>English</a> / <span class="lang-link active" data-lang=zh-cn>中文</span></div></div><div class=pr-content><h1 id=title>Title</h1><p>Add AssetPath::resolve_path and resolve_embed_path methods<h2 id=basic-information>Basic Information</h2><ul><li><strong>Title</strong>: Add AssetPath::resolve_path and resolve_embed_path methods<li><strong>PR Link</strong>: https://github.com/bevyengine/bevy/pull/22416<li><strong>Author</strong>: Eyad3skr<li><strong>Status</strong>: MERGED<li><strong>Labels</strong>: A-Assets, C-Code-Quality, C-Usability, S-Ready-For-Final-Review, X-Uncontroversial, D-Straightforward<li><strong>Created</strong>: 2026-01-07T12:27:38Z<li><strong>Merged</strong>: 2026-01-08T19:03:17Z<li><strong>Merged By</strong>: alice-i-cecile</ul><h2 id=description-translation>Description Translation</h2><p><strong>目标</strong> (Objective)<p>修复 #22239<p><strong>解决方案</strong> (Solution)<ul><li>添加了 <code>resolve_path(&AssetPath)</code> - 等同于 <code>resolve(&str)</code><li>添加了 <code>resolve_embed_path(&AssetPath)</code> - 等同于 <code>resolve_embed(&str)</code><li>重构了 <code>resolve_internal</code> 以使用共享的 <code>resolve_from_parts</code> 辅助函数<li>添加了单元测试来验证等价性<li>所有语义边缘情况都保留（例如：仅标签、前导斜杠）<li>现有方法的行为没有改变</ul><p><strong>测试</strong> (Testing)<ul><li>添加了2个新的等价性测试，证明 <code>resolve_path() ≡ resolve(&path.to_string())</code><li>所有20个测试通过：<code>cargo test -p bevy_asset --lib path::tests</code><li>测试覆盖：相对路径、标签、前导斜杠、显式资源源、RFC 1808 嵌入行为</ul><p><strong>如何测试</strong> (How to test)<pre style=color:#61676c;background-color:#fafafa><code><span>cargo test -p bevy_asset --lib path::tests
</span></code></pre><hr><h2 id=the-story-of-this-pull-request>The Story of This Pull Request</h2><h3 id=the-problem-and-context>The Problem and Context</h3><p>在 Bevy 的资产系统中，<code>AssetPath</code> 结构体提供了 <code>resolve</code> 和 <code>resolve_embed</code> 方法来解析相对路径。这些方法原本只接受字符串参数（<code>&str</code>），这意味着当开发者已经有一个 <code>AssetPath</code> 实例时，仍然需要先将其转换为字符串，再由这些方法重新解析。这个过程既低效又冗余。<p>具体来说，使用场景是这样的：假设你有一个基础路径 <code>base_path: AssetPath</code> 和一个相对路径 <code>relative_path: AssetPath</code>，你想要将它们组合起来。原本的做法是：<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#fa6e32>let</span><span> resolved </span><span style=color:#ed9366>=</span><span> base_path</span><span style=color:#ed9366>.</span><span style=color:#f07171>resolve</span><span>(</span><span style=color:#ed9366>&</span><span>relative_path</span><span style=color:#ed9366>.</span><span style=color:#f07171>to_string</span><span>())</span><span style=color:#61676ccc>;
</span></code></pre><p>这里存在两个问题：首先，<code>to_string()</code> 进行了不必要的字符串分配；其次，<code>resolve</code> 内部需要重新解析这个字符串。这是一个典型的 API 设计问题——当调用者已经持有结构化的数据时，API 却要求他们将数据序列化为字符串。<h3 id=the-solution-approach>The Solution Approach</h3><p>这个 PR 的解决方案直接而有效：为 <code>AssetPath</code> 添加接受 <code>&AssetPath</code> 参数的新方法，同时保留原有字符串接口以向后兼容。具体方法是：<ol><li>添加 <code>resolve(&AssetPath)</code> 和 <code>resolve_embed(&AssetPath)</code> 方法<li>将原有的字符串方法重命名为 <code>resolve_str</code> 和 <code>resolve_embed_str</code><li>重构内部实现，提取通用逻辑到 <code>resolve_from_parts</code> 函数中，避免代码重复</ol><p>这种设计保持了 API 的清晰性：当你有字符串时使用 <code>*_str</code> 方法，当你有 <code>AssetPath</code> 时直接使用新方法。这种模式在 Rust 生态系统中很常见，例如 <code>Path</code> 和 <code>PathBuf</code> 也提供了类似的方法。<h3 id=the-implementation>The Implementation</h3><p>核心实现位于 <code>crates/bevy_asset/src/path.rs</code>。原有的 <code>resolve</code> 和 <code>resolve_embed</code> 方法被重命名为 <code>resolve_str</code> 和 <code>resolve_embed_str</code>，并继续处理字符串解析。新添加的 <code>resolve</code> 和 <code>resolve_embed</code> 方法直接接受 <code>&AssetPath</code> 参数。<p>关键的技术决策是提取了一个共享的辅助函数 <code>resolve_from_parts</code>，它处理实际的路径解析逻辑。这个函数接受分解后的路径组成部分：基础路径、是否替换最后一部分（RFC 1808 语义）、源、路径和标签。这样，无论是从字符串解析还是直接从 <code>AssetPath</code> 获取这些部分，都能复用相同的解析逻辑。<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#fa6e32>fn </span><span style=color:#f29718>resolve_from_parts</span><span>(
</span><span>    </span><span style=color:#ed9366>&</span><span style=color:#ff8f40>self</span><span>,
</span><span>    </span><span style=color:#ff8f40>replace</span><span style=color:#61676ccc>: </span><span style=color:#fa6e32>bool</span><span>,           </span><span style=color:#abb0b6;font-style:italic>// 是否应用 RFC 1808 语义（移除最后一个路径组件）
</span><span>    </span><span style=color:#ff8f40>source</span><span style=color:#61676ccc>: </span><span style=color:#55b4d4;font-style:italic>Option</span><span><</span><span style=color:#ed9366>&</span><span style=color:#fa6e32>str</span><span>>,    </span><span style=color:#abb0b6;font-style:italic>// 显式指定的源
</span><span>    </span><span style=color:#ff8f40>rpath</span><span style=color:#61676ccc>: </span><span style=color:#ed9366>&</span><span>Path,           </span><span style=color:#abb0b6;font-style:italic>// 要解析的路径
</span><span>    </span><span style=color:#ff8f40>rlabel</span><span style=color:#61676ccc>: </span><span style=color:#55b4d4;font-style:italic>Option</span><span><</span><span style=color:#ed9366>&</span><span style=color:#fa6e32>str</span><span>>,   </span><span style=color:#abb0b6;font-style:italic>// 标签
</span><span>) </span><span style=color:#61676ccc>-> </span><span>AssetPath<</span><span style=color:#fa6e32>'static</span><span>>
</span></code></pre><p>新方法首先检查是否为“仅标签“情况（只有标签，没有源和路径）。如果是，就直接替换基础路径的标签。否则，调用 <code>resolve_from_parts</code> 进行完整的路径解析。<h3 id=technical-insights>Technical Insights</h3><p>这个实现展示了几个重要的软件工程原则：<ol><li><strong>避免不必要的分配</strong>：新方法避免了 <code>to_string()</code> 调用，减少了内存分配和字符串解析开销。<li><strong>DRY（Don’t Repeat Yourself）原则</strong>：通过提取 <code>resolve_from_parts</code> 函数，避免了 <code>resolve_internal</code> 和 <code>resolve</code>/<code>resolve_embed</code> 之间的代码重复。<li><strong>向后兼容性</strong>：通过重命名而非替换原有方法，确保了现有代码继续工作，同时提供了迁移路径。<li><strong>清晰的语义</strong>：方法名清晰地表达了它们的用途，<code>*_str</code> 后缀表明需要字符串解析。</ol><p>RFC 1808 语义（嵌入式资源解析）的处理也得到了保持。当 <code>replace</code> 为 <code>true</code> 时，如果基础路径不以斜杠结尾，会移除最后一个路径组件。这在处理嵌入在资产文件（如 GLTF）中的相对路径时非常重要，因为这些路径相对于包含它们的文件所在的目录，而不是文件本身。<h3 id=the-impact>The Impact</h3><p>这个 PR 带来了几个具体的改进：<ol><li><strong>性能提升</strong>：避免了不必要的字符串分配和解析，对于频繁调用的路径解析操作，这可以带来可观的性能改进。<li><strong>API 改进</strong>：提供了更符合直觉的 API，当开发者已经持有 <code>AssetPath</code> 时，可以直接使用，无需转换。<li><strong>代码质量</strong>：通过重构减少了代码重复，使维护更加容易。<li><strong>迁移指南</strong>：PR 包含了迁移指南文档，帮助用户平滑过渡到新 API。</ol><p>在实际使用中，Bevy 的 GLTF 加载器和资产解压示例已经更新使用新的 <code>resolve_embed_str</code> 方法，展示了如何迁移现有代码。<h2 id=visual-representation>Visual Representation</h2><pre class=language-mermaid data-lang=mermaid style=color:#61676c;background-color:#fafafa><code class=language-mermaid data-lang=mermaid><span>graph TD
</span><span>    A[AssetPath] --> B[resolve/ resolve_embed]
</span><span>    A --> C[resolve_str/ resolve_embed_str]
</span><span>    B --> D[resolve_from_parts]
</span><span>    C --> E[parse_internal]
</span><span>    E --> D
</span><span>    D --> F[返回解析后的 AssetPath]
</span><span>    
</span><span>    G[字符串输入] --> C
</span><span>    H[AssetPath 输入] --> B
</span></code></pre><h2 id=key-files-changed>Key Files Changed</h2><h3 id=1-crates-bevy-asset-src-path-rs-360-129>1. <code>crates/bevy_asset/src/path.rs</code> (+360/-129)</h3><p><strong>修改原因</strong>：这是核心修改文件，实现了新的 <code>resolve</code> 和 <code>resolve_embed</code> 方法，并重构了内部实现。<p><strong>关键修改</strong>：<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// 添加新方法
</span><span style=color:#fa6e32>pub fn </span><span style=color:#f29718>resolve</span><span>(</span><span style=color:#ed9366>&</span><span style=color:#ff8f40>self</span><span>, </span><span style=color:#ff8f40>path</span><span style=color:#61676ccc>: </span><span style=color:#ed9366>&</span><span>AssetPath<'</span><span style=color:#ed9366>_</span><span>>) </span><span style=color:#61676ccc>-> </span><span>AssetPath<</span><span style=color:#fa6e32>'static</span><span>> {
</span><span>    </span><span style=color:#fa6e32>let</span><span> is_label_only </span><span style=color:#ed9366>= </span><span style=color:#f07171>matches!</span><span>(path</span><span style=color:#ed9366>.</span><span style=color:#f07171>source</span><span>()</span><span style=color:#61676ccc>, </span><span>AssetSourceId</span><span style=color:#ed9366>::</span><span>Default)
</span><span>        </span><span style=color:#ed9366>&&</span><span> path</span><span style=color:#ed9366>.</span><span style=color:#f07171>path</span><span>()</span><span style=color:#ed9366>.</span><span style=color:#f07171>as_os_str</span><span>()</span><span style=color:#ed9366>.</span><span style=color:#f07171>is_empty</span><span>()
</span><span>        </span><span style=color:#ed9366>&&</span><span> path</span><span style=color:#ed9366>.</span><span style=color:#f07171>label</span><span>()</span><span style=color:#ed9366>.</span><span style=color:#f07171>is_some</span><span>()</span><span style=color:#61676ccc>;
</span><span>
</span><span>    </span><span style=color:#fa6e32>if</span><span> is_label_only {
</span><span>        </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span style=color:#f07171>clone_owned</span><span>()
</span><span>            </span><span style=color:#ed9366>.</span><span style=color:#f07171>with_label</span><span>(path</span><span style=color:#ed9366>.</span><span style=color:#f07171>label</span><span>()</span><span style=color:#ed9366>.</span><span style=color:#f07171>unwrap</span><span>()</span><span style=color:#ed9366>.</span><span style=color:#f07171>to_owned</span><span>())
</span><span>    } </span><span style=color:#fa6e32>else </span><span>{
</span><span>        </span><span style=color:#fa6e32>let</span><span> explicit_source </span><span style=color:#ed9366>= </span><span style=color:#fa6e32>match</span><span> path</span><span style=color:#ed9366>.</span><span style=color:#f07171>source</span><span>() {
</span><span>            AssetSourceId</span><span style=color:#ed9366>::</span><span>Default </span><span style=color:#ed9366>=> </span><span style=color:#55b4d4;font-style:italic>None</span><span style=color:#61676ccc>,
</span><span>            AssetSourceId</span><span style=color:#ed9366>::</span><span>Name(name) </span><span style=color:#ed9366>=> </span><span style=color:#55b4d4;font-style:italic>Some</span><span>(name</span><span style=color:#ed9366>.</span><span style=color:#f07171>as_ref</span><span>())</span><span style=color:#61676ccc>,
</span><span>        }</span><span style=color:#61676ccc>;
</span><span>
</span><span>        </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span style=color:#f07171>resolve_from_parts</span><span>(</span><span style=color:#ff8f40>false</span><span style=color:#61676ccc>,</span><span> explicit_source</span><span style=color:#61676ccc>,</span><span> path</span><span style=color:#ed9366>.</span><span style=color:#f07171>path</span><span>()</span><span style=color:#61676ccc>,</span><span> path</span><span style=color:#ed9366>.</span><span style=color:#f07171>label</span><span>())
</span><span>    }
</span><span>}
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// 重命名原有方法
</span><span style=color:#fa6e32>pub fn </span><span style=color:#f29718>resolve_str</span><span>(</span><span style=color:#ed9366>&</span><span style=color:#ff8f40>self</span><span>, </span><span style=color:#ff8f40>path</span><span style=color:#61676ccc>: </span><span style=color:#ed9366>&</span><span style=color:#fa6e32>str</span><span>) </span><span style=color:#61676ccc>-> </span><span style=color:#55b4d4;font-style:italic>Result</span><span>&LTAssetPath<</span><span style=color:#fa6e32>'static</span><span>>, ParseAssetPathError> {
</span><span>    </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span style=color:#f07171>resolve_internal</span><span>(path</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>false</span><span>)
</span><span>}
</span></code></pre><h3 id=2-release-content-migration-guides-assetpath-resolve-semantics-md-8-0>2. <code>release-content/migration-guides/assetpath-resolve-semantics.md</code> (+8/-0)</h3><p><strong>修改原因</strong>：添加迁移指南，帮助用户从旧的字符串 API 迁移到新的 <code>AssetPath</code> API。<p><strong>关键内容</strong>：<pre class=language-markdown data-lang=markdown style=color:#61676c;background-color:#fafafa><code class=language-markdown data-lang=markdown><span style=color:#abb0b6;background-color:#61676c10;font-weight:700>---
</span><span>title: "</span><span style=color:#ed9366;background-color:#61676c10>`AssetPath::resolve`</span><span> and </span><span style=color:#ed9366;background-color:#61676c10>`resolve_embed`</span><span> now take </span><span style=color:#ed9366;background-color:#61676c10>`&AssetPath`</span><span>"
</span><span>pull_requests: [22416]
</span><span style=color:#fa6e32;font-weight:700>---
</span><span>
</span><span style=color:#ed9366;background-color:#61676c10>`AssetPath::resolve`</span><span> and </span><span style=color:#ed9366;background-color:#61676c10>`AssetPath::resolve_embed`</span><span> no longer accept </span><span style=color:#ed9366;background-color:#61676c10>`&str`</span><span> and now take </span><span style=color:#ed9366;background-color:#61676c10>`&AssetPath`</span><span> directly. The previous string-based APIs have been renamed to </span><span style=color:#ed9366;background-color:#61676c10>`resolve_str`</span><span> and </span><span style=color:#ed9366;background-color:#61676c10>`resolve_embed_str`</span><span>.
</span><span>
</span><span>This change avoids unnecessary string allocation and parsing when an </span><span style=color:#ed9366;background-color:#61676c10>`AssetPath`</span><span> is already available. To migrate, pass an </span><span style=color:#ed9366;background-color:#61676c10>`AssetPath`</span><span> directly to </span><span style=color:#ed9366;background-color:#61676c10>`resolve`</span><span> or </span><span style=color:#ed9366;background-color:#61676c10>`resolve_embed`</span><span>; when working with strings, use the corresponding </span><span style=color:#ed9366;background-color:#61676c10>`*_str`</span><span> methods instead.
</span></code></pre><h3 id=3-crates-bevy-gltf-src-loader-mod-rs-2-2>3. <code>crates/bevy_gltf/src/loader/mod.rs</code> (+2/-2)</h3><p><strong>修改原因</strong>：更新 GLTF 加载器以使用新的 <code>resolve_embed_str</code> 方法，保持相同功能但使用正确的 API 名称。<p><strong>关键修改</strong>：<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// 之前
</span><span style=color:#fa6e32>let</span><span> buffer_path </span><span style=color:#ed9366>=</span><span> load_context
</span><span>    </span><span style=color:#ed9366>.</span><span style=color:#f07171>path</span><span>()
</span><span>    </span><span style=color:#ed9366>.</span><span style=color:#f07171>resolve_embed</span><span>(uri)
</span><span>    </span><span style=color:#ed9366>.</span><span style=color:#f07171>map_err</span><span>(|</span><span style=color:#ff8f40>err</span><span>| GltfError</span><span style=color:#ed9366>::</span><span>InvalidBufferUri(uri</span><span style=color:#ed9366>.</span><span style=color:#f07171>to_owned</span><span>()</span><span style=color:#61676ccc>,</span><span> err))</span><span style=color:#ed9366>?</span><span style=color:#61676ccc>;
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// 之后
</span><span style=color:#fa6e32>let</span><span> buffer_path </span><span style=color:#ed9366>=</span><span> load_context
</span><span>    </span><span style=color:#ed9366>.</span><span style=color:#f07171>path</span><span>()
</span><span>    </span><span style=color:#ed9366>.</span><span style=color:#f07171>resolve_embed_str</span><span>(uri)
</span><span>    </span><span style=color:#ed9366>.</span><span style=color:#f07171>map_err</span><span>(|</span><span style=color:#ff8f40>err</span><span>| GltfError</span><span style=color:#ed9366>::</span><span>InvalidBufferUri(uri</span><span style=color:#ed9366>.</span><span style=color:#f07171>to_owned</span><span>()</span><span style=color:#61676ccc>,</span><span> err))</span><span style=color:#ed9366>?</span><span style=color:#61676ccc>;
</span></code></pre><h3 id=4-examples-asset-asset-decompression-rs-1-1>4. <code>examples/asset/asset_decompression.rs</code> (+1/-1)</h3><p><strong>修改原因</strong>：更新资产解压示例，同样从 <code>resolve_embed</code> 改为 <code>resolve_embed_str</code>。<p><strong>关键修改</strong>：<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// 之前
</span><span style=color:#fa6e32>let</span><span> contained_path </span><span style=color:#ed9366>=</span><span> compressed_path
</span><span>    </span><span style=color:#ed9366>.</span><span style=color:#f07171>resolve_embed</span><span>(uncompressed_file_name)
</span><span>    </span><span style=color:#ed9366>.</span><span style=color:#f07171>map_err</span><span>(|_| GzAssetLoaderError</span><span style=color:#ed9366>::</span><span>IndeterminateFilePath)</span><span style=color:#ed9366>?</span><span style=color:#61676ccc>;
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// 之后
</span><span style=color:#fa6e32>let</span><span> contained_path </span><span style=color:#ed9366>=</span><span> compressed_path
</span><span>    </span><span style=color:#ed9366>.</span><span style=color:#f07171>resolve_embed_str</span><span>(uncompressed_file_name)
</span><span>    </span><span style=color:#ed9366>.</span><span style=color:#f07171>map_err</span><span>(|_| GzAssetLoaderError</span><span style=color:#ed9366>::</span><span>IndeterminateFilePath)</span><span style=color:#ed9366>?</span><span style=color:#61676ccc>;
</span></code></pre><h2 id=further-reading>Further Reading</h2><ol><li><strong>Rust API 设计指南</strong>：了解如何设计既高效又易于使用的 API<li><strong>RFC 1808 - Relative Uniform Resource Locators</strong>：理解嵌入式资源路径解析的语义<li><strong>Bevy 资产系统文档</strong>：深入学习 Bevy 的资产管理系统<li><strong>性能优化模式</strong>：学习如何避免不必要的内存分配和计算</ol></div><div data-is-md-page=true data-patch-exists=true data-patch-path=/pull_request/bevy/2026-01/pr_22416.patch id=patch-info style=display:none></div><div class=bottom-spacer></div></div></div>