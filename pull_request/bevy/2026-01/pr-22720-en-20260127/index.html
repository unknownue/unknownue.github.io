<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://unknownue.github.io name=base><title>
         #22720 Add option to turn of mip generation in bistro
        
    </title><meta content="#22720 Add option to turn of mip generation in bistro" property=og:title><meta content="A personal blog built with Zola and Apollo theme" property=og:description><meta content="A personal blog built with Zola and Apollo theme" name=description><link href=/icons/favicon.png rel=icon type=image/png><link href=https://unknownue.github.io/fonts.css rel=stylesheet><script src=https://unknownue.github.io/js/codeblock.js></script><script src=https://unknownue.github.io/js/toc.js></script><script src=https://unknownue.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Unknownue's Blog" href=https://unknownue.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://unknownue.github.io/theme/light.css rel=stylesheet><link href=https://unknownue.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://unknownue.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://unknownue.github.io/main.css media=screen rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js></script><script>// Initialize mermaid once DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            mermaid.initialize({
                startOnLoad: false,
                theme: document.body && document.body.classList.contains('dark') ? 'dark' : 'default',
                securityLevel: 'loose',
                flowchart: {
                    useMaxWidth: true,
                    htmlLabels: true
                },
                sequence: {
                    diagramMarginX: 50,
                    diagramMarginY: 10,
                    actorMargin: 50,
                    width: 150,
                    height: 65
                }
            });
        });</script><script src=https://unknownue.github.io/js/main.js></script><script defer src=https://unknownue.github.io/js/label-colors.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/rust.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/typescript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/go.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/cpp.min.js></script><script>// Ensure highlight.js is properly configured
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof hljs !== 'undefined') {
                hljs.configure({
                    languages: ['rust', 'javascript', 'python', 'cpp', 'go', 'typescript'],
                    ignoreUnescapedHTML: true
                });
                console.log('Highlight.js configured in header');
            }
        });</script><link href=https://cdn.jsdelivr.net/npm/diff2html/bundles/css/diff2html.min.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/diff2html/bundles/js/diff2html-ui.min.js></script><script src=https://unknownue.github.io/js/syntax-highlight.js></script><script src=https://unknownue.github.io/js/diff-sidebar.js></script><script src="https://unknownue.github.io/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><div class=content><header><div class=main><a href=https://unknownue.github.io>Unknownue's Blog</a><div class=socials><a class=social href=https://github.com/unknownue rel=me> <img alt=github src=https://unknownue.github.io/icons/social/github.svg> </a><a class=social href=https://github.com/unknownue/unknownue.github.io rel=me> <img alt=github-io src=https://unknownue.github.io/icons/social/rss.svg> </a></div></div><nav><a href=https://unknownue.github.io/posts style=margin-left:.25em>/posts</a><a href=https://unknownue.github.io/projects style=margin-left:.25em>/projects</a><a href=https://unknownue.github.io/about style=margin-left:.25em>/about</a><a href=https://unknownue.github.io/tags style=margin-left:.25em>/tags</a><button title="$SHORTCUT to open search" class=search-button id=search-button><img alt=Search class=search-icon src=https://unknownue.github.io/icons/search.svg></button><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><div id=modal-content><h1 class=page-header id=modalTitle>Search</h1><div id=searchBar><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search... role=combobox spellcheck=false><button title="Clear search" class=clear-button id=clear-search><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></button></div><div id=results-container><div id=results-info><span id=zero_results style=display:none>No results</span><span id=one_result style=display:none>1 result</span><span id=many_results style=display:none>$NUMBER results</span></div><div id=results role=listbox></div></div></div></div><a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://unknownue.github.io/icons/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://unknownue.github.io/icons/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><div class=pull-request-page><article class=md-content-page style=display:none></article><div class=back-link><a href=/pull_request/bevy/2026-01/>← Back to Pull Requests</a></div><div class=pr-metadata><span class=pr-date>2026-01-27</span><div class=language-switcher><span class="lang-link active" data-lang=en>English</span> / <a class=lang-link data-lang=zh-cn href=/pull_request/bevy/2026-01/pr-22720-zh-cn-20260127>中文</a></div></div><div class=pr-content><h1 id=title>Title</h1><p>Add option to turn of mip generation in bistro<h2 id=basic-information>Basic Information</h2><ul><li><strong>Title</strong>: Add option to turn of mip generation in bistro<li><strong>PR Link</strong>: https://github.com/bevyengine/bevy/pull/22720<li><strong>Author</strong>: atlv24<li><strong>Status</strong>: MERGED<li><strong>Labels</strong>: A-Rendering, S-Ready-For-Final-Review<li><strong>Created</strong>: 2026-01-27T08:31:34Z<li><strong>Merged</strong>: 2026-01-27T19:36:06Z<li><strong>Merged By</strong>: alice-i-cecile</ul><h2 id=description-translation>Description Translation</h2><h1 id=objective>Objective</h1><ul><li>mips use vram</ul><h2 id=solution>Solution</h2><ul><li>option to not mip</ul><h2 id=testing>Testing</h2><ul><li>run it</ul><h2 id=the-story-of-this-pull-request>The Story of This Pull Request</h2><p>This PR addresses a straightforward but important optimization concern in the Bevy bistro example. The problem is that mipmap generation consumes VRAM, and for users who don’t need mipmaps or want to minimize memory usage, there should be a way to disable this feature. The bistro example is a large scene that demonstrates Bevy’s rendering capabilities, and the mipmap generation for its textures can be resource-intensive.<p>The solution implemented here is pragmatic and follows established patterns in the codebase. The developer added a new command-line argument <code>--no-mip-generation</code> that conditionally disables mipmap generation. This approach gives users control over this resource consumption without affecting the default behavior of the example.<p>From an architectural perspective, the implementation is clean. Instead of having the mipmap generation plugins and systems always active, they are now conditionally added based on the command-line flag. This is more efficient than having the systems run and then skip processing based on a flag at runtime.<p>The key insight here is recognizing that mipmap generation in large scenes involves two main components: the plugins that provide the functionality (<code>MipmapGeneratorPlugin</code> and <code>MipmapGeneratorDebugTextPlugin</code>), the configuration resource (<code>MipmapGeneratorSettings</code>), and the system that processes the materials (<code>generate_mipmaps::&LTStandardMaterial></code>). All of these need to be disabled together for the feature to be fully turned off.<p>The implementation shows good understanding of Bevy’s ECS architecture. The mipmap generation system operates on <code>StandardMaterial</code> components, and by conditionally adding this system only when mipmap generation is enabled, we avoid unnecessary system execution overhead. This is particularly important for the bistro example which handles a large number of entities.<p>There’s also consideration for the user experience. The PR preserves the existing command-line options while adding the new one, maintaining backward compatibility. Users who don’t specify the flag will continue to get mipmaps generated as before.<p>One technical nuance worth noting is that the mipmap generation was previously part of a chain of systems in the <code>Update</code> schedule. The PR restructures this by moving the mipmap generation system into the conditional block and keeping the other systems in the main chain. This maintains the same execution order for the non-mipmap systems while properly isolating the mipmap generation functionality.<p>The impact of this change is primarily on performance and resource usage. For users running the bistro example on hardware with limited VRAM, or for those who want faster startup times, disabling mipmap generation provides a tangible benefit. The trade-off is potentially lower visual quality at distance, but this is acceptable for a configuration option in an example.<p>From an engineering perspective, this PR demonstrates good practice in feature flag implementation. The conditional logic is cleanly separated from the main application setup, making the code easier to understand and maintain. The pattern of conditionally adding plugins and systems based on configuration is a common and effective approach in Bevy applications.<h2 id=visual-representation>Visual Representation</h2><pre class=language-mermaid data-lang=mermaid style=color:#61676c;background-color:#fafafa><code class=language-mermaid data-lang=mermaid><span>graph TD
</span><span>    A[Command-line Args] --> B{no_mip_generation?}
</span><span>    B -->|true| C[Skip mipmap setup]
</span><span>    B -->|false| D[Add MipmapGeneratorPlugin]
</span><span>    D --> E[Add MipmapGeneratorDebugTextPlugin]
</span><span>    D --> F[Insert MipmapGeneratorSettings]
</span><span>    D --> G[Add generate_mipmaps system]
</span><span>    C --> H[Continue with other setup]
</span><span>    E --> H
</span><span>    F --> H
</span><span>    G --> H
</span></code></pre><h2 id=key-files-changed>Key Files Changed</h2><h3 id=examples-large-scenes-bistro-src-main-rs-23-24><code>examples/large_scenes/bistro/src/main.rs</code> (+23/-24)</h3><p>This is the only file modified in the PR. The changes add a new command-line option to disable mipmap generation and conditionally set up the mipmap generation systems based on this option.<p><strong>Key modifications:</strong><ol><li><strong>Added the command-line argument option:</strong></ol><pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// After (new code added):
</span><span style=color:#fa6e32>pub struct </span><span style=color:#399ee6>Args </span><span>{
</span><span>    </span><span style=color:#abb0b6;font-style:italic>// ... existing fields ...
</span><span>    
</span><span>    </span><span style=color:#abb0b6;font-style:italic>/// disable mip map generation.
</span><span>    </span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>argh</span><span>(switch)]
</span><span>    no_mip_generation</span><span style=color:#61676ccc>: </span><span style=color:#fa6e32>bool</span><span>,
</span><span>}
</span></code></pre><ol start=2><li><strong>Restructured the application setup to conditionally add mipmap generation:</strong></ol><pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before (mipmap setup was unconditional):
</span><span>app</span><span style=color:#ed9366>.</span><span style=color:#f07171>insert_resource</span><span>(MipmapGeneratorSettings {
</span><span>    </span><span style=color:#abb0b6;font-style:italic>// ... settings ...
</span><span>})
</span><span style=color:#ed9366>.</span><span style=color:#f07171>add_plugins</span><span>((MipmapGeneratorPlugin</span><span style=color:#61676ccc>,</span><span> MipmapGeneratorDebugTextPlugin))
</span><span style=color:#ed9366>.</span><span style=color:#f07171>add_systems</span><span>(
</span><span>    Update</span><span style=color:#61676ccc>,
</span><span>    (
</span><span>        generate_mipmaps</span><span style=color:#ed9366>::</span><span>&LTStandardMaterial></span><span style=color:#61676ccc>,
</span><span>        input</span><span style=color:#61676ccc>,
</span><span>        run_animation</span><span style=color:#61676ccc>,
</span><span>        spin</span><span style=color:#61676ccc>,
</span><span>        frame_time_system</span><span style=color:#61676ccc>,
</span><span>        benchmark</span><span style=color:#61676ccc>,
</span><span>    )
</span><span>        </span><span style=color:#ed9366>.</span><span style=color:#f07171>chain</span><span>()</span><span style=color:#61676ccc>,
</span><span>)</span><span style=color:#61676ccc>;
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After (mipmap setup is conditional):
</span><span style=color:#abb0b6;font-style:italic>// Note: The MipmapGeneratorSettings, MipmapGeneratorPlugin, 
</span><span style=color:#abb0b6;font-style:italic>// MipmapGeneratorDebugTextPlugin, and generate_mipmaps system
</span><span style=color:#abb0b6;font-style:italic>// are now only added when !args.no_mip_generation
</span><span>
</span><span style=color:#fa6e32>if </span><span style=color:#ed9366>!</span><span>args</span><span style=color:#ed9366>.</span><span>no_mip_generation {
</span><span>    app</span><span style=color:#ed9366>.</span><span style=color:#f07171>add_plugins</span><span>((MipmapGeneratorPlugin</span><span style=color:#61676ccc>,</span><span> MipmapGeneratorDebugTextPlugin))
</span><span>        </span><span style=color:#ed9366>.</span><span style=color:#f07171>insert_resource</span><span>(MipmapGeneratorSettings {
</span><span>            </span><span style=color:#abb0b6;font-style:italic>// ... settings ...
</span><span>        })
</span><span>        </span><span style=color:#ed9366>.</span><span style=color:#f07171>add_systems</span><span>(Update</span><span style=color:#61676ccc>, </span><span>generate_mipmaps</span><span style=color:#ed9366>::</span><span>&LTStandardMaterial>)</span><span style=color:#61676ccc>;
</span><span>}
</span></code></pre><ol start=3><li><strong>Updated the system chain to exclude the mipmap generation system when disabled:</strong></ol><pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before (generate_mipmaps was in the chain):
</span><span style=color:#ed9366>.</span><span style=color:#f07171>add_systems</span><span>(
</span><span>    Update</span><span style=color:#61676ccc>,
</span><span>    (
</span><span>        generate_mipmaps</span><span style=color:#ed9366>::</span><span>&LTStandardMaterial></span><span style=color:#61676ccc>,
</span><span>        input</span><span style=color:#61676ccc>,
</span><span>        run_animation</span><span style=color:#61676ccc>,
</span><span>        spin</span><span style=color:#61676ccc>,
</span><span>        frame_time_system</span><span style=color:#61676ccc>,
</span><span>        benchmark</span><span style=color:#61676ccc>,
</span><span>    )
</span><span>        </span><span style=color:#ed9366>.</span><span style=color:#f07171>chain</span><span>()</span><span style=color:#61676ccc>,
</span><span>)</span><span style=color:#61676ccc>;
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After (generate_mipmaps removed from the main chain):
</span><span style=color:#ed9366>.</span><span style=color:#f07171>add_systems</span><span>(
</span><span>    Update</span><span style=color:#61676ccc>,
</span><span>    (input</span><span style=color:#61676ccc>,</span><span> run_animation</span><span style=color:#61676ccc>,</span><span> spin</span><span style=color:#61676ccc>,</span><span> frame_time_system</span><span style=color:#61676ccc>,</span><span> benchmark)</span><span style=color:#ed9366>.</span><span style=color:#f07171>chain</span><span>()</span><span style=color:#61676ccc>,
</span><span>)</span><span style=color:#61676ccc>;
</span></code></pre><p>The changes are minimal but effective. They move from an always-on mipmap generation approach to an opt-out model where users can disable the feature via command-line argument. This provides better control over resource usage while maintaining the existing default behavior.<h2 id=further-reading>Further Reading</h2><ol><li><strong>Bevy Mipmap Generation Documentation</strong>: The official Bevy documentation on texture mipmap generation and the <code>MipmapGeneratorPlugin</code>.<li><strong>Bevy Command-line Arguments with Argh</strong>: The <code>argh</code> crate documentation for understanding how command-line argument parsing works in Bevy examples.<li><strong>Texture Mipmapping Fundamentals</strong>: Resources on computer graphics explaining what mipmaps are, why they’re used (for texture filtering and performance), and their memory costs.<li><strong>Bevy Conditional System Setup</strong>: Patterns for conditionally adding systems and plugins in Bevy applications based on configuration or runtime conditions.<li><strong>Bistro Example Source Code</strong>: The full bistro example to understand the context of these changes within a large scene rendering example.</ol></div><div data-is-md-page=true data-patch-exists=true data-patch-path=/pull_request/bevy/2026-01/pr_22720.patch id=patch-info style=display:none></div><div class=bottom-spacer></div></div></div>