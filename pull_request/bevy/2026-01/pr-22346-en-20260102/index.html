<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://unknownue.github.io name=base><title>
         #22346 use seeded rng for dynamic_mip_generation
        
    </title><meta content="#22346 use seeded rng for dynamic_mip_generation" property=og:title><meta content="A personal blog built with Zola and Apollo theme" property=og:description><meta content="A personal blog built with Zola and Apollo theme" name=description><link href=/icons/favicon.png rel=icon type=image/png><link href=https://unknownue.github.io/fonts.css rel=stylesheet><script src=https://unknownue.github.io/js/codeblock.js></script><script src=https://unknownue.github.io/js/toc.js></script><script src=https://unknownue.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Unknownue's Blog" href=https://unknownue.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://unknownue.github.io/theme/light.css rel=stylesheet><link href=https://unknownue.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://unknownue.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://unknownue.github.io/main.css media=screen rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js></script><script>// Initialize mermaid once DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            mermaid.initialize({
                startOnLoad: false,
                theme: document.body && document.body.classList.contains('dark') ? 'dark' : 'default',
                securityLevel: 'loose',
                flowchart: {
                    useMaxWidth: true,
                    htmlLabels: true
                },
                sequence: {
                    diagramMarginX: 50,
                    diagramMarginY: 10,
                    actorMargin: 50,
                    width: 150,
                    height: 65
                }
            });
        });</script><script src=https://unknownue.github.io/js/main.js></script><script defer src=https://unknownue.github.io/js/label-colors.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/rust.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/typescript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/go.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/cpp.min.js></script><script>// Ensure highlight.js is properly configured
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof hljs !== 'undefined') {
                hljs.configure({
                    languages: ['rust', 'javascript', 'python', 'cpp', 'go', 'typescript'],
                    ignoreUnescapedHTML: true
                });
                console.log('Highlight.js configured in header');
            }
        });</script><link href=https://cdn.jsdelivr.net/npm/diff2html/bundles/css/diff2html.min.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/diff2html/bundles/js/diff2html-ui.min.js></script><script src=https://unknownue.github.io/js/syntax-highlight.js></script><script src=https://unknownue.github.io/js/diff-sidebar.js></script><script src="https://unknownue.github.io/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><div class=content><header><div class=main><a href=https://unknownue.github.io>Unknownue's Blog</a><div class=socials><a class=social href=https://github.com/unknownue rel=me> <img alt=github src=https://unknownue.github.io/icons/social/github.svg> </a><a class=social href=https://github.com/unknownue/unknownue.github.io rel=me> <img alt=github-io src=https://unknownue.github.io/icons/social/rss.svg> </a></div></div><nav><a href=https://unknownue.github.io/posts style=margin-left:.25em>/posts</a><a href=https://unknownue.github.io/projects style=margin-left:.25em>/projects</a><a href=https://unknownue.github.io/about style=margin-left:.25em>/about</a><a href=https://unknownue.github.io/tags style=margin-left:.25em>/tags</a><button title="$SHORTCUT to open search" class=search-button id=search-button><img alt=Search class=search-icon src=https://unknownue.github.io/icons/search.svg></button><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><div id=modal-content><h1 class=page-header id=modalTitle>Search</h1><div id=searchBar><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search... role=combobox spellcheck=false><button title="Clear search" class=clear-button id=clear-search><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></button></div><div id=results-container><div id=results-info><span id=zero_results style=display:none>No results</span><span id=one_result style=display:none>1 result</span><span id=many_results style=display:none>$NUMBER results</span></div><div id=results role=listbox></div></div></div></div><a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://unknownue.github.io/icons/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://unknownue.github.io/icons/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><div class=pull-request-page><article class=md-content-page style=display:none></article><div class=back-link><a href=/pull_request/bevy/2026-01/>← Back to Pull Requests</a></div><div class=pr-metadata><span class=pr-date>2026-01-02</span><div class=language-switcher><span class="lang-link active" data-lang=en>English</span> / <a class=lang-link data-lang=zh-cn href=/pull_request/bevy/2026-01/pr-22346-zh-cn-20260102>中文</a></div></div><div class=pr-content><h1 id=title>Title</h1><h2 id=basic-information>Basic Information</h2><ul><li><strong>Title</strong>: use seeded rng for dynamic_mip_generation<li><strong>PR Link</strong>: https://github.com/bevyengine/bevy/pull/22346<li><strong>Author</strong>: mockersf<li><strong>Status</strong>: MERGED<li><strong>Labels</strong>: C-Examples<li><strong>Created</strong>: 2026-01-02T01:01:04Z<li><strong>Merged</strong>: 2026-01-02T20:34:17Z<li><strong>Merged By</strong>: mockersf</ul><h2 id=description-translation>Description Translation</h2><h1 id=objective>Objective</h1><ul><li>New example <code>dynamic_mip_generation</code> use random random</ul><h2 id=solution>Solution</h2><ul><li>Use seeded random</ul><h2 id=the-story-of-this-pull-request>The Story of This Pull Request</h2><p>This pull request addresses a reproducibility issue in the <code>dynamic_mip_generation</code> example. The example generates random patterns to demonstrate dynamic mipmap generation, but it was using a non-deterministic random number generator (ThreadRng), which meant that each run of the example would produce different patterns.<p>The problem was straightforward: the example’s randomness made it difficult to test consistently or to demonstrate specific behaviors reliably. When developers run examples, they often expect consistent output to verify that code is working correctly. Non-deterministic behavior in examples can mask bugs or make it harder to understand what the example is supposed to demonstrate.<p>The solution approach was to replace the non-deterministic ThreadRng with a seeded pseudo-random number generator. This required several changes to the codebase. First, the imports needed updating to bring in the SeedableRng trait and a specific PRNG implementation (ChaCha8Rng from the rand_chacha crate). Then, the AppStatus struct needed to store the RNG instance rather than creating a new one each time.<p>The implementation details show careful consideration of Rust’s ownership and mutability rules. The <code>AppStatus</code> struct gained a new field:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span>rng</span><span style=color:#61676ccc>:</span><span> ChaCha8Rng</span><span style=color:#61676ccc>,
</span></code></pre><p>In the Default implementation, this field is initialized with a specific seed:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span>rng</span><span style=color:#61676ccc>: </span><span>ChaCha8Rng</span><span style=color:#ed9366>::</span><span>seed_from_u64(</span><span style=color:#ff8f40>19878367467713</span><span>)</span><span style=color:#61676ccc>,
</span></code></pre><p>The seed value <code>19878367467713</code> appears arbitrary but provides deterministic output. This is a common practice in graphics examples where you want visual patterns to be reproducible across runs.<p>The technical challenge here was managing mutable access to the RNG. The <code>generate_image_data</code> method now takes <code>&mut self</code> instead of <code>&self</code> because it needs to update the RNG’s internal state. This change cascaded through the call chain:<ol><li><code>regenerate_mipmap_source_image</code> also needed to take <code>&mut self</code><li><code>regenerate_image_when_requested</code> needed to take <code>ResMut&LTAppStatus></code> instead of <code>Res&LTAppStatus></code></ol><p>This is a good example of how Rust’s borrow checker ensures proper mutation semantics. The compiler enforced that we couldn’t mutate the RNG without properly declaring the mutable borrow.<p>The key insight from this implementation is that using a seeded RNG provides the best of both worlds: the visual variety of random patterns with the reproducibility needed for testing and demonstration. The ChaCha8Rng was chosen because it’s a cryptographically secure PRNG with good performance characteristics, though for this example any seeded PRNG would work.<p>The impact of this change is subtle but important for the example’s utility. Developers can now:<ul><li>Run the example multiple times and see the same patterns<li>Use the example as a reference for testing mipmap generation logic<li>Debug issues with confidence that the random patterns aren’t masking problems</ul><p>This change also demonstrates good practices for examples in general. Examples should be deterministic when possible, especially when they’re demonstrating visual features where inconsistent output could confuse users about what they’re supposed to see.<h2 id=visual-representation>Visual Representation</h2><pre class=language-mermaid data-lang=mermaid style=color:#61676c;background-color:#fafafa><code class=language-mermaid data-lang=mermaid><span>graph TD
</span><span>    A[ThreadRng: Non-deterministic] --> B{Problem: Inconsistent example output}
</span><span>    B --> C[Solution: Switch to seeded RNG]
</span><span>    C --> D[ChaCha8Rng with fixed seed]
</span><span>    D --> E[Deterministic pattern generation]
</span><span>    E --> F[Consistent example behavior]
</span></code></pre><h2 id=key-files-changed>Key Files Changed</h2><h3 id=examples-2d-dynamic-mip-generation-rs-10-7><code>examples/2d/dynamic_mip_generation.rs</code> (+10/-7)</h3><p>This file contains the dynamic mipmap generation example that was modified to use a seeded random number generator instead of a non-deterministic one.<p><strong>Key Changes:</strong><ol><li><strong>Updated imports</strong> to use seeded RNG functionality:</ol><pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before:
</span><span style=color:#fa6e32>use </span><span>rand</span><span style=color:#ed9366>::</span><span>{rngs</span><span style=color:#ed9366>::</span><span>ThreadRng</span><span style=color:#61676ccc>,</span><span> Rng}</span><span style=color:#61676ccc>;
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After:
</span><span style=color:#fa6e32>use </span><span>rand</span><span style=color:#ed9366>::</span><span>{Rng</span><span style=color:#61676ccc>,</span><span> SeedableRng}</span><span style=color:#61676ccc>;
</span><span style=color:#fa6e32>use </span><span>rand_chacha</span><span style=color:#ed9366>::</span><span>ChaCha8Rng</span><span style=color:#61676ccc>;
</span></code></pre><ol start=2><li><strong>Added RNG field to AppStatus struct</strong> to store the seeded generator:</ol><pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before:
</span><span style=color:#fa6e32>struct </span><span style=color:#399ee6>AppStatus </span><span>{
</span><span>    enable_mip_generation</span><span style=color:#61676ccc>:</span><span> EnableMipGeneration,
</span><span>    image_width</span><span style=color:#61676ccc>:</span><span> ImageSize,
</span><span>    image_height</span><span style=color:#61676ccc>:</span><span> ImageSize,
</span><span>}
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After:
</span><span style=color:#fa6e32>struct </span><span style=color:#399ee6>AppStatus </span><span>{
</span><span>    enable_mip_generation</span><span style=color:#61676ccc>:</span><span> EnableMipGeneration,
</span><span>    image_width</span><span style=color:#61676ccc>:</span><span> ImageSize,
</span><span>    image_height</span><span style=color:#61676ccc>:</span><span> ImageSize,
</span><span>    </span><span style=color:#abb0b6;font-style:italic>/// Seeded random generator.
</span><span>    rng</span><span style=color:#61676ccc>:</span><span> ChaCha8Rng,
</span><span>}
</span></code></pre><ol start=3><li><strong>Initialized the RNG with a seed</strong> in the Default implementation:</ol><pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#fa6e32>impl </span><span>Default </span><span style=color:#fa6e32>for </span><span style=color:#399ee6>AppStatus </span><span>{
</span><span>    </span><span style=color:#fa6e32>fn </span><span style=color:#f29718>default</span><span>() </span><span style=color:#61676ccc>-> </span><span style=color:#fa6e32>Self </span><span>{
</span><span>        </span><span style=color:#fa6e32>Self </span><span>{
</span><span>            enable_mip_generation</span><span style=color:#61676ccc>: </span><span>EnableMipGeneration</span><span style=color:#ed9366>::</span><span>On</span><span style=color:#61676ccc>,
</span><span>            image_width</span><span style=color:#61676ccc>: </span><span>ImageSize</span><span style=color:#ed9366>::</span><span>Size640</span><span style=color:#61676ccc>,
</span><span>            image_height</span><span style=color:#61676ccc>: </span><span>ImageSize</span><span style=color:#ed9366>::</span><span>Size480</span><span style=color:#61676ccc>,
</span><span>            rng</span><span style=color:#61676ccc>: </span><span>ChaCha8Rng</span><span style=color:#ed9366>::</span><span>seed_from_u64(</span><span style=color:#ff8f40>19878367467713</span><span>)</span><span style=color:#61676ccc>,
</span><span>        }
</span><span>    }
</span><span>}
</span></code></pre><ol start=4><li><strong>Updated method signatures</strong> to handle mutable access to the RNG:</ol><pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before:
</span><span style=color:#fa6e32>fn </span><span style=color:#f29718>regenerate_image_when_requested</span><span>(
</span><span>    </span><span style=color:#abb0b6;font-style:italic>// ...
</span><span>    </span><span style=color:#ff8f40>app_status</span><span style=color:#61676ccc>: </span><span>Res&LTAppStatus>,
</span><span>    </span><span style=color:#abb0b6;font-style:italic>// ...
</span><span>)
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After:
</span><span style=color:#fa6e32>fn </span><span style=color:#f29718>regenerate_image_when_requested</span><span>(
</span><span>    </span><span style=color:#abb0b6;font-style:italic>// ...
</span><span>    </span><span style=color:#fa6e32>mut </span><span style=color:#ff8f40>app_status</span><span style=color:#61676ccc>: </span><span>ResMut&LTAppStatus>,
</span><span>    </span><span style=color:#abb0b6;font-style:italic>// ...
</span><span>)
</span></code></pre><ol start=5><li><strong>Modified the image generation</strong> to use the seeded RNG:</ol><pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before:
</span><span style=color:#fa6e32>fn </span><span style=color:#f29718>generate_image_data</span><span>(</span><span style=color:#ed9366>&</span><span style=color:#ff8f40>self</span><span>) </span><span style=color:#61676ccc>-> </span><span style=color:#55b4d4;font-style:italic>Vec</span><span><</span><span style=color:#fa6e32>u8</span><span>> {
</span><span>    </span><span style=color:#fa6e32>let mut</span><span> rng </span><span style=color:#ed9366>= </span><span>ThreadRng</span><span style=color:#ed9366>::</span><span>default()</span><span style=color:#61676ccc>;
</span><span>    </span><span style=color:#fa6e32>let</span><span> outer_color</span><span style=color:#61676ccc>: </span><span>[</span><span style=color:#fa6e32>u8</span><span style=color:#61676ccc>; </span><span style=color:#ff8f40>3</span><span>] </span><span style=color:#ed9366>= </span><span>array</span><span style=color:#ed9366>::</span><span>from_fn(|_| rng</span><span style=color:#ed9366>.</span><span style=color:#f07171>random</span><span>())</span><span style=color:#61676ccc>;
</span><span>    </span><span style=color:#fa6e32>let</span><span> inner_color</span><span style=color:#61676ccc>: </span><span>[</span><span style=color:#fa6e32>u8</span><span style=color:#61676ccc>; </span><span style=color:#ff8f40>3</span><span>] </span><span style=color:#ed9366>= </span><span>array</span><span style=color:#ed9366>::</span><span>from_fn(|_| rng</span><span style=color:#ed9366>.</span><span style=color:#f07171>random</span><span>())</span><span style=color:#61676ccc>;
</span><span>    </span><span style=color:#abb0b6;font-style:italic>// ...
</span><span>}
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After:
</span><span style=color:#fa6e32>fn </span><span style=color:#f29718>generate_image_data</span><span>(</span><span style=color:#ed9366>&</span><span style=color:#fa6e32>mut </span><span style=color:#ff8f40>self</span><span>) </span><span style=color:#61676ccc>-> </span><span style=color:#55b4d4;font-style:italic>Vec</span><span><</span><span style=color:#fa6e32>u8</span><span>> {
</span><span>    </span><span style=color:#fa6e32>let</span><span> outer_color</span><span style=color:#61676ccc>: </span><span>[</span><span style=color:#fa6e32>u8</span><span style=color:#61676ccc>; </span><span style=color:#ff8f40>3</span><span>] </span><span style=color:#ed9366>= </span><span>array</span><span style=color:#ed9366>::</span><span>from_fn(|_| </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>rng</span><span style=color:#ed9366>.</span><span style=color:#f07171>random</span><span>())</span><span style=color:#61676ccc>;
</span><span>    </span><span style=color:#fa6e32>let</span><span> inner_color</span><span style=color:#61676ccc>: </span><span>[</span><span style=color:#fa6e32>u8</span><span style=color:#61676ccc>; </span><span style=color:#ff8f40>3</span><span>] </span><span style=color:#ed9366>= </span><span>array</span><span style=color:#ed9366>::</span><span>from_fn(|_| </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>rng</span><span style=color:#ed9366>.</span><span style=color:#f07171>random</span><span>())</span><span style=color:#61676ccc>;
</span><span>    </span><span style=color:#abb0b6;font-style:italic>// ...
</span><span>}
</span></code></pre><p>These changes ensure that the example generates the same visual patterns every time it runs, making it more useful for testing and demonstration purposes.<h2 id=further-reading>Further Reading</h2><ul><li><a rel="noopener nofollow noreferrer" href=https://docs.rs/rand/latest/rand/ target=_blank>Rust Rand crate documentation</a> - For understanding random number generation in Rust<li><a rel="noopener nofollow noreferrer" href=https://docs.rs/rand/latest/rand/trait.SeedableRng.html target=_blank>SeedableRng trait documentation</a> - For implementing seeded random number generators<li><a rel="noopener nofollow noreferrer" href=https://docs.rs/rand_chacha/latest/rand_chacha/struct.ChaCha8Rng.html target=_blank>ChaCha8Rng implementation details</a> - For understanding the specific PRNG used<li><a rel="noopener nofollow noreferrer" href=https://bevyengine.org/learn/quick-start/ec-examples/ target=_blank>Bevy examples documentation</a> - For context on how examples are used in Bevy<li><a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/Mipmap target=_blank>Mipmapping techniques in computer graphics</a> - For background on what this example demonstrates</ul><h1 id=full-code-diff>Full Code Diff</h1><pre style=color:#61676c;background-color:#fafafa><code><span>diff --git a/examples/2d/dynamic_mip_generation.rs b/examples/2d/dynamic_mip_generation.rs
</span><span>index 3d375a3a40668..07107ecf1f8b4 100644
</span><span>--- a/examples/2d/dynamic_mip_generation.rs
</span><span>+++ b/examples/2d/dynamic_mip_generation.rs
</span><span>@@ -28,7 +28,8 @@ use bevy::{
</span><span>     sprite_render::{AlphaMode2d, Material2d, Material2dPlugin},
</span><span>     window::{PrimaryWindow, WindowResized},
</span><span> };
</span><span>-use rand::{rngs::ThreadRng, Rng};
</span><span>+use rand::{Rng, SeedableRng};
</span><span>+use rand_chacha::ChaCha8Rng;
</span><span> 
</span><span> use crate::widgets::{
</span><span>     RadioButton, RadioButtonText, WidgetClickEvent, WidgetClickSender, BUTTON_BORDER,
</span><span>@@ -68,6 +69,8 @@ struct AppStatus {
</span><span>     image_width: ImageSize,
</span><span>     /// The height of the image.
</span><span>     image_height: ImageSize,
</span><span>+    /// Seeded random generator.
</span><span>+    rng: ChaCha8Rng,
</span><span> }
</span><span> 
</span><span> impl Default for AppStatus {
</span><span>@@ -76,6 +79,7 @@ impl Default for AppStatus {
</span><span>             enable_mip_generation: EnableMipGeneration::On,
</span><span>             image_width: ImageSize::Size640,
</span><span>             image_height: ImageSize::Size480,
</span><span>+            rng: ChaCha8Rng::seed_from_u64(19878367467713),
</span><span>         }
</span><span>     }
</span><span> }
</span><span>@@ -537,7 +541,7 @@ fn regenerate_image_when_requested(
</span><span>     image_views_query: Query&LTEntity, With&LTImageView>>,
</span><span>     windows_query: Query<&Window, With&LTPrimaryWindow>>,
</span><span>     app_assets: Res&LTAppAssets>,
</span><span>-    app_status: Res&LTAppStatus>,
</span><span>+    mut app_status: ResMut&LTAppStatus>,
</span><span>     mut images: ResMut&LTAssets&LTImage>>,
</span><span>     mut single_mip_level_materials: ResMut&LTAssets&LTSingleMipLevelMaterial>>,
</span><span>     mut color_materials: ResMut&LTAssets&LTColorMaterial>>,
</span><span>@@ -750,7 +754,7 @@ impl AppStatus {
</span><span> 
</span><span>     /// Regenerates the main image based on the image size selected by the user.
</span><span>     fn regenerate_mipmap_source_image(
</span><span>-        &self,
</span><span>+        &mut self,
</span><span>         commands: &mut Commands,
</span><span>         images: &mut Assets&LTImage>,
</span><span>     ) -> Handle&LTImage> {
</span><span>@@ -779,11 +783,10 @@ impl AppStatus {
</span><span>     /// Draws the concentric ellipses that make up the image.
</span><span>     ///
</span><span>     /// Returns the RGBA8 image data.
</span><span>-    fn generate_image_data(&self) -> Vec&LTu8> {
</span><span>+    fn generate_image_data(&mut self) -> Vec&LTu8> {
</span><span>         // Select random colors for the inner and outer ellipses.
</span><span>-        let mut rng = ThreadRng::default();
</span><span>-        let outer_color: [u8; 3] = array::from_fn(|_| rng.random());
</span><span>-        let inner_color: [u8; 3] = array::from_fn(|_| rng.random());
</span><span>+        let outer_color: [u8; 3] = array::from_fn(|_| self.rng.random());
</span><span>+        let inner_color: [u8; 3] = array::from_fn(|_| self.rng.random());
</span><span> 
</span><span>         let image_byte_size = 4usize
</span><span>             * MipmapSizeIterator::new(self)
</span></code></pre></div><div data-is-md-page=true data-patch-exists=true data-patch-path=/pull_request/bevy/2026-01/pr_22346.patch id=patch-info style=display:none></div><div class=bottom-spacer></div></div></div>