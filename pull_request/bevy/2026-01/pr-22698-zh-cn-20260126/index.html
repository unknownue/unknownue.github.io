<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://unknownue.github.io name=base><title>
         #22698
        
    </title><meta content=#22698 property=og:title><meta content="A personal blog built with Zola and Apollo theme" property=og:description><meta content="A personal blog built with Zola and Apollo theme" name=description><link href=/icons/favicon.png rel=icon type=image/png><link href=https://unknownue.github.io/fonts.css rel=stylesheet><script src=https://unknownue.github.io/js/codeblock.js></script><script src=https://unknownue.github.io/js/toc.js></script><script src=https://unknownue.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Unknownue's Blog" href=https://unknownue.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://unknownue.github.io/theme/light.css rel=stylesheet><link href=https://unknownue.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://unknownue.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://unknownue.github.io/main.css media=screen rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js></script><script>// Initialize mermaid once DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            mermaid.initialize({
                startOnLoad: false,
                theme: document.body && document.body.classList.contains('dark') ? 'dark' : 'default',
                securityLevel: 'loose',
                flowchart: {
                    useMaxWidth: true,
                    htmlLabels: true
                },
                sequence: {
                    diagramMarginX: 50,
                    diagramMarginY: 10,
                    actorMargin: 50,
                    width: 150,
                    height: 65
                }
            });
        });</script><script src=https://unknownue.github.io/js/main.js></script><script defer src=https://unknownue.github.io/js/label-colors.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/rust.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/typescript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/go.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/cpp.min.js></script><script>// Ensure highlight.js is properly configured
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof hljs !== 'undefined') {
                hljs.configure({
                    languages: ['rust', 'javascript', 'python', 'cpp', 'go', 'typescript'],
                    ignoreUnescapedHTML: true
                });
                console.log('Highlight.js configured in header');
            }
        });</script><link href=https://cdn.jsdelivr.net/npm/diff2html/bundles/css/diff2html.min.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/diff2html/bundles/js/diff2html-ui.min.js></script><script src=https://unknownue.github.io/js/syntax-highlight.js></script><script src=https://unknownue.github.io/js/diff-sidebar.js></script><script src="https://unknownue.github.io/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><div class=content><header><div class=main><a href=https://unknownue.github.io>Unknownue's Blog</a><div class=socials><a class=social href=https://github.com/unknownue rel=me> <img alt=github src=https://unknownue.github.io/icons/social/github.svg> </a><a class=social href=https://github.com/unknownue/unknownue.github.io rel=me> <img alt=github-io src=https://unknownue.github.io/icons/social/rss.svg> </a></div></div><nav><a href=https://unknownue.github.io/posts style=margin-left:.25em>/posts</a><a href=https://unknownue.github.io/projects style=margin-left:.25em>/projects</a><a href=https://unknownue.github.io/about style=margin-left:.25em>/about</a><a href=https://unknownue.github.io/tags style=margin-left:.25em>/tags</a><button title="$SHORTCUT to open search" class=search-button id=search-button><img alt=Search class=search-icon src=https://unknownue.github.io/icons/search.svg></button><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><div id=modal-content><h1 class=page-header id=modalTitle>Search</h1><div id=searchBar><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search... role=combobox spellcheck=false><button title="Clear search" class=clear-button id=clear-search><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></button></div><div id=results-container><div id=results-info><span id=zero_results style=display:none>No results</span><span id=one_result style=display:none>1 result</span><span id=many_results style=display:none>$NUMBER results</span></div><div id=results role=listbox></div></div></div></div><a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://unknownue.github.io/icons/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://unknownue.github.io/icons/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><div class=pull-request-page><article class=md-content-page style=display:none></article><div class=back-link><a href=/pull_request/bevy/2026-01/>← Back to Pull Requests</a></div><div class=pr-metadata><span class=pr-date>2026-01-26</span><div class=language-switcher><a class=lang-link data-lang=en href=/pull_request/bevy/2026-01/pr-22698-en-20260126>English</a> / <span class="lang-link active" data-lang=zh-cn>中文</span></div></div><div class=pr-content><h1 id=title>Title</h1><p>render buffer debug label type prepopulation<h2 id=ji-ben-zi-xun>基本資訊</h2><ul><li><strong>標題</strong>: render buffer debug label type prepopulation<li><strong>PR連結</strong>: https://github.com/bevyengine/bevy/pull/22698<li><strong>作者</strong>: atlv24<li><strong>狀態</strong>: 已合併<li><strong>標籤</strong>: A-Rendering, S-Ready-For-Final-Review, A-Dev-Tools, X-Uncontroversial, C-Refinement<li><strong>建立時間</strong>: 2026-01-25T16:05:10Z<li><strong>合併時間</strong>: 2026-01-26T00:35:30Z<li><strong>合併者</strong>: alice-i-cecile</ul><h2 id=miao-shu-fan-yi>描述翻譯</h2><h3 id=objective-mu-biao>Objective（目標）</h3><ul><li>我們絕大多數的緩衝區（buffers）都沒有標籤（unlabelled）。這讓除錯 wgpu 錯誤變得很麻煩，因為它們缺乏上下文資訊。</ul><h3 id=solution-jie-jue-fang-an>Solution（解決方案）</h3><ul><li>我們有型別資訊，而且緩衝區大多是自訂結構型別，少數不是的情況似乎也都手動命名了。我們可以利用型別資訊，在除錯模式下預先填入緩衝區名稱。</ul><h3 id=testing-ce-shi>Testing（測試）</h3><ul><li>在啟用和未啟用除錯功能的情況下執行 occlusion_culling 範例，目前由於 wgpu 28 的變更而崩潰。</ul><h3 id=showcase-zhan-shi>Showcase（展示）</h3><p><strong>Before（之前）</strong>:<pre style=color:#61676c;background-color:#fafafa><code><span>Caused by:
</span><span>  In a CommandEncoder
</span><span>    In a dispatch command, indirect:true
</span><span>      Attempted to use Buffer with '' label with conflicting usages. Current usage BufferUses(STORAGE_READ_WRITE) and new usage BufferUses(INDIRECT). BufferUses(STORAGE_READ_WRITE) is an exclusive usage and cannot be used with any other usages within the usage scope (renderpass or compute dispatch).
</span></code></pre><p><strong>After（之後）</strong>:<pre style=color:#61676c;background-color:#fafafa><code><span>Caused by:
</span><span>  In a CommandEncoder
</span><span>    In a dispatch command, indirect:true
</span><span>      Attempted to use Buffer with 'bevy_render::render_resource::buffer_vec::RawBufferVec&LTbevy_render::batching::gpu_preprocessing::LatePreprocessWorkItemIndirectParameters>' label with conflicting usages. Current usage BufferUses(STORAGE_READ_WRITE) and new usage BufferUses(INDIRECT). BufferUses(STORAGE_READ_WRITE) is an exclusive usage and cannot be used with any other usages within the usage scope (renderpass or compute dispatch).
</span></code></pre><p>現在我們知道：1. 它是 <code>RawBufferVec</code>；2. 它儲存的是 <code>LatePreprocessWorkItemIndirectParameters</code>。這讓我們可以大大縮小尋找問題根源的範圍。<p><strong>注意</strong>：這是多次嘗試改進除錯資訊的演進結果。第一次嘗試使用 <code>#[track_caller]</code>，但這在 const 上下文中無效，因為 Location 不允許在那裡使用。第二次嘗試是在建構子中預先填入型別名稱資訊，但 <code>std::any::type_name()</code> 返回 <code>&'static str</code>，而標籤是 <code>Option&LTString></code>，而且 <code>.into()</code> 和 <code>.to_string()</code> 都不是 const，因為 <code>String</code> 是堆積分配的。最後，我將其移到緩衝區建立的地方，然後提取成一個泛型函數以消除重複。<h2 id=zhe-ge-pull-request-de-gu-shi>這個 Pull Request 的故事</h2><h3 id=wen-ti-yu-bei-jing>問題與背景</h3><p>在 Bevy 渲染系統中，wgpu 緩衝區（buffers）在建立時通常沒有設定標籤（label）。當發生緩衝區使用衝突（buffer usage conflict）或其他 wgpu 錯誤時，錯誤訊息只會顯示一個空字串作為標籤，這對於除錯來說幾乎沒有幫助。開發者需要花費大量時間追蹤哪個緩衝區出了問題，特別是當應用程式中有數十或數百個緩衝區時。<h3 id=jie-jue-fang-an-yan-jin>解決方案演進</h3><p>這個問題的解決方案經歷了幾次迭代。最初嘗試使用 <code>#[track_caller]</code> 來自動捕捉呼叫位置，但這個方法在 const 上下文中不可行。接著嘗試在建構子中預先填入型別名稱，但遇到了型別轉換問題：<code>std::any::type_name()</code> 返回 <code>&'static str</code>，而緩衝區標籤需要 <code>Option&LTString></code>，且轉換操作無法在 const 環境中進行。<p>最終的解決方案是將標籤生成邏輯推遲到實際建立緩衝區的時刻。這個方法利用了 Rust 的泛型系統和條件編譯（conditional compilation），只在啟用除錯功能時自動填入型別資訊。<h3 id=ji-shu-shi-zuo-xi-jie>技術實作細節</h3><p>核心實作是一個名為 <code>make_buffer_label</code> 的泛型函數，它接受當前緩衝區的標籤（<code>Option&LTString></code>）並返回最終使用的標籤（<code>Option<&str></code>）。這個函數的關鍵特性是：<ol><li><strong>條件編譯</strong>：使用 <code>#[cfg(feature = "type_label_buffers")]</code> 來控制功能啟用<li><strong>型別資訊擷取</strong>：使用 <code>core::any::type_name::&LTT>()</code> 取得緩衝區的完整型別名稱<li><strong>優先級處理</strong>：如果手動設定了標籤，就使用手動標籤；否則在除錯模式下使用型別名稱</ol><pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>inline</span><span>]
</span><span style=color:#fa6e32>pub</span><span>(</span><span style=color:#fa6e32>crate</span><span>) </span><span style=color:#fa6e32>fn </span><span style=color:#f29718>make_buffer_label</span><span><</span><span style=color:#fa6e32>'a</span><span>, T>(</span><span style=color:#ff8f40>label</span><span style=color:#61676ccc>: </span><span style=color:#ed9366>&</span><span style=color:#fa6e32>'a </span><span style=color:#55b4d4;font-style:italic>Option</span><span><</span><span style=color:#55b4d4;font-style:italic>String</span><span>>) </span><span style=color:#61676ccc>-> </span><span style=color:#55b4d4;font-style:italic>Option</span><span><</span><span style=color:#ed9366>&</span><span style=color:#fa6e32>'a str</span><span>> {
</span><span>    </span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>cfg</span><span>(feature </span><span style=color:#ed9366>= </span><span style=color:#86b300>"type_label_buffers"</span><span>)]
</span><span>    </span><span style=color:#fa6e32>if</span><span> label</span><span style=color:#ed9366>.</span><span style=color:#f07171>is_none</span><span>() {
</span><span>        </span><span style=color:#fa6e32>return </span><span style=color:#55b4d4;font-style:italic>Some</span><span>(core</span><span style=color:#ed9366>::</span><span>any</span><span style=color:#ed9366>::</span><span>type_name</span><span style=color:#ed9366>::</span><span>&LTT>())</span><span style=color:#61676ccc>;
</span><span>    }
</span><span>    label</span><span style=color:#ed9366>.</span><span style=color:#f07171>as_deref</span><span>()
</span><span>}
</span></code></pre><p>這個函數被整合到三種主要的緩衝區類型中：<code>RawBufferVec</code>、<code>StorageBuffer</code>/<code>DynamicStorageBuffer</code>，以及 <code>UniformBuffer</code>/<code>DynamicUniformBuffer</code>。每個緩衝區建立點都從原本直接使用 <code>self.label.as_deref()</code> 改為呼叫 <code>make_buffer_label::&LTSelf>(&self.label)</code>。<h3 id=gong-cheng-jue-ce-kao-liang>工程決策考量</h3><ol><li><strong>零成本抽象</strong>：在未啟用 <code>type_label_buffers</code> 功能時，生成的程式碼與原本相同，沒有額外開銷<li><strong>向後相容性</strong>：手動設定的標籤永遠優先於自動生成的標籤，確保現有程式碼不受影響<li><strong>功能隔離</strong>：將此功能放在獨立的 Cargo feature 中，讓開發者可以選擇性啟用<li><strong>維護性</strong>：將邏輯提取到共用函數中，避免了程式碼重複</ol><h3 id=shi-ji-ying-xiang>實際影響</h3><p>這個改動顯著改善了除錯體驗。以前，當發生緩衝區使用衝突時，錯誤訊息只會顯示空的標籤。現在，錯誤訊息會顯示完整的型別路徑，例如 <code>bevy_render::render_resource::buffer_vec::RawBufferVec&LTbevy_render::batching::gpu_preprocessing::LatePreprocessWorkItemIndirectParameters></code>。這樣的資訊讓開發者能夠：<ol><li>立即知道是哪種類型的緩衝區出問題<li>了解緩衝區儲存的資料型別<li>快速定位到相關的原始碼位置</ol><h3 id=jia-gou-zheng-he>架構整合</h3><p>這個改動保持了 Bevy 渲染系統的架構一致性。緩衝區標籤原本就是可選的，這個 PR 只是在未提供標籤時提供了一個有意義的預設值。功能通過 Cargo features 進行控制，與 Bevy 的模組化設計哲學一致。<h2 id=shi-jue-hua-biao-shi>視覺化表示</h2><pre class=language-mermaid data-lang=mermaid style=color:#61676c;background-color:#fafafa><code class=language-mermaid data-lang=mermaid><span>graph TD
</span><span>    A[wgpu Buffer Error] --> B{Buffer has label?}
</span><span>    B -->|No| C[Debug feature enabled?]
</span><span>    B -->|Yes| D[Use manual label]
</span><span>    C -->|Yes| E[Generate type name label]
</span><span>    C -->|No| F[Use empty label]
</span><span>    E --> G[Error shows type info]
</span><span>    D --> G
</span><span>    F --> G
</span></code></pre><h2 id=zhu-yao-dang-an-bian-geng>主要檔案變更</h2><h3 id=1-crates-bevy-render-src-render-resource-buffer-vec-rs-12-3>1. <code>crates/bevy_render/src/render_resource/buffer_vec.rs</code> (+12/-3)</h3><p><strong>變更原因</strong>：將標籤生成邏輯提取到共用函數，並在 <code>RawBufferVec</code> 的三個緩衝區建立點使用新函數。<p><strong>關鍵修改</strong>：<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before:
</span><span>label</span><span style=color:#61676ccc>: </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>label</span><span style=color:#ed9366>.</span><span style=color:#f07171>as_deref</span><span>()</span><span style=color:#61676ccc>,
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After:
</span><span>label</span><span style=color:#61676ccc>: </span><span>make_buffer_label</span><span style=color:#ed9366>::</span><span><</span><span style=color:#fa6e32>Self</span><span>>(</span><span style=color:#ed9366>&</span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>label)</span><span style=color:#61676ccc>,
</span></code></pre><p><strong>新增函數</strong>：<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>inline</span><span>]
</span><span style=color:#fa6e32>pub</span><span>(</span><span style=color:#fa6e32>crate</span><span>) </span><span style=color:#fa6e32>fn </span><span style=color:#f29718>make_buffer_label</span><span><</span><span style=color:#fa6e32>'a</span><span>, T>(</span><span style=color:#ff8f40>label</span><span style=color:#61676ccc>: </span><span style=color:#ed9366>&</span><span style=color:#fa6e32>'a </span><span style=color:#55b4d4;font-style:italic>Option</span><span><</span><span style=color:#55b4d4;font-style:italic>String</span><span>>) </span><span style=color:#61676ccc>-> </span><span style=color:#55b4d4;font-style:italic>Option</span><span><</span><span style=color:#ed9366>&</span><span style=color:#fa6e32>'a str</span><span>> {
</span><span>    </span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>cfg</span><span>(feature </span><span style=color:#ed9366>= </span><span style=color:#86b300>"type_label_buffers"</span><span>)]
</span><span>    </span><span style=color:#fa6e32>if</span><span> label</span><span style=color:#ed9366>.</span><span style=color:#f07171>is_none</span><span>() {
</span><span>        </span><span style=color:#fa6e32>return </span><span style=color:#55b4d4;font-style:italic>Some</span><span>(core</span><span style=color:#ed9366>::</span><span>any</span><span style=color:#ed9366>::</span><span>type_name</span><span style=color:#ed9366>::</span><span>&LTT>())</span><span style=color:#61676ccc>;
</span><span>    }
</span><span>    label</span><span style=color:#ed9366>.</span><span style=color:#f07171>as_deref</span><span>()
</span><span>}
</span></code></pre><h3 id=2-crates-bevy-render-src-render-resource-storage-buffer-rs-6-3>2. <code>crates/bevy_render/src/render_resource/storage_buffer.rs</code> (+6/-3)</h3><p><strong>變更原因</strong>：在 <code>StorageBuffer</code> 和 <code>DynamicStorageBuffer</code> 中整合自動標籤生成。<p><strong>關鍵修改</strong>：<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// 新增導入
</span><span style=color:#fa6e32>use crate</span><span style=color:#61676ccc>::</span><span>{
</span><span>    render_resource</span><span style=color:#ed9366>::</span><span>make_buffer_label</span><span style=color:#61676ccc>,
</span><span>    renderer</span><span style=color:#ed9366>::</span><span>{RenderDevice</span><span style=color:#61676ccc>,</span><span> RenderQueue}</span><span style=color:#61676ccc>,
</span><span>}</span><span style=color:#61676ccc>;
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// 在緩衝區建立點
</span><span>label</span><span style=color:#61676ccc>: </span><span>make_buffer_label</span><span style=color:#ed9366>::</span><span><</span><span style=color:#fa6e32>Self</span><span>>(</span><span style=color:#ed9366>&</span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>label)</span><span style=color:#61676ccc>,
</span></code></pre><h3 id=3-crates-bevy-render-src-render-resource-uniform-buffer-rs-3-3>3. <code>crates/bevy_render/src/render_resource/uniform_buffer.rs</code> (+3/-3)</h3><p><strong>變更原因</strong>：在 <code>UniformBuffer</code> 和 <code>DynamicUniformBuffer</code> 中整合自動標籤生成。<p><strong>關鍵修改</strong>：<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// 新增導入
</span><span style=color:#fa6e32>use crate</span><span style=color:#ed9366>::</span><span>render_resource</span><span style=color:#ed9366>::</span><span>{make_buffer_label</span><span style=color:#61676ccc>,</span><span> Buffer}</span><span style=color:#61676ccc>;
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// 在緩衝區建立點
</span><span>label</span><span style=color:#61676ccc>: </span><span>make_buffer_label</span><span style=color:#ed9366>::</span><span><</span><span style=color:#fa6e32>Self</span><span>>(</span><span style=color:#ed9366>&</span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>label)</span><span style=color:#61676ccc>,
</span></code></pre><h3 id=4-cargo-toml-dang-an-bian-geng>4. Cargo.toml 檔案變更</h3><ul><li><strong>根目錄 Cargo.toml</strong>：新增 <code>type_label_buffers</code> feature<li><strong>crates/bevy_internal/Cargo.toml</strong>：將 <code>debug</code> feature 擴展到包含 <code>bevy_render/debug</code><li><strong>crates/bevy_render/Cargo.toml</strong>：新增 <code>type_label_buffers</code> 和 <code>debug</code> features</ul><p><strong>功能依賴關係</strong>：<pre style=color:#61676c;background-color:#fafafa><code><span>debug → bevy_render/debug → type_label_buffers
</span></code></pre><h3 id=5-docs-cargo-features-md-1-0>5. <code>docs/cargo_features.md</code> (+1/-0)</h3><p><strong>變更原因</strong>：文件化新的 <code>type_label_buffers</code> feature。<p><strong>新增內容</strong>：<pre style=color:#61676c;background-color:#fafafa><code><span>|type_label_buffers|Pre-populate buffer labels with buffer types for debugging.|
</span></code></pre><h2 id=yan-shen-yue-du>延伸閱讀</h2><ol><li><strong>Rust 型別名稱</strong>：<code>std::any::type_name</code> 函數的官方文件，了解如何取得型別的靜態字串表示<li><strong>wgpu 緩衝區標籤</strong>：wgpu 文件中關於緩衝區標籤和除錯的章節<li><strong>Cargo features</strong>：Rust Cargo 的功能系統，了解如何條件編譯程式碼<li><strong>Bevy 渲染系統架構</strong>：Bevy 官方文件中有關渲染資源管理的章節<li><strong>GPU 除錯技術</strong>：現代圖形 API 中的除錯工具和技術概覽</ol><h2 id=wan-zheng-cheng-shi-ma-chai-yi>完整程式碼差異</h2><p>（已在上述各節中涵蓋主要變更，此處不再重複）</div><div data-is-md-page=true data-patch-exists=true data-patch-path=/pull_request/bevy/2026-01/pr_22698.patch id=patch-info style=display:none></div><div class=bottom-spacer></div></div></div>