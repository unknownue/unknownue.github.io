<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://unknownue.github.io name=base><title>
         #22712 Update linux_dependencies.md NixOS Wayland Dependency
        
    </title><meta content="#22712 Update linux_dependencies.md NixOS Wayland Dependency" property=og:title><meta content="A personal blog built with Zola and Apollo theme" property=og:description><meta content="A personal blog built with Zola and Apollo theme" name=description><link href=/icons/favicon.png rel=icon type=image/png><link href=https://unknownue.github.io/fonts.css rel=stylesheet><script src=https://unknownue.github.io/js/codeblock.js></script><script src=https://unknownue.github.io/js/toc.js></script><script src=https://unknownue.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Unknownue's Blog" href=https://unknownue.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://unknownue.github.io/theme/light.css rel=stylesheet><link href=https://unknownue.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://unknownue.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://unknownue.github.io/main.css media=screen rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js></script><script>// Initialize mermaid once DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            mermaid.initialize({
                startOnLoad: false,
                theme: document.body && document.body.classList.contains('dark') ? 'dark' : 'default',
                securityLevel: 'loose',
                flowchart: {
                    useMaxWidth: true,
                    htmlLabels: true
                },
                sequence: {
                    diagramMarginX: 50,
                    diagramMarginY: 10,
                    actorMargin: 50,
                    width: 150,
                    height: 65
                }
            });
        });</script><script src=https://unknownue.github.io/js/main.js></script><script defer src=https://unknownue.github.io/js/label-colors.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/rust.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/typescript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/go.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/cpp.min.js></script><script>// Ensure highlight.js is properly configured
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof hljs !== 'undefined') {
                hljs.configure({
                    languages: ['rust', 'javascript', 'python', 'cpp', 'go', 'typescript'],
                    ignoreUnescapedHTML: true
                });
                console.log('Highlight.js configured in header');
            }
        });</script><link href=https://cdn.jsdelivr.net/npm/diff2html/bundles/css/diff2html.min.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/diff2html/bundles/js/diff2html-ui.min.js></script><script src=https://unknownue.github.io/js/syntax-highlight.js></script><script src=https://unknownue.github.io/js/diff-sidebar.js></script><script src="https://unknownue.github.io/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><div class=content><header><div class=main><a href=https://unknownue.github.io>Unknownue's Blog</a><div class=socials><a class=social href=https://github.com/unknownue rel=me> <img alt=github src=https://unknownue.github.io/icons/social/github.svg> </a><a class=social href=https://github.com/unknownue/unknownue.github.io rel=me> <img alt=github-io src=https://unknownue.github.io/icons/social/rss.svg> </a></div></div><nav><a href=https://unknownue.github.io/posts style=margin-left:.25em>/posts</a><a href=https://unknownue.github.io/projects style=margin-left:.25em>/projects</a><a href=https://unknownue.github.io/about style=margin-left:.25em>/about</a><a href=https://unknownue.github.io/tags style=margin-left:.25em>/tags</a><button title="$SHORTCUT to open search" class=search-button id=search-button><img alt=Search class=search-icon src=https://unknownue.github.io/icons/search.svg></button><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><div id=modal-content><h1 class=page-header id=modalTitle>Search</h1><div id=searchBar><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search... role=combobox spellcheck=false><button title="Clear search" class=clear-button id=clear-search><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></button></div><div id=results-container><div id=results-info><span id=zero_results style=display:none>No results</span><span id=one_result style=display:none>1 result</span><span id=many_results style=display:none>$NUMBER results</span></div><div id=results role=listbox></div></div></div></div><a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://unknownue.github.io/icons/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://unknownue.github.io/icons/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><div class=pull-request-page><article class=md-content-page style=display:none></article><div class=back-link><a href=/pull_request/bevy/2026-01/>← Back to Pull Requests</a></div><div class=pr-metadata><span class=pr-date>2026-01-26</span><div class=language-switcher><a class=lang-link data-lang=en href=/pull_request/bevy/2026-01/pr-22712-en-20260126>English</a> / <span class="lang-link active" data-lang=zh-cn>中文</span></div></div><div class=pr-content><h1 id=title>Title</h1><p>Update linux_dependencies.md NixOS Wayland Dependency<h2 id=basic-information>Basic Information</h2><ul><li><strong>Title</strong>: Update linux_dependencies.md NixOS Wayland Dependency<li><strong>PR Link</strong>: https://github.com/bevyengine/bevy/pull/22712<li><strong>作者</strong>: DefectiveDev<li><strong>状态</strong>: 已合并<li><strong>标签</strong>: C-Docs, O-Linux, S-Ready-For-Final-Review<li><strong>创建时间</strong>: 2026-01-26T12:56:54Z<li><strong>合并时间</strong>: 2026-01-26T18:48:03Z<li><strong>合并者</strong>: james7132</ul><h2 id=description-translation>Description Translation</h2><p>为使用Wayland的NixOS用户添加了一行依赖说明！<h2 id=the-story-of-this-pull-request>The Story of This Pull Request</h2><p>这是一个关于文档更新的简单PR，但背后反映了Bevy引擎在Linux平台上对多种显示协议的支持需求。PR #22712专门针对NixOS用户在Wayland环境下的依赖配置进行了文档补充。<p><strong>问题与背景</strong>：在Linux系统中，图形应用需要与显示服务器（display server）通信。传统上主要使用X11（X Window System），而现代Linux桌面环境逐渐转向Wayland协议。NixOS是一个独特的Linux发行版，采用声明式配置和可复现的包管理方式。Bevy作为跨平台游戏引擎，需要确保在不同Linux环境和显示协议下都能正常工作。<p>问题的核心在于文档不完整。现有的<code>linux_dependencies.md</code>文件已经为NixOS用户提供了依赖配置示例，但只包含了X11相关的库，缺少了Wayland支持所需的依赖。当NixOS用户使用Wayland协议运行Bevy应用时，可能会遇到链接错误或运行时问题，因为缺少必要的Wayland客户端库。<p><strong>解决方案方法</strong>：这个PR采用了最直接的解决方案——在现有的NixOS配置示例中添加缺失的依赖。由于NixOS使用Nix包管理器，开发者只需要在<code>flake.nix</code>文件的<code>buildInputs</code>列表中添加<code>wayland</code>包即可。这种方式既保持了向后兼容性（X11用户不受影响），又为Wayland用户提供了完整的支持。<p><strong>实现细节</strong>：PR的修改非常简单，只涉及一个文件的单行添加。在<code>docs/linux_dependencies.md</code>文件的NixOS章节中，开发者需要在现有的依赖列表中加入<code>wayland</code>包。修改后的配置确保Bevy应用在Wayland环境下能够正确链接和使用Wayland协议相关的功能。<pre class=language-nix data-lang=nix style=color:#61676c;background-color:#fafafa><code class=language-nix data-lang=nix><span style=color:#ff8f40>buildInputs </span><span style=color:#f51818>= </span><span>[
</span><span>    </span><span style=color:#abb0b6;font-style:italic># ... 其他依赖
</span><span>    </span><span style=color:#ff8f40>wayland  </span><span style=color:#abb0b6;font-style:italic># 新增的Wayland依赖
</span><span>]</span><span style=color:#f51818>;
</span></code></pre><p>这个修改遵循了NixOS的配置惯例，将Wayland作为一个普通的系统依赖添加到构建输入中。值得注意的是，Wayland和X11可以共存，因此即使系统同时支持两种协议，这个添加也不会产生冲突。<p><strong>技术洞察</strong>：从技术角度看，Wayland协议需要客户端库（<code>libwayland-client</code>）来与Wayland合成器（compositor）通信。在大多数Linux发行版中，这个库通常作为<code>wayland</code>或<code>libwayland</code>包提供。NixOS的包命名遵循类似约定，使用<code>wayland</code>作为包名称。<p>Bevy的图形后端（如winit）会根据运行时环境自动选择合适的显示协议。在支持Wayland的系统上，应用会优先使用Wayland协议，除非显式禁用。因此，提供Wayland依赖对于确保Bevy应用在现代Linux桌面环境上正常运行至关重要。<p><strong>影响</strong>：这个PR虽然修改量很小，但对NixOS用户的使用体验有实际影响。完整的文档能帮助开发者更快地设置开发环境，避免因缺少依赖导致的构建失败或运行时问题。这也体现了开源项目文档维护的重要性——即使是很小的疏漏，也可能给特定用户群体带来困扰。<p>从工程角度看，这个PR展示了良好的维护实践：及时识别文档缺口，提供精确的最小化修复，并保持与现有配置模式的一致性。对于使用Wayland的NixOS开发者来说，这个简单的修改意味着他们可以按照文档一次性正确配置所有依赖，而不需要额外搜索或调试。<h2 id=visual-representation>Visual Representation</h2><pre class=language-mermaid data-lang=mermaid style=color:#61676c;background-color:#fafafa><code class=language-mermaid data-lang=mermaid><span>graph TD
</span><span>    A[NixOS用户] --> B[运行Bevy应用]
</span><span>    B --> C{显示协议}
</span><span>    C --> D[Wayland]
</span><span>    C --> E[X11]
</span><span>    D --> F[需要wayland库]
</span><span>    E --> G[需要X11库]
</span><span>    F --> H[文档更新前: 缺失依赖]
</span><span>    G --> I[文档已有]
</span><span>    H --> J[构建/运行时错误]
</span><span>    F --> K[文档更新后: 包含依赖]
</span><span>    K --> L[正常运行]
</span></code></pre><h2 id=key-files-changed>Key Files Changed</h2><h3 id=docs-linux-dependencies-md-1-0><code>docs/linux_dependencies.md</code> (+1/-0)</h3><p>这是一个文档文件，列出了在Linux各发行版上运行Bevy所需的依赖。<p><strong>修改内容</strong>：在NixOS章节的示例配置中，向<code>buildInputs</code>列表添加了<code>wayland</code>依赖。<p><strong>代码对比</strong>：<pre class=language-nix data-lang=nix style=color:#61676c;background-color:#fafafa><code class=language-nix data-lang=nix><span style=color:#abb0b6;font-style:italic># 修改前：
</span><span style=color:#ff8f40>buildInputs </span><span style=color:#f51818>= </span><span>[
</span><span>    </span><span style=color:#abb0b6;font-style:italic># ... 其他依赖
</span><span>    </span><span style=color:#ff8f40>xorg</span><span style=color:#ed9366>.</span><span style=color:#ff8f40>libXi
</span><span>    </span><span style=color:#ff8f40>xorg</span><span style=color:#ed9366>.</span><span style=color:#ff8f40>libXcursor
</span><span>    </span><span style=color:#ff8f40>libxkbcommon
</span><span>]</span><span style=color:#f51818>;
</span><span>
</span><span style=color:#abb0b6;font-style:italic># 修改后：
</span><span style=color:#ff8f40>buildInputs </span><span style=color:#f51818>= </span><span>[
</span><span>    </span><span style=color:#abb0b6;font-style:italic># ... 其他依赖
</span><span>    </span><span style=color:#ff8f40>xorg</span><span style=color:#ed9366>.</span><span style=color:#ff8f40>libXi
</span><span>    </span><span style=color:#ff8f40>xorg</span><span style=color:#ed9366>.</span><span style=color:#ff8f40>libXcursor
</span><span>    </span><span style=color:#ff8f40>libxkbcommon
</span><span>    </span><span style=color:#ff8f40>wayland  </span><span style=color:#abb0b6;font-style:italic># 新增
</span><span>]</span><span style=color:#f51818>;
</span></code></pre><p><strong>与PR目标的关系</strong>：这个修改直接解决了问题——为NixOS上的Wayland用户提供完整的依赖文档。修改后的配置示例现在包含了Bevy在Wayland环境下运行所需的所有必要库。<h2 id=further-reading>Further Reading</h2><ol><li><p><strong>Wayland协议</strong>：</p> <ul><li><a rel="noopener nofollow noreferrer" href=https://wayland.freedesktop.org/ target=_blank>Wayland官方文档</a><li><a rel="noopener nofollow noreferrer" href=https://wayland.freedesktop.org/architecture.html target=_blank>Wayland架构介绍</a></ul><li><p><strong>NixOS和Nix包管理器</strong>：</p> <ul><li><a rel="noopener nofollow noreferrer" href=https://nixos.org/manual/nixos/stable/ target=_blank>NixOS官方手册</a><li><a rel="noopener nofollow noreferrer" href=https://nixos.org/guides/nix-language.html target=_blank>Nix语言基础</a></ul><li><p><strong>Bevy的跨平台支持</strong>：</p> <ul><li><a rel="noopener nofollow noreferrer" href=https://bevyengine.org/learn/book/getting-started/setup/#cross-platform target=_blank>Bevy官方文档：跨平台开发</a><li><a href="https://github.com/bevyengine/bevy/issues?q=is%3Aissue+label%3AA-Linux" rel="noopener nofollow noreferrer" target=_blank>Bevy在GitHub上的Linux支持问题</a></ul><li><p><strong>Linux图形栈</strong>：</p> <ul><li><a rel="noopener nofollow noreferrer" href=https://www.howtogeek.com/771207/x11-vs-wayland-whats-the-difference/ target=_blank>X11 vs Wayland比较</a><li><a rel="noopener nofollow noreferrer" href=https://blogs.gnome.org/uraeus/2022/01/26/on-the-road-to-fedora-workstation-36/ target=_blank>现代Linux图形栈概述</a></ul><li><p><strong>游戏引擎的显示后端集成</strong>：</p> <ul><li><a rel="noopener nofollow noreferrer" href=https://github.com/rust-windowing/winit target=_blank>winit库（Bevy使用的窗口管理库）</a><li><a rel="noopener nofollow noreferrer" href=https://rust-gamedev.github.io/2021/12/14/graphics-ecosystem.html target=_blank>Rust中的跨平台图形开发</a></ul></ol><h1 id=full-code-diff>Full Code Diff</h1><p>diff –git a/docs/linux_dependencies.md b/docs/linux_dependencies.md index 9050e7495f0ae..8be5db98e72c8 100644 — a/docs/linux_dependencies.md +++ b/docs/linux_dependencies.md @@ -165,6 +165,7 @@ Add a <code>flake.nix</code> file to the root of your GitHub repository containing: xorg.libXi xorg.libXcursor libxkbcommon<ul><li><pre style=color:#61676c;background-color:#fafafa><code><span>         wayland
</span><span>       ];
</span><span>     };
</span><span> }</span></code></pre></ul></div><div data-is-md-page=true data-patch-exists=true data-patch-path=/pull_request/bevy/2026-01/pr_22712.patch id=patch-info style=display:none></div><div class=bottom-spacer></div></div></div>