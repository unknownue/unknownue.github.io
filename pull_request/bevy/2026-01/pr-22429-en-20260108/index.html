<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://unknownue.github.io name=base><title>
         #22429 0.18: Add migration guide for automatic `Aabb` updates
        
    </title><meta content="#22429 0.18: Add migration guide for automatic `Aabb` updates" property=og:title><meta content="A personal blog built with Zola and Apollo theme" property=og:description><meta content="A personal blog built with Zola and Apollo theme" name=description><link href=/icons/favicon.png rel=icon type=image/png><link href=https://unknownue.github.io/fonts.css rel=stylesheet><script src=https://unknownue.github.io/js/codeblock.js></script><script src=https://unknownue.github.io/js/toc.js></script><script src=https://unknownue.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Unknownue's Blog" href=https://unknownue.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://unknownue.github.io/theme/light.css rel=stylesheet><link href=https://unknownue.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://unknownue.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://unknownue.github.io/main.css media=screen rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js></script><script>// Initialize mermaid once DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            mermaid.initialize({
                startOnLoad: false,
                theme: document.body && document.body.classList.contains('dark') ? 'dark' : 'default',
                securityLevel: 'loose',
                flowchart: {
                    useMaxWidth: true,
                    htmlLabels: true
                },
                sequence: {
                    diagramMarginX: 50,
                    diagramMarginY: 10,
                    actorMargin: 50,
                    width: 150,
                    height: 65
                }
            });
        });</script><script src=https://unknownue.github.io/js/main.js></script><script defer src=https://unknownue.github.io/js/label-colors.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/rust.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/typescript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/go.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/cpp.min.js></script><script>// Ensure highlight.js is properly configured
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof hljs !== 'undefined') {
                hljs.configure({
                    languages: ['rust', 'javascript', 'python', 'cpp', 'go', 'typescript'],
                    ignoreUnescapedHTML: true
                });
                console.log('Highlight.js configured in header');
            }
        });</script><link href=https://cdn.jsdelivr.net/npm/diff2html/bundles/css/diff2html.min.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/diff2html/bundles/js/diff2html-ui.min.js></script><script src=https://unknownue.github.io/js/syntax-highlight.js></script><script src=https://unknownue.github.io/js/diff-sidebar.js></script><script src="https://unknownue.github.io/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><div class=content><header><div class=main><a href=https://unknownue.github.io>Unknownue's Blog</a><div class=socials><a class=social href=https://github.com/unknownue rel=me> <img alt=github src=https://unknownue.github.io/icons/social/github.svg> </a><a class=social href=https://github.com/unknownue/unknownue.github.io rel=me> <img alt=github-io src=https://unknownue.github.io/icons/social/rss.svg> </a></div></div><nav><a href=https://unknownue.github.io/posts style=margin-left:.25em>/posts</a><a href=https://unknownue.github.io/projects style=margin-left:.25em>/projects</a><a href=https://unknownue.github.io/about style=margin-left:.25em>/about</a><a href=https://unknownue.github.io/tags style=margin-left:.25em>/tags</a><button title="$SHORTCUT to open search" class=search-button id=search-button><img alt=Search class=search-icon src=https://unknownue.github.io/icons/search.svg></button><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><div id=modal-content><h1 class=page-header id=modalTitle>Search</h1><div id=searchBar><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search... role=combobox spellcheck=false><button title="Clear search" class=clear-button id=clear-search><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></button></div><div id=results-container><div id=results-info><span id=zero_results style=display:none>No results</span><span id=one_result style=display:none>1 result</span><span id=many_results style=display:none>$NUMBER results</span></div><div id=results role=listbox></div></div></div></div><a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://unknownue.github.io/icons/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://unknownue.github.io/icons/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><div class=pull-request-page><article class=md-content-page style=display:none></article><div class=back-link><a href=/pull_request/bevy/2026-01/>← Back to Pull Requests</a></div><div class=pr-metadata><span class=pr-date>2026-01-08</span><div class=language-switcher><span class="lang-link active" data-lang=en>English</span> / <a class=lang-link data-lang=zh-cn href=/pull_request/bevy/2026-01/pr-22429-zh-cn-20260108>中文</a></div></div><div class=pr-content><h1 id=title>Title</h1><h2 id=0-18-add-migration-guide-for-automatic-aabb-updates>0.18: Add migration guide for automatic <code>Aabb</code> updates</h2><h2 id=basic-information>Basic Information</h2><ul><li><strong>Title</strong>: 0.18: Add migration guide for automatic <code>Aabb</code> updates<li><strong>PR Link</strong>: https://github.com/bevyengine/bevy/pull/22429<li><strong>Author</strong>: greeble-dev<li><strong>Status</strong>: MERGED<li><strong>Labels</strong>: C-Docs, A-Rendering, S-Ready-For-Final-Review<li><strong>Created</strong>: 2026-01-08T14:22:42Z<li><strong>Merged</strong>: 2026-01-08T18:40:17Z<li><strong>Merged By</strong>: alice-i-cecile</ul><h2 id=description-translation>Description Translation</h2><p>Adds migration guide for #18742.<p>I’m not entirely sure it’s necessary, but was implied by https://github.com/bevyengine/bevy/pull/21837#discussion_r2617521376.<h2 id=the-story-of-this-pull-request>The Story of This Pull Request</h2><p>This PR documents a behavior change introduced in PR #18742 that affects how Bevy handles Axis-Aligned Bounding Box (AABB) updates for mesh and sprite components. The issue dates back to GitHub issue #4294, where Aabb components weren’t being updated when their underlying meshes or sprites were modified.<p>In Bevy 0.17, when developers modified a mesh or sprite at runtime, the associated Aabb component - which is critical for visibility calculations and picking operations - remained static. This created a discrepancy where the visual representation changed but the bounding volume used for spatial queries didn’t. Developers had to implement workarounds by manually removing and recreating the Aabb component to force Bevy to generate a new bounding box from the modified geometry.<p>The fix in PR #18742 made the Aabb update system reactive to changes in mesh and sprite components. Now when a mesh or sprite is modified, the system automatically recalculates the Aabb to match the new geometry. This eliminates the need for manual workarounds and ensures spatial queries remain accurate when geometry changes.<p>The migration guide serves a practical purpose: it helps developers identify and remove now-unnecessary workarounds from their codebases. The documentation shows the before-and-after pattern clearly:<ul><li><strong>Before (0.17)</strong>: Developers had to manually remove the Aabb component after modifying a mesh to trigger regeneration<li><strong>After (0.18)</strong>: The Aabb updates automatically when the mesh changes</ul><p>The guide also documents the new <code>NoAutoAabb</code> component, which provides an escape hatch for developers who need explicit control over Aabb creation and updates. This component disables both automatic creation and automatic updating of Aabb components for entities that have it.<p>This documentation follows the established pattern for Bevy migration guides, which typically explain breaking changes or behavior modifications between versions. The author notes they weren’t entirely sure the guide was necessary, but included it based on discussion in another PR review, demonstrating good practice in maintaining comprehensive documentation for API changes.<h2 id=visual-representation>Visual Representation</h2><pre class=language-mermaid data-lang=mermaid style=color:#61676c;background-color:#fafafa><code class=language-mermaid data-lang=mermaid><span>graph TD
</span><span>    A[Mesh/Sprite Component Modified] --> B{Auto Aabb Enabled?}
</span><span>    B -->|Yes| C[System Triggers Aabb Recalculation]
</span><span>    B -->|No (Has NoAutoAabb)| D[Aabb Remains Unchanged]
</span><span>    C --> E[Updated Aabb Used for Visibility/Picking]
</span></code></pre><h2 id=key-files-changed>Key Files Changed</h2><p><strong><code>release-content/migration-guides/automatic_aabb_updates.md</code> (+28/-0)</strong><p>This is a new file created to document the migration from the old manual Aabb update pattern to the new automatic system. The file follows the standard migration guide format and includes:<ol><li>A clear title and reference to the implementing PR<li>Context about the problem in 0.17 and the fix in 0.18<li>Code examples showing the before/after patterns<li>Documentation of the new <code>NoAutoAabb</code> component for advanced use cases</ol><p>The key content of the file:<pre class=language-markdown data-lang=markdown style=color:#61676c;background-color:#fafafa><code class=language-markdown data-lang=markdown><span style=color:#abb0b6;background-color:#61676c10;font-weight:700>---
</span><span>title: Automatic </span><span style=color:#ed9366;background-color:#61676c10>`Aabb`</span><span> updates for sprites and meshes
</span><span>pull_requests: [18742]
</span><span style=color:#fa6e32;font-weight:700>---
</span><span>
</span><span>Bevy automatically creates an </span><span style=color:#ed9366;background-color:#61676c10>`Aabb`</span><span> component for entities containing a mesh
</span><span>or sprite - the </span><span style=color:#ed9366;background-color:#61676c10>`Aabb`</span><span> is then used for visibility and picking.
</span><span>
</span><span>In 0.17 the </span><span style=color:#ed9366;background-color:#61676c10>`Aabb`</span><span> [was not updated](</span><span style=color:#4cbf99;font-style:italic;text-decoration:underline>https://github.com/bevyengine/bevy/issues/4294</span><span>)
</span><span>if the mesh or sprite was modified. This has been fixed in 0.18. If you were working around the issue by manually updating or removing the
</span><span style=color:#ed9366;background-color:#61676c10>`Aabb`</span><span>, then the workaround is no longer needed.
</span><span>
</span><span>```</span><span style=color:#ff8f40>rust
</span><span style=color:#abb0b6;background-color:#61676c07;font-style:italic>// 0.17: Modify the mesh, and remove the `Aabb` so that it's automatically
</span><span style=color:#abb0b6;background-color:#61676c07;font-style:italic>// recreated from the modified mesh.
</span><span style=color:#61676c;background-color:#61676c07>mesh</span><span style=color:#ed9366;background-color:#61676c07>.</span><span style=color:#f07171;background-color:#61676c07>insert_attribute</span><span style=color:#61676c;background-color:#61676c07>(Mesh</span><span style=color:#ed9366;background-color:#61676c07>::</span><span style=color:#ff8f40;background-color:#61676c07>ATTRIBUTE_POSITION</span><span style=color:#61676ccc;background-color:#61676c07>,</span><span style=color:#61676c;background-color:#61676c07> new_positions)</span><span style=color:#61676ccc;background-color:#61676c07>;
</span><span style=color:#61676c;background-color:#61676c07>entity</span><span style=color:#ed9366;background-color:#61676c07>.</span><span style=color:#61676c;background-color:#61676c07>remove</span><span style=color:#ed9366;background-color:#61676c07>::</span><span style=color:#61676c;background-color:#61676c07>&LTAabb>()</span><span style=color:#61676ccc;background-color:#61676c07>;
</span><span style=color:#61676c;background-color:#61676c07>
</span><span style=color:#abb0b6;background-color:#61676c07;font-style:italic>// 0.18: The `Aabb` will be automatically updated.
</span><span style=color:#61676c;background-color:#61676c07>mesh</span><span style=color:#ed9366;background-color:#61676c07>.</span><span style=color:#f07171;background-color:#61676c07>insert_attribute</span><span style=color:#61676c;background-color:#61676c07>(Mesh</span><span style=color:#ed9366;background-color:#61676c07>::</span><span style=color:#ff8f40;background-color:#61676c07>ATTRIBUTE_POSITION</span><span style=color:#61676ccc;background-color:#61676c07>,</span><span style=color:#61676c;background-color:#61676c07> new_positions)</span><span style=color:#61676ccc;background-color:#61676c07>;
</span></code></pre><p>For users who want more control, 0.18 also adds a <code>NoAutoAabb</code> component. This will disable both automatic creation and automatic update of <code>Aabb</code> components.<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span>entity</span><span style=color:#ed9366>.</span><span style=color:#f07171>insert</span><span>(NoAutoAabb)</span><span style=color:#61676ccc>;
</span></code></pre><pre style=color:#61676c;background-color:#fafafa><code><span>
</span><span>## Further Reading
</span><span>
</span><span>1. **PR #18742**: The implementation that introduced automatic Aabb updates (https://github.com/bevyengine/bevy/pull/18742)
</span><span>2. **Issue #4294**: Original issue documenting the problem with Aabb not updating (https://github.com/bevyengine/bevy/issues/4294)
</span><span>3. **Bevy ECS and Change Detection**: Understanding how Bevy's ECS detects component changes to trigger systems (https://bevyengine.org/learn/quick-start/ecs/)
</span><span>4. **Spatial Queries in Bevy**: Documentation on how Aabb components are used for visibility and picking operations (https://bevyengine.org/learn/quick-start/3d/)</span></code></pre></div><div data-is-md-page=true data-patch-exists=true data-patch-path=/pull_request/bevy/2026-01/pr_22429.patch id=patch-info style=display:none></div><div class=bottom-spacer></div></div></div>