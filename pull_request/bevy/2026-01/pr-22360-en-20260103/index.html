<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://unknownue.github.io name=base><title>
         #22360 derive Reflect on FpsOverlayConfig and FrameTimeGraphConfig
        
    </title><meta content="#22360 derive Reflect on FpsOverlayConfig and FrameTimeGraphConfig" property=og:title><meta content="A personal blog built with Zola and Apollo theme" property=og:description><meta content="A personal blog built with Zola and Apollo theme" name=description><link href=/icons/favicon.png rel=icon type=image/png><link href=https://unknownue.github.io/fonts.css rel=stylesheet><script src=https://unknownue.github.io/js/codeblock.js></script><script src=https://unknownue.github.io/js/toc.js></script><script src=https://unknownue.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Unknownue's Blog" href=https://unknownue.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://unknownue.github.io/theme/light.css rel=stylesheet><link href=https://unknownue.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://unknownue.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://unknownue.github.io/main.css media=screen rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js></script><script>// Initialize mermaid once DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            mermaid.initialize({
                startOnLoad: false,
                theme: document.body && document.body.classList.contains('dark') ? 'dark' : 'default',
                securityLevel: 'loose',
                flowchart: {
                    useMaxWidth: true,
                    htmlLabels: true
                },
                sequence: {
                    diagramMarginX: 50,
                    diagramMarginY: 10,
                    actorMargin: 50,
                    width: 150,
                    height: 65
                }
            });
        });</script><script src=https://unknownue.github.io/js/main.js></script><script defer src=https://unknownue.github.io/js/label-colors.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/rust.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/typescript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/go.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/cpp.min.js></script><script>// Ensure highlight.js is properly configured
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof hljs !== 'undefined') {
                hljs.configure({
                    languages: ['rust', 'javascript', 'python', 'cpp', 'go', 'typescript'],
                    ignoreUnescapedHTML: true
                });
                console.log('Highlight.js configured in header');
            }
        });</script><link href=https://cdn.jsdelivr.net/npm/diff2html/bundles/css/diff2html.min.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/diff2html/bundles/js/diff2html-ui.min.js></script><script src=https://unknownue.github.io/js/syntax-highlight.js></script><script src=https://unknownue.github.io/js/diff-sidebar.js></script><script src="https://unknownue.github.io/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><div class=content><header><div class=main><a href=https://unknownue.github.io>Unknownue's Blog</a><div class=socials><a class=social href=https://github.com/unknownue rel=me> <img alt=github src=https://unknownue.github.io/icons/social/github.svg> </a><a class=social href=https://github.com/unknownue/unknownue.github.io rel=me> <img alt=github-io src=https://unknownue.github.io/icons/social/rss.svg> </a></div></div><nav><a href=https://unknownue.github.io/posts style=margin-left:.25em>/posts</a><a href=https://unknownue.github.io/projects style=margin-left:.25em>/projects</a><a href=https://unknownue.github.io/about style=margin-left:.25em>/about</a><a href=https://unknownue.github.io/tags style=margin-left:.25em>/tags</a><button title="$SHORTCUT to open search" class=search-button id=search-button><img alt=Search class=search-icon src=https://unknownue.github.io/icons/search.svg></button><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><div id=modal-content><h1 class=page-header id=modalTitle>Search</h1><div id=searchBar><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search... role=combobox spellcheck=false><button title="Clear search" class=clear-button id=clear-search><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></button></div><div id=results-container><div id=results-info><span id=zero_results style=display:none>No results</span><span id=one_result style=display:none>1 result</span><span id=many_results style=display:none>$NUMBER results</span></div><div id=results role=listbox></div></div></div></div><a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://unknownue.github.io/icons/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://unknownue.github.io/icons/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><div class=pull-request-page><article class=md-content-page style=display:none></article><div class=back-link><a href=/pull_request/bevy/2026-01/>← Back to Pull Requests</a></div><div class=pr-metadata><span class=pr-date>2026-01-03</span><div class=language-switcher><span class="lang-link active" data-lang=en>English</span> / <a class=lang-link data-lang=zh-cn href=/pull_request/bevy/2026-01/pr-22360-zh-cn-20260103>中文</a></div></div><div class=pr-content><h1 id=title>Title</h1><h2 id=basic-information>Basic Information</h2><ul><li><strong>Title</strong>: derive Reflect on FpsOverlayConfig and FrameTimeGraphConfig<li><strong>PR Link</strong>: https://github.com/bevyengine/bevy/pull/22360<li><strong>Author</strong>: mirsella<li><strong>Status</strong>: MERGED<li><strong>Labels</strong>: C-Bug, D-Trivial, S-Ready-For-Final-Review, A-Reflection, A-Diagnostics<li><strong>Created</strong>: 2026-01-03T14:12:24Z<li><strong>Merged</strong>: 2026-01-03T23:07:30Z<li><strong>Merged By</strong>: alice-i-cecile</ul><h2 id=description-translation>Description Translation</h2><p>Derives <code>Reflect</code> on <code>FpsOverlayConfig</code> and <code>FrameTimeGraphConfig</code> to enable runtime reflection capabilities for these configuration structs. For example, allows modifying the config in bevy inspector egui.<h2 id=changes>Changes</h2><ul><li>Added <code>Reflect</code> derive to <code>FpsOverlayConfig</code> with <code>#[reflect(Resource)]</code> attribute<li>Added <code>Reflect</code> derive to <code>FrameTimeGraphConfig</code> (required since it’s a field in <code>FpsOverlayConfig</code>)<li>Added <code>use bevy_reflect::Reflect;</code> import</ul><h2 id=the-story-of-this-pull-request>The Story of This Pull Request</h2><p>This pull request addresses a missing feature in Bevy’s developer tools that prevented runtime configuration of FPS overlay settings through reflection-based tools like the Bevy inspector. The problem was straightforward: two configuration structs used by the FPS overlay system lacked the <code>Reflect</code> trait, which is Bevy’s standard mechanism for runtime reflection.<p>The issue became apparent when developers tried to modify <code>FpsOverlayConfig</code> or <code>FrameTimeGraphConfig</code> values at runtime using tools like the Bevy inspector GUI. Since these tools rely on reflection to discover and manipulate struct fields, missing the <code>Reflect</code> trait meant these configuration options couldn’t be adjusted during development without modifying code and recompiling.<p>The solution approach was direct: add the <code>Reflect</code> derive macro to both structs and ensure proper resource reflection for <code>FpsOverlayConfig</code>. The implementation required three specific changes in the <code>fps_overlay.rs</code> file:<p>First, the developer added the necessary import for the <code>Reflect</code> trait:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#fa6e32>use </span><span>bevy_reflect</span><span style=color:#ed9366>::</span><span>Reflect</span><span style=color:#61676ccc>;
</span></code></pre><p>This import is essential because derive macros need access to the traits they implement. Without it, the compiler wouldn’t recognize <code>Reflect</code> in the derive attribute.<p>Second, they modified the <code>FpsOverlayConfig</code> struct definition:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>derive</span><span>(Resource</span><span style=color:#61676ccc>,</span><span> Clone</span><span style=color:#61676ccc>,</span><span> Reflect)]
</span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>reflect</span><span>(Resource)]
</span><span style=color:#fa6e32>pub struct </span><span style=color:#399ee6>FpsOverlayConfig </span><span>{
</span><span>    </span><span style=color:#abb0b6;font-style:italic>// ... fields unchanged
</span><span>}
</span></code></pre><p>The key addition here is <code>Reflect</code> in the derive list and the <code>#[reflect(Resource)]</code> attribute. This combination enables the struct to be both reflectable and recognized as a resource type within Bevy’s reflection system. The <code>Resource</code> derive was already present, but reflection required explicit annotation.<p>Third, they updated the <code>FrameTimeGraphConfig</code> struct:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>derive</span><span>(Clone</span><span style=color:#61676ccc>,</span><span> Copy</span><span style=color:#61676ccc>,</span><span> Reflect)]
</span><span style=color:#fa6e32>pub struct </span><span style=color:#399ee6>FrameTimeGraphConfig </span><span>{
</span><span>    </span><span style=color:#abb0b6;font-style:italic>// ... fields unchanged
</span><span>}
</span></code></pre><p>This change was necessary because <code>FrameTimeGraphConfig</code> is a field type within <code>FpsOverlayConfig</code>. For reflection to work correctly on the parent struct, all field types must also support reflection. This is a common pattern in Bevy’s reflection system - nested types must be reflectable for the containing type to be fully reflectable.<p>From a technical perspective, this PR demonstrates Bevy’s reflection system requirements. When a struct uses <code>#[reflect(Resource)]</code>, it needs to meet several conditions: the struct itself must derive <code>Reflect</code>, and any field types that should be accessible through reflection must also derive <code>Reflect</code>. The compiler would catch missing implementations at compile time.<p>The impact of these changes is immediate for developers using Bevy’s inspector tools. They can now modify FPS overlay settings at runtime, adjusting parameters like text color, position, or graph visibility without restarting their application. This aligns with Bevy’s design philosophy of providing robust development tools alongside the game engine itself.<h2 id=visual-representation>Visual Representation</h2><pre class=language-mermaid data-lang=mermaid style=color:#61676c;background-color:#fafafa><code class=language-mermaid data-lang=mermaid><span>graph TD
</span><span>    A[bevy_reflect::Reflect] --> B[FpsOverlayConfig]
</span><span>    A --> C[FrameTimeGraphConfig]
</span><span>    B --> D[bevy_inspector_egui]
</span><span>    C --> D
</span><span>    E[#[reflect(Resource)]] --> B
</span><span>    B --> F[Configuration Fields]
</span><span>    C --> G[Graph Settings]
</span></code></pre><h2 id=key-files-changed>Key Files Changed</h2><h3 id=crates-bevy-dev-tools-src-fps-overlay-rs-5-2><code>crates/bevy_dev_tools/src/fps_overlay.rs</code> (+5/-2)</h3><p>This file contains the FPS overlay system for Bevy’s developer tools. The changes enable runtime reflection for two configuration structs.<p><strong>Key modifications:</strong><ol><li>Added the <code>Reflect</code> import:</ol><pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#fa6e32>use </span><span>bevy_reflect</span><span style=color:#ed9366>::</span><span>Reflect</span><span style=color:#61676ccc>;
</span></code></pre><ol start=2><li>Updated <code>FpsOverlayConfig</code> to support reflection:</ol><pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before:
</span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>derive</span><span>(Resource</span><span style=color:#61676ccc>,</span><span> Clone)]
</span><span style=color:#fa6e32>pub struct </span><span style=color:#399ee6>FpsOverlayConfig </span><span>{
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After:
</span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>derive</span><span>(Resource</span><span style=color:#61676ccc>,</span><span> Clone</span><span style=color:#61676ccc>,</span><span> Reflect)]
</span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>reflect</span><span>(Resource)]
</span><span style=color:#fa6e32>pub</span><span> struct FpsOverlayConfig {
</span></code></pre><ol start=3><li>Updated <code>FrameTimeGraphConfig</code> to support reflection:</ol><pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before:
</span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>derive</span><span>(Clone</span><span style=color:#61676ccc>,</span><span> Copy)]
</span><span style=color:#fa6e32>pub struct </span><span style=color:#399ee6>FrameTimeGraphConfig </span><span>{
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After:
</span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>derive</span><span>(Clone</span><span style=color:#61676ccc>,</span><span> Copy</span><span style=color:#61676ccc>,</span><span> Reflect)]
</span><span style=color:#fa6e32>pub</span><span> struct FrameTimeGraphConfig {
</span></code></pre><p>These changes are directly related to the PR’s purpose of enabling runtime configuration through reflection. The <code>FpsOverlayConfig</code> struct is marked as a reflectable resource, while <code>FrameTimeGraphConfig</code> is made reflectable because it’s used as a field within <code>FpsOverlayConfig</code>.<h2 id=further-reading>Further Reading</h2><ul><li><a rel="noopener nofollow noreferrer" href=https://docs.rs/bevy_reflect/latest/bevy_reflect/ target=_blank>Bevy Reflection Documentation</a> - Official documentation for Bevy’s reflection system<li><a rel="noopener nofollow noreferrer" href=https://github.com/jakobhellermann/bevy-inspector-egui target=_blank>Bevy Inspector Egui</a> - The inspector tool that benefits from these reflection changes<li><a rel="noopener nofollow noreferrer" href=https://doc.rust-lang.org/reference/procedural-macros.html#derive-macros target=_blank>Rust Derive Macros</a> - How derive macros work in Rust<li><a rel="noopener nofollow noreferrer" href=https://bevyengine.org/learn/book/getting-started/resources/ target=_blank>Bevy Resources and Reflection</a> - Official Bevy book section on resources and reflection</ul></div><div data-is-md-page=true data-patch-exists=true data-patch-path=/pull_request/bevy/2026-01/pr_22360.patch id=patch-info style=display:none></div><div class=bottom-spacer></div></div></div>