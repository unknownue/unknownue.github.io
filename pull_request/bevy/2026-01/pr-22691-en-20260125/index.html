<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://unknownue.github.io name=base><title>
         #22691 reflect ComputedCameraValues
        
    </title><meta content="#22691 reflect ComputedCameraValues" property=og:title><meta content="A personal blog built with Zola and Apollo theme" property=og:description><meta content="A personal blog built with Zola and Apollo theme" name=description><link href=/icons/favicon.png rel=icon type=image/png><link href=https://unknownue.github.io/fonts.css rel=stylesheet><script src=https://unknownue.github.io/js/codeblock.js></script><script src=https://unknownue.github.io/js/toc.js></script><script src=https://unknownue.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Unknownue's Blog" href=https://unknownue.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://unknownue.github.io/theme/light.css rel=stylesheet><link href=https://unknownue.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://unknownue.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://unknownue.github.io/main.css media=screen rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js></script><script>// Initialize mermaid once DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            mermaid.initialize({
                startOnLoad: false,
                theme: document.body && document.body.classList.contains('dark') ? 'dark' : 'default',
                securityLevel: 'loose',
                flowchart: {
                    useMaxWidth: true,
                    htmlLabels: true
                },
                sequence: {
                    diagramMarginX: 50,
                    diagramMarginY: 10,
                    actorMargin: 50,
                    width: 150,
                    height: 65
                }
            });
        });</script><script src=https://unknownue.github.io/js/main.js></script><script defer src=https://unknownue.github.io/js/label-colors.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/rust.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/typescript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/go.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/cpp.min.js></script><script>// Ensure highlight.js is properly configured
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof hljs !== 'undefined') {
                hljs.configure({
                    languages: ['rust', 'javascript', 'python', 'cpp', 'go', 'typescript'],
                    ignoreUnescapedHTML: true
                });
                console.log('Highlight.js configured in header');
            }
        });</script><link href=https://cdn.jsdelivr.net/npm/diff2html/bundles/css/diff2html.min.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/diff2html/bundles/js/diff2html-ui.min.js></script><script src=https://unknownue.github.io/js/syntax-highlight.js></script><script src=https://unknownue.github.io/js/diff-sidebar.js></script><script src="https://unknownue.github.io/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><div class=content><header><div class=main><a href=https://unknownue.github.io>Unknownue's Blog</a><div class=socials><a class=social href=https://github.com/unknownue rel=me> <img alt=github src=https://unknownue.github.io/icons/social/github.svg> </a><a class=social href=https://github.com/unknownue/unknownue.github.io rel=me> <img alt=github-io src=https://unknownue.github.io/icons/social/rss.svg> </a></div></div><nav><a href=https://unknownue.github.io/posts style=margin-left:.25em>/posts</a><a href=https://unknownue.github.io/projects style=margin-left:.25em>/projects</a><a href=https://unknownue.github.io/about style=margin-left:.25em>/about</a><a href=https://unknownue.github.io/tags style=margin-left:.25em>/tags</a><button title="$SHORTCUT to open search" class=search-button id=search-button><img alt=Search class=search-icon src=https://unknownue.github.io/icons/search.svg></button><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><div id=modal-content><h1 class=page-header id=modalTitle>Search</h1><div id=searchBar><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search... role=combobox spellcheck=false><button title="Clear search" class=clear-button id=clear-search><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></button></div><div id=results-container><div id=results-info><span id=zero_results style=display:none>No results</span><span id=one_result style=display:none>1 result</span><span id=many_results style=display:none>$NUMBER results</span></div><div id=results role=listbox></div></div></div></div><a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://unknownue.github.io/icons/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://unknownue.github.io/icons/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><div class=pull-request-page><article class=md-content-page style=display:none></article><div class=back-link><a href=/pull_request/bevy/2026-01/>← Back to Pull Requests</a></div><div class=pr-metadata><span class=pr-date>2026-01-25</span><div class=language-switcher><span class="lang-link active" data-lang=en>English</span> / <a class=lang-link data-lang=zh-cn href=/pull_request/bevy/2026-01/pr-22691-zh-cn-20260125>中文</a></div></div><div class=pr-content><h1 id=title>Title</h1><h2 id=basic-information>Basic Information</h2><ul><li><strong>Title</strong>: reflect ComputedCameraValues<li><strong>PR Link</strong>: https://github.com/bevyengine/bevy/pull/22691<li><strong>Author</strong>: atlv24<li><strong>Status</strong>: MERGED<li><strong>Labels</strong>: D-Trivial, A-Rendering, S-Ready-For-Final-Review, A-Reflection<li><strong>Created</strong>: 2026-01-25T04:13:19Z<li><strong>Merged</strong>: 2026-01-25T21:22:50Z<li><strong>Merged By</strong>: alice-i-cecile</ul><h2 id=description-translation>Description Translation</h2><h1 id=objective>Objective</h1><ul><li>Don’t know why it wasn’t reflected</ul><h2 id=solution>Solution</h2><ul><li>reflect it</ul><h2 id=testing>Testing</h2><ul><li>ci</ul><h2 id=the-story-of-this-pull-request>The Story of This Pull Request</h2><p>This PR addresses a straightforward oversight in Bevy’s camera system: the <code>ComputedCameraValues</code> struct wasn’t configured for reflection. In Bevy’s architecture, reflection enables runtime type inspection, serialization, and various editor features. When a type implements the <code>Reflect</code> trait, it can be dynamically examined and manipulated at runtime, which is particularly important for editor tooling and scene serialization.<p>The issue was discovered when working with the camera component. The <code>Camera</code> struct already had <code>#[derive(Reflect)]</code>, but its <code>computed</code> field was marked with <code>#[reflect(ignore, clone)]</code>. This meant that while the camera itself was reflectable, its computed values weren’t included in reflection operations. Looking deeper, the problem extended to the <code>ComputedCameraValues</code> struct itself, which didn’t derive <code>Reflect</code>, and also to <code>RenderTargetInfo</code> which was in the same situation.<p>The solution was simple and direct: add <code>Reflect</code> to the derive macros for both structs and remove the ignore attribute from the <code>computed</code> field. This change makes the camera’s computed values fully accessible through Bevy’s reflection system, which is important for features like scene serialization where these values need to be preserved or for editor tools that might need to inspect camera state.<p>Interestingly, there’s a comment in the code about another field (<code>output_mode</code>) not being reflected yet, mentioning “todo: reflect this when #6042 lands.” This suggests that camera reflection improvements are being tracked separately, and this PR likely represents a smaller, self-contained piece of that work.<p>The implementation follows Bevy’s established patterns for reflection. By deriving <code>Reflect</code> on these structs, they automatically gain the necessary trait implementations to work with Bevy’s reflection system. The <code>clone</code> attribute was likely removed because <code>ComputedCameraValues</code> already implements <code>Clone</code>, and with <code>Reflect</code> derived, the reflection system can handle cloning through its own mechanisms.<p>This change doesn’t affect runtime performance in normal gameplay since reflection is typically only used during specific operations like serialization or editor interactions. However, it does increase the flexibility of the camera system by making all its data accessible through Bevy’s reflection APIs.<h2 id=visual-representation>Visual Representation</h2><pre class=language-mermaid data-lang=mermaid style=color:#61676c;background-color:#fafafa><code class=language-mermaid data-lang=mermaid><span>graph TD
</span><span>    A[Camera Component] --> B[computed field]
</span><span>    B --> C[ComputedCameraValues]
</span><span>    C --> D[RenderTargetInfo]
</span><span>    C --> E[clip_from_view Matrix]
</span><span>    C --> F[view_from_world Matrix]
</span><span>    
</span><span>    style A fill:#e1f5fe
</span><span>    style C fill:#f3e5f5
</span><span>    style D fill:#e8f5e8
</span></code></pre><h2 id=key-files-changed>Key Files Changed</h2><p><code>crates/bevy_camera/src/camera.rs</code> (+2/-3)<p>This file contains the core camera types in Bevy. The changes enable reflection for camera-related data structures that were previously missing this capability.<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// File: crates/bevy_camera/src/camera.rs
</span><span style=color:#abb0b6;font-style:italic>// Before:
</span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>derive</span><span>(Debug</span><span style=color:#61676ccc>,</span><span> Clone)]
</span><span style=color:#fa6e32>pub struct </span><span style=color:#399ee6>RenderTargetInfo </span><span>{
</span><span>    </span><span style=color:#abb0b6;font-style:italic>// ...
</span><span>}
</span><span>
</span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>derive</span><span>(Default</span><span style=color:#61676ccc>,</span><span> Debug</span><span style=color:#61676ccc>,</span><span> Clone)]
</span><span style=color:#fa6e32>pub struct </span><span style=color:#399ee6>ComputedCameraValues </span><span>{
</span><span>    </span><span style=color:#abb0b6;font-style:italic>// ...
</span><span>}
</span><span>
</span><span style=color:#fa6e32>pub struct </span><span style=color:#399ee6>Camera </span><span>{
</span><span>    </span><span style=color:#abb0b6;font-style:italic>// ...
</span><span>    </span><span style=color:#abb0b6;font-style:italic>/// Computed values for this camera, such as the projection matrix and the render target size.
</span><span>    </span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>reflect</span><span>(ignore</span><span style=color:#61676ccc>,</span><span> clone)]
</span><span>    </span><span style=color:#fa6e32>pub </span><span>computed</span><span style=color:#61676ccc>:</span><span> ComputedCameraValues,
</span><span>    </span><span style=color:#abb0b6;font-style:italic>// ...
</span><span>}
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After:
</span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>derive</span><span>(Debug</span><span style=color:#61676ccc>,</span><span> Reflect</span><span style=color:#61676ccc>,</span><span> Clone)]
</span><span style=color:#fa6e32>pub struct </span><span style=color:#399ee6>RenderTargetInfo </span><span>{
</span><span>    </span><span style=color:#abb0b6;font-style:italic>// ...
</span><span>}
</span><span>
</span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>derive</span><span>(Default</span><span style=color:#61676ccc>,</span><span> Debug</span><span style=color:#61676ccc>,</span><span> Reflect</span><span style=color:#61676ccc>,</span><span> Clone)]
</span><span style=color:#fa6e32>pub struct </span><span style=color:#399ee6>ComputedCameraValues </span><span>{
</span><span>    </span><span style=color:#abb0b6;font-style:italic>// ...
</span><span>}
</span><span>
</span><span style=color:#fa6e32>pub struct </span><span style=color:#399ee6>Camera </span><span>{
</span><span>    </span><span style=color:#abb0b6;font-style:italic>// ...
</span><span>    </span><span style=color:#abb0b6;font-style:italic>/// Computed values for this camera, such as the projection matrix and the render target size.
</span><span>    </span><span style=color:#fa6e32>pub </span><span>computed</span><span style=color:#61676ccc>:</span><span> ComputedCameraValues,
</span><span>    </span><span style=color:#abb0b6;font-style:italic>// ...
</span><span>}
</span></code></pre><p>The changes are minimal but important:<ol><li><code>RenderTargetInfo</code> now derives <code>Reflect</code> in addition to <code>Debug</code> and <code>Clone</code><li><code>ComputedCameraValues</code> now derives <code>Reflect</code> in addition to <code>Default</code>, <code>Debug</code>, and <code>Clone</code><li>The <code>#[reflect(ignore, clone)]</code> attribute is removed from the <code>computed</code> field in the <code>Camera</code> struct, allowing it to be included in reflection operations</ol><p>These changes enable the entire camera data structure to be serialized, deserialized, and inspected at runtime through Bevy’s reflection system.<h2 id=further-reading>Further Reading</h2><ol><li><a rel="noopener nofollow noreferrer" href=https://docs.rs/bevy_reflect/latest/bevy_reflect/ target=_blank>Bevy Reflection Documentation</a> - Comprehensive guide to Bevy’s reflection system<li><a rel="noopener nofollow noreferrer" href=https://bevyengine.org/learn/quick-start/reflection/#deriving-reflect target=_blank>Deriving Reflect Trait</a> - How to use the Reflect derive macro<li><a rel="noopener nofollow noreferrer" href=https://docs.rs/bevy_camera/latest/bevy_camera/ target=_blank>Bevy Camera Component Documentation</a> - Detailed information about camera components in Bevy</ol><h1 id=full-code-diff>Full Code Diff</h1><pre style=color:#61676c;background-color:#fafafa><code><span>diff --git a/crates/bevy_camera/src/camera.rs b/crates/bevy_camera/src/camera.rs
</span><span>index 8b2248942e3ef..e8827d7edcee7 100644
</span><span>--- a/crates/bevy_camera/src/camera.rs
</span><span>+++ b/crates/bevy_camera/src/camera.rs
</span><span>@@ -158,7 +158,7 @@ impl Default for SubCameraView {
</span><span> }
</span><span> 
</span><span> /// Information about the current [`RenderTarget`].
</span><span>-#[derive(Debug, Clone)]
</span><span>+#[derive(Debug, Reflect, Clone)]
</span><span> pub struct RenderTargetInfo {
</span><span>     /// The physical size of this render target (in physical pixels, ignoring scale factor).
</span><span>     pub physical_size: UVec2,
</span><span>@@ -179,7 +179,7 @@ impl Default for RenderTargetInfo {
</span><span> }
</span><span> 
</span><span> /// Holds internally computed [`Camera`] values.
</span><span>-#[derive(Default, Debug, Clone)]
</span><span>+#[derive(Default, Debug, Reflect, Clone)]
</span><span> pub struct ComputedCameraValues {
</span><span>     pub clip_from_view: Mat4,
</span><span>     pub target_info: Option&LTRenderTargetInfo>,
</span><span>@@ -355,7 +355,6 @@ pub struct Camera {
</span><span>     /// camera will not be rendered.
</span><span>     pub is_active: bool,
</span><span>     /// Computed values for this camera, such as the projection matrix and the render target size.
</span><span>-    #[reflect(ignore, clone)]
</span><span>     pub computed: ComputedCameraValues,
</span><span>     // todo: reflect this when #6042 lands
</span><span>     /// The [`CameraOutputMode`] for this camera.
</span></code></pre></div><div data-is-md-page=true data-patch-exists=true data-patch-path=/pull_request/bevy/2026-01/pr_22691.patch id=patch-info style=display:none></div><div class=bottom-spacer></div></div></div>