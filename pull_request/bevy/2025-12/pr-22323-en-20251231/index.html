<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://unknownue.github.io name=base><title>
         #22323 `bevy_dev_tools::fps_overlay` elide default font
        
    </title><meta content="#22323 `bevy_dev_tools::fps_overlay` elide default font" property=og:title><meta content="A personal blog built with Zola and Apollo theme" property=og:description><meta content="A personal blog built with Zola and Apollo theme" name=description><link href=/icons/favicon.png rel=icon type=image/png><link href=https://unknownue.github.io/fonts.css rel=stylesheet><script src=https://unknownue.github.io/js/codeblock.js></script><script src=https://unknownue.github.io/js/toc.js></script><script src=https://unknownue.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Unknownue's Blog" href=https://unknownue.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://unknownue.github.io/theme/light.css rel=stylesheet><link href=https://unknownue.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://unknownue.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://unknownue.github.io/main.css media=screen rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js></script><script>// Initialize mermaid once DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            mermaid.initialize({
                startOnLoad: false,
                theme: document.body && document.body.classList.contains('dark') ? 'dark' : 'default',
                securityLevel: 'loose',
                flowchart: {
                    useMaxWidth: true,
                    htmlLabels: true
                },
                sequence: {
                    diagramMarginX: 50,
                    diagramMarginY: 10,
                    actorMargin: 50,
                    width: 150,
                    height: 65
                }
            });
        });</script><script src=https://unknownue.github.io/js/main.js></script><script defer src=https://unknownue.github.io/js/label-colors.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/rust.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/typescript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/go.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/cpp.min.js></script><script>// Ensure highlight.js is properly configured
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof hljs !== 'undefined') {
                hljs.configure({
                    languages: ['rust', 'javascript', 'python', 'cpp', 'go', 'typescript'],
                    ignoreUnescapedHTML: true
                });
                console.log('Highlight.js configured in header');
            }
        });</script><link href=https://cdn.jsdelivr.net/npm/diff2html/bundles/css/diff2html.min.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/diff2html/bundles/js/diff2html-ui.min.js></script><script src=https://unknownue.github.io/js/syntax-highlight.js></script><script src=https://unknownue.github.io/js/diff-sidebar.js></script><script src="https://unknownue.github.io/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><div class=content><header><div class=main><a href=https://unknownue.github.io>Unknownue's Blog</a><div class=socials><a class=social href=https://github.com/unknownue rel=me> <img alt=github src=https://unknownue.github.io/icons/social/github.svg> </a><a class=social href=https://github.com/unknownue/unknownue.github.io rel=me> <img alt=github-io src=https://unknownue.github.io/icons/social/rss.svg> </a></div></div><nav><a href=https://unknownue.github.io/posts style=margin-left:.25em>/posts</a><a href=https://unknownue.github.io/projects style=margin-left:.25em>/projects</a><a href=https://unknownue.github.io/about style=margin-left:.25em>/about</a><a href=https://unknownue.github.io/tags style=margin-left:.25em>/tags</a><button title="$SHORTCUT to open search" class=search-button id=search-button><img alt=Search class=search-icon src=https://unknownue.github.io/icons/search.svg></button><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><div id=modal-content><h1 class=page-header id=modalTitle>Search</h1><div id=searchBar><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search... role=combobox spellcheck=false><button title="Clear search" class=clear-button id=clear-search><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></button></div><div id=results-container><div id=results-info><span id=zero_results style=display:none>No results</span><span id=one_result style=display:none>1 result</span><span id=many_results style=display:none>$NUMBER results</span></div><div id=results role=listbox></div></div></div></div><a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://unknownue.github.io/icons/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://unknownue.github.io/icons/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><div class=pull-request-page><article class=md-content-page style=display:none></article><div class=back-link><a href=/pull_request/bevy/2025-12/>← Back to Pull Requests</a></div><div class=pr-metadata><span class=pr-date>2025-12-31</span><div class=language-switcher><span class="lang-link active" data-lang=en>English</span> / <a class=lang-link data-lang=zh-cn href=/pull_request/bevy/2025-12/pr-22323-zh-cn-20251231>中文</a></div></div><div class=pr-content><h1 id=title>Title</h1><h2 id=basic-information>Basic Information</h2><ul><li><strong>Title</strong>: <code>bevy_dev_tools::fps_overlay</code> elide default font<li><strong>PR Link</strong>: https://github.com/bevyengine/bevy/pull/22323<li><strong>Author</strong>: ickshonpe<li><strong>Status</strong>: MERGED<li><strong>Labels</strong>: D-Trivial, C-Code-Quality, S-Ready-For-Final-Review, A-Dev-Tools<li><strong>Created</strong>: 2025-12-31T12:09:45Z<li><strong>Merged</strong>: 2025-12-31T22:22:27Z<li><strong>Merged By</strong>: alice-i-cecile</ul><h2 id=description-translation>Description Translation</h2><p>Translate the PR description to the target language, preserving:<ul><li>Technical terms in English<li>All image references and links exactly as they appear<li>Code blocks and formatting</ul><p>Note: If the target language is English, simply include the original description exactly as-is, without any translation notes or placeholders.<h1 id=objective>Objective</h1><p>In <code>fps_overlay</code> ellide the <code>font</code> field, setting <code>font: Handle::&LTFont>::default()</code> explicitly is a bit weird.<h2 id=the-story-of-this-pull-request>The Story of This Pull Request</h2><p>This PR addresses a code quality issue in Bevy’s developer tools module, specifically in the FPS overlay system. The problem centered around an unnecessarily explicit initialization pattern that could be simplified using existing API functionality.<p>When configuring the default FPS overlay, the code was manually constructing a <code>TextFont</code> struct with explicit default values:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span>text_config</span><span style=color:#61676ccc>:</span><span> TextFont {
</span><span>    font</span><span style=color:#61676ccc>: </span><span>Handle</span><span style=color:#ed9366>::</span><span>&LTFont></span><span style=color:#ed9366>::</span><span>default()</span><span style=color:#61676ccc>,
</span><span>    font_size</span><span style=color:#61676ccc>: </span><span style=color:#ff8f40>32.0</span><span style=color:#61676ccc>,
</span><span>    </span><span style=color:#ed9366>..</span><span style=color:#55b4d4;font-style:italic>Default</span><span style=color:#ed9366>::</span><span>default()
</span><span>}
</span></code></pre><p>This pattern had two notable issues. First, it was unnecessarily verbose - the explicit setting of <code>font: Handle::&LTFont>::default()</code> was redundant because this is already the default value for that field. Second, and more importantly, Bevy’s <code>TextFont</code> struct provides a convenience method <code>from_font_size()</code> that handles this exact use case more cleanly. The existing code was essentially reimplementing behavior that was already available through the standard API.<p>The fix was straightforward and focused on code clarity rather than functional changes. By using <code>TextFont::from_font_size(32.)</code>, the code becomes more concise and leverages the existing API as intended. This method internally handles the font handle initialization with default values, eliminating the need for manual struct construction with explicit defaults.<p>Interestingly, this change also required updating the imports. The original code imported <code>Handle</code> and <code>Font</code> from <code>bevy_asset</code> and <code>bevy_text</code> respectively, but with the simplified approach, these imports were no longer needed. This demonstrates how API improvements can cascade into cleaner import statements, reducing the cognitive load when reading the code.<p>The technical approach here follows established Rust patterns for improving code ergonomics. The <code>from_font_size</code> method is an example of a “constructor pattern” that provides a more readable and maintainable way to create struct instances compared to manual struct literals with spread operators. This pattern is particularly valuable when dealing with complex default values or when certain fields should always be initialized together.<p>From an engineering perspective, this change represents a typical code quality improvement seen in mature codebases. As APIs evolve and convenience methods are added, existing code should be updated to use these improvements. This reduces maintenance burden and improves consistency across the codebase.<p>The impact of this change is minimal but meaningful. Functionally, the FPS overlay behaves exactly as before - the font defaults to the same handle, and the font size remains 32.0. However, the code is now cleaner, easier to understand, and better aligned with Bevy’s API conventions. Future developers working on this code will encounter a more idiomatic pattern that clearly communicates intent through the <code>from_font_size</code> method name rather than requiring them to parse explicit struct initialization.<p>This type of change also has subtle benefits for maintainability. If the <code>TextFont</code> struct’s default behavior changes in the future (for example, if the default font handle initialization logic is updated), code using <code>from_font_size()</code> will automatically inherit those improvements, while explicit struct initialization would need to be updated manually.<h2 id=visual-representation>Visual Representation</h2><pre class=language-mermaid data-lang=mermaid style=color:#61676c;background-color:#fafafa><code class=language-mermaid data-lang=mermaid><span>graph TD
</span><span>    A[FpsOverlayConfig] --> B[text_config: TextFont]
</span><span>    B --> C[Original: Manual struct initialization]
</span><span>    B --> D[Updated: TextFont::from_font_size(32.)]
</span><span>    C --> E[font: Handle::&LTFont>::default()]
</span><span>    C --> F[font_size: 32.0]
</span><span>    C --> G[..Default::default()]
</span><span>    D --> H[Internal default font handle]
</span><span>    D --> I[Explicit font_size: 32.0]
</span></code></pre><h2 id=key-files-changed>Key Files Changed</h2><h3 id=crates-bevy-dev-tools-src-fps-overlay-rs><code>crates/bevy_dev_tools/src/fps_overlay.rs</code></h3><p>This file contains the FPS overlay plugin for Bevy’s developer tools. The changes simplify the default configuration initialization by using a more concise API method.<p><strong>Key changes:</strong><ol><li>Removed unnecessary imports (<code>Handle</code> and <code>Font</code>) that were no longer needed after the simplification<li>Updated the <code>Default</code> implementation for <code>FpsOverlayConfig</code> to use <code>TextFont::from_font_size()</code> instead of manual struct initialization</ol><pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before:
</span><span>text_config</span><span style=color:#61676ccc>:</span><span> TextFont {
</span><span>    font</span><span style=color:#61676ccc>: </span><span>Handle</span><span style=color:#ed9366>::</span><span>&LTFont></span><span style=color:#ed9366>::</span><span>default()</span><span style=color:#61676ccc>,
</span><span>    font_size</span><span style=color:#61676ccc>: </span><span style=color:#ff8f40>32.0</span><span style=color:#61676ccc>,
</span><span>    </span><span style=color:#ed9366>..</span><span style=color:#55b4d4;font-style:italic>Default</span><span style=color:#ed9366>::</span><span>default()
</span><span>}
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After:
</span><span>text_config</span><span style=color:#61676ccc>: </span><span>TextFont</span><span style=color:#ed9366>::</span><span>from_font_size(</span><span style=color:#ff8f40>32.</span><span>)
</span></code></pre><p>The change leverages an existing constructor method that handles default font initialization internally, making the code cleaner and more maintainable.<h2 id=further-reading>Further Reading</h2><ol><li><strong>Rust Constructor Patterns</strong>: The Rust Programming Language book section on associated functions and the <code>new</code> convention for constructors<li><strong>Bevy Text API Documentation</strong>: Documentation for the <code>TextFont</code> struct and its associated methods<li><strong>Rust Default Trait</strong>: Understanding how <code>Default::default()</code> works and when to use it versus custom constructors<li><strong>Bevy ECS Plugin Architecture</strong>: How developer tools plugins like the FPS overlay integrate into Bevy’s Entity Component System</ol></div><div data-is-md-page=true data-patch-exists=true data-patch-path=/pull_request/bevy/2025-12/pr_22323.patch id=patch-info style=display:none></div><div class=bottom-spacer></div></div></div>