<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://unknownue.github.io name=base><title>
         #22085 Make Gizmos::rect_2d and primitive_2d draw the joint of the first corner of closed shapes
        
    </title><meta content="#22085 Make Gizmos::rect_2d and primitive_2d draw the joint of the first corner of closed shapes" property=og:title><meta content="A personal blog built with Zola and Apollo theme" property=og:description><meta content="A personal blog built with Zola and Apollo theme" name=description><link href=/icons/favicon.png rel=icon type=image/png><link href=https://unknownue.github.io/fonts.css rel=stylesheet><script src=https://unknownue.github.io/js/codeblock.js></script><script src=https://unknownue.github.io/js/toc.js></script><script src=https://unknownue.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Unknownue's Blog" href=https://unknownue.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://unknownue.github.io/theme/light.css rel=stylesheet><link href=https://unknownue.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://unknownue.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://unknownue.github.io/main.css media=screen rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js></script><script>// Initialize mermaid once DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            mermaid.initialize({
                startOnLoad: false,
                theme: document.body && document.body.classList.contains('dark') ? 'dark' : 'default',
                securityLevel: 'loose',
                flowchart: {
                    useMaxWidth: true,
                    htmlLabels: true
                },
                sequence: {
                    diagramMarginX: 50,
                    diagramMarginY: 10,
                    actorMargin: 50,
                    width: 150,
                    height: 65
                }
            });
        });</script><script src=https://unknownue.github.io/js/main.js></script><script defer src=https://unknownue.github.io/js/label-colors.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/rust.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/typescript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/go.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/cpp.min.js></script><script>// Ensure highlight.js is properly configured
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof hljs !== 'undefined') {
                hljs.configure({
                    languages: ['rust', 'javascript', 'python', 'cpp', 'go', 'typescript'],
                    ignoreUnescapedHTML: true
                });
                console.log('Highlight.js configured in header');
            }
        });</script><link href=https://cdn.jsdelivr.net/npm/diff2html/bundles/css/diff2html.min.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/diff2html/bundles/js/diff2html-ui.min.js></script><script src=https://unknownue.github.io/js/syntax-highlight.js></script><script src=https://unknownue.github.io/js/diff-sidebar.js></script><script src="https://unknownue.github.io/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><div class=content><header><div class=main><a href=https://unknownue.github.io>Unknownue's Blog</a><div class=socials><a class=social href=https://github.com/unknownue rel=me> <img alt=github src=https://unknownue.github.io/icons/social/github.svg> </a><a class=social href=https://github.com/unknownue/unknownue.github.io rel=me> <img alt=github-io src=https://unknownue.github.io/icons/social/rss.svg> </a></div></div><nav><a href=https://unknownue.github.io/posts style=margin-left:.25em>/posts</a><a href=https://unknownue.github.io/projects style=margin-left:.25em>/projects</a><a href=https://unknownue.github.io/about style=margin-left:.25em>/about</a><a href=https://unknownue.github.io/tags style=margin-left:.25em>/tags</a><button title="$SHORTCUT to open search" class=search-button id=search-button><img alt=Search class=search-icon src=https://unknownue.github.io/icons/search.svg></button><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><div id=modal-content><h1 class=page-header id=modalTitle>Search</h1><div id=searchBar><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search... role=combobox spellcheck=false><button title="Clear search" class=clear-button id=clear-search><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></button></div><div id=results-container><div id=results-info><span id=zero_results style=display:none>No results</span><span id=one_result style=display:none>1 result</span><span id=many_results style=display:none>$NUMBER results</span></div><div id=results role=listbox></div></div></div></div><a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://unknownue.github.io/icons/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://unknownue.github.io/icons/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><div class=pull-request-page><article class=md-content-page style=display:none></article><div class=back-link><a href=/pull_request/bevy/2025-12/>← Back to Pull Requests</a></div><div class=pr-metadata><span class=pr-date>2025-12-11</span><div class=language-switcher><span class="lang-link active" data-lang=en>English</span> / <a class=lang-link data-lang=zh-cn href=/pull_request/bevy/2025-12/pr-22085-zh-cn-20251211>中文</a></div></div><div class=pr-content><h1 id=make-gizmos-rect-2d-and-primitive-2d-draw-the-joint-of-the-first-corner-of-closed-shapes>Make Gizmos::rect_2d and primitive_2d draw the joint of the first corner of closed shapes</h1><h2 id=basic-information>Basic Information</h2><ul><li><strong>Title</strong>: Make Gizmos::rect_2d and primitive_2d draw the joint of the first corner of closed shapes<li><strong>PR Link</strong>: https://github.com/bevyengine/bevy/pull/22085<li><strong>Author</strong>: uckelman<li><strong>Status</strong>: MERGED<li><strong>Labels</strong>: C-Bug, S-Ready-For-Final-Review, A-Gizmos, D-Straightforward<li><strong>Created</strong>: 2025-12-10T20:58:34Z<li><strong>Merged</strong>: 2025-12-11T01:46:51Z<li><strong>Merged By</strong>: alice-i-cecile</ul><h2 id=description-translation>Description Translation</h2><p>Make <code>Gizmos::rect_2d</code> and <code>primitive_2d</code> draw the joint of the first corner of closed shapes<h1 id=objective>Objective</h1><ul><li><code>Gizmos::rect_2d</code> and <code>primitive_2d</code> do not draw the line joint between the first and last segments. This looks odd when the line joint is not <code>GizmoLineJoint::None</code>. (This affects <code>Triangle2d</code>, <code>Rhombus</code>, <code>Rectangle</code>, <code>Polygon</code>, and <code>RegularPolygon</code>.)<li>Fixes #22081.</ul><h2 id=solution>Solution</h2><ul><li><code>Gizmos::rect_2d</code> and <code>primitive_2d</code> draw using <code>Gizmos::linestrip_2d</code>, which doesn’t draw a closed shape.<li>In order to make <code>linestrip_2d</code> to draw a joint at a corner, that corner has to be in the points list with a predecessor and a successor.<li>There is no predecessor for the first element in the list, and no successor when it is repeated as the last.<li>Appending the second point to the list is enough to put the first point between two other points, which causes the joint to be rendered.<li>I added a <code>Gizmos::lineloop_2d</code> function which handles the final joint for all closed shapes.<li>Draw closed shapes with the <code>lineloop_2d</code> function, rather than manually adding closing vertices in each case.</ul><h2 id=testing>Testing</h2><ul><li>I tested my change against this demo:</ul><pre style=color:#61676c;background-color:#fafafa><code><span>use bevy::prelude::*;
</span><span>
</span><span>fn main() {
</span><span>    App::new()
</span><span>        .add_plugins(DefaultPlugins)
</span><span>        .add_systems(Startup, setup)
</span><span>        .add_systems(Update, draw_shapes)
</span><span>        .run();
</span><span>}
</span><span>
</span><span>fn setup(
</span><span>    mut config_store: ResMut&LTGizmoConfigStore>,
</span><span>    mut commands: Commands
</span><span>)
</span><span>{
</span><span>    let (config, _) = config_store.config_mut::&LTDefaultGizmoConfigGroup>();
</span><span>    config.line.width = 10.0;
</span><span>    config.line.joints = GizmoLineJoint::Miter;
</span><span>
</span><span>    commands.spawn(Camera2d);
</span><span>}
</span><span>
</span><span>fn draw_shapes(mut gizmos: Gizmos) {
</span><span>    gizmos.rect_2d(
</span><span>        Vec2::new(-200.0, 0.0),
</span><span>        Vec2::new(50.0, 50.0),
</span><span>        Color::srgb_u8(0xFF, 0, 0)
</span><span>    );
</span><span>
</span><span>    gizmos.primitive_2d(
</span><span>        &Rhombus { half_diagonals: Vec2::new(20.0, 35.0) },
</span><span>        Vec2::new(-100.0, 0.0),
</span><span>        Color::srgb_u8(0xFF, 0, 0)
</span><span>    );
</span><span>
</span><span>    gizmos.primitive_2d(
</span><span>        &Triangle2d { vertices: [Vec2::ZERO, Vec2::new(50.0, 0.), Vec2::new(0.0, 60.0) ] },
</span><span>        Vec2::new(-20.0, -30.0),
</span><span>        Color::srgb_u8(0xFF, 0, 0)
</span><span>    );
</span><span>
</span><span>    gizmos.primitive_2d(
</span><span>        &Rectangle { half_size: Vec2::new(25.0, 25.0) },
</span><span>        Vec2::new(100.0, 0.0),
</span><span>        Color::srgb_u8(0xFF, 0, 0)
</span><span>    );
</span><span>
</span><span>     gizmos.primitive_2d(
</span><span>        &RegularPolygon { sides: 5, circumcircle: Circle::new(40.0) },
</span><span>        Vec2::new(200.0, 0.0),
</span><span>        Color::srgb_u8(0xFF, 0, 0)
</span><span>    );
</span><span>
</span><span>    gizmos.primitive_2d(
</span><span>        &Polygon { vertices: vec![Vec2::ZERO, Vec2::new(90.0, 0.), Vec2::new(75.0, 60.0), Vec2::new(15.0, 60.0) ] },
</span><span>        Vec2::new(275.0, -30.0),
</span><span>        Color::srgb_u8(0xFF, 0, 0)
</span><span>    );
</span><span>}
</span></code></pre><hr><h2 id=showcase>Showcase</h2><p>Before:</p><img alt=Image height=191 src=https://github.com/user-attachments/assets/b57a6fdb-669b-4aa7-b294-412c3871e8ec width=751><p>After:</p><img alt=Image height=247 src=https://github.com/user-attachments/assets/2dc7f5ba-f446-41e6-8d07-b3b37a8f59ef width=738><h2 id=the-story-of-this-pull-request>The Story of This Pull Request</h2><p>This PR addresses a visual inconsistency in Bevy’s 2D gizmo drawing system. When drawing closed shapes like rectangles, triangles, and polygons with non-default line joints, the joint at the first corner wasn’t being rendered, resulting in a visible gap in the shape’s outline.<p>The problem originated from how closed shapes were being drawn. The <code>rect_2d</code> and <code>primitive_2d</code> methods were using <code>linestrip_2d</code> to draw shape outlines. A line strip draws segments between consecutive points but doesn’t automatically connect the last point back to the first. To close the shape, implementations were manually adding a duplicate of the first point at the end of the point list.<p>However, this approach had a subtle issue: line joints are only drawn when a point has both a predecessor and a successor in the point list. When the first point only appears as the last element (as the closing point), it has a predecessor (the actual last point) but no successor. Similarly, when it appears as the first element, it has a successor but no predecessor. This meant the joint at the first corner was never drawn with proper miter or bevel joints.<p>The solution introduces a new <code>lineloop_2d</code> method that handles closed shapes correctly. Instead of just duplicating the first point, this method creates a point sequence that places the first point between two other points in the list. By including the second point again at the end of the sequence, the first point gains both a predecessor (the last unique point) and a successor (the duplicated second point), triggering the joint rendering.<p>The implementation demonstrates good API design by creating a dedicated method for closed shapes rather than patching each shape individually. This centralizes the logic and ensures consistency across all closed shapes. The method efficiently handles the point sequence using iterator chains without requiring intermediate collections.<p>All affected shape drawing methods (rectangle, rhombus, triangle, rectangle primitive, polygon, and regular polygon) were updated to use <code>lineloop_2d</code> instead of <code>linestrip_2d</code>. The polygon implementation also got a cleanup - it previously had special logic to handle potentially duplicated closing points, which became unnecessary with the new approach.<p>The fix is minimal and focused: it addresses the specific rendering issue without changing the broader gizmo system architecture. The new <code>lineloop_2d</code> method follows the existing API patterns and integrates cleanly with the rest of the codebase.<h2 id=visual-representation>Visual Representation</h2><pre class=language-mermaid data-lang=mermaid style=color:#61676c;background-color:#fafafa><code class=language-mermaid data-lang=mermaid><span>graph TD
</span><span>    A[Gizmos::rect_2d] --> B[Gizmos::primitive_2d]
</span><span>    B --> C[Triangle2d]
</span><span>    B --> D[Rhombus]
</span><span>    B --> E[Rectangle]
</span><span>    B --> F[Polygon]
</span><span>    B --> G[RegularPolygon]
</span><span>    
</span><span>    H[Gizmos::linestrip_2d] --> I{Closed shapes}
</span><span>    I -->|Problem: Missing joint| J[Visual gap at first corner]
</span><span>    
</span><span>    K[Gizmos::lineloop_2d] -->|Solution: New method| L[Proper joint rendering]
</span><span>    
</span><span>    A --> K
</span><span>    C --> K
</span><span>    D --> K
</span><span>    E --> K
</span><span>    F --> K
</span><span>    G --> K
</span></code></pre><h2 id=key-files-changed>Key Files Changed</h2><ol><li><p><strong><code>crates/bevy_gizmos/src/gizmos.rs</code></strong> (+41/-1)</p> <ul><li>Added new <code>lineloop_2d</code> method for drawing closed shapes with proper joints<li>Updated <code>rect_2d</code> to use <code>lineloop_2d</code> instead of <code>linestrip_2d</code></ul> <p>Key changes:</p> <pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// File: crates/bevy_gizmos/src/gizmos.rs
</span><span style=color:#abb0b6;font-style:italic>// Before (in rect_2d method):
</span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span style=color:#f07171>linestrip_2d</span><span>([tl</span><span style=color:#61676ccc>,</span><span> tr</span><span style=color:#61676ccc>,</span><span> br</span><span style=color:#61676ccc>,</span><span> bl</span><span style=color:#61676ccc>,</span><span> tl]</span><span style=color:#61676ccc>,</span><span> color)</span><span style=color:#61676ccc>;
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After (in rect_2d method):
</span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span style=color:#f07171>lineloop_2d</span><span>([tl</span><span style=color:#61676ccc>,</span><span> tr</span><span style=color:#61676ccc>,</span><span> br</span><span style=color:#61676ccc>,</span><span> bl]</span><span style=color:#61676ccc>,</span><span> color)</span><span style=color:#61676ccc>;
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// New method added:
</span><span style=color:#fa6e32>pub fn </span><span style=color:#f29718>lineloop_2d</span><span>(
</span><span>    </span><span style=color:#ed9366>&</span><span style=color:#fa6e32>mut </span><span style=color:#ff8f40>self</span><span>,
</span><span>    </span><span style=color:#ff8f40>positions</span><span style=color:#61676ccc>:</span><span> impl </span><span style=color:#55b4d4;font-style:italic>IntoIterator</span><span>&LTItem = Vec2>,
</span><span>    </span><span style=color:#ff8f40>color</span><span style=color:#61676ccc>:</span><span> impl </span><span style=color:#55b4d4;font-style:italic>Into</span><span>&LTColor>,
</span><span>) {
</span><span>    </span><span style=color:#fa6e32>if </span><span style=color:#ed9366>!</span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>enabled {
</span><span>        </span><span style=color:#fa6e32>return</span><span style=color:#61676ccc>;
</span><span>    }
</span><span>
</span><span>    </span><span style=color:#abb0b6;font-style:italic>// Loop back to the start; second is needed to ensure that
</span><span>    </span><span style=color:#abb0b6;font-style:italic>// the joint on the first corner is drawn.
</span><span>    </span><span style=color:#fa6e32>let mut</span><span> positions </span><span style=color:#ed9366>=</span><span> positions</span><span style=color:#ed9366>.</span><span style=color:#f07171>into_iter</span><span>()</span><span style=color:#61676ccc>;
</span><span>    </span><span style=color:#fa6e32>let</span><span> first </span><span style=color:#ed9366>=</span><span> positions</span><span style=color:#ed9366>.</span><span style=color:#f07171>next</span><span>()</span><span style=color:#61676ccc>;
</span><span>    </span><span style=color:#fa6e32>let</span><span> second </span><span style=color:#ed9366>=</span><span> positions</span><span style=color:#ed9366>.</span><span style=color:#f07171>next</span><span>()</span><span style=color:#61676ccc>;
</span><span>
</span><span>    </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span style=color:#f07171>linestrip</span><span>(
</span><span>        first
</span><span>            </span><span style=color:#ed9366>.</span><span style=color:#f07171>into_iter</span><span>()
</span><span>            </span><span style=color:#ed9366>.</span><span style=color:#f07171>chain</span><span>(second)
</span><span>            </span><span style=color:#ed9366>.</span><span style=color:#f07171>chain</span><span>(positions)
</span><span>            </span><span style=color:#ed9366>.</span><span style=color:#f07171>chain</span><span>(first)
</span><span>            </span><span style=color:#ed9366>.</span><span style=color:#f07171>chain</span><span>(second)
</span><span>            </span><span style=color:#ed9366>.</span><span style=color:#f07171>map</span><span>(|</span><span style=color:#ff8f40>vec2</span><span>| vec2</span><span style=color:#ed9366>.</span><span style=color:#f07171>extend</span><span>(</span><span style=color:#ff8f40>0.</span><span>))</span><span style=color:#61676ccc>,
</span><span>        color</span><span style=color:#61676ccc>,
</span><span>    )</span><span style=color:#61676ccc>;
</span><span>}
</span></code></pre><li><p><strong><code>crates/bevy_gizmos/src/primitives/dim2.rs</code></strong> (+14/-24)</p> <ul><li>Updated all 2D primitive drawing methods to use <code>lineloop_2d</code><li>Simplified polygon handling by removing special closing-point logic</ul> <p>Key changes (examples):</p> <pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// File: crates/bevy_gizmos/src/primitives/dim2.rs
</span><span style=color:#abb0b6;font-style:italic>// Before (in Triangle2d implementation):
</span><span style=color:#fa6e32>let</span><span> positions </span><span style=color:#ed9366>= </span><span>[a</span><span style=color:#61676ccc>,</span><span> b</span><span style=color:#61676ccc>,</span><span> c</span><span style=color:#61676ccc>,</span><span> a]</span><span style=color:#ed9366>.</span><span style=color:#f07171>map</span><span>(|</span><span style=color:#ff8f40>vec2</span><span>| isometry </span><span style=color:#ed9366>*</span><span> vec2)</span><span style=color:#61676ccc>;
</span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span style=color:#f07171>linestrip_2d</span><span>(positions</span><span style=color:#61676ccc>,</span><span> color)</span><span style=color:#61676ccc>;
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After:
</span><span style=color:#fa6e32>let</span><span> positions </span><span style=color:#ed9366>= </span><span>[a</span><span style=color:#61676ccc>,</span><span> b</span><span style=color:#61676ccc>,</span><span> c]</span><span style=color:#ed9366>.</span><span style=color:#f07171>map</span><span>(|</span><span style=color:#ff8f40>vec2</span><span>| isometry </span><span style=color:#ed9366>*</span><span> vec2)</span><span style=color:#61676ccc>;
</span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span style=color:#f07171>lineloop_2d</span><span>(positions</span><span style=color:#61676ccc>,</span><span> color)</span><span style=color:#61676ccc>;
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// Before (in Polygon implementation - complex logic):
</span><span style=color:#fa6e32>let</span><span> closing_point </span><span style=color:#ed9366>= </span><span>{
</span><span>    </span><span style=color:#fa6e32>let</span><span> first </span><span style=color:#ed9366>=</span><span> primitive</span><span style=color:#ed9366>.</span><span>vertices</span><span style=color:#ed9366>.</span><span style=color:#f07171>first</span><span>()</span><span style=color:#61676ccc>;
</span><span>    (primitive</span><span style=color:#ed9366>.</span><span>vertices</span><span style=color:#ed9366>.</span><span style=color:#f07171>last</span><span>() </span><span style=color:#ed9366>!=</span><span> first)
</span><span>        </span><span style=color:#ed9366>.</span><span style=color:#f07171>then_some</span><span>(first)
</span><span>        </span><span style=color:#ed9366>.</span><span style=color:#f07171>flatten</span><span>()
</span><span>        </span><span style=color:#ed9366>.</span><span style=color:#f07171>cloned</span><span>()
</span><span>}</span><span style=color:#61676ccc>;
</span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span style=color:#f07171>linestrip_2d</span><span>(
</span><span>    primitive
</span><span>        </span><span style=color:#ed9366>.</span><span>vertices
</span><span>        </span><span style=color:#ed9366>.</span><span style=color:#f07171>iter</span><span>()
</span><span>        </span><span style=color:#ed9366>.</span><span style=color:#f07171>copied</span><span>()
</span><span>        </span><span style=color:#ed9366>.</span><span style=color:#f07171>chain</span><span>(closing_point)
</span><span>        </span><span style=color:#ed9366>.</span><span style=color:#f07171>map</span><span>(|</span><span style=color:#ff8f40>vec2</span><span>| isometry </span><span style=color:#ed9366>*</span><span> vec2)</span><span style=color:#61676ccc>,
</span><span>    color</span><span style=color:#61676ccc>,
</span><span>)</span><span style=color:#61676ccc>;
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After (simplified):
</span><span style=color:#fa6e32>let</span><span> vertices </span><span style=color:#ed9366>= </span><span style=color:#fa6e32>if</span><span> primitive</span><span style=color:#ed9366>.</span><span>vertices</span><span style=color:#ed9366>.</span><span style=color:#f07171>first</span><span>() </span><span style=color:#ed9366>==</span><span> primitive</span><span style=color:#ed9366>.</span><span>vertices</span><span style=color:#ed9366>.</span><span style=color:#f07171>last</span><span>() {
</span><span>    </span><span style=color:#ed9366>&</span><span>primitive</span><span style=color:#ed9366>.</span><span>vertices[</span><span style=color:#ed9366>..</span><span>primitive</span><span style=color:#ed9366>.</span><span>vertices</span><span style=color:#ed9366>.</span><span style=color:#f07171>len</span><span>() </span><span style=color:#ed9366>- </span><span style=color:#ff8f40>1</span><span>]
</span><span>} </span><span style=color:#fa6e32>else </span><span>{
</span><span>    </span><span style=color:#ed9366>&</span><span>primitive</span><span style=color:#ed9366>.</span><span>vertices[</span><span style=color:#ed9366>..</span><span>]
</span><span>}</span><span style=color:#61676ccc>;
</span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span style=color:#f07171>lineloop_2d</span><span>(vertices</span><span style=color:#ed9366>.</span><span style=color:#f07171>iter</span><span>()</span><span style=color:#ed9366>.</span><span style=color:#f07171>map</span><span>(|</span><span style=color:#ed9366>&</span><span style=color:#ff8f40>vec2</span><span>| isometry </span><span style=color:#ed9366>*</span><span> vec2)</span><span style=color:#61676ccc>,</span><span> color)</span><span style=color:#61676ccc>;
</span></code></pre></ol><h2 id=further-reading>Further Reading</h2><ol><li><strong>Bevy Gizmos Documentation</strong>: The official Bevy documentation covers the gizmo system and its various drawing methods<li><strong>Line Joint Algorithms</strong>: Research on miter, bevel, and round joint algorithms in computer graphics<li><strong>Iterator Chains in Rust</strong>: Understanding how Rust’s iterator methods like <code>chain()</code> work for efficient sequence manipulation<li><strong>2D Geometry Transformations</strong>: Concepts like isometries and coordinate transformations used in the primitive drawing methods<li><strong>Graphics Pipeline Fundamentals</strong>: How line rendering works in modern graphics pipelines, including segment joining and caps</ol></div><div data-is-md-page=true data-patch-exists=true data-patch-path=/pull_request/bevy/2025-12/pr_22085.patch id=patch-info style=display:none></div><div class=bottom-spacer></div></div></div>