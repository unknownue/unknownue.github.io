<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://unknownue.github.io name=base><title>
         #22070 `spec_v2`: migrate TAA
        
    </title><meta content="#22070 `spec_v2`: migrate TAA" property=og:title><meta content="A personal blog built with Zola and Apollo theme" property=og:description><meta content="A personal blog built with Zola and Apollo theme" name=description><link href=/icons/favicon.png rel=icon type=image/png><link href=https://unknownue.github.io/fonts.css rel=stylesheet><script src=https://unknownue.github.io/js/codeblock.js></script><script src=https://unknownue.github.io/js/toc.js></script><script src=https://unknownue.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Unknownue's Blog" href=https://unknownue.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://unknownue.github.io/theme/light.css rel=stylesheet><link href=https://unknownue.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://unknownue.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://unknownue.github.io/main.css media=screen rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js></script><script>// Initialize mermaid once DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            mermaid.initialize({
                startOnLoad: false,
                theme: document.body && document.body.classList.contains('dark') ? 'dark' : 'default',
                securityLevel: 'loose',
                flowchart: {
                    useMaxWidth: true,
                    htmlLabels: true
                },
                sequence: {
                    diagramMarginX: 50,
                    diagramMarginY: 10,
                    actorMargin: 50,
                    width: 150,
                    height: 65
                }
            });
        });</script><script src=https://unknownue.github.io/js/main.js></script><script defer src=https://unknownue.github.io/js/label-colors.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/rust.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/typescript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/go.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/cpp.min.js></script><script>// Ensure highlight.js is properly configured
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof hljs !== 'undefined') {
                hljs.configure({
                    languages: ['rust', 'javascript', 'python', 'cpp', 'go', 'typescript'],
                    ignoreUnescapedHTML: true
                });
                console.log('Highlight.js configured in header');
            }
        });</script><link href=https://cdn.jsdelivr.net/npm/diff2html/bundles/css/diff2html.min.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/diff2html/bundles/js/diff2html-ui.min.js></script><script src=https://unknownue.github.io/js/syntax-highlight.js></script><script src=https://unknownue.github.io/js/diff-sidebar.js></script><script src="https://unknownue.github.io/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><div class=content><header><div class=main><a href=https://unknownue.github.io>Unknownue's Blog</a><div class=socials><a class=social href=https://github.com/unknownue rel=me> <img alt=github src=https://unknownue.github.io/icons/social/github.svg> </a><a class=social href=https://github.com/unknownue/unknownue.github.io rel=me> <img alt=github-io src=https://unknownue.github.io/icons/social/rss.svg> </a></div></div><nav><a href=https://unknownue.github.io/posts style=margin-left:.25em>/posts</a><a href=https://unknownue.github.io/projects style=margin-left:.25em>/projects</a><a href=https://unknownue.github.io/about style=margin-left:.25em>/about</a><a href=https://unknownue.github.io/tags style=margin-left:.25em>/tags</a><button title="$SHORTCUT to open search" class=search-button id=search-button><img alt=Search class=search-icon src=https://unknownue.github.io/icons/search.svg></button><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><div id=modal-content><h1 class=page-header id=modalTitle>Search</h1><div id=searchBar><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search... role=combobox spellcheck=false><button title="Clear search" class=clear-button id=clear-search><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></button></div><div id=results-container><div id=results-info><span id=zero_results style=display:none>No results</span><span id=one_result style=display:none>1 result</span><span id=many_results style=display:none>$NUMBER results</span></div><div id=results role=listbox></div></div></div></div><a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://unknownue.github.io/icons/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://unknownue.github.io/icons/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><div class=pull-request-page><article class=md-content-page style=display:none></article><div class=back-link><a href=/pull_request/bevy/2025-12/>← Back to Pull Requests</a></div><div class=pr-metadata><span class=pr-date>2025-12-15</span><div class=language-switcher><span class="lang-link active" data-lang=en>English</span> / <a class=lang-link data-lang=zh-cn href=/pull_request/bevy/2025-12/pr-22070-zh-cn-20251215>中文</a></div></div><div class=pr-content><h1 id=title>Title</h1><h2 id=basic-information>Basic Information</h2><ul><li><strong>Title</strong>: <code>spec_v2</code>: migrate TAA<li><strong>PR Link</strong>: https://github.com/bevyengine/bevy/pull/22070<li><strong>Author</strong>: ecoskey<li><strong>Status</strong>: MERGED<li><strong>Labels</strong>: A-Rendering, C-Code-Quality, S-Ready-For-Final-Review, D-Modest<li><strong>Created</strong>: 2025-12-09T04:36:08Z<li><strong>Merged</strong>: 2025-12-15T00:53:55Z<li><strong>Merged By</strong>: alice-i-cecile</ul><h2 id=description-translation>Description Translation</h2><h1 id=objective>Objective</h1><ul><li>Migrate TAA to <code>spec_v2</code></ul><h2 id=testing>Testing</h2><ul><li>Ran <code>anti_aliasing</code> example, seems fine</ul><h2 id=the-story-of-this-pull-request>The Story of This Pull Request</h2><p>This PR migrates the Temporal Anti-Aliasing (TAA) render pipeline from Bevy’s old specialization system to the new <code>spec_v2</code> system. The work focuses on refactoring the pipeline specialization logic without changing TAA’s core functionality, maintaining the same visual output while adopting a more modern and maintainable architecture.<p>The old specialization system used the <code>SpecializedRenderPipeline</code> trait with <code>SpecializedRenderPipelines</code> resource. This system had limitations: each pipeline specialization required separate storage, and the specialization logic was tightly coupled with the pipeline state management. The <code>spec_v2</code> system introduces a more flexible approach using the <code>Variants</code> type and <code>Specializer</code> trait, separating the specialization logic from pipeline storage.<p>The implementation began by updating imports and removing the old system’s infrastructure. The <code>SpecializedRenderPipelines&LTTaaPipeline></code> resource initialization was removed, as was the dependency on the <code>SpecializedRenderPipelines</code> type. Instead, the code now uses <code>Variants&LTRenderPipeline, TaaPipelineSpecializer></code> to manage pipeline specializations.<p>The <code>TaaPipeline</code> struct was restructured to store a <code>Variants</code> instance instead of separate shader handles and specialization logic:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#fa6e32>struct </span><span style=color:#399ee6>TaaPipeline </span><span>{
</span><span>    taa_bind_group_layout</span><span style=color:#61676ccc>:</span><span> BindGroupLayoutDescriptor,
</span><span>    nearest_sampler</span><span style=color:#61676ccc>:</span><span> Sampler,
</span><span>    linear_sampler</span><span style=color:#61676ccc>:</span><span> Sampler,
</span><span>    variants</span><span style=color:#61676ccc>: </span><span>Variants&LTRenderPipeline, TaaPipelineSpecializer>,
</span><span>}
</span></code></pre><p>A new <code>TaaPipelineSpecializer</code> struct was created to implement the <code>Specializer&LTRenderPipeline></code> trait. This separation of concerns makes the specialization logic more testable and reusable. The <code>SpecializerKey</code> derive macro was added to the <code>TaaPipelineKey</code> struct to enable proper key handling in the new system.<p>The specialization logic itself remained functionally identical but was restructured to work with the new API. Instead of building a complete <code>RenderPipelineDescriptor</code> from scratch, the specializer now modifies an existing descriptor:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#fa6e32>impl </span><span>Specializer&LTRenderPipeline> </span><span style=color:#fa6e32>for </span><span style=color:#399ee6>TaaPipelineSpecializer </span><span>{
</span><span>    </span><span style=color:#fa6e32>type </span><span style=color:#399ee6>Key </span><span style=color:#ed9366>=</span><span> TaaPipelineKey</span><span style=color:#61676ccc>;
</span><span>
</span><span>    </span><span style=color:#fa6e32>fn </span><span style=color:#f29718>specialize</span><span>(
</span><span>        </span><span style=color:#ed9366>&</span><span style=color:#ff8f40>self</span><span>,
</span><span>        </span><span style=color:#ff8f40>key</span><span style=color:#61676ccc>: </span><span style=color:#fa6e32>Self</span><span style=color:#ed9366>::</span><span>Key,
</span><span>        </span><span style=color:#ff8f40>descriptor</span><span style=color:#61676ccc>: </span><span style=color:#ed9366>&</span><span style=color:#fa6e32>mut</span><span> RenderPipelineDescriptor,
</span><span>    ) </span><span style=color:#61676ccc>-> </span><span style=color:#55b4d4;font-style:italic>Result</span><span>&LTCanonical<</span><span style=color:#fa6e32>Self</span><span style=color:#ed9366>::</span><span>Key>, BevyError> {
</span><span>        </span><span style=color:#fa6e32>let</span><span> fragment </span><span style=color:#ed9366>=</span><span> descriptor</span><span style=color:#ed9366>.</span><span style=color:#f07171>fragment_mut</span><span>()</span><span style=color:#ed9366>?</span><span style=color:#61676ccc>;
</span><span>        </span><span style=color:#fa6e32>let</span><span> format </span><span style=color:#ed9366>= </span><span style=color:#fa6e32>if</span><span> key</span><span style=color:#ed9366>.</span><span>hdr {
</span><span>            fragment</span><span style=color:#ed9366>.</span><span>shader_defs</span><span style=color:#ed9366>.</span><span style=color:#f07171>push</span><span>(</span><span style=color:#86b300>"TONEMAP"</span><span style=color:#ed9366>.</span><span style=color:#f07171>into</span><span>())</span><span style=color:#61676ccc>;
</span><span>            ViewTarget</span><span style=color:#ed9366>::</span><span style=color:#ff8f40>TEXTURE_FORMAT_HDR
</span><span>        } </span><span style=color:#fa6e32>else </span><span>{
</span><span>            TextureFormat</span><span style=color:#ed9366>::</span><span>bevy_default()
</span><span>        }</span><span style=color:#61676ccc>;
</span><span>
</span><span>        </span><span style=color:#fa6e32>if</span><span> key</span><span style=color:#ed9366>.</span><span>reset {
</span><span>            fragment</span><span style=color:#ed9366>.</span><span>shader_defs</span><span style=color:#ed9366>.</span><span style=color:#f07171>push</span><span>(</span><span style=color:#86b300>"RESET"</span><span style=color:#ed9366>.</span><span style=color:#f07171>into</span><span>())</span><span style=color:#61676ccc>;
</span><span>        }
</span><span>
</span><span>        </span><span style=color:#fa6e32>let</span><span> color_target_state </span><span style=color:#ed9366>=</span><span> ColorTargetState {
</span><span>            format</span><span style=color:#61676ccc>,
</span><span>            blend</span><span style=color:#61676ccc>: </span><span style=color:#55b4d4;font-style:italic>None</span><span style=color:#61676ccc>,
</span><span>            write_mask</span><span style=color:#61676ccc>: </span><span>ColorWrites</span><span style=color:#ed9366>::</span><span style=color:#ff8f40>ALL</span><span style=color:#61676ccc>,
</span><span>        }</span><span style=color:#61676ccc>;
</span><span>
</span><span>        fragment</span><span style=color:#ed9366>.</span><span style=color:#f07171>set_target</span><span>(</span><span style=color:#ff8f40>0</span><span style=color:#61676ccc>,</span><span> color_target_state</span><span style=color:#ed9366>.</span><span style=color:#f07171>clone</span><span>())</span><span style=color:#61676ccc>;
</span><span>        fragment</span><span style=color:#ed9366>.</span><span style=color:#f07171>set_target</span><span>(</span><span style=color:#ff8f40>1</span><span style=color:#61676ccc>,</span><span> color_target_state)</span><span style=color:#61676ccc>;
</span><span>
</span><span>        </span><span style=color:#55b4d4;font-style:italic>Ok</span><span>(key)
</span><span>    }
</span><span>}
</span></code></pre><p>This change required updating the <code>prepare_taa_pipelines</code> system to use the new <code>Variants</code> API and handle the <code>Result</code> return type properly. Error handling was added where previously panics might have occurred implicitly:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#fa6e32>fn </span><span style=color:#f29718>prepare_taa_pipelines</span><span>(
</span><span>    </span><span style=color:#fa6e32>mut </span><span style=color:#ff8f40>commands</span><span style=color:#61676ccc>:</span><span> Commands,
</span><span>    </span><span style=color:#ff8f40>pipeline_cache</span><span style=color:#61676ccc>: </span><span>Res&LTPipelineCache>,
</span><span>    </span><span style=color:#fa6e32>mut </span><span style=color:#ff8f40>pipeline</span><span style=color:#61676ccc>: </span><span>ResMut&LTTaaPipeline>,
</span><span>    </span><span style=color:#ff8f40>views</span><span style=color:#61676ccc>: </span><span>Query<(Entity, </span><span style=color:#ed9366>&</span><span>ExtractedView, </span><span style=color:#ed9366>&</span><span>TemporalAntiAliasing)>,
</span><span>) </span><span style=color:#61676ccc>-> </span><span style=color:#55b4d4;font-style:italic>Result</span><span><(), BevyError> {
</span><span>    </span><span style=color:#fa6e32>for </span><span>(entity</span><span style=color:#61676ccc>,</span><span> view</span><span style=color:#61676ccc>,</span><span> taa_settings) </span><span style=color:#ed9366>in &</span><span>views {
</span><span>        </span><span style=color:#fa6e32>let mut</span><span> pipeline_key </span><span style=color:#ed9366>=</span><span> TaaPipelineKey {
</span><span>            hdr</span><span style=color:#61676ccc>:</span><span> view</span><span style=color:#ed9366>.</span><span>hdr</span><span style=color:#61676ccc>,
</span><span>            reset</span><span style=color:#61676ccc>:</span><span> taa_settings</span><span style=color:#ed9366>.</span><span>reset</span><span style=color:#61676ccc>,
</span><span>        }</span><span style=color:#61676ccc>;
</span><span>        </span><span style=color:#fa6e32>let</span><span> pipeline_id </span><span style=color:#ed9366>=</span><span> pipeline
</span><span>            </span><span style=color:#ed9366>.</span><span>variants
</span><span>            </span><span style=color:#ed9366>.</span><span style=color:#f07171>specialize</span><span>(</span><span style=color:#ed9366>&</span><span>pipeline_cache</span><span style=color:#61676ccc>,</span><span> pipeline_key</span><span style=color:#ed9366>.</span><span style=color:#f07171>clone</span><span>())</span><span style=color:#ed9366>?</span><span style=color:#61676ccc>;
</span><span>
</span><span>        </span><span style=color:#abb0b6;font-style:italic>// Prepare non-reset pipeline anyways - it will be necessary next frame
</span><span>        </span><span style=color:#fa6e32>if</span><span> pipeline_key</span><span style=color:#ed9366>.</span><span>reset {
</span><span>            pipeline_key</span><span style=color:#ed9366>.</span><span>reset </span><span style=color:#ed9366>= </span><span style=color:#ff8f40>false</span><span style=color:#61676ccc>;
</span><span>            pipeline
</span><span>                </span><span style=color:#ed9366>.</span><span>variants
</span><span>                </span><span style=color:#ed9366>.</span><span style=color:#f07171>specialize</span><span>(</span><span style=color:#ed9366>&</span><span>pipeline_cache</span><span style=color:#61676ccc>,</span><span> pipeline_key)</span><span style=color:#ed9366>?</span><span style=color:#61676ccc>;
</span><span>        }
</span><span>
</span><span>        commands
</span><span>            </span><span style=color:#ed9366>.</span><span style=color:#f07171>entity</span><span>(entity)
</span><span>            </span><span style=color:#ed9366>.</span><span style=color:#f07171>insert</span><span>(TemporalAntiAliasPipelineId(pipeline_id))</span><span style=color:#61676ccc>;
</span><span>    }
</span><span>
</span><span>    </span><span style=color:#55b4d4;font-style:italic>Ok</span><span>(())
</span><span>}
</span></code></pre><p>The migration maintains all existing functionality: TAA still supports both HDR and non-HDR rendering, and the reset functionality for temporal accumulation remains intact. The visual output and performance characteristics should be identical to the previous implementation.<p>This refactoring demonstrates the practical application of the <code>spec_v2</code> system in a real rendering pipeline. The changes improve code organization by separating specialization logic from pipeline management, making the system more maintainable and aligned with Bevy’s evolving rendering architecture. The error handling improvements also make the code more robust by explicitly handling potential failures during pipeline specialization.<h2 id=visual-representation>Visual Representation</h2><pre class=language-mermaid data-lang=mermaid style=color:#61676c;background-color:#fafafa><code class=language-mermaid data-lang=mermaid><span>graph TD
</span><span>    A[TaaPipeline Resource] --> B[Variants&LTRenderPipeline, TaaPipelineSpecializer>]
</span><span>    B --> C[Specialization Logic]
</span><span>    C --> D[TaaPipelineKey]
</span><span>    D --> E{HDR?}
</span><span>    D --> F{Reset?}
</span><span>    E --> G[Add TONEMAP shader_def]
</span><span>    F --> H[Add RESET shader_def]
</span><span>    G --> I[Set color format]
</span><span>    H --> I
</span><span>    I --> J[Create RenderPipeline]
</span><span>    J --> K[TemporalAntiAliasPipelineId]
</span></code></pre><h2 id=key-files-changed>Key Files Changed</h2><h3 id=crates-bevy-anti-alias-src-taa-mod-rs-57-47><code>crates/bevy_anti_alias/src/taa/mod.rs</code> (+57/-47)</h3><p>This is the only file modified in the PR. It contains the complete TAA implementation that was migrated from the old specialization system to <code>spec_v2</code>.<p>Key changes:<ol><li><strong>Updated imports</strong> - Removed old specialization system imports and added new <code>spec_v2</code> imports<li><strong>Refactored <code>TaaPipeline</code> struct</strong> - Changed from storing separate shader handles to using <code>Variants</code><li><strong>Added <code>TaaPipelineSpecializer</code></strong> - New struct implementing the <code>Specializer</code> trait<li><strong>Updated <code>prepare_taa_pipelines</code> system</strong> - Modified to use the new <code>Variants</code> API with proper error handling</ol><p>Code snippets showing the transition:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before - Old specialization system:
</span><span style=color:#fa6e32>impl </span><span>Plugin </span><span style=color:#fa6e32>for </span><span style=color:#399ee6>TemporalAntiAliasPlugin </span><span>{
</span><span>    </span><span style=color:#fa6e32>fn </span><span style=color:#f29718>build</span><span>(</span><span style=color:#ed9366>&</span><span style=color:#ff8f40>self</span><span>, </span><span style=color:#ff8f40>app</span><span style=color:#61676ccc>: </span><span style=color:#ed9366>&</span><span style=color:#fa6e32>mut</span><span> App) {
</span><span>        </span><span style=color:#abb0b6;font-style:italic>// ...
</span><span>        render_app
</span><span>            </span><span style=color:#ed9366>.</span><span>init_resource</span><span style=color:#ed9366>::</span><span>&LTSpecializedRenderPipelines&LTTaaPipeline>>()
</span><span>            </span><span style=color:#abb0b6;font-style:italic>// ...
</span><span>    }
</span><span>}
</span><span>
</span><span style=color:#fa6e32>struct </span><span style=color:#399ee6>TaaPipeline </span><span>{
</span><span>    taa_bind_group_layout</span><span style=color:#61676ccc>:</span><span> BindGroupLayoutDescriptor,
</span><span>    nearest_sampler</span><span style=color:#61676ccc>:</span><span> Sampler,
</span><span>    linear_sampler</span><span style=color:#61676ccc>:</span><span> Sampler,
</span><span>    fullscreen_shader</span><span style=color:#61676ccc>:</span><span> FullscreenShader,
</span><span>    fragment_shader</span><span style=color:#61676ccc>: </span><span>Handle&LTShader>,
</span><span>}
</span><span>
</span><span style=color:#fa6e32>impl </span><span>SpecializedRenderPipeline </span><span style=color:#fa6e32>for </span><span style=color:#399ee6>TaaPipeline </span><span>{
</span><span>    </span><span style=color:#fa6e32>type </span><span style=color:#399ee6>Key </span><span style=color:#ed9366>=</span><span> TaaPipelineKey</span><span style=color:#61676ccc>;
</span><span>    
</span><span>    </span><span style=color:#fa6e32>fn </span><span style=color:#f29718>specialize</span><span>(</span><span style=color:#ed9366>&</span><span style=color:#ff8f40>self</span><span>, </span><span style=color:#ff8f40>key</span><span style=color:#61676ccc>: </span><span style=color:#fa6e32>Self</span><span style=color:#ed9366>::</span><span>Key) </span><span style=color:#61676ccc>-></span><span> RenderPipelineDescriptor {
</span><span>        </span><span style=color:#abb0b6;font-style:italic>// Build complete descriptor from scratch
</span><span>        </span><span style=color:#abb0b6;font-style:italic>// ...
</span><span>    }
</span><span>}
</span></code></pre><pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// After - New spec_v2 system:
</span><span style=color:#fa6e32>impl </span><span>Plugin </span><span style=color:#fa6e32>for </span><span style=color:#399ee6>TemporalAntiAliasPlugin </span><span>{
</span><span>    </span><span style=color:#fa6e32>fn </span><span style=color:#f29718>build</span><span>(</span><span style=color:#ed9366>&</span><span style=color:#ff8f40>self</span><span>, </span><span style=color:#ff8f40>app</span><span style=color:#61676ccc>: </span><span style=color:#ed9366>&</span><span style=color:#fa6e32>mut</span><span> App) {
</span><span>        </span><span style=color:#abb0b6;font-style:italic>// ...
</span><span>        render_app
</span><span>            </span><span style=color:#abb0b6;font-style:italic>// No init_resource for SpecializedRenderPipelines
</span><span>            </span><span style=color:#abb0b6;font-style:italic>// ...
</span><span>    }
</span><span>}
</span><span>
</span><span style=color:#fa6e32>struct </span><span style=color:#399ee6>TaaPipeline </span><span>{
</span><span>    taa_bind_group_layout</span><span style=color:#61676ccc>:</span><span> BindGroupLayoutDescriptor,
</span><span>    nearest_sampler</span><span style=color:#61676ccc>:</span><span> Sampler,
</span><span>    linear_sampler</span><span style=color:#61676ccc>:</span><span> Sampler,
</span><span>    variants</span><span style=color:#61676ccc>: </span><span>Variants&LTRenderPipeline, TaaPipelineSpecializer>,
</span><span>}
</span><span>
</span><span style=color:#fa6e32>struct </span><span style=color:#399ee6>TaaPipelineSpecializer</span><span style=color:#61676ccc>;
</span><span>
</span><span style=color:#fa6e32>impl </span><span>Specializer&LTRenderPipeline> </span><span style=color:#fa6e32>for </span><span style=color:#399ee6>TaaPipelineSpecializer </span><span>{
</span><span>    </span><span style=color:#fa6e32>type </span><span style=color:#399ee6>Key </span><span style=color:#ed9366>=</span><span> TaaPipelineKey</span><span style=color:#61676ccc>;
</span><span>    
</span><span>    </span><span style=color:#fa6e32>fn </span><span style=color:#f29718>specialize</span><span>(
</span><span>        </span><span style=color:#ed9366>&</span><span style=color:#ff8f40>self</span><span>,
</span><span>        </span><span style=color:#ff8f40>key</span><span style=color:#61676ccc>: </span><span style=color:#fa6e32>Self</span><span style=color:#ed9366>::</span><span>Key,
</span><span>        </span><span style=color:#ff8f40>descriptor</span><span style=color:#61676ccc>: </span><span style=color:#ed9366>&</span><span style=color:#fa6e32>mut</span><span> RenderPipelineDescriptor,
</span><span>    ) </span><span style=color:#61676ccc>-> </span><span style=color:#55b4d4;font-style:italic>Result</span><span>&LTCanonical<</span><span style=color:#fa6e32>Self</span><span style=color:#ed9366>::</span><span>Key>, BevyError> {
</span><span>        </span><span style=color:#abb0b6;font-style:italic>// Modify existing descriptor
</span><span>        </span><span style=color:#abb0b6;font-style:italic>// ...
</span><span>    }
</span><span>}
</span></code></pre><h2 id=further-reading>Further Reading</h2><ol><li><a rel="noopener nofollow noreferrer" href=https://docs.rs/bevy_render/latest/bevy_render/render_resource/trait.SpecializedRenderPipeline.html target=_blank>Bevy Render Pipeline Specialization Documentation</a> - Old system documentation<li><a rel="noopener nofollow noreferrer" href=https://github.com/bevyengine/bevy/tree/main/crates/bevy_render/src/render_resource/specialize target=_blank>Bevy Variants and Specializer API</a> - New spec_v2 system implementation<li><a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/Temporal_anti-aliasing target=_blank>Temporal Anti-Aliasing Techniques</a> - Background on TAA algorithms<li><a rel="noopener nofollow noreferrer" href=https://bevyengine.org/learn/quick-start/getting-started/systems/ target=_blank>Bevy Rendering Architecture</a> - Overview of Bevy’s ECS and rendering systems</ol></div><div data-is-md-page=true data-patch-exists=true data-patch-path=/pull_request/bevy/2025-12/pr_22070.patch id=patch-info style=display:none></div><div class=bottom-spacer></div></div></div>