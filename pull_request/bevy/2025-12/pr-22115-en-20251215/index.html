<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://unknownue.github.io name=base><title>
         #22115 derive `Clone` and `Copy` for newer `interaction_states` unit structs
        
    </title><meta content="#22115 derive `Clone` and `Copy` for newer `interaction_states` unit structs" property=og:title><meta content="A personal blog built with Zola and Apollo theme" property=og:description><meta content="A personal blog built with Zola and Apollo theme" name=description><link href=/icons/favicon.png rel=icon type=image/png><link href=https://unknownue.github.io/fonts.css rel=stylesheet><script src=https://unknownue.github.io/js/codeblock.js></script><script src=https://unknownue.github.io/js/toc.js></script><script src=https://unknownue.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Unknownue's Blog" href=https://unknownue.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://unknownue.github.io/theme/light.css rel=stylesheet><link href=https://unknownue.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://unknownue.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://unknownue.github.io/main.css media=screen rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js></script><script>// Initialize mermaid once DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            mermaid.initialize({
                startOnLoad: false,
                theme: document.body && document.body.classList.contains('dark') ? 'dark' : 'default',
                securityLevel: 'loose',
                flowchart: {
                    useMaxWidth: true,
                    htmlLabels: true
                },
                sequence: {
                    diagramMarginX: 50,
                    diagramMarginY: 10,
                    actorMargin: 50,
                    width: 150,
                    height: 65
                }
            });
        });</script><script src=https://unknownue.github.io/js/main.js></script><script defer src=https://unknownue.github.io/js/label-colors.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/rust.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/typescript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/go.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/cpp.min.js></script><script>// Ensure highlight.js is properly configured
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof hljs !== 'undefined') {
                hljs.configure({
                    languages: ['rust', 'javascript', 'python', 'cpp', 'go', 'typescript'],
                    ignoreUnescapedHTML: true
                });
                console.log('Highlight.js configured in header');
            }
        });</script><link href=https://cdn.jsdelivr.net/npm/diff2html/bundles/css/diff2html.min.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/diff2html/bundles/js/diff2html-ui.min.js></script><script src=https://unknownue.github.io/js/syntax-highlight.js></script><script src=https://unknownue.github.io/js/diff-sidebar.js></script><script src="https://unknownue.github.io/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><div class=content><header><div class=main><a href=https://unknownue.github.io>Unknownue's Blog</a><div class=socials><a class=social href=https://github.com/unknownue rel=me> <img alt=github src=https://unknownue.github.io/icons/social/github.svg> </a><a class=social href=https://github.com/unknownue/unknownue.github.io rel=me> <img alt=github-io src=https://unknownue.github.io/icons/social/rss.svg> </a></div></div><nav><a href=https://unknownue.github.io/posts style=margin-left:.25em>/posts</a><a href=https://unknownue.github.io/projects style=margin-left:.25em>/projects</a><a href=https://unknownue.github.io/about style=margin-left:.25em>/about</a><a href=https://unknownue.github.io/tags style=margin-left:.25em>/tags</a><button title="$SHORTCUT to open search" class=search-button id=search-button><img alt=Search class=search-icon src=https://unknownue.github.io/icons/search.svg></button><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><div id=modal-content><h1 class=page-header id=modalTitle>Search</h1><div id=searchBar><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search... role=combobox spellcheck=false><button title="Clear search" class=clear-button id=clear-search><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></button></div><div id=results-container><div id=results-info><span id=zero_results style=display:none>No results</span><span id=one_result style=display:none>1 result</span><span id=many_results style=display:none>$NUMBER results</span></div><div id=results role=listbox></div></div></div></div><a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://unknownue.github.io/icons/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://unknownue.github.io/icons/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><div class=pull-request-page><article class=md-content-page style=display:none></article><div class=back-link><a href=/pull_request/bevy/2025-12/>← Back to Pull Requests</a></div><div class=pr-metadata><span class=pr-date>2025-12-15</span><div class=language-switcher><span class="lang-link active" data-lang=en>English</span> / <a class=lang-link data-lang=zh-cn href=/pull_request/bevy/2025-12/pr-22115-zh-cn-20251215>中文</a></div></div><div class=pr-content><h1 id=title>Title</h1><h2 id=derive-clone-and-copy-for-newer-interaction-states-unit-structs>derive <code>Clone</code> and <code>Copy</code> for newer <code>interaction_states</code> unit structs</h2><h2 id=basic-information>Basic Information</h2><ul><li><strong>Title</strong>: derive <code>Clone</code> and <code>Copy</code> for newer <code>interaction_states</code> unit structs<li><strong>PR Link</strong>: https://github.com/bevyengine/bevy/pull/22115<li><strong>Author</strong>: databasedav<li><strong>Status</strong>: MERGED<li><strong>Labels</strong>: None<li><strong>Created</strong>: 2025-12-15T04:22:28Z<li><strong>Merged</strong>: 2025-12-15T07:00:48Z<li><strong>Merged By</strong>: alice-i-cecile</ul><h2 id=description-translation>Description Translation</h2><h1 id=objective>Objective</h1><ul><li>derive <code>Clone</code> and <code>Copy</code> for the newer unit structs in <code>interaction_states</code>, this is useful for frameworks that are generic over <code>Component + Clone/Copy</code> and is also the status quo for the existing <code>InteractionDisabled</code> component defined a few lines above</ul><h2 id=solution>Solution</h2><ul><li>derive <code>Clone</code> and <code>Copy</code> for <code>Pressed</code>, <code>Checkable</code>, and <code>Checked</code></ul><h2 id=the-story-of-this-pull-request>The Story of This Pull Request</h2><p>This pull request addresses a straightforward consistency issue in Bevy’s UI system. The problem centers around three unit struct components in the <code>interaction_states</code> module: <code>Pressed</code>, <code>Checkable</code>, and <code>Checked</code>. These components lacked the <code>Clone</code> and <code>Copy</code> trait implementations, which created an inconsistency with the existing <code>InteractionDisabled</code> component that already had these traits derived.<p>The issue becomes apparent when considering frameworks or systems designed to work with components generically. Many Rust patterns and Bevy’s own ECS systems benefit from components that implement <code>Clone</code> and <code>Copy</code> traits, particularly for marker components (unit structs with no data). Without these traits, developers working with generic constraints like <code>T: Component + Clone</code> or <code>T: Component + Copy</code> would be unable to use these newer interaction state components, even though they logically should support these traits.<p>The solution implemented in this PR is minimal and focused. The developer simply added <code>Clone</code> and <code>Copy</code> to the derive macros for the three affected structs. Additionally, they reordered the trait derivations to maintain consistency with existing code patterns in the codebase, placing <code>Debug</code> before <code>Clone</code> and <code>Copy</code>, and <code>Default</code> at the end.<p>From a technical perspective, this change is safe because these are unit structs (structs with no fields). Unit structs are trivially copyable and clonable since they contain no data to copy or clone - they’re essentially zero-sized types that serve as markers. The Rust compiler can generate optimal implementations for these traits in such cases.<p>The implementation required only three lines of changes, each following the same pattern. The developer updated the derive attribute for each struct from <code>#[derive(Component, Default, Debug)]</code> to <code>#[derive(Component, Debug, Clone, Copy, Default)]</code>. This maintains backward compatibility while enabling the new functionality.<p>The impact of this change is primarily in improved API consistency and expanded usability. Developers can now use these interaction state components in any context requiring copyable or clonable components without workarounds. The change aligns with Rust’s philosophy of making zero-cost abstractions available where appropriate.<h2 id=visual-representation>Visual Representation</h2><pre class=language-mermaid data-lang=mermaid style=color:#61676c;background-color:#fafafa><code class=language-mermaid data-lang=mermaid><span>graph TD
</span><span>    A[InteractionDisabled Component] -->|Already has| B[Clone + Copy traits]
</span><span>    C[Pressed Component] -->|Now gets| B
</span><span>    D[Checkable Component] -->|Now gets| B
</span><span>    E[Checked Component] -->|Now gets| B
</span><span>    
</span><span>    F[Component Trait] --> A
</span><span>    F --> C
</span><span>    F --> D
</span><span>    F --> E
</span><span>    
</span><span>    G[Marker Components&LTbr/>Zero-sized types] --> A
</span><span>    G --> C
</span><span>    G --> D
</span><span>    G --> E
</span></code></pre><h2 id=key-files-changed>Key Files Changed</h2><h3 id=crates-bevy-ui-src-interaction-states-rs><code>crates/bevy_ui/src/interaction_states.rs</code></h3><p><strong>What changed</strong>: Added <code>Clone</code> and <code>Copy</code> trait derivations to three UI component structs and reordered trait derivations for consistency.<p><strong>Before:</strong><pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>/// Component that indicates whether a button or widget is currently in a pressed or "held down"
</span><span style=color:#abb0b6;font-style:italic>/// state.
</span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>derive</span><span>(Component</span><span style=color:#61676ccc>,</span><span> Default</span><span style=color:#61676ccc>,</span><span> Debug)]
</span><span style=color:#fa6e32>pub struct </span><span style=color:#399ee6>Pressed</span><span style=color:#61676ccc>;
</span><span>
</span><span style=color:#abb0b6;font-style:italic>/// Component that indicates that a widget can be checked.
</span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>derive</span><span>(Component</span><span style=color:#61676ccc>,</span><span> Default</span><span style=color:#61676ccc>,</span><span> Debug)]
</span><span style=color:#fa6e32>pub struct </span><span style=color:#399ee6>Checkable</span><span style=color:#61676ccc>;
</span><span>
</span><span style=color:#abb0b6;font-style:italic>/// Component that indicates whether a checkbox or radio button is in a checked state.
</span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>derive</span><span>(Component</span><span style=color:#61676ccc>,</span><span> Default</span><span style=color:#61676ccc>,</span><span> Debug)]
</span><span style=color:#fa6e32>pub struct </span><span style=color:#399ee6>Checked</span><span style=color:#61676ccc>;
</span></code></pre><p><strong>After:</strong><pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>/// Component that indicates whether a button or widget is currently in a pressed or "held down"
</span><span style=color:#abb0b6;font-style:italic>/// state.
</span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>derive</span><span>(Component</span><span style=color:#61676ccc>,</span><span> Debug</span><span style=color:#61676ccc>,</span><span> Clone</span><span style=color:#61676ccc>,</span><span> Copy</span><span style=color:#61676ccc>,</span><span> Default)]
</span><span style=color:#fa6e32>pub struct </span><span style=color:#399ee6>Pressed</span><span style=color:#61676ccc>;
</span><span>
</span><span style=color:#abb0b6;font-style:italic>/// Component that indicates that a widget can be checked.
</span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>derive</span><span>(Component</span><span style=color:#61676ccc>,</span><span> Debug</span><span style=color:#61676ccc>,</span><span> Clone</span><span style=color:#61676ccc>,</span><span> Copy</span><span style=color:#61676ccc>,</span><span> Default)]
</span><span style=color:#fa6e32>pub struct </span><span style=color:#399ee6>Checkable</span><span style=color:#61676ccc>;
</span><span>
</span><span style=color:#abb0b6;font-style:italic>/// Component that indicates whether a checkbox or radio button is in a checked state.
</span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>derive</span><span>(Component</span><span style=color:#61676ccc>,</span><span> Debug</span><span style=color:#61676ccc>,</span><span> Clone</span><span style=color:#61676ccc>,</span><span> Copy</span><span style=color:#61676ccc>,</span><span> Default)]
</span><span style=color:#fa6e32>pub struct </span><span style=color:#399ee6>Checked</span><span style=color:#61676ccc>;
</span></code></pre><p><strong>Why it matters</strong>: These changes bring consistency with the existing <code>InteractionDisabled</code> component and enable these marker components to be used in generic contexts that require <code>Clone</code> or <code>Copy</code> traits. The reordering of traits follows the established pattern in the codebase, improving code readability and maintainability.<h2 id=further-reading>Further Reading</h2><ol><li><p><strong>Rust Traits Documentation</strong>:</p> <ul><li><a rel="noopener nofollow noreferrer" href=https://doc.rust-lang.org/std/clone/trait.Clone.html target=_blank><code>Clone</code> trait</a><li><a rel="noopener nofollow noreferrer" href=https://doc.rust-lang.org/std/marker/trait.Copy.html target=_blank><code>Copy</code> trait</a></ul><li><p><strong>Bevy ECS Components</strong>:</p> <ul><li><a rel="noopener nofollow noreferrer" href=https://bevyengine.org/learn/book/development/ecs/components/ target=_blank>Bevy Component Documentation</a><li><a rel="noopener nofollow noreferrer" href=https://bevy-cheatbook.github.io/programming/ecs-intro.html#marker-components target=_blank>Marker Components Pattern</a></ul><li><p><strong>Zero-sized Types in Rust</strong>:</p> <ul><li><a rel="noopener nofollow noreferrer" href=https://doc.rust-lang.org/reference/type-layout.html#zero-sized-types target=_blank>The Rust Reference: Zero-sized Types</a><li><a rel="noopener nofollow noreferrer" href=https://doc.rust-lang.org/nomicon/exotic-sizes.html target=_blank>Rustonomicon: Exotic Sizes</a></ul><li><p><strong>Derive Macros</strong>:</p> <ul><li><a rel="noopener nofollow noreferrer" href=https://doc.rust-lang.org/rust-by-example/trait/derive.html target=_blank>Rust by Example: Derive</a><li><a rel="noopener nofollow noreferrer" href=https://doc.rust-lang.org/book/appendix-03-derivable-traits.html target=_blank>The Rust Programming Language: Appendix C: Derivable Traits</a></ul></ol><h1 id=full-code-diff>Full Code Diff</h1><p>diff –git a/crates/bevy_ui/src/interaction_states.rs b/crates/bevy_ui/src/interaction_states.rs index a5793ca778a57..41e80114062a9 100644 — a/crates/bevy_ui/src/interaction_states.rs +++ b/crates/bevy_ui/src/interaction_states.rs @@ -37,15 +37,15 @@ pub(crate) fn on_remove_disabled(<p>/// Component that indicates whether a button or widget is currently in a pressed or “held down” /// state. -#[derive(Component, Default, Debug)] +#[derive(Component, Debug, Clone, Copy, Default)] pub struct Pressed;<p>/// Component that indicates that a widget can be checked. -#[derive(Component, Default, Debug)] +#[derive(Component, Debug, Clone, Copy, Default)] pub struct Checkable;<p>/// Component that indicates whether a checkbox or radio button is in a checked state. -#[derive(Component, Default, Debug)] +#[derive(Component, Debug, Clone, Copy, Default)] pub struct Checked;<p>pub(crate) fn on_add_checkable(add: On&LTAdd, Checked>, mut world: DeferredWorld) {</div><div data-is-md-page=true data-patch-exists=true data-patch-path=/pull_request/bevy/2025-12/pr_22115.patch id=patch-info style=display:none></div><div class=bottom-spacer></div></div></div>