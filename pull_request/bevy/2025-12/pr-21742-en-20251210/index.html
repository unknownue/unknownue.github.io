<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://unknownue.github.io name=base><title>
         #21742 Change a function system to be exclusive
        
    </title><meta content="#21742 Change a function system to be exclusive" property=og:title><meta content="A personal blog built with Zola and Apollo theme" property=og:description><meta content="A personal blog built with Zola and Apollo theme" name=description><link href=/icons/favicon.png rel=icon type=image/png><link href=https://unknownue.github.io/fonts.css rel=stylesheet><script src=https://unknownue.github.io/js/codeblock.js></script><script src=https://unknownue.github.io/js/toc.js></script><script src=https://unknownue.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Unknownue's Blog" href=https://unknownue.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://unknownue.github.io/theme/light.css rel=stylesheet><link href=https://unknownue.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://unknownue.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://unknownue.github.io/main.css media=screen rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js></script><script>// Initialize mermaid once DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            mermaid.initialize({
                startOnLoad: false,
                theme: document.body && document.body.classList.contains('dark') ? 'dark' : 'default',
                securityLevel: 'loose',
                flowchart: {
                    useMaxWidth: true,
                    htmlLabels: true
                },
                sequence: {
                    diagramMarginX: 50,
                    diagramMarginY: 10,
                    actorMargin: 50,
                    width: 150,
                    height: 65
                }
            });
        });</script><script src=https://unknownue.github.io/js/main.js></script><script defer src=https://unknownue.github.io/js/label-colors.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/rust.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/typescript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/go.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/cpp.min.js></script><script>// Ensure highlight.js is properly configured
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof hljs !== 'undefined') {
                hljs.configure({
                    languages: ['rust', 'javascript', 'python', 'cpp', 'go', 'typescript'],
                    ignoreUnescapedHTML: true
                });
                console.log('Highlight.js configured in header');
            }
        });</script><link href=https://cdn.jsdelivr.net/npm/diff2html/bundles/css/diff2html.min.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/diff2html/bundles/js/diff2html-ui.min.js></script><script src=https://unknownue.github.io/js/syntax-highlight.js></script><script src=https://unknownue.github.io/js/diff-sidebar.js></script><script src="https://unknownue.github.io/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><div class=content><header><div class=main><a href=https://unknownue.github.io>Unknownue's Blog</a><div class=socials><a class=social href=https://github.com/unknownue rel=me> <img alt=github src=https://unknownue.github.io/icons/social/github.svg> </a><a class=social href=https://github.com/unknownue/unknownue.github.io rel=me> <img alt=github-io src=https://unknownue.github.io/icons/social/rss.svg> </a></div></div><nav><a href=https://unknownue.github.io/posts style=margin-left:.25em>/posts</a><a href=https://unknownue.github.io/projects style=margin-left:.25em>/projects</a><a href=https://unknownue.github.io/about style=margin-left:.25em>/about</a><a href=https://unknownue.github.io/tags style=margin-left:.25em>/tags</a><button title="$SHORTCUT to open search" class=search-button id=search-button><img alt=Search class=search-icon src=https://unknownue.github.io/icons/search.svg></button><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><div id=modal-content><h1 class=page-header id=modalTitle>Search</h1><div id=searchBar><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search... role=combobox spellcheck=false><button title="Clear search" class=clear-button id=clear-search><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></button></div><div id=results-container><div id=results-info><span id=zero_results style=display:none>No results</span><span id=one_result style=display:none>1 result</span><span id=many_results style=display:none>$NUMBER results</span></div><div id=results role=listbox></div></div></div></div><a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://unknownue.github.io/icons/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://unknownue.github.io/icons/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><div class=pull-request-page><article class=md-content-page style=display:none></article><div class=back-link><a href=/pull_request/bevy/2025-12/>← Back to Pull Requests</a></div><div class=pr-metadata><span class=pr-date>2025-12-10</span><div class=language-switcher><span class="lang-link active" data-lang=en>English</span> / <a class=lang-link data-lang=zh-cn href=/pull_request/bevy/2025-12/pr-21742-zh-cn-20251210>中文</a></div></div><div class=pr-content><h1 id=change-a-function-system-to-be-exclusive>Change a function system to be exclusive</h1><h2 id=basic-information>Basic Information</h2><ul><li><strong>Title</strong>: Change a function system to be exclusive<li><strong>PR Link</strong>: https://github.com/bevyengine/bevy/pull/21742<li><strong>Author</strong>: hymm<li><strong>Status</strong>: MERGED<li><strong>Labels</strong>: C-Feature, A-ECS, S-Ready-For-Final-Review, X-Contentious<li><strong>Created</strong>: 2025-11-04T22:37:20Z<li><strong>Merged</strong>: 2025-12-09T23:50:10Z<li><strong>Merged By</strong>: alice-i-cecile</ul><h2 id=description-translation>Description Translation</h2><p>The original description is in English, so it is included as-is:<h1 id=objective>Objective</h1><ul><li>I was experimenting with a library for combining multiple systems into one system that could be scheduled, but there wasn’t a way of marking a function system run exclusively.</ul><h2 id=solution>Solution</h2><ul><li>Add a method to <code>SystemMeta</code> to set the exclusive flag. Note that this PR doesn’t add anyway to actually set the flag easily. You would have to create a custom system param to be able to set it.<li>Add a system param to mark a function system to run exclusively.</ul><h2 id=testing>Testing</h2><ul><li>Haven’t tested. The one worry would be how it interacts with the executor, but in theory this should just work, since the flag is the only way the executor knows that a system is exclusive or not.</ul><h2 id=the-story-of-this-pull-request>The Story of This Pull Request</h2><p>This PR addresses a specific need in Bevy’s Entity Component System (ECS): the ability to mark a function system as exclusive. In Bevy, exclusive systems have unique access to the entire <code>World</code> and cannot run concurrently with other systems. This is important for operations that require full control over the world state, but previously, there was no straightforward way to mark a regular function system as exclusive.<p>The author was working on a library that combines multiple systems into one schedulable unit and encountered the limitation that function systems couldn’t be easily marked as exclusive. The existing <code>SystemMeta</code> struct already tracks system flags through <code>SystemStateFlags</code>, which includes an <code>EXCLUSIVE</code> flag, but there was no public API to set this flag for function systems.<p>The solution is implemented in two parts. First, a new method <code>set_exclusive()</code> is added to <code>SystemMeta</code> in <code>function_system.rs</code>. This method simply sets the <code>EXCLUSIVE</code> flag in the system’s state flags, following the same pattern as the existing <code>set_has_deferred()</code> method.<p>Second, a new system parameter <code>ExclusiveMarker</code> is introduced in <code>system_param.rs</code>. This is a “dummy” type that implements the <code>SystemParam</code> trait. When this parameter is included in a function system’s signature, it triggers the system to be marked as exclusive during initialization. The key mechanism is in the <code>init_access</code> method of the <code>SystemParam</code> implementation for <code>ExclusiveMarker</code>, which calls <code>system_meta.set_exclusive()</code>.<p>This approach follows Bevy’s existing patterns for system parameters that modify system behavior without actually providing data. For example, <code>NonSendMarker</code> is a similar dummy parameter that forces systems to run on the main thread. The <code>ExclusiveMarker</code> parameter is designed to be zero-cost at runtime - it’s a unit struct with a phantom data field, and its <code>get_param</code> method returns the marker without performing any actual world access.<p>The implementation maintains safety by marking <code>ExclusiveMarker</code> with the appropriate unsafe traits. It implements <code>SystemParam</code> with minimal state (an empty tuple for <code>State</code>), and since it doesn’t access any world data, it also safely implements <code>ReadOnlySystemParam</code>. The <code>init_access</code> method is where the actual marking happens, which occurs during system initialization before execution.<p>To verify the functionality, a test is added in <code>mod.rs</code> that demonstrates using <code>ExclusiveMarker</code> in a function system. The test creates a simple system that takes <code>ExclusiveMarker</code> as a parameter, initializes it, verifies that the system is marked as exclusive via <code>is_exclusive()</code>, and then runs the system to ensure it functions correctly.<p>One important note from the PR description is that this implementation doesn’t provide a high-level API for marking systems as exclusive. Users must explicitly include <code>ExclusiveMarker</code> in their system function signatures. This is intentional - it follows Bevy’s philosophy of making system constraints explicit in the type signature rather than relying on external configuration.<p>The author mentions concerns about how this interacts with the executor but notes that in theory it should work since the flag is the primary mechanism the executor uses to determine if a system is exclusive. This is correct - Bevy’s scheduler already respects the <code>EXCLUSIVE</code> flag when determining system execution order and parallelism.<p>This change is relatively small but extends Bevy’s ECS capabilities in a meaningful way. It provides a clean, type-safe mechanism for marking function systems as exclusive that integrates well with Bevy’s existing system parameter infrastructure and follows established patterns in the codebase.<h2 id=visual-representation>Visual Representation</h2><pre class=language-mermaid data-lang=mermaid style=color:#61676c;background-color:#fafafa><code class=language-mermaid data-lang=mermaid><span>graph TD
</span><span>    A[Function System Definition] --> B[Includes ExclusiveMarker parameter]
</span><span>    B --> C[System initialization calls init_access]
</span><span>    C --> D[SystemMeta.set_exclusive() called]
</span><span>    D --> E[EXCLUSIVE flag set in SystemStateFlags]
</span><span>    E --> F[Scheduler respects exclusive flag]
</span><span>    F --> G[System runs exclusively]
</span></code></pre><h2 id=key-files-changed>Key Files Changed</h2><h3 id=crates-bevy-ecs-src-system-function-system-rs-5-0><code>crates/bevy_ecs/src/system/function_system.rs</code> (+5/-0)</h3><p>Added the <code>set_exclusive()</code> method to <code>SystemMeta</code> to allow setting the exclusive flag.<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>/// Mark the system to run exclusively. i.e. no other systems will run at the same time.
</span><span style=color:#fa6e32>pub fn </span><span style=color:#f29718>set_exclusive</span><span>(</span><span style=color:#ed9366>&</span><span style=color:#fa6e32>mut </span><span style=color:#ff8f40>self</span><span>) {
</span><span>    </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>flags </span><span style=color:#ed9366>|= </span><span>SystemStateFlags</span><span style=color:#ed9366>::</span><span style=color:#ff8f40>EXCLUSIVE</span><span style=color:#61676ccc>;
</span><span>}
</span></code></pre><p>This change provides the low-level API to mark a system as exclusive by setting the appropriate flag in the system’s metadata.<h3 id=crates-bevy-ecs-src-system-system-param-rs-34-0><code>crates/bevy_ecs/src/system/system_param.rs</code> (+34/-0)</h3><p>Added the <code>ExclusiveMarker</code> system parameter type that allows function systems to be marked as exclusive.<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>/// A dummy type to tell the executor to run the system exclusively.
</span><span style=color:#fa6e32>pub struct </span><span style=color:#399ee6>ExclusiveMarker</span><span>(PhantomData<()</span><span style=color:#ed9366>></span><span>)</span><span style=color:#61676ccc>;
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// SAFETY: No world access.
</span><span style=color:#fa6e32>unsafe impl </span><span>SystemParam </span><span style=color:#fa6e32>for </span><span style=color:#399ee6>ExclusiveMarker </span><span>{
</span><span>    </span><span style=color:#fa6e32>type </span><span style=color:#399ee6>State </span><span style=color:#ed9366>= </span><span>()</span><span style=color:#61676ccc>;
</span><span>    </span><span style=color:#fa6e32>type </span><span style=color:#399ee6>Item</span><span style=color:#ed9366><</span><span style=color:#fa6e32>'w</span><span style=color:#61676ccc>, </span><span style=color:#fa6e32>'s</span><span style=color:#ed9366>> = </span><span style=color:#fa6e32>Self</span><span style=color:#61676ccc>;
</span><span>
</span><span>    </span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>inline</span><span>]
</span><span>    </span><span style=color:#fa6e32>fn </span><span style=color:#f29718>init_state</span><span>(</span><span style=color:#ff8f40>_world</span><span style=color:#61676ccc>: </span><span style=color:#ed9366>&</span><span style=color:#fa6e32>mut</span><span> World) </span><span style=color:#61676ccc>-> </span><span style=color:#fa6e32>Self</span><span style=color:#ed9366>::</span><span>State {}
</span><span>
</span><span>    </span><span style=color:#fa6e32>fn </span><span style=color:#f29718>init_access</span><span>(
</span><span>        </span><span style=color:#ff8f40>_state</span><span style=color:#61676ccc>: </span><span style=color:#ed9366>&</span><span style=color:#fa6e32>Self</span><span style=color:#ed9366>::</span><span>State,
</span><span>        </span><span style=color:#ff8f40>system_meta</span><span style=color:#61676ccc>: </span><span style=color:#ed9366>&</span><span style=color:#fa6e32>mut</span><span> SystemMeta,
</span><span>        </span><span style=color:#ff8f40>_component_access_set</span><span style=color:#61676ccc>: </span><span style=color:#ed9366>&</span><span style=color:#fa6e32>mut</span><span> FilteredAccessSet,
</span><span>        </span><span style=color:#ff8f40>_world</span><span style=color:#61676ccc>: </span><span style=color:#ed9366>&</span><span style=color:#fa6e32>mut</span><span> World,
</span><span>    ) {
</span><span>        system_meta</span><span style=color:#ed9366>.</span><span style=color:#f07171>set_exclusive</span><span>()</span><span style=color:#61676ccc>;
</span><span>    }
</span><span>
</span><span>    </span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>inline</span><span>]
</span><span>    </span><span style=color:#fa6e32>unsafe fn </span><span style=color:#f29718>get_param</span><span><</span><span style=color:#fa6e32>'world</span><span>, </span><span style=color:#fa6e32>'state</span><span>>(
</span><span>        </span><span style=color:#ff8f40>_state</span><span style=color:#61676ccc>: </span><span style=color:#ed9366>&</span><span style=color:#fa6e32>'state mut Self</span><span style=color:#ed9366>::</span><span>State,
</span><span>        </span><span style=color:#ff8f40>_system_meta</span><span style=color:#61676ccc>: </span><span style=color:#ed9366>&</span><span>SystemMeta,
</span><span>        </span><span style=color:#ff8f40>_world</span><span style=color:#61676ccc>: </span><span>UnsafeWorldCell<</span><span style=color:#fa6e32>'world</span><span>>,
</span><span>        </span><span style=color:#ff8f40>_change_tick</span><span style=color:#61676ccc>:</span><span> Tick,
</span><span>    ) </span><span style=color:#61676ccc>-> </span><span style=color:#fa6e32>Self</span><span style=color:#ed9366>::</span><span>Item<</span><span style=color:#fa6e32>'world</span><span>, </span><span style=color:#fa6e32>'state</span><span>> {
</span><span>        </span><span style=color:#fa6e32>Self</span><span>(PhantomData)
</span><span>    }
</span><span>}
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// SAFETY: Does not read any world state
</span><span style=color:#fa6e32>unsafe impl </span><span>ReadOnlySystemParam </span><span style=color:#fa6e32>for </span><span style=color:#399ee6>ExclusiveMarker </span><span>{}
</span></code></pre><p>This is the core implementation that allows systems to self-identify as exclusive through their parameter list. The <code>init_access</code> method is the key hook that calls the newly added <code>set_exclusive()</code> method.<h3 id=crates-bevy-ecs-src-system-mod-rs-20-2><code>crates/bevy_ecs/src/system/mod.rs</code> (+20/-2)</h3><p>Added a test to verify the exclusive system functionality works correctly.<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>test</span><span>]
</span><span style=color:#fa6e32>fn </span><span style=color:#f29718>function_system_as_exclusive</span><span>() {
</span><span>    </span><span style=color:#fa6e32>let mut</span><span> world </span><span style=color:#ed9366>= </span><span>World</span><span style=color:#ed9366>::</span><span>default()</span><span style=color:#61676ccc>;
</span><span>
</span><span>    world</span><span style=color:#ed9366>.</span><span style=color:#f07171>insert_resource</span><span>(SystemRan</span><span style=color:#ed9366>::</span><span>No)</span><span style=color:#61676ccc>;
</span><span>
</span><span>    </span><span style=color:#fa6e32>fn </span><span style=color:#f29718>sys</span><span>(</span><span style=color:#ff8f40>_marker</span><span style=color:#61676ccc>:</span><span> ExclusiveMarker, </span><span style=color:#fa6e32>mut </span><span style=color:#ff8f40>system_ran</span><span style=color:#61676ccc>: </span><span>ResMut&LTSystemRan>) {
</span><span>        </span><span style=color:#ed9366>*</span><span>system_ran </span><span style=color:#ed9366>= </span><span>SystemRan</span><span style=color:#ed9366>::</span><span>Yes</span><span style=color:#61676ccc>;
</span><span>    }
</span><span>
</span><span>    </span><span style=color:#fa6e32>let mut</span><span> sys </span><span style=color:#ed9366>= </span><span>IntoSystem</span><span style=color:#ed9366>::</span><span>into_system(sys)</span><span style=color:#61676ccc>;
</span><span>    sys</span><span style=color:#ed9366>.</span><span style=color:#f07171>initialize</span><span>(</span><span style=color:#ed9366>&</span><span style=color:#fa6e32>mut</span><span> world)</span><span style=color:#61676ccc>;
</span><span>    </span><span style=color:#f07171>assert!</span><span>(sys</span><span style=color:#ed9366>.</span><span style=color:#f07171>is_exclusive</span><span>())</span><span style=color:#61676ccc>;
</span><span>
</span><span>    </span><span style=color:#f07171>run_system</span><span>(</span><span style=color:#ed9366>&</span><span style=color:#fa6e32>mut</span><span> world</span><span style=color:#61676ccc>,</span><span> sys)</span><span style=color:#61676ccc>;
</span><span>    </span><span style=color:#f07171>assert_eq!</span><span>(</span><span style=color:#ed9366>*</span><span>world</span><span style=color:#ed9366>.</span><span>resource</span><span style=color:#ed9366>::</span><span>&LTSystemRan>()</span><span style=color:#61676ccc>, </span><span>SystemRan</span><span style=color:#ed9366>::</span><span>Yes)</span><span style=color:#61676ccc>;
</span><span>}
</span></code></pre><p>This test demonstrates the usage pattern: including <code>ExclusiveMarker</code> as a parameter marks the system as exclusive, and the system functions normally otherwise. The test also updated the import statements to include <code>ExclusiveMarker</code>.<h2 id=further-reading>Further Reading</h2><ol><li>Bevy ECS System Execution: https://bevyengine.org/learn/book/ecs/system-execution/<li>Bevy System Parameters: https://bevyengine.org/learn/book/ecs/system-params/<li>Bevy Exclusive Systems Documentation: https://bevyengine.org/learn/book/ecs/exclusive-systems/<li>Rust PhantomData Pattern: https://doc.rust-lang.org/std/marker/struct.PhantomData.html<li>Bevy SystemParam Trait Documentation: https://docs.rs/bevy_ecs/latest/bevy_ecs/system/trait.SystemParam.html</ol><h1 id=full-code-diff>Full Code Diff</h1><pre class=language-diff data-lang=diff style=color:#61676c;background-color:#fafafa><code class=language-diff data-lang=diff><span>diff --git a/crates/bevy_ecs/src/system/function_system.rs b/crates/bevy_ecs/src/system/function_system.rs
</span><span>index 5f6653be39834..4aeb704ecf9f2 100644
</span><span style=color:#c594c5>--- a/crates/bevy_ecs/src/system/function_system.rs
</span><span style=color:#c594c5>+++ b/crates/bevy_ecs/src/system/function_system.rs
</span><span style=color:#c594c5>@@ -105,6 +105,11 @@ </span><span style=color:#399ee6>impl SystemMeta {
</span><span>     pub fn set_has_deferred(&mut self) {
</span><span>         self.flags |= SystemStateFlags::DEFERRED;
</span><span>     }
</span><span style=color:#86b300>+
</span><span style=color:#86b300>+    /// Mark the system to run exclusively. i.e. no other systems will run at the same time.
</span><span style=color:#86b300>+    pub fn set_exclusive(&mut self) {
</span><span style=color:#86b300>+        self.flags |= SystemStateFlags::EXCLUSIVE;
</span><span style=color:#86b300>+    }
</span><span> }
</span><span> 
</span><span> // TODO: Actually use this in FunctionSystem. We should probably only do this once Systems are constructed using a World reference
</span><span>diff --git a/crates/bevy_ecs/src/system/mod.rs b/crates/bevy_ecs/src/system/mod.rs
</span><span>index eeecf4b7ac5db..f729731ea327a 100644
</span><span style=color:#c594c5>--- a/crates/bevy_ecs/src/system/mod.rs
</span><span style=color:#c594c5>+++ b/crates/bevy_ecs/src/system/mod.rs
</span><span style=color:#c594c5>@@ -418,8 +418,8 @@ </span><span style=color:#399ee6>mod tests {
</span><span>             SystemCondition,
</span><span>         },
</span><span>         system::{
</span><span style=color:#f07171>-            Commands, In, InMut, IntoSystem, Local, NonSend, NonSendMut, ParamSet, Query, Res,
</span><span style=color:#f07171>-            ResMut, Single, StaticSystemParam, System, SystemState,
</span><span style=color:#86b300>+            Commands, ExclusiveMarker, In, InMut, IntoSystem, Local, NonSend, NonSendMut, ParamSet,
</span><span style=color:#86b300>+            Query, Res, ResMut, Single, StaticSystemParam, System, SystemState,
</span><span>         },
</span><span>         world::{DeferredWorld, EntityMut, FromWorld, World},
</span><span>     };
</span><span style=color:#c594c5>@@ -1049,6 +1049,24 @@ </span><span style=color:#399ee6>mod tests {
</span><span>         assert_eq!(*world.resource::&LTSystemRan>(), SystemRan::Yes);
</span><span>     }
</span><span> 
</span><span style=color:#86b300>+    #[test]
</span><span style=color:#86b300>+    fn function_system_as_exclusive() {
</span><span style=color:#86b300>+        let mut world = World::default();
</span><span style=color:#86b300>+
</span><span style=color:#86b300>+        world.insert_resource(SystemRan::No);
</span><span style=color:#86b300>+
</span><span style=color:#86b300>+        fn sys(_marker: ExclusiveMarker, mut system_ran: ResMut&LTSystemRan>) {
</span><span style=color:#86b300>+            *system_ran = SystemRan::Yes;
</span><span style=color:#86b300>+        }
</span><span style=color:#86b300>+
</span><span style=color:#86b300>+        let mut sys = IntoSystem::into_system(sys);
</span><span style=color:#86b300>+        sys.initialize(&mut world);
</span><span style=color:#86b300>+        assert!(sys.is_exclusive());
</span><span style=color:#86b300>+
</span><span style=color:#86b300>+        run_system(&mut world, sys);
</span><span style=color:#86b300>+        assert_eq!(*world.resource::&LTSystemRan>(), SystemRan::Yes);
</span><span style=color:#86b300>+    }
</span><span style=color:#86b300>+
</span><span>     #[test]
</span><span>     fn removal_tracking() {
</span><span>         let mut world = World::new();
</span><span>diff --git a/crates/bevy_ecs/src/system/system_param.rs b/crates/bevy_ecs/src/system/system_param.rs
</span><span>index 8e99259149b67..bc58aa7d85b94 100644
</span><span style=color:#c594c5>--- a/crates/bevy_ecs/src/system/system_param.rs
</span><span style=color:#c594c5>+++ b/crates/bevy_ecs/src/system/system_param.rs
</span><span style=color:#c594c5>@@ -1309,6 +1309,40 @@ </span><span style=color:#399ee6>unsafe impl&LTT: SystemBuffer> SystemParam for Deferred<'_, T> {
</span><span>     }
</span><span> }
</span><span> 
</span><span style=color:#86b300>+/// A dummy type to tell the executor to run the system exclusively.
</span><span style=color:#86b300>+pub struct ExclusiveMarker(PhantomData<()>);
</span><span style=color:#86b300>+
</span><span style=color:#86b300>+// SAFETY: No world access.
</span><span style=color:#86b300>+unsafe impl SystemParam for ExclusiveMarker {
</span><span style=color:#86b300>+    type State = ();
</span><span style=color:#86b300>+    type Item<'w, 's> = Self;
</span><span style=color:#86b300>+
</span><span style=color:#86b300>+    #[inline]
</span><span style=color:#86b300>+    fn init_state(_world: &mut World) -> Self::State {}
</span><span style=color:#86b300>+
</span><span style=color:#86b300>+    fn init_access(
</span><span style=color:#86b300>+        _state: &Self::State,
</span><span style=color:#86b300>+        system_meta: &mut SystemMeta,
</span><span style=color:#86b300>+        _component_access_set: &mut FilteredAccessSet,
</span><span style=color:#86b300>+        _world: &mut World,
</span><span style=color:#86b300>+    ) {
</span><span style=color:#86b300>+        system_meta.set_exclusive();
</span><span style=color:#86b300>+    }
</span><span style=color:#86b300>+
</span><span style=color:#86b300>+    #[inline]
</span><span style=color:#86b300>+    unsafe fn get_param<'world, 'state>(
</span><span style=color:#86b300>+        _state: &'state mut Self::State,
</span><span style=color:#86b300>+        _system_meta: &SystemMeta,
</span><span style=color:#86b300>+        _world: UnsafeWorldCell<'world>,
</span><span style=color:#86b300>+        _change_tick: Tick,
</span><span style=color:#86b300>+    ) -> Self::Item<'world, 'state> {
</span><span style=color:#86b300>+        Self(PhantomData)
</span><span style=color:#86b300>+    }
</span><span style=color:#86b300>+}
</span><span style=color:#86b300>+
</span><span style=color:#86b300>+// SAFETY: Does not read any world state
</span><span style=color:#86b300>+unsafe impl ReadOnlySystemParam for ExclusiveMarker {}
</span><span style=color:#86b300>+
</span><span> /// A dummy type that is [`!Send`](Send), to force systems to run on the main thread.
</span><span> pub struct NonSendMarker(PhantomData<*mut ()>);
</span></code></pre></div><div data-is-md-page=true data-patch-exists=true data-patch-path=/pull_request/bevy/2025-12/pr_21742.patch id=patch-info style=display:none></div><div class=bottom-spacer></div></div></div>