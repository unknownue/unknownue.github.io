<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://unknownue.github.io name=base><title>
         #21243 Easy demo recording
        
    </title><meta content="#21243 Easy demo recording" property=og:title><meta content="A personal blog built with Zola and Apollo theme" property=og:description><meta content="A personal blog built with Zola and Apollo theme" name=description><link href=/icons/favicon.png rel=icon type=image/png><link href=https://unknownue.github.io/fonts.css rel=stylesheet><script src=https://unknownue.github.io/js/codeblock.js></script><script src=https://unknownue.github.io/js/toc.js></script><script src=https://unknownue.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Unknownue's Blog" href=https://unknownue.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://unknownue.github.io/theme/light.css rel=stylesheet><link href=https://unknownue.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://unknownue.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://unknownue.github.io/main.css media=screen rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js></script><script>// Initialize mermaid once DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            mermaid.initialize({
                startOnLoad: false,
                theme: document.body && document.body.classList.contains('dark') ? 'dark' : 'default',
                securityLevel: 'loose',
                flowchart: {
                    useMaxWidth: true,
                    htmlLabels: true
                },
                sequence: {
                    diagramMarginX: 50,
                    diagramMarginY: 10,
                    actorMargin: 50,
                    width: 150,
                    height: 65
                }
            });
        });</script><script src=https://unknownue.github.io/js/main.js></script><script defer src=https://unknownue.github.io/js/label-colors.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/rust.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/typescript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/go.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/cpp.min.js></script><script>// Ensure highlight.js is properly configured
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof hljs !== 'undefined') {
                hljs.configure({
                    languages: ['rust', 'javascript', 'python', 'cpp', 'go', 'typescript'],
                    ignoreUnescapedHTML: true
                });
                console.log('Highlight.js configured in header');
            }
        });</script><link href=https://cdn.jsdelivr.net/npm/diff2html/bundles/css/diff2html.min.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/diff2html/bundles/js/diff2html-ui.min.js></script><script src=https://unknownue.github.io/js/syntax-highlight.js></script><script src=https://unknownue.github.io/js/diff-sidebar.js></script><script src="https://unknownue.github.io/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><div class=content><header><div class=main><a href=https://unknownue.github.io>Unknownue's Blog</a><div class=socials><a class=social href=https://github.com/unknownue rel=me> <img alt=github src=https://unknownue.github.io/icons/social/github.svg> </a><a class=social href=https://github.com/unknownue/unknownue.github.io rel=me> <img alt=github-io src=https://unknownue.github.io/icons/social/rss.svg> </a></div></div><nav><a href=https://unknownue.github.io/posts style=margin-left:.25em>/posts</a><a href=https://unknownue.github.io/projects style=margin-left:.25em>/projects</a><a href=https://unknownue.github.io/about style=margin-left:.25em>/about</a><a href=https://unknownue.github.io/tags style=margin-left:.25em>/tags</a><button title="$SHORTCUT to open search" class=search-button id=search-button><img alt=Search class=search-icon src=https://unknownue.github.io/icons/search.svg></button><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><div id=modal-content><h1 class=page-header id=modalTitle>Search</h1><div id=searchBar><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search... role=combobox spellcheck=false><button title="Clear search" class=clear-button id=clear-search><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></button></div><div id=results-container><div id=results-info><span id=zero_results style=display:none>No results</span><span id=one_result style=display:none>1 result</span><span id=many_results style=display:none>$NUMBER results</span></div><div id=results role=listbox></div></div></div></div><a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://unknownue.github.io/icons/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://unknownue.github.io/icons/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><div class=pull-request-page><article class=md-content-page style=display:none></article><div class=back-link><a href=/pull_request/bevy/2025-12/>← Back to Pull Requests</a></div><div class=pr-metadata><span class=pr-date>2025-12-16</span><div class=language-switcher><span class="lang-link active" data-lang=en>English</span> / <a class=lang-link data-lang=zh-cn href=/pull_request/bevy/2025-12/pr-21243-zh-cn-20251216>中文</a></div></div><div class=pr-content><h1 id=easy-demo-recording>Easy demo recording</h1><h2 id=basic-information>Basic Information</h2><ul><li><strong>Title</strong>: Easy demo recording<li><strong>PR Link</strong>: https://github.com/bevyengine/bevy/pull/21243<li><strong>Author</strong>: mockersf<li><strong>Status</strong>: MERGED<li><strong>Labels</strong>: C-Feature, S-Ready-For-Final-Review, M-Release-Note, A-Dev-Tools<li><strong>Created</strong>: 2025-09-27T13:48:58Z<li><strong>Merged</strong>: 2025-12-16T04:10:51Z<li><strong>Merged By</strong>: cart</ul><h2 id=description-translation>Description Translation</h2><h1 id=objective>Objective</h1><ul><li>Followup on #21237<li>It can be hard to share how to record a demo for a specific feature<li>Make it easy</ul><h2 id=solution>Solution</h2><ul><li>Add a dev plugin that can move the camera<li>Add plumbing to CI testing to be able to move the camera and control screen recording<li>Demo can be configured in code or in a configuration file</ul><h2 id=testing>Testing</h2><ul><li>Add to an example:</ul><pre class=language-rs data-lang=rs style=color:#61676c;background-color:#fafafa><code class=language-rs data-lang=rs><span style=color:#fa6e32>let</span><span> fps </span><span style=color:#ed9366>= </span><span style=color:#ff8f40>120</span><span style=color:#61676ccc>; </span><span style=color:#abb0b6;font-style:italic>// FPS for the example on your computer
</span><span>
</span><span>[</span><span style=color:#ed9366>...</span><span>]
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// Before `DefaultPlugins`:
</span><span>        </span><span style=color:#ed9366>.</span><span style=color:#f07171>insert_resource</span><span>(CiTestingConfig {
</span><span>            events</span><span style=color:#61676ccc>: </span><span style=color:#f07171>vec!</span><span>[
</span><span>                CiTestingEventOnFrame(fps </span><span style=color:#ed9366>* </span><span style=color:#ff8f40>1</span><span style=color:#61676ccc>, </span><span>ci_testing</span><span style=color:#ed9366>::</span><span>CiTestingEvent</span><span style=color:#ed9366>::</span><span>StartScreenRecording)</span><span style=color:#61676ccc>,
</span><span>                {
</span><span>                    </span><span style=color:#fa6e32>let</span><span> transform </span><span style=color:#ed9366>= </span><span>Transform</span><span style=color:#ed9366>::</span><span>from_xyz(</span><span style=color:#ff8f40>0.7</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>0.7</span><span style=color:#61676ccc>, </span><span style=color:#ed9366>-</span><span style=color:#ff8f40>1.0</span><span>)
</span><span>                        </span><span style=color:#ed9366>.</span><span style=color:#f07171>looking_at</span><span>(Vec3</span><span style=color:#ed9366>::</span><span>new(</span><span style=color:#ff8f40>0.0</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>0.3</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>0.0</span><span>)</span><span style=color:#61676ccc>, </span><span>Vec3</span><span style=color:#ed9366>::</span><span>Y)</span><span style=color:#61676ccc>;
</span><span>                    CiTestingEventOnFrame(
</span><span>                        fps </span><span style=color:#ed9366>* </span><span style=color:#ff8f40>6</span><span style=color:#61676ccc>,
</span><span>                        ci_testing</span><span style=color:#ed9366>::</span><span>CiTestingEvent</span><span style=color:#ed9366>::</span><span>MoveCamera {
</span><span>                            translation</span><span style=color:#61676ccc>:</span><span> transform</span><span style=color:#ed9366>.</span><span>translation</span><span style=color:#61676ccc>,
</span><span>                            rotation</span><span style=color:#61676ccc>:</span><span> transform</span><span style=color:#ed9366>.</span><span>rotation</span><span style=color:#61676ccc>,
</span><span>                        }</span><span style=color:#61676ccc>,
</span><span>                    )
</span><span>                }</span><span style=color:#61676ccc>,
</span><span>                {
</span><span>                    </span><span style=color:#fa6e32>let</span><span> transform </span><span style=color:#ed9366>= </span><span>Transform</span><span style=color:#ed9366>::</span><span>from_xyz(</span><span style=color:#ed9366>-</span><span style=color:#ff8f40>0.7</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>0.7</span><span style=color:#61676ccc>, </span><span style=color:#ed9366>-</span><span style=color:#ff8f40>1.0</span><span>)
</span><span>                        </span><span style=color:#ed9366>.</span><span style=color:#f07171>looking_at</span><span>(Vec3</span><span style=color:#ed9366>::</span><span>new(</span><span style=color:#ff8f40>0.0</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>0.3</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>0.0</span><span>)</span><span style=color:#61676ccc>, </span><span>Vec3</span><span style=color:#ed9366>::</span><span>Y)</span><span style=color:#61676ccc>;
</span><span>                    CiTestingEventOnFrame(
</span><span>                        fps </span><span style=color:#ed9366>* </span><span style=color:#ff8f40>11</span><span style=color:#61676ccc>,
</span><span>                        ci_testing</span><span style=color:#ed9366>::</span><span>CiTestingEvent</span><span style=color:#ed9366>::</span><span>MoveCamera {
</span><span>                            translation</span><span style=color:#61676ccc>:</span><span> transform</span><span style=color:#ed9366>.</span><span>translation</span><span style=color:#61676ccc>,
</span><span>                            rotation</span><span style=color:#61676ccc>:</span><span> transform</span><span style=color:#ed9366>.</span><span>rotation</span><span style=color:#61676ccc>,
</span><span>                        }</span><span style=color:#61676ccc>,
</span><span>                    )
</span><span>                }</span><span style=color:#61676ccc>,
</span><span>                {
</span><span>                    </span><span style=color:#fa6e32>let</span><span> transform </span><span style=color:#ed9366>= </span><span>Transform</span><span style=color:#ed9366>::</span><span>from_xyz(</span><span style=color:#ed9366>-</span><span style=color:#ff8f40>0.7</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>0.7</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>1.0</span><span>)
</span><span>                        </span><span style=color:#ed9366>.</span><span style=color:#f07171>looking_at</span><span>(Vec3</span><span style=color:#ed9366>::</span><span>new(</span><span style=color:#ff8f40>0.0</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>0.3</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>0.0</span><span>)</span><span style=color:#61676ccc>, </span><span>Vec3</span><span style=color:#ed9366>::</span><span>Y)</span><span style=color:#61676ccc>;
</span><span>                    CiTestingEventOnFrame(
</span><span>                        fps </span><span style=color:#ed9366>* </span><span style=color:#ff8f40>16</span><span style=color:#61676ccc>,
</span><span>                        ci_testing</span><span style=color:#ed9366>::</span><span>CiTestingEvent</span><span style=color:#ed9366>::</span><span>MoveCamera {
</span><span>                            translation</span><span style=color:#61676ccc>:</span><span> transform</span><span style=color:#ed9366>.</span><span>translation</span><span style=color:#61676ccc>,
</span><span>                            rotation</span><span style=color:#61676ccc>:</span><span> transform</span><span style=color:#ed9366>.</span><span>rotation</span><span style=color:#61676ccc>,
</span><span>                        }</span><span style=color:#61676ccc>,
</span><span>                    )
</span><span>                }</span><span style=color:#61676ccc>,
</span><span>                {
</span><span>                    </span><span style=color:#fa6e32>let</span><span> transform </span><span style=color:#ed9366>= </span><span>Transform</span><span style=color:#ed9366>::</span><span>from_xyz(</span><span style=color:#ff8f40>0.7</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>0.7</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>1.0</span><span>)
</span><span>                        </span><span style=color:#ed9366>.</span><span style=color:#f07171>looking_at</span><span>(Vec3</span><span style=color:#ed9366>::</span><span>new(</span><span style=color:#ff8f40>0.0</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>0.3</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>0.0</span><span>)</span><span style=color:#61676ccc>, </span><span>Vec3</span><span style=color:#ed9366>::</span><span>Y)</span><span style=color:#61676ccc>;
</span><span>                    CiTestingEventOnFrame(
</span><span>                        fps </span><span style=color:#ed9366>* </span><span style=color:#ff8f40>21</span><span style=color:#61676ccc>,
</span><span>                        ci_testing</span><span style=color:#ed9366>::</span><span>CiTestingEvent</span><span style=color:#ed9366>::</span><span>MoveCamera {
</span><span>                            translation</span><span style=color:#61676ccc>:</span><span> transform</span><span style=color:#ed9366>.</span><span>translation</span><span style=color:#61676ccc>,
</span><span>                            rotation</span><span style=color:#61676ccc>:</span><span> transform</span><span style=color:#ed9366>.</span><span>rotation</span><span style=color:#61676ccc>,
</span><span>                        }</span><span style=color:#61676ccc>,
</span><span>                    )
</span><span>                }</span><span style=color:#61676ccc>,
</span><span>                CiTestingEventOnFrame(fps </span><span style=color:#ed9366>* </span><span style=color:#ff8f40>26</span><span style=color:#61676ccc>, </span><span>ci_testing</span><span style=color:#ed9366>::</span><span>CiTestingEvent</span><span style=color:#ed9366>::</span><span>StopScreenRecording)</span><span style=color:#61676ccc>,
</span><span>            ]</span><span style=color:#61676ccc>,
</span><span>            </span><span style=color:#ed9366>..</span><span style=color:#f07171>default</span><span>()
</span><span>        })
</span></code></pre><ul><li>Run the example with <code>--features bevy_internal/screenrecording,bevy_ci_testing</code><li>Lay back, enjoy your demo recording</ul><hr><h2 id=showcase>Showcase</h2><p>https://github.com/user-attachments/assets/bbd9e56d-58c1-41eb-b6b4-1f1db2f2dab5<h2 id=the-story-of-this-pull-request>The Story of This Pull Request</h2><p>This PR addresses a practical problem in Bevy’s development workflow: creating demo recordings for features or examples was previously cumbersome and required manual intervention. The solution extends Bevy’s existing CI testing infrastructure to provide automated camera movement and screen recording capabilities, making it easier to create polished demonstration videos.<h3 id=the-problem-and-context>The Problem and Context</h3><p>Before this PR, creating demo videos for Bevy examples or features involved manual screen recording and camera manipulation. This was time-consuming, inconsistent, and difficult to share or reproduce. The existing CI testing framework (<code>bevy_ci_testing</code>) already provided some automation for screenshots and controlled exits, but it lacked camera control and screen recording capabilities.<p>The PR builds on previous work in #21237, which added screen recording functionality. However, that work alone didn’t provide a way to script camera movements or integrate with the CI testing system.<h3 id=the-solution-approach>The Solution Approach</h3><p>The approach taken is to extend the existing CI testing configuration system with new event types for camera movement and screen recording control. This leverages the existing event-driven architecture where specific actions can be scheduled to occur at particular frames. The implementation adds:<ol><li>New event types in the CI testing configuration<li>A camera movement plugin that smoothly interpolates camera positions<li>Integration logic to automatically add the necessary plugins when their features are needed<li>Support for both programmatic configuration (in code) and file-based configuration</ol><p>This design choice makes sense because it builds on established patterns in Bevy’s CI testing system rather than creating a separate, parallel system. Users familiar with the existing CI testing configuration can easily adapt to the new features.<h3 id=the-implementation>The Implementation</h3><p>The implementation adds three new event types to the <code>CiTestingEvent</code> enum:<ul><li><code>StartScreenRecording</code> and <code>StopScreenRecording</code> for controlling screen capture<li><code>MoveCamera</code> with translation and rotation parameters for camera positioning</ul><p>The <code>CiTestingPlugin</code> was modified to conditionally load the <code>EasyCameraMovementPlugin</code> and <code>EasyScreenRecordPlugin</code> based on whether the configuration requires them. This is a smart optimization that avoids adding unnecessary systems when they’re not needed.<p>One interesting implementation detail is how the plugin checks if a resource is already added:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#fa6e32>if </span><span style=color:#ed9366>!</span><span>app</span><span style=color:#ed9366>.</span><span style=color:#f07171>world</span><span>()</span><span style=color:#ed9366>.</span><span>is_resource_added</span><span style=color:#ed9366>::</span><span>&LTCiTestingConfig>() {
</span><span>    </span><span style=color:#abb0b6;font-style:italic>// Load configuration from file
</span><span>} </span><span style=color:#fa6e32>else </span><span>{
</span><span>    app</span><span style=color:#ed9366>.</span><span style=color:#f07171>world</span><span>()</span><span style=color:#ed9366>.</span><span>resource</span><span style=color:#ed9366>::</span><span>&LTCiTestingConfig>()</span><span style=color:#ed9366>.</span><span style=color:#f07171>clone</span><span>()
</span><span>}
</span></code></pre><p>This allows users to either provide configuration through a file or programmatically insert the <code>CiTestingConfig</code> resource before the plugin runs.<p>The camera movement system uses exponential smoothing (via <code>smooth_nudge</code>) to create fluid camera transitions:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span>query</span><span style=color:#ed9366>.</span><span style=color:#ff8f40>0.</span><span>translation</span><span style=color:#ed9366>.</span><span style=color:#f07171>smooth_nudge</span><span>(
</span><span>    </span><span style=color:#ed9366>&</span><span>target</span><span style=color:#ed9366>.</span><span>translation</span><span style=color:#61676ccc>,
</span><span>    decay_rate</span><span style=color:#61676ccc>,
</span><span>    time</span><span style=color:#ed9366>.</span><span style=color:#f07171>delta_secs</span><span>()</span><span style=color:#61676ccc>,
</span><span>)</span><span style=color:#61676ccc>;
</span></code></pre><p>This produces professional-looking camera movements without abrupt jumps.<h3 id=technical-insights>Technical Insights</h3><p>The implementation demonstrates several good engineering practices:<ol><li><p><strong>Conditional Plugin Loading</strong>: The system only adds the screen recording plugin if the configuration actually contains screen recording events. This minimizes overhead when the feature isn’t needed.</p><li><p><strong>Smooth Interpolation</strong>: The camera movement uses mathematical interpolation rather than instant teleportation, which produces more natural-looking demos.</p><li><p><strong>Backward Compatibility</strong>: The changes extend existing structures with new variants and <code>Clone</code> implementations without breaking existing functionality.</p><li><p><strong>Flexible Configuration</strong>: Supporting both file-based and programmatic configuration gives users flexibility in how they define their demos.</p></ol><p>One potential limitation is that the camera movement system assumes there’s exactly one camera in the scene (<code>world.query_filtered::&LTEntity, With&LTCamera>>().single(world)</code>). This works for simple examples but might need extension for more complex scenes with multiple cameras.<h3 id=the-impact>The Impact</h3><p>This PR significantly improves Bevy’s documentation and demonstration capabilities. Developers can now create reproducible, scripted demos that showcase features from specific camera angles and with professional transitions. This is particularly valuable for:<ol><li><strong>Documentation</strong>: Creating consistent demo videos for examples<li><strong>Marketing</strong>: Producing high-quality feature showcases<li><strong>Testing</strong>: Automated visual testing with controlled camera positions<li><strong>Education</strong>: Creating tutorial content with scripted camera movements</ol><p>The feature is opt-in through feature flags (<code>bevy_internal/screenrecording</code> and <code>bevy_ci_testing</code>), so it doesn’t affect users who don’t need it. The integration with the existing CI testing system means there’s minimal new API surface to learn for developers already using those tools.<h2 id=visual-representation>Visual Representation</h2><pre class=language-mermaid data-lang=mermaid style=color:#61676c;background-color:#fafafa><code class=language-mermaid data-lang=mermaid><span>graph TD
</span><span>    A[CiTestingConfig] -->|contains| B[CiTestingEventOnFrame list]
</span><span>    B -->|each has| C[Frame number + CiTestingEvent]
</span><span>    C -->|can be| D[StartScreenRecording]
</span><span>    C -->|can be| E[StopScreenRecording]
</span><span>    C -->|can be| F[MoveCamera with transform]
</span><span>    G[CiTestingPlugin] -->|conditionally adds| H[EasyCameraMovementPlugin]
</span><span>    G -->|conditionally adds| I[EasyScreenRecordPlugin]
</span><span>    H -->|adds system| J[Camera movement system]
</span><span>    J -->|reads| K[CameraMovement component]
</span><span>    F -->|adds| K[CameraMovement component]
</span><span>    D -->|triggers| L[Screen recording start]
</span><span>    E -->|triggers| M[Screen recording stop]
</span></code></pre><h2 id=key-files-changed>Key Files Changed</h2><h3 id=1-crates-bevy-dev-tools-src-ci-testing-config-rs>1. <code>crates/bevy_dev_tools/src/ci_testing/config.rs</code></h3><p>Added new event types and made configuration structs cloneable to support programmatic configuration.<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before:
</span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>derive</span><span>(Deserialize</span><span style=color:#61676ccc>,</span><span> PartialEq</span><span style=color:#61676ccc>,</span><span> Debug)]
</span><span style=color:#fa6e32>pub enum </span><span style=color:#399ee6>CiTestingEvent </span><span>{
</span><span>    Screenshot</span><span style=color:#61676ccc>,
</span><span>    AppExit</span><span style=color:#61676ccc>,
</span><span>    Custom(</span><span style=color:#55b4d4;font-style:italic>String</span><span>)</span><span style=color:#61676ccc>,
</span><span>}
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After:
</span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>derive</span><span>(Deserialize</span><span style=color:#61676ccc>,</span><span> PartialEq</span><span style=color:#61676ccc>,</span><span> Debug</span><span style=color:#61676ccc>,</span><span> Clone)]
</span><span style=color:#fa6e32>pub enum </span><span style=color:#399ee6>CiTestingEvent </span><span>{
</span><span>    Screenshot</span><span style=color:#61676ccc>,
</span><span>    AppExit</span><span style=color:#61676ccc>,
</span><span>    StartScreenRecording</span><span style=color:#61676ccc>,
</span><span>    StopScreenRecording</span><span style=color:#61676ccc>,
</span><span>    MoveCamera {
</span><span>        translation</span><span style=color:#61676ccc>:</span><span> Vec3</span><span style=color:#61676ccc>,
</span><span>        rotation</span><span style=color:#61676ccc>:</span><span> Quat</span><span style=color:#61676ccc>,
</span><span>    }</span><span style=color:#61676ccc>,
</span><span>    Custom(</span><span style=color:#55b4d4;font-style:italic>String</span><span>)</span><span style=color:#61676ccc>,
</span><span>}
</span></code></pre><h3 id=2-crates-bevy-dev-tools-src-ci-testing-mod-rs>2. <code>crates/bevy_dev_tools/src/ci_testing/mod.rs</code></h3><p>Modified the plugin to conditionally add camera movement and screen recording plugins based on configuration needs.<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Key addition: Conditional plugin loading
</span><span style=color:#fa6e32>if </span><span style=color:#ed9366>!</span><span>app</span><span style=color:#ed9366>.</span><span>is_plugin_added</span><span style=color:#ed9366>::</span><span>&LTEasyCameraMovementPlugin>() {
</span><span>    app</span><span style=color:#ed9366>.</span><span style=color:#f07171>add_plugins</span><span>(EasyCameraMovementPlugin</span><span style=color:#ed9366>::</span><span>default())</span><span style=color:#61676ccc>;
</span><span>}
</span><span>
</span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>cfg</span><span>(feature </span><span style=color:#ed9366>= </span><span style=color:#86b300>"screenrecording"</span><span>)]
</span><span style=color:#fa6e32>if </span><span style=color:#ed9366>!</span><span>app</span><span style=color:#ed9366>.</span><span>is_plugin_added</span><span style=color:#ed9366>::</span><span>&LTEasyScreenRecordPlugin>()
</span><span>    </span><span style=color:#ed9366>&&</span><span> config
</span><span>        </span><span style=color:#ed9366>.</span><span>events
</span><span>        </span><span style=color:#ed9366>.</span><span style=color:#f07171>iter</span><span>()
</span><span>        </span><span style=color:#ed9366>.</span><span style=color:#f07171>any</span><span>(|</span><span style=color:#ff8f40>e</span><span>| </span><span style=color:#f07171>matches!</span><span>(e</span><span style=color:#ed9366>.</span><span style=color:#ff8f40>1</span><span style=color:#61676ccc>, </span><span>CiTestingEvent</span><span style=color:#ed9366>::</span><span>StartScreenRecording))
</span><span>{
</span><span>    app</span><span style=color:#ed9366>.</span><span style=color:#f07171>add_plugins</span><span>(EasyScreenRecordPlugin</span><span style=color:#ed9366>::</span><span>default())</span><span style=color:#61676ccc>;
</span><span>}
</span></code></pre><h3 id=3-crates-bevy-dev-tools-src-ci-testing-systems-rs>3. <code>crates/bevy_dev_tools/src/ci_testing/systems.rs</code></h3><p>Added handling for the new event types in the event processing system.<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Handling MoveCamera event:
</span><span>CiTestingEvent</span><span style=color:#ed9366>::</span><span>MoveCamera {
</span><span>    translation</span><span style=color:#61676ccc>,
</span><span>    rotation</span><span style=color:#61676ccc>,
</span><span>} </span><span style=color:#ed9366>=> </span><span>{
</span><span>    </span><span style=color:#f07171>info!</span><span>(</span><span style=color:#86b300>"Moved camera at frame {}."</span><span style=color:#61676ccc>, </span><span style=color:#ed9366>*</span><span>current_frame)</span><span style=color:#61676ccc>;
</span><span>    </span><span style=color:#fa6e32>if let </span><span style=color:#55b4d4;font-style:italic>Ok</span><span>(camera) </span><span style=color:#ed9366>=</span><span> world</span><span style=color:#ed9366>.</span><span>query_filtered</span><span style=color:#ed9366>::</span><span>&LTEntity, With&LTCamera>>()</span><span style=color:#ed9366>.</span><span style=color:#f07171>single</span><span>(world) {
</span><span>        world</span><span style=color:#ed9366>.</span><span style=color:#f07171>entity_mut</span><span>(camera)</span><span style=color:#ed9366>.</span><span style=color:#f07171>insert</span><span>(CameraMovement {
</span><span>            translation</span><span style=color:#61676ccc>,
</span><span>            rotation</span><span style=color:#61676ccc>,
</span><span>        })</span><span style=color:#61676ccc>;
</span><span>    }
</span><span>}
</span></code></pre><h3 id=4-crates-bevy-dev-tools-src-easy-screenshot-rs>4. <code>crates/bevy_dev_tools/src/easy_screenshot.rs</code></h3><p>Added the new <code>EasyCameraMovementPlugin</code> and <code>CameraMovement</code> component for smooth camera transitions.<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>/// Plugin to move the camera smoothly according to the current time
</span><span style=color:#fa6e32>pub struct </span><span style=color:#399ee6>EasyCameraMovementPlugin </span><span>{
</span><span>    </span><span style=color:#abb0b6;font-style:italic>/// Decay rate for the camera movement
</span><span>    </span><span style=color:#fa6e32>pub </span><span>decay_rate</span><span style=color:#61676ccc>: </span><span style=color:#fa6e32>f32</span><span>,
</span><span>}
</span><span>
</span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>derive</span><span>(Component)]
</span><span style=color:#fa6e32>pub struct </span><span style=color:#399ee6>CameraMovement </span><span>{
</span><span>    </span><span style=color:#abb0b6;font-style:italic>/// Target position for the camera movement
</span><span>    </span><span style=color:#fa6e32>pub </span><span>translation</span><span style=color:#61676ccc>:</span><span> Vec3,
</span><span>    </span><span style=color:#abb0b6;font-style:italic>/// Target rotation for the camera movement
</span><span>    </span><span style=color:#fa6e32>pub </span><span>rotation</span><span style=color:#61676ccc>:</span><span> Quat,
</span><span>}
</span></code></pre><h3 id=5-crates-bevy-dev-tools-cargo-toml>5. <code>crates/bevy_dev_tools/Cargo.toml</code></h3><p>Added <code>bevy_transform</code> dependency to support camera transform operations.<pre class=language-toml data-lang=toml style=color:#61676c;background-color:#fafafa><code class=language-toml data-lang=toml><span style=color:#399ee6>bevy_transform </span><span>= { </span><span style=color:#399ee6>path </span><span>= </span><span style=color:#86b300>"../bevy_transform"</span><span style=color:#61676ccc>, </span><span style=color:#399ee6>version </span><span>= </span><span style=color:#86b300>"0.18.0-dev" </span><span>}
</span></code></pre><h2 id=further-reading>Further Reading</h2><ol><li><p><strong>Bevy’s Plugin System</strong>: Understanding how plugins work in Bevy is essential for extending functionality like this. The official Bevy book covers this: https://bevyengine.org/learn/book/getting-started/plugins/</p><li><p><strong>Exponential Smoothing</strong>: The camera movement uses exponential smoothing. For more on smoothing techniques in game development: https://gafferongames.com/post/integration_basics/</p><li><p><strong>Event-Driven Architecture</strong>: This PR extends Bevy’s event-driven CI testing system. For more on event systems in game engines: https://gameprogrammingpatterns.com/event-queue.html</p><li><p><strong>Conditional Compilation in Rust</strong>: The use of <code>#[cfg(feature = "screenrecording")]</code> demonstrates Rust’s conditional compilation features. The Rust book covers this: https://doc.rust-lang.org/cargo/reference/features.html</p><li><p><strong>Previous PR #21237</strong>: Understanding the screen recording functionality that this PR builds upon: https://github.com/bevyengine/bevy/pull/21237</p></ol></div><div data-is-md-page=true data-patch-exists=true data-patch-path=/pull_request/bevy/2025-12/pr_21243.patch id=patch-info style=display:none></div><div class=bottom-spacer></div></div></div>