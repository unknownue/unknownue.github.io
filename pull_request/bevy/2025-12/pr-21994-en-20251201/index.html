<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://unknownue.github.io name=base><title>
         #21994 Update criterion requirement from 0.7.0 to 0.8.0
        
    </title><meta content="#21994 Update criterion requirement from 0.7.0 to 0.8.0" property=og:title><meta content="A personal blog built with Zola and Apollo theme" property=og:description><meta content="A personal blog built with Zola and Apollo theme" name=description><link href=/icons/favicon.png rel=icon type=image/png><link href=https://unknownue.github.io/fonts.css rel=stylesheet><script src=https://unknownue.github.io/js/codeblock.js></script><script src=https://unknownue.github.io/js/toc.js></script><script src=https://unknownue.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Unknownue's Blog" href=https://unknownue.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://unknownue.github.io/theme/light.css rel=stylesheet><link href=https://unknownue.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://unknownue.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://unknownue.github.io/main.css media=screen rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js></script><script>// Initialize mermaid once DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            mermaid.initialize({
                startOnLoad: false,
                theme: document.body && document.body.classList.contains('dark') ? 'dark' : 'default',
                securityLevel: 'loose',
                flowchart: {
                    useMaxWidth: true,
                    htmlLabels: true
                },
                sequence: {
                    diagramMarginX: 50,
                    diagramMarginY: 10,
                    actorMargin: 50,
                    width: 150,
                    height: 65
                }
            });
        });</script><script src=https://unknownue.github.io/js/main.js></script><script defer src=https://unknownue.github.io/js/label-colors.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/rust.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/typescript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/go.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/cpp.min.js></script><script>// Ensure highlight.js is properly configured
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof hljs !== 'undefined') {
                hljs.configure({
                    languages: ['rust', 'javascript', 'python', 'cpp', 'go', 'typescript'],
                    ignoreUnescapedHTML: true
                });
                console.log('Highlight.js configured in header');
            }
        });</script><link href=https://cdn.jsdelivr.net/npm/diff2html/bundles/css/diff2html.min.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/diff2html/bundles/js/diff2html-ui.min.js></script><script src=https://unknownue.github.io/js/syntax-highlight.js></script><script src=https://unknownue.github.io/js/diff-sidebar.js></script><script src="https://unknownue.github.io/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><div class=content><header><div class=main><a href=https://unknownue.github.io>Unknownue's Blog</a><div class=socials><a class=social href=https://github.com/unknownue rel=me> <img alt=github src=https://unknownue.github.io/icons/social/github.svg> </a><a class=social href=https://github.com/unknownue/unknownue.github.io rel=me> <img alt=github-io src=https://unknownue.github.io/icons/social/rss.svg> </a></div></div><nav><a href=https://unknownue.github.io/posts style=margin-left:.25em>/posts</a><a href=https://unknownue.github.io/projects style=margin-left:.25em>/projects</a><a href=https://unknownue.github.io/about style=margin-left:.25em>/about</a><a href=https://unknownue.github.io/tags style=margin-left:.25em>/tags</a><button title="$SHORTCUT to open search" class=search-button id=search-button><img alt=Search class=search-icon src=https://unknownue.github.io/icons/search.svg></button><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><div id=modal-content><h1 class=page-header id=modalTitle>Search</h1><div id=searchBar><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search... role=combobox spellcheck=false><button title="Clear search" class=clear-button id=clear-search><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></button></div><div id=results-container><div id=results-info><span id=zero_results style=display:none>No results</span><span id=one_result style=display:none>1 result</span><span id=many_results style=display:none>$NUMBER results</span></div><div id=results role=listbox></div></div></div></div><a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://unknownue.github.io/icons/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://unknownue.github.io/icons/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><div class=pull-request-page><article class=md-content-page style=display:none></article><div class=back-link><a href=/pull_request/bevy/2025-12/>← Back to Pull Requests</a></div><div class=pr-metadata><span class=pr-date>2025-12-01</span><div class=language-switcher><span class="lang-link active" data-lang=en>English</span> / <a class=lang-link data-lang=zh-cn href=/pull_request/bevy/2025-12/pr-21994-zh-cn-20251201>中文</a></div></div><div class=pr-content><h1 id=title>Title</h1><p>Update criterion requirement from 0.7.0 to 0.8.0<h2 id=basic-information>Basic Information</h2><ul><li><strong>Title</strong>: Update criterion requirement from 0.7.0 to 0.8.0<li><strong>PR Link</strong>: https://github.com/bevyengine/bevy/pull/21994<li><strong>Author</strong>: app/dependabot<li><strong>Status</strong>: MERGED<li><strong>Labels</strong>: C-Dependencies<li><strong>Created</strong>: 2025-12-01T06:35:18Z<li><strong>Merged</strong>: 2025-12-01T07:26:13Z<li><strong>Merged By</strong>: mockersf</ul><h2 id=description-translation>Description Translation</h2><p>Updates the requirements on <a rel="noopener nofollow noreferrer" href=https://github.com/criterion-rs/criterion.rs target=_blank>criterion</a> to permit the latest version.<details><summary>Changelog</summary> <p><em>Sourced from <a href=https://github.com/criterion-rs/criterion.rs/blob/master/CHANGELOG.md>criterion's changelog</a>.</em></p> <blockquote><h2><a href=https://github.com/criterion-rs/criterion.rs/compare/criterion-v0.7.0...criterion-v0.8.0>0.8.0</a> - 2025-11-29</h2><h3>BREAKING</h3><ul><li>Drop async-std support</ul><h3>Changed</h3><ul><li>Bump MSRV to 1.86, stable to 1.91.1</ul><h3>Added</h3><ul><li>Add ability to plot throughput on summary page.<li>Add support for reporting throughput in elements and bytes - <code>Throughput::ElementsAndBytes</code> allows the text summary to report throughput in both units simultaneously.<li>Add alloca-based memory layout randomisation to mitigate memory effects on measurements.<li>Add doc comment to benchmark runner in criterion_group macro (removes linter warnings)</ul><h3>Fixed</h3><ul><li>Fix plotting NaN bug</ul><h3>Other</h3><ul><li>Remove Master API Docs links temporarily while we restore the docs publishing.</ul><h2>[0.7.0] - 2025-07-25</h2><ul><li>Bump version of criterion-plot to align dependencies.</ul><h2>[0.6.0] - 2025-05-17</h2><h3>Changed</h3><ul><li>MSRV bumped to 1.80<li>The <code>real_blackbox</code> feature no longer has any impact. Criterion always uses <code>std::hint::black_box()</code> now. Users of <code>criterion::black_box()</code> should switch to <code>std::hint::black_box()</code>.<li><code>clap</code> dependency unpinned.</ul><h3>Fixed</h3><ul><li>gnuplot version is now correctly detected when using certain Windows binaries/configurations that used to fail</ul><h3>Added</h3><ul><li>Async benchmarking with Tokio may be done via a <code>tokio::runtime::Handle</code>, not only a <code>tokio::runtime::Runtime</code></ul><h2>[0.5.1] - 2023-05-26</h2><h3>Fixed</h3><ul><li>Quick mode (--quick) no longer crashes with measured times over 5 seconds when --noplot is not active</ul><h2>[0.5.0] - 2023-05-23</h2></blockquote> <p>... (truncated)</p></details><details><summary>Commits</summary> <ul><li><a href=https://github.com/criterion-rs/criterion.rs/commit/b49ade728c064f49cb2a70b0368658a15cf21833><code>b49ade7</code></a> chore: release v0.8.0<li>See full diff in <a href=https://github.com/criterion-rs/criterion.rs/compare/criterion-plot-v0.7.0...criterion-v0.8.0>compare view</a></ul></details><br><p>Dependabot will resolve any conflicts with this PR as long as you don’t alter it yourself. You can also trigger a rebase manually by commenting <code>@dependabot rebase</code>.<hr><details><summary>Dependabot commands and options</summary> <br> <p>You can trigger Dependabot actions by commenting on this PR:</p> <ul><li><code>@dependabot rebase</code> will rebase this PR<li><code>@dependabot recreate</code> will recreate this PR, overwriting any edits that have been made to it<li><code>@dependabot merge</code> will merge this PR after your CI passes on it<li><code>@dependabot squash and merge</code> will squash and merge this PR after your CI passes on it<li><code>@dependabot cancel merge</code> will cancel a previously requested merge and block automerging<li><code>@dependabot reopen</code> will reopen this PR if it is closed<li><code>@dependabot close</code> will close this PR and stop Dependabot recreating it. You can achieve the same result by closing it manually<li><code>@dependabot show &LTdependency name> ignore conditions</code> will show all of the ignore conditions of the specified dependency<li><code>@dependabot ignore this major version</code> will close this PR and stop Dependabot creating any more for this major version (unless you reopen the PR or upgrade to it yourself)<li><code>@dependabot ignore this minor version</code> will close this PR and stop Dependabot creating any more for this minor version (unless you reopen the PR or upgrade to it yourself)<li><code>@dependabot ignore this dependency</code> will close this PR and stop Dependabot creating any more for this dependency (unless you reopen the PR or upgrade to it yourself)</ul></details><h2 id=the-story-of-this-pull-request>The Story of This Pull Request</h2><p>This PR is a routine dependency update that follows the standard process for maintaining a Rust project’s dependencies. Dependabot, an automated dependency management tool, detected that a newer version of the criterion benchmarking library was available and created this PR to update the dependency specification.<p>The core change is straightforward: updating the criterion dependency version from 0.7.0 to 0.8.0 in the <code>benches/Cargo.toml</code> file. This is a minor version bump according to semantic versioning, which typically indicates backward-compatible new functionality. However, the changelog reveals that this version includes some breaking changes, most notably the removal of async-std support and an increase in the minimum supported Rust version (MSRV) to 1.86.<p>For Bevy’s benchmarking setup, the removal of async-std support is not problematic because Bevy doesn’t use async-std for its benchmarking. The MSRV bump is more significant because it requires Rust 1.86 or newer for building and running benchmarks. This aligns with Rust’s typical release cycle where dependencies gradually increase their minimum requirements as new language features become stable and widely adopted.<p>The criterion 0.8.0 release brings several improvements that benefit Bevy’s benchmarking workflow. The addition of throughput plotting on the summary page and the new <code>Throughput::ElementsAndBytes</code> enum variant allows benchmarks to report throughput in multiple units simultaneously. This is particularly useful for graphics and game engine benchmarks where operations might be measured both in terms of elements processed and bytes transferred.<p>Another notable improvement is the alloca-based memory layout randomization, which helps mitigate memory effects on measurements. This addresses a common issue in microbenchmarking where memory alignment and layout can introduce measurement noise. By randomizing memory layouts, criterion provides more robust and reliable benchmark results.<p>The fix for the plotting NaN bug is also important, as NaN values in benchmark results can cause visualization issues and potentially crash the reporting system. This fix ensures that Bevy’s benchmark reports remain stable even when edge cases occur.<p>From an engineering perspective, this update follows the standard practice of keeping dependencies current to benefit from security patches, bug fixes, and performance improvements. The PR was created automatically by Dependabot, reviewed by a maintainer, and merged quickly (within about 50 minutes), indicating that the change was low-risk and compatible with Bevy’s existing codebase.<p>The merge by mockersf suggests that the maintainer verified the compatibility of the new criterion version with Bevy’s benchmarking infrastructure. Given that only the version number changed and no code modifications were required in Bevy’s benchmark files, the update was likely validated by ensuring that existing benchmarks continued to compile and run successfully.<h2 id=visual-representation>Visual Representation</h2><pre class=language-mermaid data-lang=mermaid style=color:#61676c;background-color:#fafafa><code class=language-mermaid data-lang=mermaid><span>graph TD
</span><span>    A[Dependabot detects new criterion version] --> B[Creates PR #21994]
</span><span>    B --> C[Updates version in benches/Cargo.toml]
</span><span>    C --> D[Maintainer reviews changelog]
</span><span>    D --> E{Checks breaking changes impact}
</span><span>    E -->|No impact| F[Approves and merges]
</span><span>    E -->|Impact| G[Rejects or requests changes]
</span><span>    F --> H[Bevy now uses criterion 0.8.0]
</span><span>    H --> I[Benchmarks benefit from new features]
</span></code></pre><h2 id=key-files-changed>Key Files Changed</h2><p>List the most significant files changed in this PR:<ul><li><code>benches/Cargo.toml</code> (+1/-1)</ul><p><strong>File: benches/Cargo.toml</strong><ol><li><p><strong>What changed and why</strong>: Updated the criterion dependency version from 0.7.0 to 0.8.0 to use the latest version of the benchmarking library with its improvements and fixes.</p><li><p><strong>Code snippets showing the key modifications</strong>:</p></ol><pre class=language-toml data-lang=toml style=color:#61676c;background-color:#fafafa><code class=language-toml data-lang=toml><span style=color:#abb0b6;font-style:italic># File: benches/Cargo.toml
</span><span style=color:#abb0b6;font-style:italic># Before:
</span><span style=color:#399ee6>criterion </span><span>= { </span><span style=color:#399ee6>version </span><span>= </span><span style=color:#86b300>"0.7.0"</span><span style=color:#61676ccc>, </span><span style=color:#399ee6>features </span><span>= [</span><span style=color:#86b300>"html_reports"</span><span>] }
</span><span>
</span><span style=color:#abb0b6;font-style:italic># After:
</span><span style=color:#399ee6>criterion </span><span>= { </span><span style=color:#399ee6>version </span><span>= </span><span style=color:#86b300>"0.8.0"</span><span style=color:#61676ccc>, </span><span style=color:#399ee6>features </span><span>= [</span><span style=color:#86b300>"html_reports"</span><span>] }
</span></code></pre><ol start=3><li><strong>How these changes relate to the overall purpose of the PR</strong>: This single line change updates the entire benchmarking infrastructure to use the newer criterion version. The <code>html_reports</code> feature flag is preserved, ensuring that Bevy continues to generate HTML benchmark reports.</ol><h2 id=further-reading>Further Reading</h2><ol><li><strong>Criterion.rs Documentation</strong>: https://bheisler.github.io/criterion.rs/book/index.html<li><strong>Semantic Versioning</strong>: https://semver.org/<li><strong>Rust Dependency Management with Cargo</strong>: https://doc.rust-lang.org/cargo/guide/dependencies.html<li><strong>Benchmarking Best Practices</strong>: https://github.com/bheisler/criterion.rs/blob/master/book/src/user_guide/benchmarking.md<li><strong>Dependabot Documentation</strong>: https://docs.github.com/en/code-security/dependabot/dependabot-version-updates/about-dependabot-version-updates</ol><h1 id=full-code-diff>Full Code Diff</h1><p>diff –git a/benches/Cargo.toml b/benches/Cargo.toml index f569def4edbfd..8940f1eed7105 100644 — a/benches/Cargo.toml +++ b/benches/Cargo.toml @@ -10,7 +10,7 @@ autobenches = false [dependencies]<h1 id=the-primary-crate-that-runs-and-analyzes-our-benchmarks-this-is-a-regular-dependency-because-the>The primary crate that runs and analyzes our benchmarks. This is a regular dependency because the</h1><h1 id=bench-macro-refers-to-it-in-its-documentation><code>bench!</code> macro refers to it in its documentation.</h1><p>-criterion = { version = “0.7.0”, features = [“html_reports”] } +criterion = { version = “0.8.0”, features = [“html_reports”] }<p>[dev-dependencies]<h1 id=bevy-crates>Bevy crates</h1></div><div data-is-md-page=true data-patch-exists=true data-patch-path=/pull_request/bevy/2025-12/pr_21994.patch id=patch-info style=display:none></div><div class=bottom-spacer></div></div></div>