<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://unknownue.github.io name=base><title>
         #22317 Fix: Closes shapes for 3d gizmos
        
    </title><meta content="#22317 Fix: Closes shapes for 3d gizmos" property=og:title><meta content="A personal blog built with Zola and Apollo theme" property=og:description><meta content="A personal blog built with Zola and Apollo theme" name=description><link href=/icons/favicon.png rel=icon type=image/png><link href=https://unknownue.github.io/fonts.css rel=stylesheet><script src=https://unknownue.github.io/js/codeblock.js></script><script src=https://unknownue.github.io/js/toc.js></script><script src=https://unknownue.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Unknownue's Blog" href=https://unknownue.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://unknownue.github.io/theme/light.css rel=stylesheet><link href=https://unknownue.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://unknownue.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://unknownue.github.io/main.css media=screen rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js></script><script>// Initialize mermaid once DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            mermaid.initialize({
                startOnLoad: false,
                theme: document.body && document.body.classList.contains('dark') ? 'dark' : 'default',
                securityLevel: 'loose',
                flowchart: {
                    useMaxWidth: true,
                    htmlLabels: true
                },
                sequence: {
                    diagramMarginX: 50,
                    diagramMarginY: 10,
                    actorMargin: 50,
                    width: 150,
                    height: 65
                }
            });
        });</script><script src=https://unknownue.github.io/js/main.js></script><script defer src=https://unknownue.github.io/js/label-colors.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/rust.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/typescript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/go.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/cpp.min.js></script><script>// Ensure highlight.js is properly configured
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof hljs !== 'undefined') {
                hljs.configure({
                    languages: ['rust', 'javascript', 'python', 'cpp', 'go', 'typescript'],
                    ignoreUnescapedHTML: true
                });
                console.log('Highlight.js configured in header');
            }
        });</script><link href=https://cdn.jsdelivr.net/npm/diff2html/bundles/css/diff2html.min.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/diff2html/bundles/js/diff2html-ui.min.js></script><script src=https://unknownue.github.io/js/syntax-highlight.js></script><script src=https://unknownue.github.io/js/diff-sidebar.js></script><script src="https://unknownue.github.io/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><div class=content><header><div class=main><a href=https://unknownue.github.io>Unknownue's Blog</a><div class=socials><a class=social href=https://github.com/unknownue rel=me> <img alt=github src=https://unknownue.github.io/icons/social/github.svg> </a><a class=social href=https://github.com/unknownue/unknownue.github.io rel=me> <img alt=github-io src=https://unknownue.github.io/icons/social/rss.svg> </a></div></div><nav><a href=https://unknownue.github.io/posts style=margin-left:.25em>/posts</a><a href=https://unknownue.github.io/projects style=margin-left:.25em>/projects</a><a href=https://unknownue.github.io/about style=margin-left:.25em>/about</a><a href=https://unknownue.github.io/tags style=margin-left:.25em>/tags</a><button title="$SHORTCUT to open search" class=search-button id=search-button><img alt=Search class=search-icon src=https://unknownue.github.io/icons/search.svg></button><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><div id=modal-content><h1 class=page-header id=modalTitle>Search</h1><div id=searchBar><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search... role=combobox spellcheck=false><button title="Clear search" class=clear-button id=clear-search><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></button></div><div id=results-container><div id=results-info><span id=zero_results style=display:none>No results</span><span id=one_result style=display:none>1 result</span><span id=many_results style=display:none>$NUMBER results</span></div><div id=results role=listbox></div></div></div></div><a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://unknownue.github.io/icons/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://unknownue.github.io/icons/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><div class=pull-request-page><article class=md-content-page style=display:none></article><div class=back-link><a href=/pull_request/bevy/2025-12/>← Back to Pull Requests</a></div><div class=pr-metadata><span class=pr-date>2025-12-31</span><div class=language-switcher><span class="lang-link active" data-lang=en>English</span> / <a class=lang-link data-lang=zh-cn href=/pull_request/bevy/2025-12/pr-22317-zh-cn-20251231>中文</a></div></div><div class=pr-content><h1 id=title>Title</h1><h2 id=basic-information>Basic Information</h2><ul><li><strong>Title</strong>: Fix: Closes shapes for 3d gizmos<li><strong>PR Link</strong>: https://github.com/bevyengine/bevy/pull/22317<li><strong>Author</strong>: kfc35<li><strong>Status</strong>: MERGED<li><strong>Labels</strong>: C-Bug, C-Code-Quality, S-Ready-For-Final-Review, A-Gizmos<li><strong>Created</strong>: 2025-12-30T20:02:15Z<li><strong>Merged</strong>: 2025-12-31T22:22:11Z<li><strong>Merged By</strong>: alice-i-cecile</ul><h2 id=description-translation>Description Translation</h2><h1 id=objective>Objective</h1><ul><li>Fixes #22204</ul><h2 id=solution>Solution</h2><ul><li>Refactored the solution from #22085 and made it use 3 dimensions; have 2d <code>lineloop</code> delegate to the 3d one.<li>Updated any relevant usages of <code>linestrip</code> to use <code>lineloop</code> (rect and <code>GizmoPrimitive3d&LTTriangle3d></code>). <code>GizmoPrimitive3d&LTPolyline3d></code>, cube(), and aabb3d() still use <code>linestrip</code>. As far as I could tell, the cube looked ok for all corners in the <code>3d_gizmos</code> example (the black cube in the center of the scene) but another pair of eyes could be helpful there.<li>This does not do anything for #22095 !</ul><h2 id=testing>Testing</h2><ul><li><p>Ran <code>cargo run --example 3d_gizmos --features=free_camera</code> and saw that the green 3d square gizmo now closes <img alt="Screenshot 2025-12-30 at 4 06 41 PM" height=182 src=https://github.com/user-attachments/assets/5f9f4337-d1fe-4c2e-98c0-2d83fe4b0ea6 width=1063></p><li><p>Ran the demo in #22085 and ensured no regressions for 2d_gizmos</p><li><p>Ran a modified demo for <code>Triangle3d</code> and verified that <code>Triangle3d</code> now closes</p></ul><details><summary>Modified Demo for Triangle 3d</summary> <pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#fa6e32>use </span><span>bevy</span><span style=color:#ed9366>::</span><span>prelude</span><span style=color:#ed9366>::*</span><span style=color:#61676ccc>;
</span><span>
</span><span style=color:#fa6e32>fn </span><span style=color:#f29718>main</span><span>() {
</span><span>    App</span><span style=color:#ed9366>::</span><span>new()
</span><span>        </span><span style=color:#ed9366>.</span><span style=color:#f07171>add_plugins</span><span>(DefaultPlugins)
</span><span>        </span><span style=color:#ed9366>.</span><span style=color:#f07171>add_systems</span><span>(Startup</span><span style=color:#61676ccc>,</span><span> setup)
</span><span>        </span><span style=color:#ed9366>.</span><span style=color:#f07171>add_systems</span><span>(Update</span><span style=color:#61676ccc>,</span><span> draw_shapes)
</span><span>        </span><span style=color:#ed9366>.</span><span style=color:#f07171>run</span><span>()</span><span style=color:#61676ccc>;
</span><span>}
</span><span>
</span><span style=color:#fa6e32>fn </span><span style=color:#f29718>setup</span><span>(
</span><span>    </span><span style=color:#fa6e32>mut </span><span style=color:#ff8f40>config_store</span><span style=color:#61676ccc>: </span><span>ResMut&LTGizmoConfigStore>,
</span><span>    </span><span style=color:#fa6e32>mut </span><span style=color:#ff8f40>commands</span><span style=color:#61676ccc>:</span><span> Commands
</span><span>)
</span><span>{
</span><span>    </span><span style=color:#fa6e32>let </span><span>(config</span><span style=color:#61676ccc>, </span><span style=color:#ed9366>_</span><span>) </span><span style=color:#ed9366>=</span><span> config_store</span><span style=color:#ed9366>.</span><span>config_mut</span><span style=color:#ed9366>::</span><span>&LTDefaultGizmoConfigGroup>()</span><span style=color:#61676ccc>;
</span><span>    config</span><span style=color:#ed9366>.</span><span>line</span><span style=color:#ed9366>.</span><span>width </span><span style=color:#ed9366>= </span><span style=color:#ff8f40>10.0</span><span style=color:#61676ccc>;
</span><span>    config</span><span style=color:#ed9366>.</span><span>line</span><span style=color:#ed9366>.</span><span>joints </span><span style=color:#ed9366>= </span><span>GizmoLineJoint</span><span style=color:#ed9366>::</span><span>Miter</span><span style=color:#61676ccc>;
</span><span>
</span><span>    commands</span><span style=color:#ed9366>.</span><span style=color:#f07171>spawn</span><span>((Camera3d</span><span style=color:#ed9366>::</span><span>default()</span><span style=color:#61676ccc>, 
</span><span>        Transform</span><span style=color:#ed9366>::</span><span>from_xyz(</span><span style=color:#ff8f40>0.0</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>0.0</span><span style=color:#61676ccc>, </span><span style=color:#ed9366>-</span><span style=color:#ff8f40>5.0</span><span>)</span><span style=color:#ed9366>.</span><span style=color:#f07171>looking_at</span><span>(Vec3</span><span style=color:#ed9366>::</span><span style=color:#ff8f40>ZERO</span><span style=color:#61676ccc>, </span><span>Vec3</span><span style=color:#ed9366>::</span><span>Z)))</span><span style=color:#61676ccc>;
</span><span>}
</span><span>
</span><span style=color:#fa6e32>fn </span><span style=color:#f29718>draw_shapes</span><span>(</span><span style=color:#fa6e32>mut </span><span style=color:#ff8f40>gizmos</span><span style=color:#61676ccc>:</span><span> Gizmos) {
</span><span>    gizmos</span><span style=color:#ed9366>.</span><span style=color:#f07171>primitive_3d</span><span>(
</span><span>        </span><span style=color:#ed9366>&</span><span>Triangle3d { vertices</span><span style=color:#61676ccc>: </span><span>[Vec3</span><span style=color:#ed9366>::</span><span style=color:#ff8f40>ZERO</span><span style=color:#61676ccc>, </span><span>Vec3</span><span style=color:#ed9366>::</span><span>new(</span><span style=color:#ff8f40>1.0</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>0.</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>0.</span><span>)</span><span style=color:#61676ccc>, </span><span>Vec3</span><span style=color:#ed9366>::</span><span>new(</span><span style=color:#ff8f40>0.0</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>1.0</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>0.</span><span>) ] }</span><span style=color:#61676ccc>,
</span><span>        Vec3</span><span style=color:#ed9366>::</span><span>new(</span><span style=color:#ff8f40>0.0</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>0.0</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>0.</span><span>)</span><span style=color:#61676ccc>,
</span><span>        Color</span><span style=color:#ed9366>::</span><span>srgb_u8(</span><span style=color:#ff8f40>0xFF</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>0</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>0</span><span>)
</span><span>    )</span><span style=color:#61676ccc>;
</span><span>}
</span></code></pre> <p>Before (notice notch in bottom left hand corner): <img alt="Screenshot 2025-12-30 at 2 46 36 PM" height=308 src=https://github.com/user-attachments/assets/3b073b9e-7145-4eef-b070-13a56376b17f width=369></p> <p>After (notch in bottom left hand corner is gone): <img alt="Screenshot 2025-12-30 at 2 47 28 PM" height=339 src=https://github.com/user-attachments/assets/47494176-b212-42ac-82b0-f042c94941f3 width=361></p></details><h2 id=the-story-of-this-pull-request>The Story of This Pull Request</h2><p>This PR addresses a visual bug in Bevy’s 3D gizmo system where closed shapes like rectangles and triangles weren’t properly connecting their final vertex back to the first vertex. When drawing with thicker lines and certain joint styles (particularly miter joints), this resulted in visible gaps at the corners where the shape should have been fully closed.<p>The root cause was that while Bevy had a <code>lineloop</code> method for 2D gizmos that handled closing shapes properly, the 3D gizmo system only had a <code>linestrip</code> method that didn’t automatically close shapes. Developers using 3D gizmos had to manually add the starting point again at the end of their vertex list, but this approach didn’t properly handle the joint rendering at the first corner.<p>The developer approached this by first examining how the 2D <code>lineloop</code> method worked in a previous fix (#22085). That implementation used a clever technique: after drawing through all the points, it added both the first and second points again to ensure the joint at the first corner would render correctly. The developer recognized this pattern could be abstracted to work in 3D as well.<p>Instead of creating separate 2D and 3D implementations with duplicated logic, the developer made an architectural decision to have the 2D <code>lineloop</code> delegate to the new 3D version. This is a smart reuse of code - by extending 2D points to 3D (adding a z-coordinate of 0), the same 3D line-drawing logic could handle both cases. This approach reduces code duplication and ensures consistent behavior between 2D and 3D gizmos.<p>The implementation adds a new <code>lineloop</code> method to the 3D gizmos API with proper documentation and example usage. The key insight in the implementation is the need to include not just the first point again, but also the second point:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#fa6e32>let mut</span><span> positions </span><span style=color:#ed9366>=</span><span> positions</span><span style=color:#ed9366>.</span><span style=color:#f07171>into_iter</span><span>()</span><span style=color:#61676ccc>;
</span><span style=color:#fa6e32>let</span><span> first </span><span style=color:#ed9366>=</span><span> positions</span><span style=color:#ed9366>.</span><span style=color:#f07171>next</span><span>()</span><span style=color:#61676ccc>;
</span><span style=color:#fa6e32>let</span><span> second </span><span style=color:#ed9366>=</span><span> positions</span><span style=color:#ed9366>.</span><span style=color:#f07171>next</span><span>()</span><span style=color:#61676ccc>;
</span><span>
</span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span style=color:#f07171>linestrip</span><span>(
</span><span>    first
</span><span>        </span><span style=color:#ed9366>.</span><span style=color:#f07171>into_iter</span><span>()
</span><span>        </span><span style=color:#ed9366>.</span><span style=color:#f07171>chain</span><span>(second)
</span><span>        </span><span style=color:#ed9366>.</span><span style=color:#f07171>chain</span><span>(positions)
</span><span>        </span><span style=color:#ed9366>.</span><span style=color:#f07171>chain</span><span>(first)
</span><span>        </span><span style=color:#ed9366>.</span><span style=color:#f07171>chain</span><span>(second)</span><span style=color:#61676ccc>,
</span><span>    color</span><span style=color:#61676ccc>,
</span><span>)</span><span style=color:#61676ccc>;
</span></code></pre><p>This pattern ensures that when the line renderer processes the segments, it has enough context to properly calculate and render the joint at the starting point. Without including the second point again, the final segment (from the last point back to the first) wouldn’t have information about what comes after it to calculate the joint properly.<p>After implementing the core <code>lineloop</code> method, the developer updated two key usages:<ol><li>The <code>rect_3d</code> method now uses <code>lineloop</code> instead of manually constructing a closed polyline<li>The <code>Triangle3d</code> primitive rendering in the 3D primitives module also switches to <code>lineloop</code></ol><p>The developer was careful about which shapes to update - only closed shapes that should form complete loops. Other shapes like <code>Polyline3d</code> (which by definition doesn’t close), cubes, and AABBs were left using <code>linestrip</code> since they were already working correctly.<p>Testing was thorough: the developer verified the fix worked in the existing 3D gizmos example, ensured no regressions in 2D gizmos, and created a custom test to visually confirm triangles now render correctly. The before-and-after screenshots clearly show the missing corner joint being fixed.<p>This fix demonstrates good API design by extending the existing pattern from 2D to 3D, maintaining backward compatibility (existing code continues to work), and providing a cleaner interface for drawing closed shapes. The delegation from 2D to 3D also shows thoughtful architecture that reduces maintenance burden while ensuring consistency across the codebase.<h2 id=visual-representation>Visual Representation</h2><pre class=language-mermaid data-lang=mermaid style=color:#61676c;background-color:#fafafa><code class=language-mermaid data-lang=mermaid><span>graph TD
</span><span>    A[3D lineloop method] --> B[rect_3d]
</span><span>    A --> C[Triangle3d primitive]
</span><span>    A --> D[2D lineloop]
</span><span>    
</span><span>    B --> E[Fixes rectangle closing]
</span><span>    C --> F[Fixes triangle closing]
</span><span>    D --> G[Maintains 2D functionality]
</span><span>    
</span><span>    H[Existing linestrip] --> I[Polyline3d]
</span><span>    H --> J[cube]
</span><span>    H --> K[aabb3d]
</span></code></pre><h2 id=key-files-changed>Key Files Changed</h2><ol><li><p><strong><code>crates/bevy_gizmos/src/gizmos.rs</code></strong> (+37/-18)</p> <p>This file contains the core implementation changes:</p> <ul><li>Added a new <code>lineloop</code> method for 3D gizmos that properly closes shapes<li>Updated <code>rect_3d</code> to use the new <code>lineloop</code> method instead of manually creating a closed linestrip<li>Refactored the 2D <code>lineloop</code> method to delegate to the 3D version, reducing code duplication</ul> <p>Key code changes:</p> <pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// New 3D lineloop method
</span><span style=color:#fa6e32>pub fn </span><span style=color:#f29718>lineloop</span><span>(</span><span style=color:#ed9366>&</span><span style=color:#fa6e32>mut </span><span style=color:#ff8f40>self</span><span>, </span><span style=color:#ff8f40>positions</span><span style=color:#61676ccc>:</span><span> impl </span><span style=color:#55b4d4;font-style:italic>IntoIterator</span><span>&LTItem = Vec3>, </span><span style=color:#ff8f40>color</span><span style=color:#61676ccc>:</span><span> impl </span><span style=color:#55b4d4;font-style:italic>Into</span><span>&LTColor>) {
</span><span>    </span><span style=color:#fa6e32>if </span><span style=color:#ed9366>!</span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>enabled {
</span><span>        </span><span style=color:#fa6e32>return</span><span style=color:#61676ccc>;
</span><span>    }
</span><span>
</span><span>    </span><span style=color:#abb0b6;font-style:italic>// Loop back to the start; second is needed to ensure that
</span><span>    </span><span style=color:#abb0b6;font-style:italic>// the joint on the first corner is drawn.
</span><span>    </span><span style=color:#fa6e32>let mut</span><span> positions </span><span style=color:#ed9366>=</span><span> positions</span><span style=color:#ed9366>.</span><span style=color:#f07171>into_iter</span><span>()</span><span style=color:#61676ccc>;
</span><span>    </span><span style=color:#fa6e32>let</span><span> first </span><span style=color:#ed9366>=</span><span> positions</span><span style=color:#ed9366>.</span><span style=color:#f07171>next</span><span>()</span><span style=color:#61676ccc>;
</span><span>    </span><span style=color:#fa6e32>let</span><span> second </span><span style=color:#ed9366>=</span><span> positions</span><span style=color:#ed9366>.</span><span style=color:#f07171>next</span><span>()</span><span style=color:#61676ccc>;
</span><span>
</span><span>    </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span style=color:#f07171>linestrip</span><span>(
</span><span>        first
</span><span>            </span><span style=color:#ed9366>.</span><span style=color:#f07171>into_iter</span><span>()
</span><span>            </span><span style=color:#ed9366>.</span><span style=color:#f07171>chain</span><span>(second)
</span><span>            </span><span style=color:#ed9366>.</span><span style=color:#f07171>chain</span><span>(positions)
</span><span>            </span><span style=color:#ed9366>.</span><span style=color:#f07171>chain</span><span>(first)
</span><span>            </span><span style=color:#ed9366>.</span><span style=color:#f07171>chain</span><span>(second)</span><span style=color:#61676ccc>,
</span><span>        color</span><span style=color:#61676ccc>,
</span><span>    )</span><span style=color:#61676ccc>;
</span><span>}
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// Updated rect_3d to use lineloop
</span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span style=color:#f07171>lineloop</span><span>([tl</span><span style=color:#61676ccc>,</span><span> tr</span><span style=color:#61676ccc>,</span><span> br</span><span style=color:#61676ccc>,</span><span> bl]</span><span style=color:#61676ccc>,</span><span> color)</span><span style=color:#61676ccc>;
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// Refactored 2D lineloop to delegate to 3D
</span><span style=color:#fa6e32>pub fn </span><span style=color:#f29718>lineloop</span><span>(</span><span style=color:#ed9366>&</span><span style=color:#fa6e32>mut </span><span style=color:#ff8f40>self</span><span>, </span><span style=color:#ff8f40>positions</span><span style=color:#61676ccc>:</span><span> impl </span><span style=color:#55b4d4;font-style:italic>IntoIterator</span><span>&LTItem = Vec2>, </span><span style=color:#ff8f40>color</span><span style=color:#61676ccc>:</span><span> impl </span><span style=color:#55b4d4;font-style:italic>Into</span><span>&LTColor>) {
</span><span>    </span><span style=color:#fa6e32>if </span><span style=color:#ed9366>!</span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>enabled {
</span><span>        </span><span style=color:#fa6e32>return</span><span style=color:#61676ccc>;
</span><span>    }
</span><span>    </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span style=color:#f07171>lineloop</span><span>(positions</span><span style=color:#ed9366>.</span><span style=color:#f07171>into_iter</span><span>()</span><span style=color:#ed9366>.</span><span style=color:#f07171>map</span><span>(|</span><span style=color:#ff8f40>vec2</span><span>| vec2</span><span style=color:#ed9366>.</span><span style=color:#f07171>extend</span><span>(</span><span style=color:#ff8f40>0.</span><span>))</span><span style=color:#61676ccc>,</span><span> color)</span><span style=color:#61676ccc>;
</span><span>}
</span></code></pre><li><p><strong><code>crates/bevy_gizmos/src/primitives/dim3.rs</code></strong> (+1/-1)</p> <p>This file contains a single line change to fix triangle rendering:</p> <ul><li>Updated the <code>Triangle3d</code> primitive rendering to use <code>lineloop</code> instead of <code>linestrip</code></ul> <p>Key code change:</p> <pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before:
</span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span style=color:#f07171>linestrip</span><span>([a</span><span style=color:#61676ccc>,</span><span> b</span><span style=color:#61676ccc>,</span><span> c</span><span style=color:#61676ccc>,</span><span> a]</span><span style=color:#ed9366>.</span><span style=color:#f07171>map</span><span>(|</span><span style=color:#ff8f40>vec3</span><span>| isometry </span><span style=color:#ed9366>*</span><span> vec3)</span><span style=color:#61676ccc>,</span><span> color)</span><span style=color:#61676ccc>;
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After:
</span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span style=color:#f07171>lineloop</span><span>([a</span><span style=color:#61676ccc>,</span><span> b</span><span style=color:#61676ccc>,</span><span> c]</span><span style=color:#ed9366>.</span><span style=color:#f07171>map</span><span>(|</span><span style=color:#ff8f40>vec3</span><span>| isometry </span><span style=color:#ed9366>*</span><span> vec3)</span><span style=color:#61676ccc>,</span><span> color)</span><span style=color:#61676ccc>;
</span></code></pre></ol><h2 id=further-reading>Further Reading</h2><ul><li><a rel="noopener nofollow noreferrer" href=https://docs.rs/bevy_gizmos/latest/bevy_gizmos/ target=_blank>Bevy Gizmos Documentation</a> - Official API documentation for Bevy’s gizmo system<li><a rel="noopener nofollow noreferrer" href=https://github.com/bevyengine/bevy/issues/22204 target=_blank>Issue #22204</a> - Original bug report showing the problem with 3D rectangle gizmos<li><a rel="noopener nofollow noreferrer" href=https://github.com/bevyengine/bevy/pull/22085 target=_blank>PR #22085</a> - Previous fix for 2D gizmos that inspired this solution<li><a rel="noopener nofollow noreferrer" href=https://github.com/bevyengine/bevy/blob/main/examples/3d_gizmos.rs target=_blank>Bevy Examples: 3D Gizmos</a> - Example demonstrating various 3D gizmo functionality<li><a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/Line_join target=_blank>Computer Graphics: Line Joints</a> - Background on different line joint styles (miter, bevel, round)</ul></div><div data-is-md-page=true data-patch-exists=true data-patch-path=/pull_request/bevy/2025-12/pr_22317.patch id=patch-info style=display:none></div><div class=bottom-spacer></div></div></div>