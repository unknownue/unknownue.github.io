<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://unknownue.github.io name=base><title>
         #22141 More missing `Measured2d` impls
        
    </title><meta content="#22141 More missing `Measured2d` impls" property=og:title><meta content="A personal blog built with Zola and Apollo theme" property=og:description><meta content="A personal blog built with Zola and Apollo theme" name=description><link href=/icons/favicon.png rel=icon type=image/png><link href=https://unknownue.github.io/fonts.css rel=stylesheet><script src=https://unknownue.github.io/js/codeblock.js></script><script src=https://unknownue.github.io/js/toc.js></script><script src=https://unknownue.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Unknownue's Blog" href=https://unknownue.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://unknownue.github.io/theme/light.css rel=stylesheet><link href=https://unknownue.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://unknownue.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://unknownue.github.io/main.css media=screen rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js></script><script>// Initialize mermaid once DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            mermaid.initialize({
                startOnLoad: false,
                theme: document.body && document.body.classList.contains('dark') ? 'dark' : 'default',
                securityLevel: 'loose',
                flowchart: {
                    useMaxWidth: true,
                    htmlLabels: true
                },
                sequence: {
                    diagramMarginX: 50,
                    diagramMarginY: 10,
                    actorMargin: 50,
                    width: 150,
                    height: 65
                }
            });
        });</script><script src=https://unknownue.github.io/js/main.js></script><script defer src=https://unknownue.github.io/js/label-colors.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/rust.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/typescript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/go.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/cpp.min.js></script><script>// Ensure highlight.js is properly configured
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof hljs !== 'undefined') {
                hljs.configure({
                    languages: ['rust', 'javascript', 'python', 'cpp', 'go', 'typescript'],
                    ignoreUnescapedHTML: true
                });
                console.log('Highlight.js configured in header');
            }
        });</script><link href=https://cdn.jsdelivr.net/npm/diff2html/bundles/css/diff2html.min.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/diff2html/bundles/js/diff2html-ui.min.js></script><script src=https://unknownue.github.io/js/syntax-highlight.js></script><script src=https://unknownue.github.io/js/diff-sidebar.js></script><script src="https://unknownue.github.io/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><div class=content><header><div class=main><a href=https://unknownue.github.io>Unknownue's Blog</a><div class=socials><a class=social href=https://github.com/unknownue rel=me> <img alt=github src=https://unknownue.github.io/icons/social/github.svg> </a><a class=social href=https://github.com/unknownue/unknownue.github.io rel=me> <img alt=github-io src=https://unknownue.github.io/icons/social/rss.svg> </a></div></div><nav><a href=https://unknownue.github.io/posts style=margin-left:.25em>/posts</a><a href=https://unknownue.github.io/projects style=margin-left:.25em>/projects</a><a href=https://unknownue.github.io/about style=margin-left:.25em>/about</a><a href=https://unknownue.github.io/tags style=margin-left:.25em>/tags</a><button title="$SHORTCUT to open search" class=search-button id=search-button><img alt=Search class=search-icon src=https://unknownue.github.io/icons/search.svg></button><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><div id=modal-content><h1 class=page-header id=modalTitle>Search</h1><div id=searchBar><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search... role=combobox spellcheck=false><button title="Clear search" class=clear-button id=clear-search><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></button></div><div id=results-container><div id=results-info><span id=zero_results style=display:none>No results</span><span id=one_result style=display:none>1 result</span><span id=many_results style=display:none>$NUMBER results</span></div><div id=results role=listbox></div></div></div></div><a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://unknownue.github.io/icons/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://unknownue.github.io/icons/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><div class=pull-request-page><article class=md-content-page style=display:none></article><div class=back-link><a href=/pull_request/bevy/2025-12/>← Back to Pull Requests</a></div><div class=pr-metadata><span class=pr-date>2025-12-16</span><div class=language-switcher><span class="lang-link active" data-lang=en>English</span> / <a class=lang-link data-lang=zh-cn href=/pull_request/bevy/2025-12/pr-22141-zh-cn-20251216>中文</a></div></div><div class=pr-content><h1 id=title>Title</h1><p>More missing <code>Measured2d</code> impls<h2 id=basic-information>Basic Information</h2><ul><li><strong>Title</strong>: More missing <code>Measured2d</code> impls<li><strong>PR Link</strong>: https://github.com/bevyengine/bevy/pull/22141<li><strong>Author</strong>: lynn-lumen<li><strong>Status</strong>: MERGED<li><strong>Labels</strong>: C-Feature, S-Ready-For-Final-Review, A-Math, D-Straightforward<li><strong>Created</strong>: 2025-12-15T22:33:01Z<li><strong>Merged</strong>: 2025-12-16T05:18:47Z<li><strong>Merged By</strong>: alice-i-cecile</ul><h2 id=description-translation>Description Translation</h2><p><strong>Objective</strong><ul><li>Implement <code>Measured2d</code> for the remaining primitives where an implementation makes sense.</ul><p><strong>Solution</strong><ul><li>Implemented <code>Measured2d</code> for <code>Plane3d</code>. This might seem weird, but we have done the same for <code>Triangle3d</code> before.<li>Implemented <code>Measured2d</code> for <code>Ring&LTP: Measured2d></code>. The implementation holds given the invariants of the primitive.</ul><h2 id=the-story-of-this-pull-request>The Story of This Pull Request</h2><p>This PR addresses a straightforward gap in Bevy’s geometry API by adding missing implementations of the <code>Measured2d</code> trait for two geometric primitives: <code>Plane3d</code> and <code>Ring&LTP></code>. The <code>Measured2d</code> trait provides methods for calculating area and perimeter, which are fundamental operations for 2D geometry computations.<p>The author, lynn-lumen, recognized that while many 2D primitives already had <code>Measured2d</code> implementations, two specific cases were missing. The implementation follows established patterns in the codebase and maintains consistency with existing conventions.<p>For <code>Plane3d</code>, the implementation calculates area as <code>half_size.element_product() * 4.0</code> and perimeter as <code>half_size.element_sum() * 4.0</code>. Although <code>Plane3d</code> exists in 3D space, it has well-defined 2D measurements when considered as a rectangular surface. The PR description acknowledges that this might seem unconventional but notes the precedent set by <code>Triangle3d</code>, which already has a <code>Measured2d</code> implementation despite being a 3D primitive.<p>For <code>Ring&LTP></code>, the implementation is generic over any primitive <code>P</code> that implements both <code>Primitive2d</code> and <code>Measured2d</code>. The area of a ring is calculated as the outer shape’s area minus the inner shape’s area, and the perimeter is the sum of both shapes’ perimeters. This follows mathematical intuition where a ring can be thought of as the region between two concentric shapes.<p>The changes are minimal but important for API completeness. Both implementations use the <code>#[inline]</code> attribute, which is consistent with other <code>Measured2d</code> implementations in the codebase and suggests these are expected to be lightweight, frequently called operations where inlining could provide performance benefits.<p>The PR was reviewed and merged quickly, indicating the changes were uncontroversial and aligned with existing patterns. The labels “D-Straightforward” and “S-Ready-For-Final-Review” reflect the simplicity and correctness of the implementation.<h2 id=visual-representation>Visual Representation</h2><pre class=language-mermaid data-lang=mermaid style=color:#61676c;background-color:#fafafa><code class=language-mermaid data-lang=mermaid><span>graph TD
</span><span>    A[Measured2d Trait] --> B[Plane3d Implementation]
</span><span>    A --> C[Ring Implementation]
</span><span>    C --> D[Generic over P]
</span><span>    D --> E[Requires: Primitive2d + Measured2d]
</span><span>    
</span><span>    B --> F[Uses half_size: Vec2]
</span><span>    C --> G[Uses outer_shape and inner_shape]
</span></code></pre><h2 id=key-files-changed>Key Files Changed</h2><h3 id=crates-bevy-math-src-primitives-dim2-rs-12-0><code>crates/bevy_math/src/primitives/dim2.rs</code> (+12/-0)</h3><p><strong>Purpose</strong>: Add <code>Measured2d</code> implementation for <code>Ring&LTP></code> where <code>P</code> is a primitive that already implements <code>Measured2d</code>.<p><strong>Key Code Changes</strong>:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#fa6e32>impl</span><span>&LTP</span><span style=color:#61676ccc>:</span><span> Primitive2d </span><span style=color:#ed9366>+</span><span> Measured2d> Measured2d </span><span style=color:#fa6e32>for </span><span style=color:#399ee6>Ring</span><span>&LTP> {
</span><span>    </span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>inline</span><span>]
</span><span>    </span><span style=color:#fa6e32>fn </span><span style=color:#f29718>area</span><span>(</span><span style=color:#ed9366>&</span><span style=color:#ff8f40>self</span><span>) </span><span style=color:#61676ccc>-> </span><span style=color:#fa6e32>f32 </span><span>{
</span><span>        </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>outer_shape</span><span style=color:#ed9366>.</span><span style=color:#f07171>area</span><span>() </span><span style=color:#ed9366>- </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>inner_shape</span><span style=color:#ed9366>.</span><span style=color:#f07171>area</span><span>()
</span><span>    }
</span><span>
</span><span>    </span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>inline</span><span>]
</span><span>    </span><span style=color:#fa6e32>fn </span><span style=color:#f29718>perimeter</span><span>(</span><span style=color:#ed9366>&</span><span style=color:#ff8f40>self</span><span>) </span><span style=color:#61676ccc>-> </span><span style=color:#fa6e32>f32 </span><span>{
</span><span>        </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>outer_shape</span><span style=color:#ed9366>.</span><span style=color:#f07171>perimeter</span><span>() </span><span style=color:#ed9366>+ </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>inner_shape</span><span style=color:#ed9366>.</span><span style=color:#f07171>perimeter</span><span>()
</span><span>    }
</span><span>}
</span></code></pre><p><strong>Analysis</strong>: This implementation follows mathematical principles where a ring’s area is the difference between outer and inner areas, and its perimeter is the sum of both perimeters. The generic constraint ensures type safety by only allowing rings composed of measurable primitives.<h3 id=crates-bevy-math-src-primitives-dim3-rs-11-0><code>crates/bevy_math/src/primitives/dim3.rs</code> (+11/-0)</h3><p><strong>Purpose</strong>: Add <code>Measured2d</code> implementation for <code>Plane3d</code>.<p><strong>Key Code Changes</strong>:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#fa6e32>impl </span><span>Measured2d </span><span style=color:#fa6e32>for </span><span style=color:#399ee6>Plane3d </span><span>{
</span><span>    </span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>inline</span><span>]
</span><span>    </span><span style=color:#fa6e32>fn </span><span style=color:#f29718>area</span><span>(</span><span style=color:#ed9366>&</span><span style=color:#ff8f40>self</span><span>) </span><span style=color:#61676ccc>-> </span><span style=color:#fa6e32>f32 </span><span>{
</span><span>        </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>half_size</span><span style=color:#ed9366>.</span><span style=color:#f07171>element_product</span><span>() </span><span style=color:#ed9366>* </span><span style=color:#ff8f40>4.0
</span><span>    }
</span><span>
</span><span>    </span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>inline</span><span>]
</span><span>    </span><span style=color:#fa6e32>fn </span><span style=color:#f29718>perimeter</span><span>(</span><span style=color:#ed9366>&</span><span style=color:#ff8f40>self</span><span>) </span><span style=color:#61676ccc>-> </span><span style=color:#fa6e32>f32 </span><span>{
</span><span>        </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>half_size</span><span style=color:#ed9366>.</span><span style=color:#f07171>element_sum</span><span>() </span><span style=color:#ed9366>* </span><span style=color:#ff8f40>4.0
</span><span>    }
</span><span>}
</span></code></pre><p><strong>Analysis</strong>: The <code>Plane3d</code> struct represents a rectangle in 3D space with <code>half_size</code> representing half the dimensions. The area calculation multiplies the product of half dimensions by 4 (since area = (2×half_x) × (2×half_y) = 4×half_x×half_y). The perimeter calculation similarly scales the sum of half dimensions by 4 (perimeter = 2×(2×half_x + 2×half_y) = 4×(half_x + half_y)).<h2 id=further-reading>Further Reading</h2><ol><li><strong>Bevy’s Geometry Primitives</strong>: For understanding the broader context of Bevy’s geometric types and their relationships<li><strong>The <code>Measured2d</code> Trait Documentation</strong>: To see other implementations and understand the trait’s contract<li><strong>Mathematical Geometry Formulas</strong>: For background on area and perimeter calculations for various shapes<li><strong>Rust Traits and Generics</strong>: For understanding how the generic implementation for <code>Ring&LTP></code> works<li><strong>Bevy’s Inline Attribute Usage</strong>: To understand performance considerations around inlining small, frequently called methods</ol></div><div data-is-md-page=true data-patch-exists=true data-patch-path=/pull_request/bevy/2025-12/pr_22141.patch id=patch-info style=display:none></div><div class=bottom-spacer></div></div></div>