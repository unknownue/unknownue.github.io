<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://unknownue.github.io name=base><title>
         #22042 enable easier modification of image samplers in image loaders
        
    </title><meta content="#22042 enable easier modification of image samplers in image loaders" property=og:title><meta content="A personal blog built with Zola and Apollo theme" property=og:description><meta content="A personal blog built with Zola and Apollo theme" name=description><link href=/icons/favicon.png rel=icon type=image/png><link href=https://unknownue.github.io/fonts.css rel=stylesheet><script src=https://unknownue.github.io/js/codeblock.js></script><script src=https://unknownue.github.io/js/toc.js></script><script src=https://unknownue.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Unknownue's Blog" href=https://unknownue.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://unknownue.github.io/theme/light.css rel=stylesheet><link href=https://unknownue.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://unknownue.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://unknownue.github.io/main.css media=screen rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js></script><script>// Initialize mermaid once DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            mermaid.initialize({
                startOnLoad: false,
                theme: document.body && document.body.classList.contains('dark') ? 'dark' : 'default',
                securityLevel: 'loose',
                flowchart: {
                    useMaxWidth: true,
                    htmlLabels: true
                },
                sequence: {
                    diagramMarginX: 50,
                    diagramMarginY: 10,
                    actorMargin: 50,
                    width: 150,
                    height: 65
                }
            });
        });</script><script src=https://unknownue.github.io/js/main.js></script><script defer src=https://unknownue.github.io/js/label-colors.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/rust.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/typescript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/go.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/cpp.min.js></script><script>// Ensure highlight.js is properly configured
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof hljs !== 'undefined') {
                hljs.configure({
                    languages: ['rust', 'javascript', 'python', 'cpp', 'go', 'typescript'],
                    ignoreUnescapedHTML: true
                });
                console.log('Highlight.js configured in header');
            }
        });</script><link href=https://cdn.jsdelivr.net/npm/diff2html/bundles/css/diff2html.min.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/diff2html/bundles/js/diff2html-ui.min.js></script><script src=https://unknownue.github.io/js/syntax-highlight.js></script><script src=https://unknownue.github.io/js/diff-sidebar.js></script><script src="https://unknownue.github.io/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><div class=content><header><div class=main><a href=https://unknownue.github.io>Unknownue's Blog</a><div class=socials><a class=social href=https://github.com/unknownue rel=me> <img alt=github src=https://unknownue.github.io/icons/social/github.svg> </a><a class=social href=https://github.com/unknownue/unknownue.github.io rel=me> <img alt=github-io src=https://unknownue.github.io/icons/social/rss.svg> </a></div></div><nav><a href=https://unknownue.github.io/posts style=margin-left:.25em>/posts</a><a href=https://unknownue.github.io/projects style=margin-left:.25em>/projects</a><a href=https://unknownue.github.io/about style=margin-left:.25em>/about</a><a href=https://unknownue.github.io/tags style=margin-left:.25em>/tags</a><button title="$SHORTCUT to open search" class=search-button id=search-button><img alt=Search class=search-icon src=https://unknownue.github.io/icons/search.svg></button><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><div id=modal-content><h1 class=page-header id=modalTitle>Search</h1><div id=searchBar><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search... role=combobox spellcheck=false><button title="Clear search" class=clear-button id=clear-search><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></button></div><div id=results-container><div id=results-info><span id=zero_results style=display:none>No results</span><span id=one_result style=display:none>1 result</span><span id=many_results style=display:none>$NUMBER results</span></div><div id=results role=listbox></div></div></div></div><a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://unknownue.github.io/icons/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://unknownue.github.io/icons/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><div class=pull-request-page><article class=md-content-page style=display:none></article><div class=back-link><a href=/pull_request/bevy/2025-12/>← Back to Pull Requests</a></div><div class=pr-metadata><span class=pr-date>2025-12-07</span><div class=language-switcher><span class="lang-link active" data-lang=en>English</span> / <a class=lang-link data-lang=zh-cn href=/pull_request/bevy/2025-12/pr-22042-zh-cn-20251207>中文</a></div></div><div class=pr-content><h1 id=title-enable-easier-modification-of-image-samplers-in-image-loaders>Title: enable easier modification of image samplers in image loaders</h1><h2 id=basic-information>Basic Information</h2><ul><li><strong>Title</strong>: enable easier modification of image samplers in image loaders<li><strong>PR Link</strong>: https://github.com/bevyengine/bevy/pull/22042<li><strong>Author</strong>: ChristopherBiscardi<li><strong>Status</strong>: MERGED<li><strong>Labels</strong>: A-Rendering, C-Usability, S-Ready-For-Final-Review<li><strong>Created</strong>: 2025-12-06T03:36:34Z<li><strong>Merged</strong>: 2025-12-07T18:41:21Z<li><strong>Merged By</strong>: mockersf</ul><h2 id=description-translation>Description Translation</h2><h1 id=objective>Objective</h1><p>Previously, to modify a sampler when loading an image with settings it was required to set all fields individually. Much of the time, these settings are all the same so to enable repeating textures you have to set the address_mode 3 times. To set filters you have to set them another 3 times.<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span>MeshMaterial3d(materials</span><span style=color:#ed9366>.</span><span style=color:#f07171>add</span><span>(
</span><span>    StandardMaterial {
</span><span>        base_color_texture</span><span style=color:#61676ccc>:
</span><span>            </span><span style=color:#55b4d4;font-style:italic>Some</span><span>(
</span><span>                asset_server</span><span style=color:#ed9366>.</span><span style=color:#f07171>load_with_settings</span><span>(
</span><span>                    </span><span style=color:#86b300>"floor_graph_base_color.png"</span><span style=color:#61676ccc>,
</span><span>                    |</span><span style=color:#ff8f40>settings</span><span style=color:#61676ccc>: </span><span style=color:#ed9366>&</span><span style=color:#fa6e32>mut</span><span> ImageLoaderSettings| {
</span><span>                        </span><span style=color:#fa6e32>let</span><span>  descriptor </span><span style=color:#ed9366>=</span><span> settings</span><span style=color:#ed9366>.</span><span>sampler</span><span style=color:#ed9366>.</span><span style=color:#f07171>get_or_init_descriptor</span><span>()</span><span style=color:#61676ccc>;
</span><span>                        descriptor</span><span style=color:#ed9366>.</span><span>address_mode_u </span><span style=color:#ed9366>= </span><span>bevy</span><span style=color:#ed9366>::</span><span>image</span><span style=color:#ed9366>::</span><span>ImageAddressMode</span><span style=color:#ed9366>::</span><span>Repeat</span><span style=color:#61676ccc>;
</span><span>                        descriptor</span><span style=color:#ed9366>.</span><span>address_mode_v </span><span style=color:#ed9366>= </span><span>bevy</span><span style=color:#ed9366>::</span><span>image</span><span style=color:#ed9366>::</span><span>ImageAddressMode</span><span style=color:#ed9366>::</span><span>Repeat</span><span style=color:#61676ccc>;
</span><span>                        descriptor</span><span style=color:#ed9366>.</span><span>address_mode_w </span><span style=color:#ed9366>= </span><span>bevy</span><span style=color:#ed9366>::</span><span>image</span><span style=color:#ed9366>::</span><span>ImageAddressMode</span><span style=color:#ed9366>::</span><span>Repeat</span><span style=color:#61676ccc>;
</span><span>                        descriptor</span><span style=color:#ed9366>.</span><span>mag_filter </span><span style=color:#ed9366>= </span><span>ImageFilterMode</span><span style=color:#ed9366>::</span><span>Linear</span><span style=color:#61676ccc>;
</span><span>                        descriptor</span><span style=color:#ed9366>.</span><span>min_filter </span><span style=color:#ed9366>= </span><span>ImageFilterMode</span><span style=color:#ed9366>::</span><span>Linear</span><span style=color:#61676ccc>;
</span><span>                        descriptor</span><span style=color:#ed9366>.</span><span>mipmap_filter </span><span style=color:#ed9366>= </span><span>ImageFilterMode</span><span style=color:#ed9366>::</span><span>Linear</span><span style=color:#61676ccc>;
</span><span>                    }
</span><span>                )</span><span style=color:#61676ccc>,
</span><span>            )</span><span style=color:#61676ccc>,
</span><span>        unlit</span><span style=color:#61676ccc>: </span><span style=color:#ff8f40>true</span><span style=color:#61676ccc>,
</span><span>        cull_mode</span><span style=color:#61676ccc>: </span><span style=color:#55b4d4;font-style:italic>None</span><span style=color:#61676ccc>,
</span><span>        uv_transform</span><span style=color:#61676ccc>: </span><span>Affine2</span><span style=color:#ed9366>::</span><span>from_scale(Vec2</span><span style=color:#ed9366>::</span><span>new(</span><span style=color:#ff8f40>30.</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>90.</span><span>))</span><span style=color:#61676ccc>,
</span><span>        </span><span style=color:#ed9366>..</span><span style=color:#f07171>default</span><span>()
</span><span>    }</span><span style=color:#61676ccc>,
</span><span>))</span><span style=color:#61676ccc>,
</span></code></pre><h2 id=solution>Solution</h2><p>Add two new helpers, loosely modeled after the <code>Transform::with_&LTfield></code> functions. Further modifications can still be made to the descriptor for use cases which want to set one of the three fields differently, or additionally set anisotropy_clamp, etc.<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#fa6e32>let</span><span> descriptor </span><span style=color:#ed9366>=</span><span> settings
</span><span>    </span><span style=color:#ed9366>.</span><span>sampler
</span><span>    </span><span style=color:#ed9366>.</span><span style=color:#f07171>get_or_init_descriptor</span><span>()
</span><span>    </span><span style=color:#ed9366>.</span><span style=color:#f07171>set_address_mode</span><span>(ImageAddressMode</span><span style=color:#ed9366>::</span><span>Repeat)
</span><span>    </span><span style=color:#ed9366>.</span><span style=color:#f07171>set_filter</span><span>(ImageFilterMode</span><span style=color:#ed9366>::</span><span>Linear)</span><span style=color:#61676ccc>;
</span></code></pre><h2 id=testing>Testing</h2><p>New test in bevy_image<h2 id=showcase>Showcase</h2><pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span>MeshMaterial3d(materials</span><span style=color:#ed9366>.</span><span style=color:#f07171>add</span><span>(
</span><span>    StandardMaterial {
</span><span>        base_color_texture</span><span style=color:#61676ccc>:
</span><span>            </span><span style=color:#55b4d4;font-style:italic>Some</span><span>(
</span><span>                asset_server</span><span style=color:#ed9366>.</span><span style=color:#f07171>load_with_settings</span><span>(
</span><span>                    </span><span style=color:#86b300>"floor_graph_base_color.png"</span><span style=color:#61676ccc>,
</span><span>                    |</span><span style=color:#ff8f40>settings</span><span style=color:#61676ccc>: </span><span style=color:#ed9366>&</span><span style=color:#fa6e32>mut</span><span> ImageLoaderSettings| {
</span><span>                        </span><span style=color:#fa6e32>let</span><span> descriptor </span><span style=color:#ed9366>=</span><span> settings
</span><span>                            </span><span style=color:#ed9366>.</span><span>sampler
</span><span>                            </span><span style=color:#ed9366>.</span><span style=color:#f07171>get_or_init_descriptor</span><span>()
</span><span>                            </span><span style=color:#ed9366>.</span><span style=color:#f07171>set_address_mode</span><span>(ImageAddressMode</span><span style=color:#ed9366>::</span><span>Repeat)
</span><span>                            </span><span style=color:#ed9366>.</span><span style=color:#f07171>set_filter</span><span>(ImageFilterMode</span><span style=color:#ed9366>::</span><span>Linear)</span><span style=color:#61676ccc>;
</span><span>                    }
</span><span>                )</span><span style=color:#61676ccc>,
</span><span>            )</span><span style=color:#61676ccc>,
</span><span>        unlit</span><span style=color:#61676ccc>: </span><span style=color:#ff8f40>true</span><span style=color:#61676ccc>,
</span><span>        cull_mode</span><span style=color:#61676ccc>: </span><span style=color:#55b4d4;font-style:italic>None</span><span style=color:#61676ccc>,
</span><span>        uv_transform</span><span style=color:#61676ccc>: </span><span>Affine2</span><span style=color:#ed9366>::</span><span>from_scale(Vec2</span><span style=color:#ed9366>::</span><span>new(</span><span style=color:#ff8f40>30.</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>90.</span><span>))</span><span style=color:#61676ccc>,
</span><span>        </span><span style=color:#ed9366>..</span><span style=color:#f07171>default</span><span>()
</span><span>    }</span><span style=color:#61676ccc>,
</span><span>))</span><span style=color:#61676ccc>,
</span></code></pre><p>This PR now includes:<ul><li><code>set_filter</code><li><code>set_address_mode</code><li><code>set_anisotropic_filter</code></ul><h2 id=the-story-of-this-pull-request>The Story of This Pull Request</h2><p>This PR addresses a common usability issue in Bevy’s image loading system where configuring texture samplers required repetitive, error-prone code. When loading textures with custom sampler settings, developers had to set each field individually, even when applying the same value to multiple similar fields. For example, setting a texture to repeat in all three dimensions required three separate assignments, and setting filtering modes required another three assignments.<p>The problem manifested in real code like this:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#fa6e32>let</span><span> descriptor </span><span style=color:#ed9366>=</span><span> settings</span><span style=color:#ed9366>.</span><span>sampler</span><span style=color:#ed9366>.</span><span style=color:#f07171>get_or_init_descriptor</span><span>()</span><span style=color:#61676ccc>;
</span><span>descriptor</span><span style=color:#ed9366>.</span><span>address_mode_u </span><span style=color:#ed9366>= </span><span>bevy</span><span style=color:#ed9366>::</span><span>image</span><span style=color:#ed9366>::</span><span>ImageAddressMode</span><span style=color:#ed9366>::</span><span>Repeat</span><span style=color:#61676ccc>;
</span><span>descriptor</span><span style=color:#ed9366>.</span><span>address_mode_v </span><span style=color:#ed9366>= </span><span>bevy</span><span style=color:#ed9366>::</span><span>image</span><span style=color:#ed9366>::</span><span>ImageAddressMode</span><span style=color:#ed9366>::</span><span>Repeat</span><span style=color:#61676ccc>;
</span><span>descriptor</span><span style=color:#ed9366>.</span><span>address_mode_w </span><span style=color:#ed9366>= </span><span>bevy</span><span style=color:#ed9366>::</span><span>image</span><span style=color:#ed9366>::</span><span>ImageAddressMode</span><span style=color:#ed9366>::</span><span>Repeat</span><span style=color:#61676ccc>;
</span><span>descriptor</span><span style=color:#ed9366>.</span><span>mag_filter </span><span style=color:#ed9366>= </span><span>ImageFilterMode</span><span style=color:#ed9366>::</span><span>Linear</span><span style=color:#61676ccc>;
</span><span>descriptor</span><span style=color:#ed9366>.</span><span>min_filter </span><span style=color:#ed9366>= </span><span>ImageFilterMode</span><span style=color:#ed9366>::</span><span>Linear</span><span style=color:#61676ccc>;
</span><span>descriptor</span><span style=color:#ed9366>.</span><span>mipmap_filter </span><span style=color:#ed9366>= </span><span>ImageFilterMode</span><span style=color:#ed9366>::</span><span>Linear</span><span style=color:#61676ccc>;
</span></code></pre><p>This approach had several drawbacks: it was verbose (6 lines instead of 2), prone to copy-paste errors, and required developers to remember which fields needed to be set together for common use cases like anisotropic filtering.<p>The solution implemented follows a common pattern in Bevy’s API design - the builder pattern with fluent interface methods, similar to what’s used in <code>Transform::with_*</code> methods. By adding three new helper methods to <code>ImageSamplerDescriptor</code>, the PR significantly reduces boilerplate while maintaining full flexibility.<p>The implementation adds three methods:<ol><li><p><strong><code>set_filter()</code></strong>: Sets all three filter modes (min, mag, and mipmap) to the same value. This covers the common case where developers want consistent filtering across all filter types.</p><li><p><strong><code>set_address_mode()</code></strong>: Sets all three address modes (U, V, and W) to the same value. This is particularly useful for textures that should repeat in all dimensions.</p><li><p><strong><code>set_anisotropic_filter()</code></strong>: Configures anisotropic filtering by setting the anisotropy clamp value and automatically setting all filters to linear mode (a requirement for anisotropic filtering to work).</p></ol><p>The methods are designed to be chainable (returning <code>&mut Self</code>) and marked as <code>#[inline]</code> for zero-cost abstraction. This design allows developers to write concise, readable code:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#fa6e32>let</span><span> descriptor </span><span style=color:#ed9366>=</span><span> settings
</span><span>    </span><span style=color:#ed9366>.</span><span>sampler
</span><span>    </span><span style=color:#ed9366>.</span><span style=color:#f07171>get_or_init_descriptor</span><span>()
</span><span>    </span><span style=color:#ed9366>.</span><span style=color:#f07171>set_address_mode</span><span>(ImageAddressMode</span><span style=color:#ed9366>::</span><span>Repeat)
</span><span>    </span><span style=color:#ed9366>.</span><span style=color:#f07171>set_filter</span><span>(ImageFilterMode</span><span style=color:#ed9366>::</span><span>Linear)</span><span style=color:#61676ccc>;
</span></code></pre><p>Importantly, the solution doesn’t remove the ability to configure individual fields differently. Developers can still manually set <code>address_mode_u</code>, <code>address_mode_v</code>, and <code>address_mode_w</code> separately if they need different behaviors along different axes. The helper methods simply provide a convenient shorthand for the most common cases.<p>The PR includes comprehensive tests that verify both the basic functionality and the anisotropic filtering behavior. The tests demonstrate the expected usage pattern and ensure that the methods correctly modify the underlying descriptor fields.<p>One technical consideration worth noting is the <code>set_anisotropic_filter</code> method’s implementation. It automatically sets all filter modes to <code>ImageFilterMode::Linear</code> because anisotropic filtering requires linear filtering to function correctly. This design choice prevents a common error where developers might enable anisotropy without setting the appropriate filter modes, which would otherwise result in incorrect rendering.<p>The impact of these changes is straightforward: less code, fewer errors, and better developer experience when working with texture samplers in Bevy. The changes are backward compatible - existing code continues to work unchanged, while new code can take advantage of the more ergonomic API.<h2 id=visual-representation>Visual Representation</h2><pre class=language-mermaid data-lang=mermaid style=color:#61676c;background-color:#fafafa><code class=language-mermaid data-lang=mermaid><span>graph TD
</span><span>    A[ImageLoaderSettings] --> B[.sampler]
</span><span>    B --> C[ImageSampler::get_or_init_descriptor()]
</span><span>    C --> D[ImageSamplerDescriptor]
</span><span>    D --> E[.set_address_mode()]
</span><span>    D --> F[.set_filter()]
</span><span>    D --> G[.set_anisotropic_filter()]
</span><span>    E --> H[Modified Descriptor]
</span><span>    F --> H
</span><span>    G --> H
</span><span>    H --> I[Image Loading Pipeline]
</span></code></pre><h2 id=key-files-changed>Key Files Changed</h2><h3 id=crates-bevy-image-src-image-rs-60-0><code>crates/bevy_image/src/image.rs</code> (+60/-0)</h3><p>This file contains the <code>ImageSamplerDescriptor</code> struct definition and its implementation. The PR adds three new helper methods to this struct:<ol><li><strong><code>set_filter()</code></strong>: A convenience method that sets all three filter modes (min, mag, and mipmap) to the same value.<li><strong><code>set_address_mode()</code></strong>: A convenience method that sets all three address modes (U, V, and W) to the same value.<li><strong><code>set_anisotropic_filter()</code></strong>: A specialized method that configures anisotropic filtering, automatically setting the required linear filter modes.</ol><p>Code additions:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>/// Returns this sampler descriptor with a new `ImageFilterMode` min, mag, and mipmap filters
</span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>inline</span><span>]
</span><span style=color:#fa6e32>pub fn </span><span style=color:#f29718>set_filter</span><span>(</span><span style=color:#ed9366>&</span><span style=color:#fa6e32>mut </span><span style=color:#ff8f40>self</span><span>, </span><span style=color:#ff8f40>filter</span><span style=color:#61676ccc>:</span><span> ImageFilterMode) </span><span style=color:#61676ccc>-> </span><span style=color:#ed9366>&</span><span style=color:#fa6e32>mut Self </span><span>{
</span><span>    </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>mag_filter </span><span style=color:#ed9366>=</span><span> filter</span><span style=color:#61676ccc>;
</span><span>    </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>min_filter </span><span style=color:#ed9366>=</span><span> filter</span><span style=color:#61676ccc>;
</span><span>    </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>mipmap_filter </span><span style=color:#ed9366>=</span><span> filter</span><span style=color:#61676ccc>;
</span><span>    </span><span style=color:#55b4d4;font-style:italic>self
</span><span>}
</span><span>
</span><span style=color:#abb0b6;font-style:italic>/// Returns this sampler descriptor with a new `ImageAddressMode` for u, v, and w
</span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>inline</span><span>]
</span><span style=color:#fa6e32>pub fn </span><span style=color:#f29718>set_address_mode</span><span>(</span><span style=color:#ed9366>&</span><span style=color:#fa6e32>mut </span><span style=color:#ff8f40>self</span><span>, </span><span style=color:#ff8f40>address_mode</span><span style=color:#61676ccc>:</span><span> ImageAddressMode) </span><span style=color:#61676ccc>-> </span><span style=color:#ed9366>&</span><span style=color:#fa6e32>mut Self </span><span>{
</span><span>    </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>address_mode_u </span><span style=color:#ed9366>=</span><span> address_mode</span><span style=color:#61676ccc>;
</span><span>    </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>address_mode_v </span><span style=color:#ed9366>=</span><span> address_mode</span><span style=color:#61676ccc>;
</span><span>    </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>address_mode_w </span><span style=color:#ed9366>=</span><span> address_mode</span><span style=color:#61676ccc>;
</span><span>    </span><span style=color:#55b4d4;font-style:italic>self
</span><span>}
</span><span>
</span><span style=color:#abb0b6;font-style:italic>/// Returns this sampler descriptor with an `anisotropy_clamp` value and also
</span><span style=color:#abb0b6;font-style:italic>/// set filters to `ImageFilterMode::Linear`, which is required to
</span><span style=color:#abb0b6;font-style:italic>/// use anisotropy.
</span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>inline</span><span>]
</span><span style=color:#fa6e32>pub fn </span><span style=color:#f29718>set_anisotropic_filter</span><span>(</span><span style=color:#ed9366>&</span><span style=color:#fa6e32>mut </span><span style=color:#ff8f40>self</span><span>, </span><span style=color:#ff8f40>anisotropy_clamp</span><span style=color:#61676ccc>: </span><span style=color:#fa6e32>u16</span><span>) </span><span style=color:#61676ccc>-> </span><span style=color:#ed9366>&</span><span style=color:#fa6e32>mut Self </span><span>{
</span><span>    </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>mag_filter </span><span style=color:#ed9366>= </span><span>ImageFilterMode</span><span style=color:#ed9366>::</span><span>Linear</span><span style=color:#61676ccc>;
</span><span>    </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>min_filter </span><span style=color:#ed9366>= </span><span>ImageFilterMode</span><span style=color:#ed9366>::</span><span>Linear</span><span style=color:#61676ccc>;
</span><span>    </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>mipmap_filter </span><span style=color:#ed9366>= </span><span>ImageFilterMode</span><span style=color:#ed9366>::</span><span>Linear</span><span style=color:#61676ccc>;
</span><span>    </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>anisotropy_clamp </span><span style=color:#ed9366>=</span><span> anisotropy_clamp</span><span style=color:#61676ccc>;
</span><span>    </span><span style=color:#55b4d4;font-style:italic>self
</span><span>}
</span></code></pre><p>The PR also adds two test functions that verify the new functionality works correctly:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>test</span><span>]
</span><span style=color:#fa6e32>fn </span><span style=color:#f29718>get_or_init_sampler_modifications</span><span>() {
</span><span>    </span><span style=color:#abb0b6;font-style:italic>// given some sampler
</span><span>    </span><span style=color:#fa6e32>let mut</span><span> default_sampler </span><span style=color:#ed9366>= </span><span>ImageSampler</span><span style=color:#ed9366>::</span><span>Default</span><span style=color:#61676ccc>;
</span><span>    </span><span style=color:#abb0b6;font-style:italic>// a load_with_settings call wants to customize the descriptor
</span><span>    </span><span style=color:#fa6e32>let</span><span> my_sampler_in_a_loader </span><span style=color:#ed9366>=</span><span> default_sampler
</span><span>        </span><span style=color:#ed9366>.</span><span style=color:#f07171>get_or_init_descriptor</span><span>()
</span><span>        </span><span style=color:#ed9366>.</span><span style=color:#f07171>set_filter</span><span>(ImageFilterMode</span><span style=color:#ed9366>::</span><span>Linear)
</span><span>        </span><span style=color:#ed9366>.</span><span style=color:#f07171>set_address_mode</span><span>(ImageAddressMode</span><span style=color:#ed9366>::</span><span>Repeat)</span><span style=color:#61676ccc>;
</span><span>
</span><span>    </span><span style=color:#f07171>assert_eq!</span><span>(
</span><span>        my_sampler_in_a_loader</span><span style=color:#ed9366>.</span><span>address_mode_u</span><span style=color:#61676ccc>,
</span><span>        ImageAddressMode</span><span style=color:#ed9366>::</span><span>Repeat
</span><span>    )</span><span style=color:#61676ccc>;
</span><span>    </span><span style=color:#f07171>assert_eq!</span><span>(my_sampler_in_a_loader</span><span style=color:#ed9366>.</span><span>min_filter</span><span style=color:#61676ccc>, </span><span>ImageFilterMode</span><span style=color:#ed9366>::</span><span>Linear)</span><span style=color:#61676ccc>;
</span><span>}
</span><span>
</span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>test</span><span>]
</span><span style=color:#fa6e32>fn </span><span style=color:#f29718>get_or_init_sampler_anisotropy</span><span>() {
</span><span>    </span><span style=color:#abb0b6;font-style:italic>// given some sampler
</span><span>    </span><span style=color:#fa6e32>let mut</span><span> default_sampler </span><span style=color:#ed9366>= </span><span>ImageSampler</span><span style=color:#ed9366>::</span><span>Default</span><span style=color:#61676ccc>;
</span><span>    </span><span style=color:#abb0b6;font-style:italic>// a load_with_settings call wants to customize the descriptor
</span><span>    </span><span style=color:#fa6e32>let</span><span> my_sampler_in_a_loader </span><span style=color:#ed9366>=</span><span> default_sampler
</span><span>        </span><span style=color:#ed9366>.</span><span style=color:#f07171>get_or_init_descriptor</span><span>()
</span><span>        </span><span style=color:#ed9366>.</span><span style=color:#f07171>set_anisotropic_filter</span><span>(</span><span style=color:#ff8f40>8</span><span>)</span><span style=color:#61676ccc>;
</span><span>
</span><span>    </span><span style=color:#f07171>assert_eq!</span><span>(my_sampler_in_a_loader</span><span style=color:#ed9366>.</span><span>min_filter</span><span style=color:#61676ccc>, </span><span>ImageFilterMode</span><span style=color:#ed9366>::</span><span>Linear)</span><span style=color:#61676ccc>;
</span><span>    </span><span style=color:#f07171>assert_eq!</span><span>(my_sampler_in_a_loader</span><span style=color:#ed9366>.</span><span>anisotropy_clamp</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>8</span><span>)</span><span style=color:#61676ccc>;
</span><span>}
</span></code></pre><p>These changes directly address the PR’s goal by providing a more ergonomic API for configuring texture samplers while maintaining backward compatibility and full flexibility for advanced use cases.<h2 id=further-reading>Further Reading</h2><ol><li><strong>Bevy Asset System Documentation</strong>: Understanding how <code>load_with_settings</code> works in Bevy’s asset system<li><strong>wgpu SamplerDescriptor</strong>: The underlying WebGPU/WGPU sampler configuration that <code>ImageSamplerDescriptor</code> translates to<li><strong>Texture Filtering Modes</strong>: Technical details about minification, magnification, and mipmap filtering<li><strong>Texture Addressing Modes</strong>: Explanation of wrap, mirror, clamp, and border addressing modes<li><strong>Anisotropic Filtering</strong>: How anisotropic filtering improves texture quality at oblique angles<li><strong>Builder Pattern</strong>: The design pattern used in this implementation for creating fluent APIs</ol></div><div data-is-md-page=true data-patch-exists=true data-patch-path=/pull_request/bevy/2025-12/pr_22042.patch id=patch-info style=display:none></div><div class=bottom-spacer></div></div></div>