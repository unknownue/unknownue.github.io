<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://unknownue.github.io name=base><title>
         #21910 UI scrollbars clipping fix
        
    </title><meta content="#21910 UI scrollbars clipping fix" property=og:title><meta content="A personal blog built with Zola and Apollo theme" property=og:description><meta content="A personal blog built with Zola and Apollo theme" name=description><link href=/icons/favicon.png rel=icon type=image/png><link href=https://unknownue.github.io/fonts.css rel=stylesheet><script src=https://unknownue.github.io/js/codeblock.js></script><script src=https://unknownue.github.io/js/toc.js></script><script src=https://unknownue.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Unknownue's Blog" href=https://unknownue.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://unknownue.github.io/theme/light.css rel=stylesheet><link href=https://unknownue.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://unknownue.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://unknownue.github.io/main.css media=screen rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js></script><script>// Initialize mermaid once DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            mermaid.initialize({
                startOnLoad: false,
                theme: document.body && document.body.classList.contains('dark') ? 'dark' : 'default',
                securityLevel: 'loose',
                flowchart: {
                    useMaxWidth: true,
                    htmlLabels: true
                },
                sequence: {
                    diagramMarginX: 50,
                    diagramMarginY: 10,
                    actorMargin: 50,
                    width: 150,
                    height: 65
                }
            });
        });</script><script src=https://unknownue.github.io/js/main.js></script><script defer src=https://unknownue.github.io/js/label-colors.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/rust.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/typescript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/go.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/cpp.min.js></script><script>// Ensure highlight.js is properly configured
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof hljs !== 'undefined') {
                hljs.configure({
                    languages: ['rust', 'javascript', 'python', 'cpp', 'go', 'typescript'],
                    ignoreUnescapedHTML: true
                });
                console.log('Highlight.js configured in header');
            }
        });</script><link href=https://cdn.jsdelivr.net/npm/diff2html/bundles/css/diff2html.min.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/diff2html/bundles/js/diff2html-ui.min.js></script><script src=https://unknownue.github.io/js/syntax-highlight.js></script><script src=https://unknownue.github.io/js/diff-sidebar.js></script><script src="https://unknownue.github.io/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><div class=content><header><div class=main><a href=https://unknownue.github.io>Unknownue's Blog</a><div class=socials><a class=social href=https://github.com/unknownue rel=me> <img alt=github src=https://unknownue.github.io/icons/social/github.svg> </a><a class=social href=https://github.com/unknownue/unknownue.github.io rel=me> <img alt=github-io src=https://unknownue.github.io/icons/social/rss.svg> </a></div></div><nav><a href=https://unknownue.github.io/posts style=margin-left:.25em>/posts</a><a href=https://unknownue.github.io/projects style=margin-left:.25em>/projects</a><a href=https://unknownue.github.io/about style=margin-left:.25em>/about</a><a href=https://unknownue.github.io/tags style=margin-left:.25em>/tags</a><button title="$SHORTCUT to open search" class=search-button id=search-button><img alt=Search class=search-icon src=https://unknownue.github.io/icons/search.svg></button><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><div id=modal-content><h1 class=page-header id=modalTitle>Search</h1><div id=searchBar><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search... role=combobox spellcheck=false><button title="Clear search" class=clear-button id=clear-search><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></button></div><div id=results-container><div id=results-info><span id=zero_results style=display:none>No results</span><span id=one_result style=display:none>1 result</span><span id=many_results style=display:none>$NUMBER results</span></div><div id=results role=listbox></div></div></div></div><a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://unknownue.github.io/icons/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://unknownue.github.io/icons/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><div class=pull-request-page><article class=md-content-page style=display:none></article><div class=back-link><a href=/pull_request/bevy/2025-12/>← Back to Pull Requests</a></div><div class=pr-metadata><span class=pr-date>2025-12-15</span><div class=language-switcher><span class="lang-link active" data-lang=en>English</span> / <a class=lang-link data-lang=zh-cn href=/pull_request/bevy/2025-12/pr-21910-zh-cn-20251215>中文</a></div></div><div class=pr-content><h1 id=ui-scrollbars-clipping-fix>UI scrollbars clipping fix</h1><h2 id=basic-information>Basic Information</h2><ul><li><strong>Title</strong>: UI scrollbars clipping fix<li><strong>PR Link</strong>: https://github.com/bevyengine/bevy/pull/21910<li><strong>Author</strong>: ickshonpe<li><strong>Status</strong>: MERGED<li><strong>Labels</strong>: C-Bug, A-UI, S-Ready-For-Final-Review, D-Straightforward<li><strong>Created</strong>: 2025-11-22T11:31:43Z<li><strong>Merged</strong>: 2025-12-15T00:56:35Z<li><strong>Merged By</strong>: alice-i-cecile</ul><h2 id=description>Description</h2><h1 id=objective>Objective</h1><h4 id=fix-two-problems>Fix two problems</h4><ol><li>Scrollbars are placed in the padding region of the node, not the content region. The content insets returned by <code>ComputedNode::content_inset</code> should account for the sizes of the scrollbars.<li>In <code>update_clipping_system</code> the clipping rect calculations are incorrect, <code>scrollbar_size</code> should only be added to the <code>right</code> and <code>bottom</code> when <code>visual_area</code> is set to <code>ContentBox</code>. For <code>BorderBox</code> and <code>PaddingBox</code>, the scrollbars are inside the clipping rect.</ol><h2 id=solution>Solution</h2><ol><li>Add the scrollbar size to the <code>right</code> and <code>bottom</code> insets returned by <code>ComputedNode::content_inset</code>.<li>Since <code>content_inset</code> now includes <code>scrollbar size</code>, remove the subtraction from <code>clip_rect.max</code> in <code>update_clipping_system</code>.</ol><h2 id=testing>Testing</h2><p>Look at:<pre style=color:#61676c;background-color:#fafafa><code><span>cargo run --example scrollbars --features="experimental_bevy_ui_widgets"
</span></code></pre><h2 id=the-story-of-this-pull-request>The Story of This Pull Request</h2><p>This pull request addresses a subtle bug in Bevy’s UI system related to scrollbar placement and clipping calculations. The issue was discovered when developers noticed that scrollbars were appearing in incorrect positions relative to their containing nodes, and content was being improperly clipped when scrollbars were present.<p>The core problem stemmed from an inconsistency in how the system calculated content insets for nodes with scrollbars. In UI layout systems, a node typically has several conceptual regions: border, padding, content, and potentially scrollbars. The content inset defines how much space is reserved on each side of a node before the actual content area begins, accounting for borders and padding. However, the original implementation didn’t account for scrollbars in this calculation.<p>When examining the <code>ComputedNode::content_inset()</code> method, we can see the original implementation simply returned the sum of border and padding:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#fa6e32>pub fn </span><span style=color:#f29718>content_inset</span><span>(</span><span style=color:#ed9366>&</span><span style=color:#ff8f40>self</span><span>) </span><span style=color:#61676ccc>-></span><span> BorderRect {
</span><span>    </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>border </span><span style=color:#ed9366>+ </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>padding
</span><span>}
</span></code></pre><p>This was problematic because scrollbars occupy space at the edges of a node’s content area. Specifically, horizontal scrollbars appear at the bottom, and vertical scrollbars appear at the right. These scrollbars should reduce the available content area, so they need to be included in the content inset calculation.<p>The fix modifies the <code>content_inset()</code> method to add the scrollbar dimensions to the right and bottom insets:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#fa6e32>pub fn </span><span style=color:#f29718>content_inset</span><span>(</span><span style=color:#ed9366>&</span><span style=color:#ff8f40>self</span><span>) </span><span style=color:#61676ccc>-></span><span> BorderRect {
</span><span>    </span><span style=color:#fa6e32>let mut</span><span> content_inset </span><span style=color:#ed9366>= </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>border </span><span style=color:#ed9366>+ </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>padding</span><span style=color:#61676ccc>;
</span><span>    content_inset</span><span style=color:#ed9366>.</span><span>right </span><span style=color:#ed9366>+= </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>scrollbar_size</span><span style=color:#ed9366>.</span><span>x</span><span style=color:#61676ccc>;
</span><span>    content_inset</span><span style=color:#ed9366>.</span><span>bottom </span><span style=color:#ed9366>+= </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>scrollbar_size</span><span style=color:#ed9366>.</span><span>y</span><span style=color:#61676ccc>;
</span><span>    content_inset
</span><span>}
</span></code></pre><p>This change has a cascading effect on other calculations that depend on <code>content_inset()</code>. The <code>horizontal_scrollbar_gutter()</code> and <code>vertical_scrollbar_gutter()</code> methods, which calculate the rectangular areas where scrollbars should be rendered, needed adjustments. These methods use the content inset to position the scrollbars within the node.<p>Looking at the <code>horizontal_scrollbar_gutter()</code> method before the fix:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#fa6e32>let</span><span> max_x </span><span style=color:#ed9366>=</span><span> half_size</span><span style=color:#ed9366>.</span><span>x </span><span style=color:#ed9366>-</span><span> content_inset</span><span style=color:#ed9366>.</span><span>right </span><span style=color:#ed9366>- </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>scrollbar_size</span><span style=color:#ed9366>.</span><span>x</span><span style=color:#61676ccc>;
</span><span style=color:#fa6e32>let</span><span> max_y </span><span style=color:#ed9366>=</span><span> half_size</span><span style=color:#ed9366>.</span><span>y </span><span style=color:#ed9366>-</span><span> content_inset</span><span style=color:#ed9366>.</span><span>bottom</span><span style=color:#61676ccc>;
</span><span style=color:#fa6e32>let</span><span> min_y </span><span style=color:#ed9366>=</span><span> max_y </span><span style=color:#ed9366>- </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>scrollbar_size</span><span style=color:#ed9366>.</span><span>y</span><span style=color:#61676ccc>;
</span></code></pre><p>After the fix, with the scrollbar size now included in <code>content_inset.right</code> and <code>content_inset.bottom</code>, the calculation simplifies:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#fa6e32>let</span><span> max_x </span><span style=color:#ed9366>=</span><span> half_size</span><span style=color:#ed9366>.</span><span>x </span><span style=color:#ed9366>-</span><span> content_inset</span><span style=color:#ed9366>.</span><span>right</span><span style=color:#61676ccc>;
</span><span style=color:#fa6e32>let</span><span> min_y </span><span style=color:#ed9366>=</span><span> half_size</span><span style=color:#ed9366>.</span><span>y </span><span style=color:#ed9366>-</span><span> content_inset</span><span style=color:#ed9366>.</span><span>bottom</span><span style=color:#61676ccc>;
</span><span style=color:#fa6e32>let</span><span> max_y </span><span style=color:#ed9366>=</span><span> min_y </span><span style=color:#ed9366>+ </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>scrollbar_size</span><span style=color:#ed9366>.</span><span>y</span><span style=color:#61676ccc>;
</span></code></pre><p>The same pattern applies to the <code>vertical_scrollbar_gutter()</code> method. These changes ensure scrollbars are positioned correctly within the padding region of the node, not overlapping the content area.<p>The second part of the fix addresses a related issue in the clipping system. The <code>update_clipping()</code> function calculates a clipping rectangle for nodes, which defines what portion of the node’s content is visible. The function needed to consider different visual area types: <code>BorderBox</code>, <code>PaddingBox</code>, and <code>ContentBox</code>.<p>The key insight is that for <code>BorderBox</code> and <code>PaddingBox</code>, scrollbars should be inside the clipping rect (visible), while for <code>ContentBox</code>, scrollbars should be outside the clipping rect (content is clipped to make room for scrollbars). The original code was incorrectly subtracting scrollbar size from the clipping rect for all visual area types:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span>clip_rect</span><span style=color:#ed9366>.</span><span>max</span><span style=color:#ed9366>.</span><span>x </span><span style=color:#ed9366>-=</span><span> clip_inset</span><span style=color:#ed9366>.</span><span>right </span><span style=color:#ed9366>+</span><span> computed_node</span><span style=color:#ed9366>.</span><span>scrollbar_size</span><span style=color:#ed9366>.</span><span>x</span><span style=color:#61676ccc>;
</span><span>clip_rect</span><span style=color:#ed9366>.</span><span>max</span><span style=color:#ed9366>.</span><span>y </span><span style=color:#ed9366>-=</span><span> clip_inset</span><span style=color:#ed9366>.</span><span>bottom </span><span style=color:#ed9366>+</span><span> computed_node</span><span style=color:#ed9366>.</span><span>scrollbar_size</span><span style=color:#ed9366>.</span><span>y</span><span style=color:#61676ccc>;
</span></code></pre><p>With the updated <code>content_inset()</code> method already including scrollbar size for <code>ContentBox</code>, the fix removes the extra subtraction:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span>clip_rect</span><span style=color:#ed9366>.</span><span>max</span><span style=color:#ed9366>.</span><span>x </span><span style=color:#ed9366>-=</span><span> clip_inset</span><span style=color:#ed9366>.</span><span>right</span><span style=color:#61676ccc>;
</span><span>clip_rect</span><span style=color:#ed9366>.</span><span>max</span><span style=color:#ed9366>.</span><span>y </span><span style=color:#ed9366>-=</span><span> clip_inset</span><span style=color:#ed9366>.</span><span>bottom</span><span style=color:#61676ccc>;
</span></code></pre><p>Now, when <code>clip_inset</code> is derived from <code>content_inset()</code> (for <code>ContentBox</code>), it already includes the scrollbar size. For <code>BorderBox</code> and <code>PaddingBox</code>, <code>clip_inset</code> doesn’t include scrollbar size, which is correct because scrollbars should remain visible inside those clipping areas.<p>This fix demonstrates a common pattern in UI systems: ensuring consistency between different calculations that depend on the same underlying data. By centralizing the scrollbar size calculation in <code>content_inset()</code>, we prevent drift between related computations and make the system more maintainable.<p>From an architectural perspective, this change improves the separation of concerns. The <code>content_inset()</code> method now properly represents all elements that reduce the available content area, making it a more reliable abstraction for other parts of the UI system to use.<h2 id=visual-representation>Visual Representation</h2><pre class=language-mermaid data-lang=mermaid style=color:#61676c;background-color:#fafafa><code class=language-mermaid data-lang=mermaid><span>graph TD
</span><span>    A[UI Node with Scrollbars] --> B{Calculate content_inset}
</span><span>    B --> C[Original: border + padding]
</span><span>    B --> D[Fixed: border + padding + scrollbar_size]
</span><span>    D --> E[Used by scrollbar_gutter methods]
</span><span>    D --> F[Used by update_clipping system]
</span><span>    E --> G[Correct scrollbar positioning]
</span><span>    F --> H[Correct content clipping]
</span></code></pre><h2 id=key-files-changed>Key Files Changed</h2><h3 id=crates-bevy-ui-src-ui-node-rs-10-7><code>crates/bevy_ui/src/ui_node.rs</code> (+10/-7)</h3><p>This file contains the <code>ComputedNode</code> struct and its methods. The main changes involve updating the <code>content_inset()</code> method to include scrollbar dimensions, and adjusting the scrollbar gutter calculations to work with the updated content inset.<p>Key changes:<ol><li><strong>Updated <code>content_inset()</code> method</strong>:</ol><pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before:
</span><span style=color:#fa6e32>pub fn </span><span style=color:#f29718>content_inset</span><span>(</span><span style=color:#ed9366>&</span><span style=color:#ff8f40>self</span><span>) </span><span style=color:#61676ccc>-></span><span> BorderRect {
</span><span>    </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>border </span><span style=color:#ed9366>+ </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>padding
</span><span>}
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After:
</span><span style=color:#fa6e32>pub fn </span><span style=color:#f29718>content_inset</span><span>(</span><span style=color:#ed9366>&</span><span style=color:#ff8f40>self</span><span>) </span><span style=color:#61676ccc>-></span><span> BorderRect {
</span><span>    </span><span style=color:#fa6e32>let mut</span><span> content_inset </span><span style=color:#ed9366>= </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>border </span><span style=color:#ed9366>+ </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>padding</span><span style=color:#61676ccc>;
</span><span>    content_inset</span><span style=color:#ed9366>.</span><span>right </span><span style=color:#ed9366>+= </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>scrollbar_size</span><span style=color:#ed9366>.</span><span>x</span><span style=color:#61676ccc>;
</span><span>    content_inset</span><span style=color:#ed9366>.</span><span>bottom </span><span style=color:#ed9366>+= </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>scrollbar_size</span><span style=color:#ed9366>.</span><span>y</span><span style=color:#61676ccc>;
</span><span>    content_inset
</span><span>}
</span></code></pre><ol start=2><li><strong>Updated <code>horizontal_scrollbar_gutter()</code> method</strong>:</ol><pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before:
</span><span style=color:#fa6e32>let</span><span> max_x </span><span style=color:#ed9366>=</span><span> half_size</span><span style=color:#ed9366>.</span><span>x </span><span style=color:#ed9366>-</span><span> content_inset</span><span style=color:#ed9366>.</span><span>right </span><span style=color:#ed9366>- </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>scrollbar_size</span><span style=color:#ed9366>.</span><span>x</span><span style=color:#61676ccc>;
</span><span style=color:#fa6e32>let</span><span> max_y </span><span style=color:#ed9366>=</span><span> half_size</span><span style=color:#ed9366>.</span><span>y </span><span style=color:#ed9366>-</span><span> content_inset</span><span style=color:#ed9366>.</span><span>bottom</span><span style=color:#61676ccc>;
</span><span style=color:#fa6e32>let</span><span> min_y </span><span style=color:#ed9366>=</span><span> max_y </span><span style=color:#ed9366>- </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>scrollbar_size</span><span style=color:#ed9366>.</span><span>y</span><span style=color:#61676ccc>;
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After:
</span><span style=color:#fa6e32>let</span><span> max_x </span><span style=color:#ed9366>=</span><span> half_size</span><span style=color:#ed9366>.</span><span>x </span><span style=color:#ed9366>-</span><span> content_inset</span><span style=color:#ed9366>.</span><span>right</span><span style=color:#61676ccc>;
</span><span style=color:#fa6e32>let</span><span> min_y </span><span style=color:#ed9366>=</span><span> half_size</span><span style=color:#ed9366>.</span><span>y </span><span style=color:#ed9366>-</span><span> content_inset</span><span style=color:#ed9366>.</span><span>bottom</span><span style=color:#61676ccc>;
</span><span style=color:#fa6e32>let</span><span> max_y </span><span style=color:#ed9366>=</span><span> min_y </span><span style=color:#ed9366>+ </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>scrollbar_size</span><span style=color:#ed9366>.</span><span>y</span><span style=color:#61676ccc>;
</span></code></pre><ol start=3><li><strong>Updated <code>vertical_scrollbar_gutter()</code> method</strong>:</ol><pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before:
</span><span style=color:#fa6e32>let</span><span> max_x </span><span style=color:#ed9366>=</span><span> half_size</span><span style=color:#ed9366>.</span><span>x </span><span style=color:#ed9366>-</span><span> content_inset</span><span style=color:#ed9366>.</span><span>right</span><span style=color:#61676ccc>;
</span><span style=color:#fa6e32>let</span><span> min_x </span><span style=color:#ed9366>=</span><span> max_x </span><span style=color:#ed9366>- </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>scrollbar_size</span><span style=color:#ed9366>.</span><span>x</span><span style=color:#61676ccc>;
</span><span style=color:#fa6e32>let</span><span> min_y </span><span style=color:#ed9366>= -</span><span>half_size</span><span style=color:#ed9366>.</span><span>y </span><span style=color:#ed9366>+</span><span> content_inset</span><span style=color:#ed9366>.</span><span>top</span><span style=color:#61676ccc>;
</span><span style=color:#fa6e32>let</span><span> max_y </span><span style=color:#ed9366>=</span><span> half_size</span><span style=color:#ed9366>.</span><span>y </span><span style=color:#ed9366>-</span><span> content_inset</span><span style=color:#ed9366>.</span><span>bottom </span><span style=color:#ed9366>- </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>scrollbar_size</span><span style=color:#ed9366>.</span><span>y</span><span style=color:#61676ccc>;
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After:
</span><span style=color:#fa6e32>let</span><span> min_x </span><span style=color:#ed9366>=</span><span> half_size</span><span style=color:#ed9366>.</span><span>x </span><span style=color:#ed9366>-</span><span> content_inset</span><span style=color:#ed9366>.</span><span>right</span><span style=color:#61676ccc>;
</span><span style=color:#fa6e32>let</span><span> max_x </span><span style=color:#ed9366>=</span><span> min_x </span><span style=color:#ed9366>+ </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>scrollbar_size</span><span style=color:#ed9366>.</span><span>x</span><span style=color:#61676ccc>;
</span><span style=color:#fa6e32>let</span><span> min_y </span><span style=color:#ed9366>= -</span><span>half_size</span><span style=color:#ed9366>.</span><span>y </span><span style=color:#ed9366>+</span><span> content_inset</span><span style=color:#ed9366>.</span><span>top</span><span style=color:#61676ccc>;
</span><span style=color:#fa6e32>let</span><span> max_y </span><span style=color:#ed9366>=</span><span> half_size</span><span style=color:#ed9366>.</span><span>y </span><span style=color:#ed9366>-</span><span> content_inset</span><span style=color:#ed9366>.</span><span>bottom</span><span style=color:#61676ccc>;
</span></code></pre><h3 id=crates-bevy-ui-src-update-rs-2-2><code>crates/bevy_ui/src/update.rs</code> (+2/-2)</h3><p>This file contains the <code>update_clipping()</code> function which calculates clipping rectangles for UI nodes. The change removes the redundant subtraction of scrollbar size since it’s now included in the content inset.<p>Key changes:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before:
</span><span>clip_rect</span><span style=color:#ed9366>.</span><span>max</span><span style=color:#ed9366>.</span><span>x </span><span style=color:#ed9366>-=</span><span> clip_inset</span><span style=color:#ed9366>.</span><span>right </span><span style=color:#ed9366>+</span><span> computed_node</span><span style=color:#ed9366>.</span><span>scrollbar_size</span><span style=color:#ed9366>.</span><span>x</span><span style=color:#61676ccc>;
</span><span>clip_rect</span><span style=color:#ed9366>.</span><span>max</span><span style=color:#ed9366>.</span><span>y </span><span style=color:#ed9366>-=</span><span> clip_inset</span><span style=color:#ed9366>.</span><span>bottom </span><span style=color:#ed9366>+</span><span> computed_node</span><span style=color:#ed9366>.</span><span>scrollbar_size</span><span style=color:#ed9366>.</span><span>y</span><span style=color:#61676ccc>;
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After:
</span><span>clip_rect</span><span style=color:#ed9366>.</span><span>max</span><span style=color:#ed9366>.</span><span>x </span><span style=color:#ed9366>-=</span><span> clip_inset</span><span style=color:#ed9366>.</span><span>right</span><span style=color:#61676ccc>;
</span><span>clip_rect</span><span style=color:#ed9366>.</span><span>max</span><span style=color:#ed9366>.</span><span>y </span><span style=color:#ed9366>-=</span><span> clip_inset</span><span style=color:#ed9366>.</span><span>bottom</span><span style=color:#61676ccc>;
</span></code></pre><h2 id=further-reading>Further Reading</h2><ol><li><strong>Bevy UI Layout System</strong>: Understanding Bevy’s UI layout model, including borders, padding, and content areas<li><strong>CSS Box Model</strong>: The web’s CSS box model (border, padding, margin, content) provides useful analogies for understanding UI layout systems<li><strong>Clipping in Computer Graphics</strong>: Fundamentals of clipping rectangles and viewport management in 2D graphics<li><strong>Scrollbar Design Patterns</strong>: Common approaches to scrollbar placement and interaction in UI frameworks</ol></div><div data-is-md-page=true data-patch-exists=true data-patch-path=/pull_request/bevy/2025-12/pr_21910.patch id=patch-info style=display:none></div><div class=bottom-spacer></div></div></div>