<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://unknownue.github.io name=base><title>
         #22294 use zizmor to lint GitHub actions
        
    </title><meta content="#22294 use zizmor to lint GitHub actions" property=og:title><meta content="A personal blog built with Zola and Apollo theme" property=og:description><meta content="A personal blog built with Zola and Apollo theme" name=description><link href=/icons/favicon.png rel=icon type=image/png><link href=https://unknownue.github.io/fonts.css rel=stylesheet><script src=https://unknownue.github.io/js/codeblock.js></script><script src=https://unknownue.github.io/js/toc.js></script><script src=https://unknownue.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Unknownue's Blog" href=https://unknownue.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://unknownue.github.io/theme/light.css rel=stylesheet><link href=https://unknownue.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://unknownue.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://unknownue.github.io/main.css media=screen rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js></script><script>// Initialize mermaid once DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            mermaid.initialize({
                startOnLoad: false,
                theme: document.body && document.body.classList.contains('dark') ? 'dark' : 'default',
                securityLevel: 'loose',
                flowchart: {
                    useMaxWidth: true,
                    htmlLabels: true
                },
                sequence: {
                    diagramMarginX: 50,
                    diagramMarginY: 10,
                    actorMargin: 50,
                    width: 150,
                    height: 65
                }
            });
        });</script><script src=https://unknownue.github.io/js/main.js></script><script defer src=https://unknownue.github.io/js/label-colors.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/rust.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/typescript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/go.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/cpp.min.js></script><script>// Ensure highlight.js is properly configured
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof hljs !== 'undefined') {
                hljs.configure({
                    languages: ['rust', 'javascript', 'python', 'cpp', 'go', 'typescript'],
                    ignoreUnescapedHTML: true
                });
                console.log('Highlight.js configured in header');
            }
        });</script><link href=https://cdn.jsdelivr.net/npm/diff2html/bundles/css/diff2html.min.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/diff2html/bundles/js/diff2html-ui.min.js></script><script src=https://unknownue.github.io/js/syntax-highlight.js></script><script src=https://unknownue.github.io/js/diff-sidebar.js></script><script src="https://unknownue.github.io/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><div class=content><header><div class=main><a href=https://unknownue.github.io>Unknownue's Blog</a><div class=socials><a class=social href=https://github.com/unknownue rel=me> <img alt=github src=https://unknownue.github.io/icons/social/github.svg> </a><a class=social href=https://github.com/unknownue/unknownue.github.io rel=me> <img alt=github-io src=https://unknownue.github.io/icons/social/rss.svg> </a></div></div><nav><a href=https://unknownue.github.io/posts style=margin-left:.25em>/posts</a><a href=https://unknownue.github.io/projects style=margin-left:.25em>/projects</a><a href=https://unknownue.github.io/about style=margin-left:.25em>/about</a><a href=https://unknownue.github.io/tags style=margin-left:.25em>/tags</a><button title="$SHORTCUT to open search" class=search-button id=search-button><img alt=Search class=search-icon src=https://unknownue.github.io/icons/search.svg></button><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><div id=modal-content><h1 class=page-header id=modalTitle>Search</h1><div id=searchBar><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search... role=combobox spellcheck=false><button title="Clear search" class=clear-button id=clear-search><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></button></div><div id=results-container><div id=results-info><span id=zero_results style=display:none>No results</span><span id=one_result style=display:none>1 result</span><span id=many_results style=display:none>$NUMBER results</span></div><div id=results role=listbox></div></div></div></div><a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://unknownue.github.io/icons/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://unknownue.github.io/icons/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><div class=pull-request-page><article class=md-content-page style=display:none></article><div class=back-link><a href=/pull_request/bevy/2025-12/>â† Back to Pull Requests</a></div><div class=pr-metadata><span class=pr-date>2025-12-30</span><div class=language-switcher><a class=lang-link data-lang=en href=/pull_request/bevy/2025-12/pr-22294-en-20251230>English</a> / <span class="lang-link active" data-lang=zh-cn>ä¸­æ–‡</span></div></div><div class=pr-content><h1 id=title>Title</h1><h2 id=basic-information>Basic Information</h2><ul><li><strong>Title</strong>: use zizmor to lint GitHub actions<li><strong>PR Link</strong>: https://github.com/bevyengine/bevy/pull/22294<li><strong>Author</strong>: mockersf<li><strong>Status</strong>: MERGED<li><strong>Labels</strong>: A-Build-System, C-Code-Quality, S-Ready-For-Final-Review<li><strong>Created</strong>: 2025-12-28T23:03:18Z<li><strong>Merged</strong>: 2025-12-30T01:48:30Z<li><strong>Merged By</strong>: alice-i-cecile</ul><h2 id=description-translation>Description Translation</h2><p><strong>ç›®æ ‡</strong><ul><li>æå‡ Bevy CI çš„å®‰å…¨æ€§</ul><p><strong>è§£å†³æ–¹æ¡ˆ</strong><ul><li>ä½¿ç”¨ zizmor å¯¹ actions è¿›è¡Œä»£ç æ£€æŸ¥ (lint) https://github.com/zizmorcore/zizmor<li>ä¿®å¤äº†ä¸€äº›ä»£ç æ£€æŸ¥å‘ç°çš„é—®é¢˜ <ul><li>é”å®š (pin) actions çš„ç‰ˆæœ¬<li>æŒ‡å®š <code>persist-credentials</code><li>åœ¨ä½œä¸š (job) çº§åˆ«è€Œéå·¥ä½œæµ (workflow) çº§åˆ«è®¾ç½®å†™å…¥æƒé™<li>ä¸º <code>pull_request_target</code> å·¥ä½œæµè®¾ç½®ç›®æ ‡åˆ†æ”¯</ul><li>å°†è¯¥ä»£ç æ£€æŸ¥å·¥å…·ä½œä¸º CI çš„ä¸€éƒ¨åˆ†ã€‚é€šè¿‡æ‰€æè®®çš„é…ç½®ï¼Œå®ƒå°†åœ¨å®‰å…¨ä¸­å¿ƒæŠ¥å‘Šæ½œåœ¨é—®é¢˜ï¼Œè€Œä¸ä¼šé˜»æ­¢åˆå¹¶ã€‚ç›®å‰ä»æœ‰ä¸€äº›ä»£ç æ£€æŸ¥å¤±è´¥çš„é—®é¢˜éœ€è¦æ›´å¤šé‡æ„å·¥ä½œæ¥ä¿®å¤ã€‚</ul><h2 id=the-story-of-this-pull-request>The Story of This Pull Request</h2><p>è¿™ä¸ª PR çš„æ ¸å¿ƒæ•…äº‹æ˜¯å…³äºä¸»åŠ¨æå‡ CI/CD æµæ°´çº¿çš„å®‰å…¨æ€§ï¼Œè€Œéè¢«åŠ¨å“åº”å®‰å…¨äº‹ä»¶ã€‚åœ¨è½¯ä»¶å¼€å‘ä¸­ï¼ŒæŒç»­é›†æˆ(CI)è„šæœ¬ä½œä¸ºæ„å»ºã€æµ‹è¯•å’Œéƒ¨ç½²çš„åŸºçŸ³ï¼Œå…¶æœ¬èº«ä¹Ÿå¿…é¡»æ˜¯å®‰å…¨çš„ã€‚ä¸å®‰å…¨çš„é…ç½®ï¼Œä¾‹å¦‚ä½¿ç”¨æœªé”å®šçš„ç¬¬ä¸‰æ–¹ Action ç‰ˆæœ¬æˆ–æˆäºˆè¿‡å®½çš„æƒé™ï¼Œå¯èƒ½æˆä¸ºä¾›åº”é“¾æ”»å‡»çš„å…¥å£ã€‚<h3 id=wen-ti-yu-bei-jing>é—®é¢˜ä¸èƒŒæ™¯</h3><p>åœ¨ PR æè¿°ä¸­ï¼Œä½œè€…æ˜ç¡®æŒ‡å‡ºç›®æ ‡æ˜¯â€œæå‡ Bevy CI çš„å®‰å…¨æ€§â€ã€‚è™½ç„¶æ²¡æœ‰è¯¦ç»†åˆ—å‡ºå…·ä½“çš„å®‰å…¨æ¼æ´ï¼Œä½† PR æ‰€åšçš„ä¿®æ”¹æŒ‡å‘äº†å‡ ä¸ªåœ¨å¼€æºé¡¹ç›®ä¸­å¸¸è§çš„ GitHub Actions å®‰å…¨é£é™©ï¼š<ol><li><strong>ä¾èµ–åŠ«æŒ</strong>ï¼šå½“ä½¿ç”¨æ ‡ç­¾ï¼ˆå¦‚ <code>v6</code>ã€<code>v8.0.0</code>ï¼‰å¼•ç”¨ç¬¬ä¸‰æ–¹ Action æ—¶ï¼Œå­˜åœ¨æ ‡ç­¾è¢«æ¶æ„æ›´æ–°æˆ–ä»“åº“è¢«åŠ«æŒçš„é£é™©ã€‚æ”»å‡»è€…å¯ä»¥å‘å¸ƒä¸€ä¸ªå¸¦æ¶æ„ä»£ç çš„æ–°ç‰ˆæœ¬ï¼Œå¹¶ç»™åŒæ ·çš„æ ‡ç­¾æ‰“ä¸Šæ ‡è®°ï¼Œå½“ä¸‹æ¬¡ CI è¿è¡Œæ—¶å°±ä¼šè‡ªåŠ¨æ‹‰å–åˆ°æ¶æ„ç‰ˆæœ¬ã€‚<li><strong>æƒé™è¿‡å®½</strong>ï¼šåœ¨å·¥ä½œæµ(workflow)çº§åˆ«å…¨å±€æˆäºˆ <code>pull-requests: write</code> æƒé™ï¼Œæ„å‘³ç€è¯¥å·¥ä½œæµä¸­çš„æ‰€æœ‰ä½œä¸š(job)éƒ½æ‹¥æœ‰äº†æ­¤æƒé™ï¼Œè¿™è¿åäº†æœ€å°æƒé™åŸåˆ™ã€‚ç†æƒ³æƒ…å†µæ˜¯åªåœ¨éœ€è¦è¯„è®º PR çš„ä½œä¸šä¸­æˆäºˆæ­¤æƒé™ã€‚<li><strong>å‡­è¯æŒä¹…åŒ–é£é™©</strong>ï¼šåœ¨ <code>pull_request_target</code> äº‹ä»¶è§¦å‘çš„å·¥ä½œæµä¸­ä½¿ç”¨ <code>actions/checkout</code> æ—¶ï¼Œå¦‚æœä¸æ˜¾å¼è®¾ç½® <code>persist-credentials: false</code>ï¼Œä» PR åˆ†æ”¯æ‹‰å–çš„ã€æ½œåœ¨çš„æ¶æ„ä»£ç å¯èƒ½ä¼šåˆ©ç”¨è¿™äº›å‡­è¯è¿›è¡Œæœªæˆæƒçš„ä»“åº“æ“ä½œã€‚<li><strong>åˆ†æ”¯æ”»å‡»é¢</strong>ï¼š<code>pull_request_target</code> äº‹ä»¶é»˜è®¤ä¼šé’ˆå¯¹æ‰€æœ‰åˆ†æ”¯çš„ PR è§¦å‘ï¼Œè¿™æ‰©å¤§äº†æ”»å‡»é¢ã€‚æœ€å¥½å°†å…¶é™åˆ¶åœ¨ä¸»è¦åˆ†æ”¯ï¼ˆå¦‚ <code>main</code>ï¼‰çš„ PR ä¸Šã€‚</ol><p>å› æ­¤ï¼Œé—®é¢˜çš„æ ¸å¿ƒåœ¨äº CI é…ç½®å­˜åœ¨å¯è¢«åˆ©ç”¨çš„å®‰å…¨éšæ‚£ï¼Œéœ€è¦ä¸€ç§ç³»ç»Ÿæ€§çš„æ–¹æ³•æ¥è¯†åˆ«å¹¶ä¿®å¤å®ƒä»¬ã€‚<h3 id=jie-jue-fang-an-yu-gong-cheng-jue-ce>è§£å†³æ–¹æ¡ˆä¸å·¥ç¨‹å†³ç­–</h3><p>ä½œè€…é€‰æ‹©çš„è§£å†³æ–¹æ¡ˆæ˜¯å¼•å…¥ <strong>zizmor</strong> è¿™ä¸ªå·¥å…·ã€‚zizmor æ˜¯ä¸€ä¸ªä¸“é—¨ç”¨äºå¯¹ GitHub Actions å·¥ä½œæµæ–‡ä»¶è¿›è¡Œé™æ€å®‰å…¨åˆ†æå’Œä»£ç æ£€æŸ¥ (linting) çš„å·¥å…·ã€‚è¿™ä¸ªé€‰æ‹©æ˜¯åˆç†çš„ï¼Œå› ä¸ºå®ƒå°†å®‰å…¨å®¡æŸ¥ä»äººå·¥çš„ã€ä¸å®šæœŸçš„å·¥ä½œè½¬å˜ä¸ºè‡ªåŠ¨åŒ–çš„ã€æŒç»­çš„è¿‡ç¨‹ã€‚<p>åœ¨å·¥ç¨‹å†³ç­–ä¸Šï¼Œä½œè€…é‡‡å–äº†åˆ†æ­¥èµ°çš„ç­–ç•¥ï¼š<ol><li><strong>é›†æˆå·¥å…·</strong>ï¼šé¦–å…ˆå°† zizmor ä½œä¸ºä¸€ä¸ªæ–°çš„ CI æ­¥éª¤åŠ å…¥å·¥ä½œæµã€‚<li><strong>åº”ç”¨ä¿®å¤</strong>ï¼šæ ¹æ® zizmor çš„æ£€æŸ¥ç»“æœï¼Œå¯¹ç°æœ‰é…ç½®è¿›è¡Œæ‰¹é‡ä¿®å¤ã€‚<li><strong>å®¹å¿æ¸è¿›</strong>ï¼šä½œè€…æåˆ°ï¼Œé…ç½®ä¼šæŠ¥å‘Šé—®é¢˜ä½†â€œä¸ä¼šé˜»å¡åˆå¹¶â€ï¼Œå¹¶ä¸”â€œä»æœ‰ä¸€äº›ä»£ç æ£€æŸ¥å¤±è´¥çš„é—®é¢˜éœ€è¦æ›´å¤šé‡æ„å·¥ä½œæ¥ä¿®å¤â€ã€‚è¿™è¡¨æ˜ä»–ä»¬é‡‡ç”¨äº†åŠ¡å®çš„æ€åº¦ï¼Œä¼˜å…ˆä¿®å¤é«˜é£é™©ã€æ˜“ä¿®å¤çš„é—®é¢˜ï¼Œå…è®¸ä½é£é™©æˆ–å¤æ‚çš„é—®é¢˜æš‚æ—¶å­˜åœ¨ï¼Œé¿å…å› è¿½æ±‚å®Œç¾è€Œé˜»ç¢æ”¹è¿›ã€‚</ol><h3 id=ji-shu-shi-xian-xi-jie>æŠ€æœ¯å®ç°ç»†èŠ‚</h3><p>è¿™ä¸ª PR ä¿®æ”¹äº† 14 ä¸ª <code>.yml</code> å·¥ä½œæµæ–‡ä»¶ã€‚æ‰€æœ‰æ”¹åŠ¨éƒ½å›´ç»•ç€ä»¥ä¸‹å‡ ä¸ªå®‰å…¨æœ€ä½³å®è·µå±•å¼€ï¼š<p><strong>1. é”å®š Action ç‰ˆæœ¬è‡³å®Œæ•´ SHA</strong> è¿™æ˜¯æœ€å¹¿æ³›ã€æœ€é‡è¦çš„æ”¹åŠ¨ã€‚å°†å¼•ç”¨ä»å¯å˜çš„â€œæ ‡ç­¾â€æ”¹ä¸ºä¸å¯å˜çš„â€œGit commit SHAâ€ã€‚<pre class=language-yaml data-lang=yaml style=color:#61676c;background-color:#fafafa><code class=language-yaml data-lang=yaml><span style=color:#abb0b6;font-style:italic># ä¹‹å‰ (æœ‰é£é™©):
</span><span>- </span><span style=color:#399ee6>uses</span><span style=color:#61676ccc>: </span><span style=color:#86b300>actions/checkout@v6
</span><span>- </span><span style=color:#399ee6>uses</span><span style=color:#61676ccc>: </span><span style=color:#86b300>actions/github-script@v8
</span><span>
</span><span style=color:#abb0b6;font-style:italic># ä¹‹å (å®‰å…¨):
</span><span>- </span><span style=color:#399ee6>uses</span><span style=color:#61676ccc>: </span><span style=color:#86b300>actions/checkout@8e8c483db84b4bee98b60c0593521ed34d9990e8 </span><span style=color:#abb0b6;font-style:italic># v6.0.1
</span><span>- </span><span style=color:#399ee6>uses</span><span style=color:#61676ccc>: </span><span style=color:#86b300>actions/github-script@ed597411d8f924073f98dfc5c65a23a2325f34cd </span><span style=color:#abb0b6;font-style:italic># v8.0.0
</span></code></pre><p>é€šè¿‡åœ¨æ³¨é‡Šä¸­ä¿ç•™ç‰ˆæœ¬å·ï¼Œæ—¢ä¿è¯äº†å®‰å…¨æ€§ï¼Œåˆä¿æŒäº†å¯è¯»æ€§ã€‚<p><strong>2. ç²¾ç»†åŒ–æƒé™æ§åˆ¶ (Principle of Least Privilege)</strong> å°†å…¨å±€æƒé™ä¸‹æ”¾åˆ°å…·ä½“çš„ä½œä¸š(job)ä¸­ã€‚<pre class=language-yaml data-lang=yaml style=color:#61676c;background-color:#fafafa><code class=language-yaml data-lang=yaml><span style=color:#abb0b6;font-style:italic># ä¹‹å‰ (åœ¨ workflow æ ¹èŠ‚ç‚¹):
</span><span style=color:#399ee6>permissions</span><span style=color:#61676ccc>:
</span><span>  </span><span style=color:#399ee6>pull-requests</span><span style=color:#61676ccc>: </span><span style=color:#86b300>'write'
</span><span>
</span><span style=color:#399ee6>jobs</span><span style=color:#61676ccc>:
</span><span>  </span><span style=color:#399ee6>some-job</span><span style=color:#61676ccc>:
</span><span>    </span><span style=color:#abb0b6;font-style:italic># è¿™ä¸ª job ä¸éœ€è¦å†™ PR çš„æƒé™ï¼Œä½†ä¹Ÿæ‹¥æœ‰äº†
</span><span>    </span><span style=color:#399ee6>steps</span><span style=color:#61676ccc>: </span><span>[</span><span style=color:#61676ccc>.</span><span style=color:#ff8f40>..</span><span>]
</span><span>
</span><span style=color:#abb0b6;font-style:italic># ä¹‹å (åœ¨ job å†…éƒ¨):
</span><span style=color:#399ee6>jobs</span><span style=color:#61676ccc>:
</span><span>  </span><span style=color:#399ee6>comment-on-migration-guide-label</span><span style=color:#61676ccc>:
</span><span>    </span><span style=color:#399ee6>permissions</span><span style=color:#61676ccc>:
</span><span>      </span><span style=color:#399ee6>pull-requests</span><span style=color:#61676ccc>: </span><span style=color:#86b300>"write"
</span><span>    </span><span style=color:#399ee6>steps</span><span style=color:#61676ccc>: </span><span>[</span><span style=color:#61676ccc>.</span><span style=color:#ff8f40>..</span><span>]
</span></code></pre><p>è¿™æ ·ï¼Œåªæœ‰çœŸæ­£éœ€è¦è¯„è®º PR çš„ä½œä¸šï¼ˆå¦‚ <code>comment-on-migration-guide-label</code>ï¼‰æ‰æ‹¥æœ‰ç›¸åº”æƒé™ã€‚<p><strong>3. å®‰å…¨é…ç½® <code>actions/checkout</code></strong> åœ¨ <code>pull_request_target</code> ä¸Šä¸‹æ–‡ä¸­ï¼Œæ˜ç¡®ç¦ç”¨å‡­è¯æŒä¹…åŒ–ã€‚<pre class=language-yaml data-lang=yaml style=color:#61676c;background-color:#fafafa><code class=language-yaml data-lang=yaml><span>- </span><span style=color:#399ee6>uses</span><span style=color:#61676ccc>: </span><span style=color:#86b300>actions/checkout@8e8c483db84b4bee98b60c0593521ed34d9990e8 </span><span style=color:#abb0b6;font-style:italic># v6.0.1
</span><span>  </span><span style=color:#399ee6>with</span><span style=color:#61676ccc>:
</span><span>    </span><span style=color:#399ee6>ref</span><span style=color:#61676ccc>: </span><span style=color:#86b300>${{ github.event.pull_request.head.sha }}
</span><span>    </span><span style=color:#399ee6>persist-credentials</span><span style=color:#61676ccc>: </span><span style=color:#ff8f40>false </span><span style=color:#abb0b6;font-style:italic># å…³é”®çš„å®‰å…¨è®¾ç½®
</span></code></pre><p><strong>4. é™åˆ¶ <code>pull_request_target</code> çš„ç›®æ ‡åˆ†æ”¯</strong> å°†é«˜é£é™©äº‹ä»¶ <code>pull_request_target</code> çš„è§¦å‘èŒƒå›´é™å®šåœ¨ä¸»è¦åˆ†æ”¯ï¼Œå‡å°‘æš´éœ²ã€‚<pre class=language-yaml data-lang=yaml style=color:#61676c;background-color:#fafafa><code class=language-yaml data-lang=yaml><span style=color:#ff8f40>on</span><span style=color:#61676ccc>:
</span><span>  </span><span style=color:#399ee6>pull_request_target</span><span style=color:#61676ccc>:
</span><span>    </span><span style=color:#399ee6>types</span><span style=color:#61676ccc>: </span><span>[</span><span style=color:#86b300>labeled</span><span>]
</span><span>    </span><span style=color:#399ee6>branches</span><span style=color:#61676ccc>: </span><span style=color:#abb0b6;font-style:italic># æ–°å¢çš„é™å®š
</span><span>      - </span><span style=color:#86b300>"main"
</span></code></pre><p><strong>5. é›†æˆå®‰å…¨åˆ†ææµæ°´çº¿</strong> PR ä¸ä»…ä¿®å¤é—®é¢˜ï¼Œè¿˜å»ºç«‹äº†ä¸€ä¸ªé•¿æœŸçš„ç›‘æ§æœºåˆ¶ã€‚å®ƒå°†åŸæœ‰çš„ <code>codeql.yml</code> é‡å‘½åä¸ºæ›´å…·æè¿°æ€§çš„ <code>security-static-analysis.yml</code>ï¼Œå¹¶æ–°å¢äº† <code>zizmor</code> ä½œä¸šã€‚<pre class=language-yaml data-lang=yaml style=color:#61676c;background-color:#fafafa><code class=language-yaml data-lang=yaml><span style=color:#abb0b6;font-style:italic># åœ¨ .github/workflows/security-static-analysis.yml ä¸­æ–°å¢çš„ job
</span><span style=color:#399ee6>zizmor</span><span style=color:#61676ccc>:
</span><span>  </span><span style=color:#399ee6>runs-on</span><span style=color:#61676ccc>: </span><span style=color:#86b300>ubuntu-latest
</span><span>  </span><span style=color:#399ee6>permissions</span><span style=color:#61676ccc>:
</span><span>    </span><span style=color:#399ee6>security-events</span><span style=color:#61676ccc>: </span><span style=color:#86b300>write
</span><span>    </span><span style=color:#399ee6>contents</span><span style=color:#61676ccc>: </span><span style=color:#86b300>read
</span><span>    </span><span style=color:#399ee6>actions</span><span style=color:#61676ccc>: </span><span style=color:#86b300>read
</span><span>  </span><span style=color:#399ee6>steps</span><span style=color:#61676ccc>:
</span><span>    - </span><span style=color:#399ee6>name</span><span style=color:#61676ccc>: </span><span style=color:#86b300>Checkout repository
</span><span>      </span><span style=color:#399ee6>uses</span><span style=color:#61676ccc>: </span><span style=color:#86b300>actions/checkout@1af3b93b6815bc44a9784bd300feb67ff0d1eeb3 </span><span style=color:#abb0b6;font-style:italic># v6.0.0
</span><span>      </span><span style=color:#399ee6>with</span><span style=color:#61676ccc>:
</span><span>        </span><span style=color:#399ee6>persist-credentials</span><span style=color:#61676ccc>: </span><span style=color:#ff8f40>false
</span><span>    - </span><span style=color:#399ee6>name</span><span style=color:#61676ccc>: </span><span style=color:#86b300>Run zizmor ğŸŒˆ
</span><span>      </span><span style=color:#399ee6>uses</span><span style=color:#61676ccc>: </span><span style=color:#86b300>zizmorcore/zizmor-action@e639db99335bc9038abc0e066dfcd72e23d26fb4 </span><span style=color:#abb0b6;font-style:italic># v0.3.0
</span></code></pre><p>è¿™ä¸ªä½œä¸šæ‹¥æœ‰ <code>security-events: write</code> æƒé™ï¼Œå¯ä»¥å°†å‘ç°çš„é—®é¢˜æŠ¥å‘Šåˆ° GitHub çš„å®‰å…¨ä¸­å¿ƒï¼Œå®ç°é›†ä¸­åŒ–ç®¡ç†å’Œè·Ÿè¸ªã€‚<h3 id=ji-shu-dong-cha-yu-ying-xiang>æŠ€æœ¯æ´å¯Ÿä¸å½±å“</h3><p>è¿™ä¸ª PR å±•ç¤ºäº†å°†â€œå®‰å…¨å·¦ç§»â€(Shift-Left Security)åŸåˆ™åº”ç”¨äºåŸºç¡€è®¾æ–½ä»£ç (Infrastructure as Code, IaC)çš„ä¼˜ç§€å®è·µã€‚å®ƒå¸¦æ¥çš„å½±å“æ˜¯æ·±è¿œçš„ï¼š<ol><li><strong>é™ä½ä¾›åº”é“¾æ”»å‡»é£é™©</strong>ï¼šé€šè¿‡é”å®š SHAï¼ŒBevy é¡¹ç›®çš„ CI ç³»ç»Ÿå¯¹ä¸Šæ¸¸ Action ä»“åº“çš„æ¶æ„ä¿®æ”¹å…·å¤‡äº†å…ç–«åŠ›ã€‚<li><strong>å¼ºåŒ–æœ€å°æƒé™æ¨¡å‹</strong>ï¼šç»†ç²’åº¦çš„æƒé™æ§åˆ¶æ„å‘³ç€å³ä½¿æŸä¸ªä½œä¸šè¢«æ”»ç ´ï¼Œæ”»å‡»è€…èƒ½é€ æˆçš„ç ´åä¹Ÿå—åˆ°é™åˆ¶ã€‚<li><strong>å»ºç«‹æŒç»­çš„å®‰å…¨åé¦ˆå¾ªç¯</strong>ï¼šzizmor çš„é›†æˆæ„å‘³ç€æœªæ¥ä»»ä½•å¯¹ CI é…ç½®çš„ä¿®æ”¹ï¼ˆæ— è®ºæ˜¯æ–°å·¥ä½œæµè¿˜æ˜¯ç°æœ‰å·¥ä½œæµçš„å˜æ›´ï¼‰éƒ½ä¼šè‡ªåŠ¨æ¥å—å®‰å…¨æ£€æŸ¥ã€‚è¿™èƒ½åœ¨é”™è¯¯åˆå¹¶ä¹‹å‰æ•è·é—®é¢˜ã€‚<li><strong>æå‡å¯ç»´æŠ¤æ€§ä¸é€æ˜åº¦</strong>ï¼šä½¿ç”¨å®Œæ•´çš„ SHA å’Œæ³¨é‡Šï¼Œä½¿å¾—ä¾èµ–å…³ç³»æ›´åŠ æ¸…æ™°æ˜ç¡®ï¼Œä¾¿äºå®¡è®¡å’Œæ•…éšœæ’æŸ¥ã€‚</ol><p>ä»å·¥ç¨‹è§’åº¦çœ‹ï¼Œè¿™ä¸ª PR çš„æ”¹åŠ¨è™½ç„¶æ˜¯æœºæ¢°å¼çš„ï¼ˆå¤§é‡æŸ¥æ‰¾æ›¿æ¢ï¼‰ï¼Œä½†å…¶èƒŒåçš„è®¾è®¡å†³ç­–â€”â€”é€‰æ‹©æ­£ç¡®çš„å·¥å…·ã€éµå¾ªå®‰å…¨æœ€ä½³å®è·µã€é‡‡ç”¨æ¸è¿›å¼ä¿®å¤ç­–ç•¥â€”â€”ä½“ç°äº†æˆç†Ÿçš„è½¯ä»¶å·¥ç¨‹è¿ç»´æ€è·¯ã€‚å®ƒæ²¡æœ‰ä¿®æ”¹ Bevy çš„æ¸¸æˆå¼•æ“ä»£ç ï¼Œä½†å´åŠ å›ºäº†æ•´ä¸ªé¡¹ç›®å¼€å‘å’Œäº¤ä»˜æµç¨‹çš„åŸºçŸ³ã€‚<h2 id=visual-representation>Visual Representation</h2><pre class=language-mermaid data-lang=mermaid style=color:#61676c;background-color:#fafafa><code class=language-mermaid data-lang=mermaid><span>graph TD
</span><span>    subgraph â€œå®‰å…¨æ”¹è¿›è§¦å‘â€
</span><span>        A[è¯†åˆ« CI å®‰å…¨é£é™©] --> B[å¼•å…¥ Zizmor åˆ†æå·¥å…·]
</span><span>    end
</span><span>    
</span><span>    B --> C{æ‰«æç°æœ‰å·¥ä½œæµ}
</span><span>    
</span><span>    C --> D[ä¿®å¤: é”å®š Action SHA]
</span><span>    C --> E[ä¿®å¤: ä½œä¸šçº§æƒé™]
</span><span>    C --> F[ä¿®å¤: é…ç½® persist-credentials]
</span><span>    C --> G[ä¿®å¤: é™å®šç›®æ ‡åˆ†æ”¯]
</span><span>    
</span><span>    D --> H[æ›´æ–° 14ä¸ª CI å·¥ä½œæµæ–‡ä»¶]
</span><span>    E --> H
</span><span>    F --> H
</span><span>    G --> H
</span><span>    
</span><span>    H --> I[å»ºç«‹æŒç»­å®‰å…¨åˆ†ææµæ°´çº¿]
</span><span>    
</span><span>    I --> J[è¾“å‡ºåˆ° GitHub å®‰å…¨ä¸­å¿ƒ]
</span><span>    I --> K[é˜²æ­¢æœªæ¥é…ç½®é€€åŒ–]
</span><span>    
</span><span>    J --> L[æœ€ç»ˆç»“æœ: åŠ å›ºçš„ CI/CD ä¾›åº”é“¾]
</span><span>    K --> L
</span></code></pre><h2 id=key-files-changed>Key Files Changed</h2><p>ä»¥ä¸‹æ˜¯æ­¤ PR ä¸­ä¿®æ”¹çš„å…³é”®æ–‡ä»¶æ‘˜è¦ï¼š<ul><li><code>.github/workflows/ci.yml</code> (+101/-49)<li><code>.github/workflows/validation-jobs.yml</code> (+40/-19)<li><code>.github/workflows/example-run.yml</code> (+30/-18)<li><code>.github/workflows/ci-comment-failures.yml</code> (+17/-16)<li><code>.github/workflows/dependencies.yml</code> (+24/-8)</ul><h3 id=1-github-workflows-ci-yml>1. <code>.github/workflows/ci.yml</code></h3><p>è¿™æ˜¯ Bevy æœ€ä¸»è¦çš„æŒç»­é›†æˆå·¥ä½œæµã€‚ä¿®æ”¹å‡ ä¹æ¶‰åŠæ¯ä¸€ä¸ªä½œä¸šï¼Œæ ¸å¿ƒæ˜¯é”å®šæ‰€æœ‰ç¬¬ä¸‰æ–¹ Action çš„ç‰ˆæœ¬ï¼Œå¹¶æ·»åŠ  <code>persist-credentials: false</code>ã€‚<pre class=language-yaml data-lang=yaml style=color:#61676c;background-color:#fafafa><code class=language-yaml data-lang=yaml><span style=color:#abb0b6;font-style:italic># å…¸å‹ä¿®æ”¹ç¤ºä¾‹
</span><span style=color:#abb0b6;font-style:italic># Before:
</span><span>- </span><span style=color:#399ee6>uses</span><span style=color:#61676ccc>: </span><span style=color:#86b300>actions/checkout@v6
</span><span>- </span><span style=color:#399ee6>uses</span><span style=color:#61676ccc>: </span><span style=color:#86b300>dtolnay/rust-toolchain@stable
</span><span>
</span><span style=color:#abb0b6;font-style:italic># After:
</span><span>- </span><span style=color:#399ee6>uses</span><span style=color:#61676ccc>: </span><span style=color:#86b300>actions/checkout@8e8c483db84b4bee98b60c0593521ed34d9990e8 </span><span style=color:#abb0b6;font-style:italic># v6.0.1
</span><span>  </span><span style=color:#399ee6>with</span><span style=color:#61676ccc>:
</span><span>    </span><span style=color:#399ee6>persist-credentials</span><span style=color:#61676ccc>: </span><span style=color:#ff8f40>false
</span><span>- </span><span style=color:#399ee6>uses</span><span style=color:#61676ccc>: </span><span style=color:#86b300>dtolnay/rust-toolchain@f7ccc83f9ed1e5b9c81d8a67d7ad1a747e22a561
</span><span>  </span><span style=color:#399ee6>with</span><span style=color:#61676ccc>:
</span><span>    </span><span style=color:#399ee6>toolchain</span><span style=color:#61676ccc>: </span><span style=color:#86b300>stable
</span></code></pre><h3 id=2-github-workflows-security-static-analysis-yml-you-codeql-yml-zhong-ming-ming-er-lai>2. <code>.github/workflows/security-static-analysis.yml</code> (ç”± <code>codeql.yml</code> é‡å‘½åè€Œæ¥)</h3><p>è¿™ä¸ªæ–‡ä»¶çš„é‡å‘½åå’Œæ–°å¢çš„ <code>zizmor</code> ä½œä¸šæ˜¯æœ¬ PR çš„æ ¸å¿ƒæˆæœä¹‹ä¸€ï¼Œå®ƒåˆ›å»ºäº†é•¿æœŸçš„å®‰å…¨åˆ†ææœºåˆ¶ã€‚<pre class=language-yaml data-lang=yaml style=color:#61676c;background-color:#fafafa><code class=language-yaml data-lang=yaml><span style=color:#abb0b6;font-style:italic># æ–°å¢çš„ zizmor ä½œä¸š
</span><span style=color:#399ee6>zizmor</span><span style=color:#61676ccc>:
</span><span>  </span><span style=color:#399ee6>runs-on</span><span style=color:#61676ccc>: </span><span style=color:#86b300>ubuntu-latest
</span><span>  </span><span style=color:#399ee6>permissions</span><span style=color:#61676ccc>:
</span><span>    </span><span style=color:#399ee6>security-events</span><span style=color:#61676ccc>: </span><span style=color:#86b300>write
</span><span>    </span><span style=color:#399ee6>contents</span><span style=color:#61676ccc>: </span><span style=color:#86b300>read
</span><span>    </span><span style=color:#399ee6>actions</span><span style=color:#61676ccc>: </span><span style=color:#86b300>read
</span><span>  </span><span style=color:#399ee6>steps</span><span style=color:#61676ccc>:
</span><span>    - </span><span style=color:#399ee6>name</span><span style=color:#61676ccc>: </span><span style=color:#86b300>Checkout repository
</span><span>      </span><span style=color:#399ee6>uses</span><span style=color:#61676ccc>: </span><span style=color:#86b300>actions/checkout@1af3b93b6815bc44a9784bd300feb67ff0d1eeb3 </span><span style=color:#abb0b6;font-style:italic># v6.0.0
</span><span>      </span><span style=color:#399ee6>with</span><span style=color:#61676ccc>:
</span><span>        </span><span style=color:#399ee6>persist-credentials</span><span style=color:#61676ccc>: </span><span style=color:#ff8f40>false
</span><span>    - </span><span style=color:#399ee6>name</span><span style=color:#61676ccc>: </span><span style=color:#86b300>Run zizmor ğŸŒˆ
</span><span>      </span><span style=color:#399ee6>uses</span><span style=color:#61676ccc>: </span><span style=color:#86b300>zizmorcore/zizmor-action@e639db99335bc9038abc0e066dfcd72e23d26fb4 </span><span style=color:#abb0b6;font-style:italic># v0.3.0
</span></code></pre><h3 id=3-github-workflows-ci-comment-failures-yml>3. <code>.github/workflows/ci-comment-failures.yml</code></h3><p>æ­¤å·¥ä½œæµè´Ÿè´£åœ¨ CI å¤±è´¥æ—¶è¯„è®º PRã€‚ä¿®æ”¹å°†æƒé™ä»å·¥ä½œæµçº§åˆ«ä¸‹æ”¾åˆ°äº†éœ€è¦è¯„è®ºçš„ä¸‰ä¸ªå…·ä½“ä½œä¸š (<code>missing-examples</code>, <code>missing-features</code>, <code>msrv</code>) ä¸­ï¼Œå¹¶é”å®šäº† Action ç‰ˆæœ¬ã€‚<pre class=language-yaml data-lang=yaml style=color:#61676c;background-color:#fafafa><code class=language-yaml data-lang=yaml><span style=color:#abb0b6;font-style:italic># Before (æ–‡ä»¶å¼€å¤´):
</span><span style=color:#399ee6>permissions</span><span style=color:#61676ccc>:
</span><span>  </span><span style=color:#399ee6>pull-requests</span><span style=color:#61676ccc>: </span><span style=color:#86b300>'write'
</span><span>
</span><span style=color:#abb0b6;font-style:italic># After (åœ¨æ¯ä¸ª job å†…éƒ¨):
</span><span style=color:#399ee6>jobs</span><span style=color:#61676ccc>:
</span><span>  </span><span style=color:#399ee6>missing-examples</span><span style=color:#61676ccc>:
</span><span>    </span><span style=color:#399ee6>permissions</span><span style=color:#61676ccc>:
</span><span>      </span><span style=color:#399ee6>pull-requests</span><span style=color:#61676ccc>: </span><span style=color:#86b300>"write"
</span><span>    </span><span style=color:#399ee6>runs-on</span><span style=color:#61676ccc>: </span><span style=color:#86b300>ubuntu-latest
</span><span>    </span><span style=color:#61676ccc>.</span><span style=color:#ff8f40>..
</span></code></pre><h3 id=4-github-workflows-action-on-pr-labeled-yml>4. <code>.github/workflows/action-on-PR-labeled.yml</code></h3><p>è¿™æ˜¯ä¸€ä¸ªç”± <code>pull_request_target</code> äº‹ä»¶è§¦å‘çš„å·¥ä½œæµï¼Œç”¨äºåœ¨ PR è¢«æ‰“ä¸Šç‰¹å®šæ ‡ç­¾æ—¶è‡ªåŠ¨è¯„è®ºã€‚ä¿®æ”¹å¢åŠ äº†ç›®æ ‡åˆ†æ”¯é™åˆ¶å’Œä½œä¸šçº§æƒé™ã€‚<pre class=language-yaml data-lang=yaml style=color:#61676c;background-color:#fafafa><code class=language-yaml data-lang=yaml><span style=color:#abb0b6;font-style:italic># Before:
</span><span style=color:#ff8f40>on</span><span style=color:#61676ccc>:
</span><span>  </span><span style=color:#399ee6>pull_request_target</span><span style=color:#61676ccc>:
</span><span>    </span><span style=color:#399ee6>types</span><span style=color:#61676ccc>:
</span><span>      - </span><span style=color:#86b300>labeled
</span><span style=color:#399ee6>permissions</span><span style=color:#61676ccc>:
</span><span>  </span><span style=color:#399ee6>pull-requests</span><span style=color:#61676ccc>: </span><span style=color:#86b300>'write'
</span><span>
</span><span style=color:#abb0b6;font-style:italic># After:
</span><span style=color:#ff8f40>on</span><span style=color:#61676ccc>:
</span><span>  </span><span style=color:#399ee6>pull_request_target</span><span style=color:#61676ccc>:
</span><span>    </span><span style=color:#399ee6>types</span><span style=color:#61676ccc>:
</span><span>      - </span><span style=color:#86b300>labeled
</span><span>    </span><span style=color:#399ee6>branches</span><span style=color:#61676ccc>:      </span><span style=color:#abb0b6;font-style:italic># æ–°å¢åˆ†æ”¯é™å®š
</span><span>      - </span><span style=color:#86b300>"main"
</span><span style=color:#abb0b6;font-style:italic># ç§»é™¤äº†å…¨å±€ permissions å—ï¼Œæ”¹ä¸ºåœ¨æ¯ä¸ª job å†…å®šä¹‰
</span><span style=color:#399ee6>jobs</span><span style=color:#61676ccc>:
</span><span>  </span><span style=color:#399ee6>comment-on-migration-guide-label</span><span style=color:#61676ccc>:
</span><span>    </span><span style=color:#399ee6>permissions</span><span style=color:#61676ccc>:
</span><span>      </span><span style=color:#399ee6>pull-requests</span><span style=color:#61676ccc>: </span><span style=color:#86b300>"write"
</span><span>    </span><span style=color:#61676ccc>.</span><span style=color:#ff8f40>..
</span></code></pre><h2 id=further-reading>Further Reading</h2><p>å¯¹äºå¸Œæœ›æ·±å…¥äº†è§£æœ¬ PR æ‰€æ¶‰åŠæ¦‚å¿µçš„è¯»è€…ï¼Œå»ºè®®å‚è€ƒä»¥ä¸‹èµ„æºï¼š<ol><li><p><strong>GitHub Actions å®‰å…¨å¼ºåŒ–æŒ‡å—</strong>:</p> <ul><li><a rel="noopener nofollow noreferrer" href=https://docs.github.com/en/actions/security-guides/security-hardening-for-github-actions target=_blank>GitHub å®˜æ–¹æ–‡æ¡£ï¼šå®‰å…¨å¼ºåŒ– GitHub Actions</a><li>é‡ç‚¹é˜…è¯»â€œä½¿ç”¨ç¬¬ä¸‰æ–¹ Actionsâ€ã€â€œé˜²æ­¢ pwn è¯·æ±‚â€ç­‰ç« èŠ‚ã€‚</ul><li><p><strong>å¼€æºä¾›åº”é“¾å®‰å…¨</strong>:</p> <ul><li><a rel="noopener nofollow noreferrer" href=https://openssf.org/%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/ target=_blank>OpenSSF: ä¾›åº”é“¾å®‰å…¨æœ€ä½³å®è·µ</a><li>äº†è§£è½¯ä»¶ç‰©æ–™æ¸…å•(SBOM)ã€ç­¾åã€æ¼æ´ç®¡ç†ç­‰æ¦‚å¿µã€‚</ul><li><p><strong>zizmor å·¥å…·</strong>:</p> <ul><li><a rel="noopener nofollow noreferrer" href=https://github.com/zizmorcore/zizmor target=_blank>zizmor GitHub ä»“åº“</a><li>æŸ¥çœ‹å…¶è§„åˆ™é›†ï¼Œäº†è§£å®ƒå…·ä½“æ£€æŸ¥å“ªäº›å®‰å…¨é—®é¢˜ã€‚</ul><li><p><strong>æœ€å°æƒé™åŸåˆ™</strong>:</p> <ul><li><a rel="noopener nofollow noreferrer" href=https://cheatsheetseries.owaaasp.org/cheatsheets/Least_Privilege_Cheat_Sheet.html target=_blank>OWASP: æœ€å°æƒé™åŸåˆ™</a><li>è¿™ä¸€å®‰å…¨è®¾è®¡åŸåˆ™åœ¨ç½‘ç»œã€ç³»ç»Ÿå’Œåº”ç”¨å±‚é¢éƒ½è‡³å…³é‡è¦ã€‚</ul><li><p><strong>å…³äº <code>pull_request_target</code></strong>:</p> <ul><li><a rel="noopener nofollow noreferrer" href=https://github.blog/2020-08-03-github-actions-improvements-for-fork-and-pull-request-workflows/ target=_blank>GitHub åšå®¢ï¼šKeeping your GitHub Actions and workflows secure Part 2: Untrusted input</a><li>æ·±å…¥ç†è§£æ­¤äº‹ä»¶çš„ç‰¹æ®Šæ€§åŠå®‰å…¨é£é™©ã€‚</ul></ol></div><div data-is-md-page=true data-patch-exists=true data-patch-path=/pull_request/bevy/2025-12/pr_22294.patch id=patch-info style=display:none></div><div class=bottom-spacer></div></div></div>