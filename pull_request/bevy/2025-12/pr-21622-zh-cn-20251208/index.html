<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://unknownue.github.io name=base><title>
         #21622 :bug: ä¿®å¤ PropagateStop å’Œ PropagateOver
        
    </title><meta content="#21622 :bug: ä¿®å¤ PropagateStop å’Œ PropagateOver" property=og:title><meta content="A personal blog built with Zola and Apollo theme" property=og:description><meta content="A personal blog built with Zola and Apollo theme" name=description><link href=/icons/favicon.png rel=icon type=image/png><link href=https://unknownue.github.io/fonts.css rel=stylesheet><script src=https://unknownue.github.io/js/codeblock.js></script><script src=https://unknownue.github.io/js/toc.js></script><script src=https://unknownue.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Unknownue's Blog" href=https://unknownue.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://unknownue.github.io/theme/light.css rel=stylesheet><link href=https://unknownue.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://unknownue.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://unknownue.github.io/main.css media=screen rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js></script><script>// Initialize mermaid once DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            mermaid.initialize({
                startOnLoad: false,
                theme: document.body && document.body.classList.contains('dark') ? 'dark' : 'default',
                securityLevel: 'loose',
                flowchart: {
                    useMaxWidth: true,
                    htmlLabels: true
                },
                sequence: {
                    diagramMarginX: 50,
                    diagramMarginY: 10,
                    actorMargin: 50,
                    width: 150,
                    height: 65
                }
            });
        });</script><script src=https://unknownue.github.io/js/main.js></script><script defer src=https://unknownue.github.io/js/label-colors.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/rust.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/typescript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/go.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/cpp.min.js></script><script>// Ensure highlight.js is properly configured
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof hljs !== 'undefined') {
                hljs.configure({
                    languages: ['rust', 'javascript', 'python', 'cpp', 'go', 'typescript'],
                    ignoreUnescapedHTML: true
                });
                console.log('Highlight.js configured in header');
            }
        });</script><link href=https://cdn.jsdelivr.net/npm/diff2html/bundles/css/diff2html.min.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/diff2html/bundles/js/diff2html-ui.min.js></script><script src=https://unknownue.github.io/js/syntax-highlight.js></script><script src=https://unknownue.github.io/js/diff-sidebar.js></script><script src="https://unknownue.github.io/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><div class=content><header><div class=main><a href=https://unknownue.github.io>Unknownue's Blog</a><div class=socials><a class=social href=https://github.com/unknownue rel=me> <img alt=github src=https://unknownue.github.io/icons/social/github.svg> </a><a class=social href=https://github.com/unknownue/unknownue.github.io rel=me> <img alt=github-io src=https://unknownue.github.io/icons/social/rss.svg> </a></div></div><nav><a href=https://unknownue.github.io/posts style=margin-left:.25em>/posts</a><a href=https://unknownue.github.io/projects style=margin-left:.25em>/projects</a><a href=https://unknownue.github.io/about style=margin-left:.25em>/about</a><a href=https://unknownue.github.io/tags style=margin-left:.25em>/tags</a><button title="$SHORTCUT to open search" class=search-button id=search-button><img alt=Search class=search-icon src=https://unknownue.github.io/icons/search.svg></button><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><div id=modal-content><h1 class=page-header id=modalTitle>Search</h1><div id=searchBar><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search... role=combobox spellcheck=false><button title="Clear search" class=clear-button id=clear-search><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></button></div><div id=results-container><div id=results-info><span id=zero_results style=display:none>No results</span><span id=one_result style=display:none>1 result</span><span id=many_results style=display:none>$NUMBER results</span></div><div id=results role=listbox></div></div></div></div><a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://unknownue.github.io/icons/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://unknownue.github.io/icons/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><div class=pull-request-page><article class=md-content-page style=display:none></article><div class=back-link><a href=/pull_request/bevy/2025-12/>â† Back to Pull Requests</a></div><div class=pr-metadata><span class=pr-date>2025-12-08</span><div class=language-switcher><a class=lang-link data-lang=en href=/pull_request/bevy/2025-12/pr-21622-en-20251208>English</a> / <span class="lang-link active" data-lang=zh-cn>ä¸­æ–‡</span></div></div><div class=pr-content><h1 id=title>Title</h1><h2 id=ji-ben-xin-xi>åŸºæœ¬ä¿¡æ¯</h2><ul><li><strong>æ ‡é¢˜</strong>: ğŸ› ä¿®å¤ PropagateStop å’Œ PropagateOver<li><strong>PR é“¾æ¥</strong>: https://github.com/bevyengine/bevy/pull/21622<li><strong>ä½œè€…</strong>: ekwoka<li><strong>çŠ¶æ€</strong>: å·²åˆå¹¶<li><strong>æ ‡ç­¾</strong>: C-Bug, A-ECS, S-Ready-For-Final-Review<li><strong>åˆ›å»ºæ—¶é—´</strong>: 2025-10-21T16:54:04Z<li><strong>åˆå¹¶æ—¶é—´</strong>: 2025-12-08T23:06:55Z<li><strong>åˆå¹¶äºº</strong>: alice-i-cecile</ul><h2 id=miao-shu-fan-yi>æè¿°ç¿»è¯‘</h2><h3 id=objective>Objective</h3><p>ä¿®å¤ #21620<p>ç¡®ä¿ <code>PropagateStop</code> æŒ‰æ–‡æ¡£æ‰€è¿°å·¥ä½œã€‚ç›®å‰ï¼Œ<code>PropagateStop&LTC></code> è¢«æè¿°ä¸ºä»…é˜²æ­¢å…¶å­å®ä½“ç»§æ‰¿ <code>C</code>ï¼Œä½†åœ¨å®è·µä¸­ï¼Œè¯¥å®ä½“æœ¬èº«ä¹Ÿä¸ä¼šç»§æ‰¿ <code>C</code>ã€‚<p>ä½¿ <code>PropagateOver</code> æ­£å¸¸å·¥ä½œã€‚å®ƒä¹‹å‰å®Œå…¨æ— æ•ˆã€‚<h3 id=solution>Solution</h3><p>è°ƒæ•´æµç¨‹ï¼Œé˜²æ­¢åœ¨å­˜åœ¨ <code>PropagateStop</code> æ—¶é€’å½’ç»§æ‰¿ <code>Inherited</code>ï¼Œè€Œä¸æ˜¯å®Œå…¨è·³è¿‡è®¿é—® <code>PropagateStop</code> å®ä½“ã€‚<p>å½“å®ä½“åŒæ—¶å…·æœ‰ <code>Inherited&LTC></code> å’Œ <code>PropagateOver&LTC></code> æ—¶ï¼Œè·³è¿‡åº”ç”¨ <code>C</code>ã€‚<h3 id=testing>Testing</h3><p>é¦–å…ˆæ›´æ–°äº†æµ‹è¯•ä»¥éªŒè¯æµ‹è¯•ç”¨ä¾‹ã€‚å®ƒä»¬ä¸å®Œæ•´ï¼Œå¹¶ä¸”åœ¨æ£€æŸ¥æ­£ç¡®æœ€ç»ˆçŠ¶æ€æ—¶æ— æ³•é€šè¿‡ã€‚<p>åœ¨ç¡®è®¤è¿™äº›æµ‹è¯•æ— æ•ˆåï¼Œé€æ­¥è°ƒæ•´ä»£ç ç›´è‡³åŠŸèƒ½æ­£å¸¸ã€‚<h3 id=fuller-explanation>Fuller Explanation</h3><p>æ ¹æ®æˆ‘å¯¹ç›®æ ‡çš„ç†è§£ï¼ˆä»¥åŠæˆ‘çš„å®ç°ï¼‰ï¼Œè¿™äº›ç»„ä»¶çš„ç»“æœåº”è¯¥æ˜¯è¿™æ ·çš„ï¼š<pre style=color:#61676c;background-color:#fafafa><code><span>(Propagate&LTC>, Inherited&LTC>, C)
</span><span>  (Inherited&LTC>, C)
</span><span>    (PropagateOver&LTC>, Inherited&LTC>)
</span><span>      (Inherited&LTC>, C)
</span><span>        (PropagateStop&LTC>, Inherited&LTC>, C)
</span></code></pre><p>è€Œä¹‹å‰ï¼ˆæˆ‘è®¤ä¸ºé”™è¯¯çš„ï¼‰è¡Œä¸ºä¼¼ä¹æ˜¯ï¼š<pre style=color:#61676c;background-color:#fafafa><code><span>(Propagate&LTC>, Inherited&LTC>, C)
</span><span>  (Inherited&LTC>, C)
</span><span>    (PropagateOver&LTC>, Inherited&LTC>, C)
</span><span>      (Inherited&LTC>, C)
</span><span>        (PropagateStop&LTC>)
</span></code></pre><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼šåœ¨å½“å‰è°ƒæ•´ä¸­ï¼Œ<code>PropagateOver&LTC></code> ä»ç„¶è·å–äº† <code>Inherited&LTC></code>ã€‚æˆ‘è®¤ä¸ºä¹‹å‰å°±æ˜¯è¿™æ ·åšçš„ï¼Œä½†æˆ‘ä¸å®Œå…¨ç†è§£ <code>Inherited&LTC></code> å­˜åœ¨çš„å…¨éƒ¨åŸå› ï¼Ÿæˆ‘æƒ³å®ƒæ˜¯ä¸ºäº†æ­£ç¡®æ ‡è®° <code>C</code> æ˜¯ç»§æ‰¿è€Œæ¥çš„ï¼Œæ‰€ä»¥ä¹Ÿè®¸æˆ‘è¿˜éœ€è¦ä» <code>PropagateOver&LTC></code> ä¸Šç§»é™¤å®ƒï¼Œä»¥ç¡®ä¿æ¸…ç†æ—¶ä¸ä¼šä¹Ÿç§»é™¤å•ç‹¬åº”ç”¨çš„ <code>C</code>ï¼Ÿ<p>æˆ‘æ²¡æœ‰ä»”ç»†æŸ¥çœ‹å…¶ä»–æµ‹è¯•è¯•å›¾æµ‹è¯•ä»€ä¹ˆï¼ˆæˆ–è€…å®ƒä»¬æ˜¯å¦æ­£ç¡®æµ‹è¯•äº†é‚£äº›å†…å®¹ï¼‰ï¼Œä»¥è¯„ä¼°æ˜¯å¦éœ€è¦å…¶ä»–æ›´æ”¹ã€‚<p>å¦‚æœ <code>PropagateOver&LTC></code> æ²¡æœ‰ <code>Inherited&LTC></code> å¹¶ä¸”è¢«é‡æ–°è®¾ç½®çˆ¶çº§ï¼Œæ˜¯å¦èƒ½ç¡®ä¿å…¶å­å®ä½“æ­£ç¡®ç§»é™¤/æ›´æ–°å®ƒä»¬çš„ <code>Inherited&LTC></code>ï¼Ÿ<p>è¿›ä¸€æ­¥æŸ¥çœ‹ä»£ç ï¼Œå¾ˆå¯èƒ½å¯ä»¥é€šè¿‡ä½¿ç”¨ AncestorIter å’Œ DescendentIter æ¥å¤§å¹…ç®€åŒ–ï¼Œä½†æˆ‘ä¸ç¡®å®šåœ¨å½“å‰æ—¶åˆ»æ˜¯è¿›è¡Œæ›´å…¨é¢çš„é‡æ„æ›´æœ‰æ„ä¹‰ï¼Œè¿˜æ˜¯å…ˆå°è¯•è§£å†³è¿™ä¸ªç›´æ¥é—®é¢˜ï¼Œç„¶åå†è¿›è¡Œæ›´å¤§çš„é‡æ„ï¼Ÿ<p>æœ‰ä»€ä¹ˆæƒ³æ³•ï¼Ÿ<hr><h2 id=zhe-ge-pull-request-de-gu-shi>è¿™ä¸ª Pull Request çš„æ•…äº‹</h2><p>è¿™ä¸ª PR ä¿®å¤äº† Bevy ECS ä¸­ä¸¤ä¸ªå±‚æ¬¡ä¼ æ’­ç»„ä»¶çš„å…³é”®é”™è¯¯ã€‚é—®é¢˜å‡ºç°åœ¨ <code>PropagateStop</code> å’Œ <code>PropagateOver</code> çš„è¡Œä¸ºä¸æ–‡æ¡£æè¿°ä¸ç¬¦ï¼Œå¯¼è‡´å¼€å‘è€…åœ¨æ„å»ºå¤æ‚çš„å®ä½“å±‚æ¬¡ç»“æ„æ—¶é‡åˆ°æ„å¤–è¡Œä¸ºã€‚<h3 id=wen-ti-yu-bei-jing>é—®é¢˜ä¸èƒŒæ™¯</h3><p>åœ¨ Bevy çš„ ECS ç³»ç»Ÿä¸­ï¼Œç»„ä»¶å¯ä»¥é€šè¿‡å®ä½“å±‚æ¬¡å…³ç³»è¿›è¡Œä¼ æ’­ã€‚<code>Propagate&LTC></code> ç»„ä»¶å…è®¸çˆ¶å®ä½“çš„ç»„ä»¶å€¼ä¼ æ’­åˆ°å­å®ä½“ã€‚ç„¶è€Œï¼Œæœ‰ä¸¤ä¸ªç‰¹æ®Šçš„æ§åˆ¶ç»„ä»¶å­˜åœ¨ç¼ºé™·ï¼š<ol><li><p><strong><code>PropagateStop&LTC></code></strong>ï¼šæ ¹æ®æ–‡æ¡£ï¼Œåº”è¯¥åªé˜»æ­¢å…¶å­å®ä½“ç»§æ‰¿ç»„ä»¶ <code>C</code>ï¼Œä½†å®ä½“æœ¬èº«åº”è¯¥ç»§ç»­ç»§æ‰¿çˆ¶çº§çš„ç»„ä»¶ã€‚ç„¶è€Œï¼Œå®é™…å®ç°ä¸­ï¼Œå¸¦æœ‰ <code>PropagateStop</code> çš„å®ä½“æœ¬èº«ä¹Ÿä¸ä¼šç»§æ‰¿ç»„ä»¶ã€‚</p><li><p><strong><code>PropagateOver&LTC></code></strong>ï¼šåº”è¯¥å…è®¸å®ä½“è¦†ç›–ç»§æ‰¿çš„ç»„ä»¶å€¼ï¼Œä½¿ç”¨è‡ªå·±çš„ç»„ä»¶å€¼ï¼ŒåŒæ—¶ä»å…è®¸å…¶å­å®ä½“ä»è¯¥å®ä½“çš„ç¥–å…ˆç»§æ‰¿åŸå§‹å€¼ã€‚ä½†å®é™…ä¸Šå®ƒå®Œå…¨ä¸èµ·ä½œç”¨ã€‚</p></ol><p>è¿™äº›é”™è¯¯å½±å“äº†éœ€è¦ç²¾ç¡®æ§åˆ¶ç»„ä»¶ä¼ æ’­çš„åœºæ™¯ï¼Œæ¯”å¦‚ UI ç³»ç»Ÿä¸­éœ€è¦å±€éƒ¨è¦†ç›–æ ·å¼ï¼Œæˆ–è€…æ¸¸æˆå¯¹è±¡å±‚æ¬¡ç»“æ„ä¸­éœ€è¦ä¸­æ–­æŸäº›å±æ€§çš„ç»§æ‰¿ã€‚<h3 id=jie-jue-fang-an-fang-fa>è§£å†³æ–¹æ¡ˆæ–¹æ³•</h3><p>å¼€å‘è€…é‡‡å–äº†é€æ­¥ä¿®å¤çš„æ–¹æ³•ï¼Œè€Œä¸æ˜¯ç«‹å³è¿›è¡Œå¤§è§„æ¨¡é‡æ„ã€‚æ ¸å¿ƒæ€è·¯æ˜¯è°ƒæ•´ä¼ æ’­ç³»ç»Ÿçš„æŸ¥è¯¢å’Œå¤„ç†é€»è¾‘ï¼Œä½¿å…¶æ­£ç¡®å¤„ç†è¾¹ç•Œæƒ…å†µï¼š<ol><li><p>å¯¹äº <code>PropagateStop</code>ï¼šæ”¹å˜ä¼ æ’­ç®—æ³•ï¼Œå…è®¸å¸¦æœ‰ <code>PropagateStop</code> çš„å®ä½“ç»§æ‰¿çˆ¶çº§ç»„ä»¶ï¼Œä½†é˜»æ­¢è¿›ä¸€æ­¥å‘ä¸‹æ¸¸ä¼ æ’­åˆ°å…¶å­å®ä½“ã€‚</p><li><p>å¯¹äº <code>PropagateOver</code>ï¼šç¡®ä¿ç³»ç»Ÿè¯†åˆ«è¿™äº›å®ä½“å¹¶è·³è¿‡å¯¹å®ƒä»¬çš„ç»„ä»¶åº”ç”¨ï¼ŒåŒæ—¶ä»å…è®¸ä¼ æ’­æ ‡è®°ç»§ç»­å‘ä¸‹æ¸¸ä¼ é€’ã€‚</p></ol><h3 id=ju-ti-shi-xian>å…·ä½“å®ç°</h3><p>å®ç°ä¸»è¦é›†ä¸­åœ¨ <code>crates/bevy_app/src/propagate.rs</code> æ–‡ä»¶ä¸­çš„å‡ ä¸ªå…³é”®ç³»ç»Ÿï¼š<p><strong>ç¬¬ä¸€ä¸ªé‡è¦å˜åŒ–</strong>ï¼šä¿®æ”¹ <code>propagate_inherited</code> ç³»ç»Ÿçš„æŸ¥è¯¢ï¼Œä½¿å…¶åŒ…å« <code>PropagateStop</code> ä¿¡æ¯ï¼š<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// ä¹‹å‰ï¼š
</span><span>recurse</span><span style=color:#61676ccc>: </span><span>Query<
</span><span>    (</span><span style=color:#55b4d4;font-style:italic>Option</span><span><</span><span style=color:#ed9366>&</span><span style=color:#fa6e32>R</span><span style=color:#ed9366>::</span><span>RelationshipTarget>, </span><span style=color:#55b4d4;font-style:italic>Option</span><span><</span><span style=color:#ed9366>&</span><span>Inherited&LTC>>),
</span><span>    (Without&LTPropagate&LTC>>, Without&LTPropagateStop&LTC>>, F),
</span><span>></span><span style=color:#61676ccc>,
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// ä¹‹åï¼š
</span><span>recurse</span><span style=color:#61676ccc>: </span><span>Query<
</span><span>    (
</span><span>        </span><span style=color:#55b4d4;font-style:italic>Option</span><span><</span><span style=color:#ed9366>&</span><span style=color:#fa6e32>R</span><span style=color:#ed9366>::</span><span>RelationshipTarget>,
</span><span>        </span><span style=color:#55b4d4;font-style:italic>Option</span><span><</span><span style=color:#ed9366>&</span><span>Inherited&LTC>>,
</span><span>        </span><span style=color:#55b4d4;font-style:italic>Option</span><span><</span><span style=color:#ed9366>&</span><span>PropagateStop&LTC>>,
</span><span>    ),
</span><span>    (Without&LTPropagate&LTC>>, F),
</span><span>></span><span style=color:#61676ccc>,
</span></code></pre><p>è¿™ä¸ªå˜åŒ–æ˜¯å…³é”®ï¼šç°åœ¨æŸ¥è¯¢åŒ…å«äº† <code>PropagateStop</code> ä¿¡æ¯ï¼Œä½†ä¸å†æ’é™¤å¸¦æœ‰ <code>PropagateStop</code> çš„å®ä½“ã€‚è¿™ä½¿å¾—ç³»ç»Ÿèƒ½å¤Ÿæ£€æŸ¥ä¸€ä¸ªå®ä½“æ˜¯å¦æœ‰ <code>PropagateStop</code>ï¼Œè€Œä¸æ˜¯å®Œå…¨è·³è¿‡å®ƒä»¬ã€‚<p><strong>ç¬¬äºŒä¸ªå…³é”®ä¿®æ”¹</strong>ï¼šåœ¨ä¼ æ’­é€»è¾‘ä¸­æ·»åŠ åœæ­¢æ£€æŸ¥ï¼š<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// ä¹‹å‰ï¼šæ— æ¡ä»¶ä¼ æ’­åˆ°å­å®ä½“
</span><span style=color:#fa6e32>if let </span><span style=color:#55b4d4;font-style:italic>Some</span><span>(targets) </span><span style=color:#ed9366>=</span><span> maybe_targets {
</span><span>    to_process</span><span style=color:#ed9366>.</span><span style=color:#f07171>extend</span><span>(
</span><span>        targets
</span><span>            </span><span style=color:#ed9366>.</span><span style=color:#f07171>iter</span><span>()
</span><span>            </span><span style=color:#ed9366>.</span><span style=color:#f07171>map</span><span>(|</span><span style=color:#ff8f40>target</span><span>| (target</span><span style=color:#61676ccc>,</span><span> maybe_inherited</span><span style=color:#ed9366>.</span><span style=color:#f07171>clone</span><span>()))</span><span style=color:#61676ccc>,
</span><span>    )</span><span style=color:#61676ccc>;
</span><span>}
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// ä¹‹åï¼šä»…åœ¨æ²¡æœ‰ PropagateStop æ—¶ä¼ æ’­
</span><span style=color:#fa6e32>if</span><span> maybe_stop</span><span style=color:#ed9366>.</span><span style=color:#f07171>is_none</span><span>()
</span><span>    </span><span style=color:#ed9366>&& </span><span style=color:#fa6e32>let </span><span style=color:#55b4d4;font-style:italic>Some</span><span>(targets) </span><span style=color:#ed9366>=</span><span> maybe_targets
</span><span>{
</span><span>    to_process</span><span style=color:#ed9366>.</span><span style=color:#f07171>extend</span><span>(
</span><span>        targets
</span><span>            </span><span style=color:#ed9366>.</span><span style=color:#f07171>iter</span><span>()
</span><span>            </span><span style=color:#ed9366>.</span><span style=color:#f07171>map</span><span>(|</span><span style=color:#ff8f40>target</span><span>| (target</span><span style=color:#61676ccc>,</span><span> maybe_inherited</span><span style=color:#ed9366>.</span><span style=color:#f07171>clone</span><span>()))</span><span style=color:#61676ccc>,
</span><span>    )</span><span style=color:#61676ccc>;
</span><span>}
</span></code></pre><p>è¿™ä¸ªæ”¹å˜ç¡®ä¿äº† <code>PropagateStop</code> å®ä½“ä»èƒ½è·å¾— <code>Inherited&LTC></code> ç»„ä»¶ï¼ˆå¦‚æœå®ƒä»¬çš„çˆ¶çº§æœ‰çš„è¯ï¼‰ï¼Œä½†ä¸ä¼šå°†ç»§æ‰¿çŠ¶æ€è¿›ä¸€æ­¥ä¼ é€’ç»™å®ƒä»¬çš„å­å®ä½“ã€‚<p><strong>ç¬¬ä¸‰ä¸ªé‡è¦å˜åŒ–</strong>ï¼šæ–°å¢ <code>update_removed_limit</code> ç³»ç»Ÿæ¥å¤„ç† <code>PropagateOver</code> æˆ– <code>PropagateStop</code> è¢«ç§»é™¤çš„æƒ…å†µï¼š<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#fa6e32>pub fn </span><span style=color:#f29718>update_removed_limit</span><span>&LTC</span><span style=color:#61676ccc>:</span><span> Component </span><span style=color:#ed9366>+ </span><span style=color:#55b4d4;font-style:italic>Clone </span><span style=color:#ed9366>+ </span><span style=color:#55b4d4;font-style:italic>PartialEq</span><span>, F</span><span style=color:#61676ccc>:</span><span> QueryFilter, R</span><span style=color:#61676ccc>:</span><span> Relationship>(
</span><span>    </span><span style=color:#fa6e32>mut </span><span style=color:#ff8f40>inherited</span><span style=color:#61676ccc>: </span><span>Query<</span><span style=color:#ed9366>&</span><span style=color:#fa6e32>mut </span><span>Inherited&LTC>>,
</span><span>    </span><span style=color:#fa6e32>mut </span><span style=color:#ff8f40>removed_skip</span><span style=color:#61676ccc>: </span><span>RemovedComponents&LTPropagateOver&LTC>>,
</span><span>    </span><span style=color:#fa6e32>mut </span><span style=color:#ff8f40>removed_stop</span><span style=color:#61676ccc>: </span><span>RemovedComponents&LTPropagateStop&LTC>>,
</span><span>) {
</span><span>    </span><span style=color:#fa6e32>for</span><span> entity </span><span style=color:#ed9366>in</span><span> removed_skip</span><span style=color:#ed9366>.</span><span style=color:#f07171>read</span><span>() {
</span><span>        </span><span style=color:#fa6e32>if let </span><span style=color:#55b4d4;font-style:italic>Ok</span><span>(</span><span style=color:#fa6e32>mut</span><span> inherited) </span><span style=color:#ed9366>=</span><span> inherited</span><span style=color:#ed9366>.</span><span style=color:#f07171>get_mut</span><span>(entity) {
</span><span>            inherited</span><span style=color:#ed9366>.</span><span style=color:#f07171>set_changed</span><span>()</span><span style=color:#61676ccc>;
</span><span>        }
</span><span>    }
</span><span>    </span><span style=color:#fa6e32>for</span><span> entity </span><span style=color:#ed9366>in</span><span> removed_stop</span><span style=color:#ed9366>.</span><span style=color:#f07171>read</span><span>() {
</span><span>        </span><span style=color:#fa6e32>if let </span><span style=color:#55b4d4;font-style:italic>Ok</span><span>(</span><span style=color:#fa6e32>mut</span><span> inherited) </span><span style=color:#ed9366>=</span><span> inherited</span><span style=color:#ed9366>.</span><span style=color:#f07171>get_mut</span><span>(entity) {
</span><span>            inherited</span><span style=color:#ed9366>.</span><span style=color:#f07171>set_changed</span><span>()</span><span style=color:#61676ccc>;
</span><span>        }
</span><span>    }
</span><span>}
</span></code></pre><p>è¿™ä¸ªæ–°å¢çš„ç³»ç»Ÿç¡®ä¿äº†å½“ <code>PropagateOver</code> æˆ– <code>PropagateStop</code> è¢«ç§»é™¤æ—¶ï¼Œå®ä½“çš„ <code>Inherited&LTC></code> ç»„ä»¶ä¼šè¢«æ ‡è®°ä¸ºå·²æ›´æ”¹ï¼Œä»è€Œè§¦å‘é‡æ–°ä¼ æ’­ã€‚<p><strong>ç¬¬å››ä¸ªä¿®æ”¹</strong>ï¼šè°ƒæ•´ <code>propagate_output</code> ç³»ç»Ÿä»¥æ­£ç¡®å¤„ç† <code>PropagateOver</code>ï¼š<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// ä¹‹å‰ï¼šåªå¤„ç† Inherited&LTC> å˜åŒ–çš„å®ä½“
</span><span style=color:#fa6e32>pub fn </span><span style=color:#f29718>propagate_output</span><span>&LTC</span><span style=color:#61676ccc>:</span><span> Component </span><span style=color:#ed9366>+ </span><span style=color:#55b4d4;font-style:italic>Clone </span><span style=color:#ed9366>+ </span><span style=color:#55b4d4;font-style:italic>PartialEq</span><span>, F</span><span style=color:#61676ccc>:</span><span> QueryFilter>(
</span><span>    </span><span style=color:#fa6e32>mut </span><span style=color:#ff8f40>commands</span><span style=color:#61676ccc>:</span><span> Commands,
</span><span>    </span><span style=color:#ff8f40>changed</span><span style=color:#61676ccc>: </span><span>Query<
</span><span>        (Entity, </span><span style=color:#ed9366>&</span><span>Inherited&LTC>, </span><span style=color:#55b4d4;font-style:italic>Option</span><span><</span><span style=color:#ed9366>&</span><span>C>),
</span><span>        (Changed&LTInherited&LTC>>, Without&LTPropagateOver&LTC>>, F),
</span><span>    >,
</span><span>) { </span><span style=color:#abb0b6;font-style:italic>/* ... */ </span><span>}
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// ä¹‹åï¼šä¹Ÿå¤„ç† Inherited&LTC> è¢«ç§»é™¤çš„æƒ…å†µ
</span><span style=color:#fa6e32>pub fn </span><span style=color:#f29718>propagate_output</span><span>&LTC</span><span style=color:#61676ccc>:</span><span> Component </span><span style=color:#ed9366>+ </span><span style=color:#55b4d4;font-style:italic>Clone </span><span style=color:#ed9366>+ </span><span style=color:#55b4d4;font-style:italic>PartialEq</span><span>, F</span><span style=color:#61676ccc>:</span><span> QueryFilter>(
</span><span>    </span><span style=color:#fa6e32>mut </span><span style=color:#ff8f40>commands</span><span style=color:#61676ccc>:</span><span> Commands,
</span><span>    </span><span style=color:#ff8f40>changed</span><span style=color:#61676ccc>: </span><span>Query<
</span><span>        (Entity, </span><span style=color:#ed9366>&</span><span>Inherited&LTC>, </span><span style=color:#55b4d4;font-style:italic>Option</span><span><</span><span style=color:#ed9366>&</span><span>C>),
</span><span>        (Changed&LTInherited&LTC>>, Without&LTPropagateOver&LTC>>, F),
</span><span>    >,
</span><span>    </span><span style=color:#fa6e32>mut </span><span style=color:#ff8f40>removed</span><span style=color:#61676ccc>: </span><span>RemovedComponents&LTInherited&LTC>>,
</span><span>    </span><span style=color:#ff8f40>skip</span><span style=color:#61676ccc>: </span><span>Query<(), With&LTPropagateOver&LTC>>>,
</span><span>) {
</span><span>    </span><span style=color:#abb0b6;font-style:italic>// ... å¤„ç† changed
</span><span>    
</span><span>    </span><span style=color:#abb0b6;font-style:italic>// æ–°å¢çš„å¤„ç†ç§»é™¤é€»è¾‘
</span><span>    </span><span style=color:#fa6e32>for</span><span> removed </span><span style=color:#ed9366>in</span><span> removed</span><span style=color:#ed9366>.</span><span style=color:#f07171>read</span><span>() {
</span><span>        </span><span style=color:#fa6e32>if</span><span> skip</span><span style=color:#ed9366>.</span><span style=color:#f07171>get</span><span>(removed)</span><span style=color:#ed9366>.</span><span style=color:#f07171>is_err</span><span>() {
</span><span>            commands</span><span style=color:#ed9366>.</span><span style=color:#f07171>entity</span><span>(removed)</span><span style=color:#ed9366>.</span><span>remove</span><span style=color:#ed9366>::</span><span>&LTC>()</span><span style=color:#61676ccc>;
</span><span>        }
</span><span>    }
</span><span>}
</span></code></pre><p>è¿™ä¸ªä¿®æ”¹ç¡®ä¿å½“ <code>Inherited&LTC></code> è¢«ç§»é™¤æ—¶ï¼Œå¯¹åº”çš„ç»„ä»¶ <code>C</code> ä¹Ÿä¼šè¢«ç§»é™¤ï¼Œé™¤éå®ä½“æœ‰ <code>PropagateOver&LTC></code>ï¼ˆè¿™ç§æƒ…å†µä¸‹å®ä½“åº”è¯¥ä¿ç•™è‡ªå·±çš„ <code>C</code> ç»„ä»¶ï¼‰ã€‚<h3 id=ji-shu-dong-cha>æŠ€æœ¯æ´å¯Ÿ</h3><p>è¿™ä¸ªä¿®å¤å±•ç¤ºäº†å‡ ä¸ªé‡è¦çš„ ECS è®¾è®¡æ¨¡å¼ï¼š<ol><li><p><strong>å˜æ›´æ£€æµ‹çš„æ™ºèƒ½ä½¿ç”¨</strong>ï¼šé€šè¿‡ <code>set_changed()</code> æ‰‹åŠ¨è§¦å‘å˜æ›´æ£€æµ‹ï¼Œç¡®ä¿ç³»ç»Ÿåœ¨ç›¸å…³ç»„ä»¶è¢«ç§»é™¤æ—¶é‡æ–°è¿è¡Œã€‚</p><li><p><strong>æŸ¥è¯¢è¿‡æ»¤çš„ç²¾ç¡®æ€§</strong>ï¼šä»”ç»†è°ƒæ•´æŸ¥è¯¢è¿‡æ»¤å™¨ï¼Œç¡®ä¿ç³»ç»Ÿåªå¤„ç†å®ƒä»¬åº”è¯¥å¤„ç†çš„å®ä½“ï¼ŒåŒæ—¶ä¸æ„å¤–æ’é™¤é‡è¦å®ä½“ã€‚</p><li><p><strong>å¢é‡ä¼ æ’­ç®—æ³•</strong>ï¼šä¼ æ’­ç³»ç»Ÿä½¿ç”¨æœ¬åœ°å‘é‡ (<code>Local&LTVec<...>></code>) æ¥è·Ÿè¸ªéœ€è¦å¤„ç†çš„å®ä½“ï¼Œè¿™æ˜¯ä¸€ç§é«˜æ•ˆçš„å¹¿åº¦ä¼˜å…ˆä¼ æ’­æ–¹æ³•ã€‚</p></ol><p>å¼€å‘è€…è¿˜æ³¨æ„åˆ°ä»£ç æœ‰é‡æ„çš„ç©ºé—´ï¼Œå¯èƒ½é€šè¿‡ä½¿ç”¨ <code>AncestorIter</code> å’Œ <code>DescendentIter</code> æ¥ç®€åŒ–ï¼Œä½†å†³å®šå…ˆä¿®å¤ç´§æ€¥é—®é¢˜ï¼Œå°†æ›´å¤§è§„æ¨¡çš„é‡æ„ç•™åˆ°ä»¥åã€‚è¿™æ˜¯å·¥ç¨‹å®è·µä¸­å¸¸è§çš„æƒè¡¡ï¼šåœ¨ä¿æŒç³»ç»Ÿç¨³å®šçš„åŒæ—¶ä¿®å¤å…³é”®é”™è¯¯ã€‚<h3 id=ying-xiang>å½±å“</h3><p>è¿™ä¸ªä¿®å¤å¸¦æ¥äº†ä»¥ä¸‹å…·ä½“æ”¹è¿›ï¼š<ol><li><p><strong>æ­£ç¡®çš„ <code>PropagateStop</code> è¡Œä¸º</strong>ï¼šå¸¦æœ‰ <code>PropagateStop&LTC></code> çš„å®ä½“ç°åœ¨ä¼šæ­£ç¡®ç»§æ‰¿çˆ¶çº§çš„ç»„ä»¶ <code>C</code>ï¼Œä½†é˜»æ­¢è¯¥ç»„ä»¶ä¼ æ’­ç»™å…¶å­å®ä½“ã€‚</p><li><p><strong>å¯ç”¨çš„ <code>PropagateOver</code> åŠŸèƒ½</strong>ï¼šå¼€å‘è€…ç°åœ¨å¯ä»¥ä½¿ç”¨ <code>PropagateOver</code> æ¥è¦†ç›–ç»§æ‰¿çš„ç»„ä»¶å€¼ï¼ŒåŒæ—¶ä»å…è®¸å­å®ä½“ä»ç¥–å…ˆç»§æ‰¿åŸå§‹å€¼ã€‚</p><li><p><strong>æ›´å¥å£®çš„æµ‹è¯•å¥—ä»¶</strong>ï¼šPR æ·»åŠ å’Œä¿®æ”¹äº†å¤§é‡æµ‹è¯•ï¼Œè¦†ç›–äº†å„ç§è¾¹ç¼˜æƒ…å†µï¼ŒåŒ…æ‹¬ï¼š</p> <ul><li>ç§»é™¤ <code>Propagate</code> ç»„ä»¶åçš„ä¼ æ’­è¡Œä¸º<li>å®ä½“é‡æ–°è®¾ç½®çˆ¶çº§çš„æƒ…å†µ<li><code>PropagateOver</code> å’Œ <code>PropagateStop</code> è¢«ç§»é™¤çš„æƒ…å†µ<li>è¿‡æ»¤å™¨æ¡ä»¶å˜åŒ–çš„æƒ…å†µ</ul></ol><p>æµ‹è¯•çš„å®Œå–„ç¡®ä¿äº†è¿™äº›ä¿®å¤ä¸ä¼šåœ¨æœªæ¥è¢«æ„å¤–ç ´åã€‚<p>ä»æŠ€æœ¯å€ºçš„è§’åº¦çœ‹ï¼Œè¿™ä¸ªä¿®å¤æš´éœ²äº†ç°æœ‰å®ç°çš„ä¸€äº›å¤æ‚æ€§ï¼Œä½†ä¹Ÿä¸ºæœªæ¥çš„é‡æ„å¥ å®šäº†åŸºç¡€ã€‚å¼€å‘è€…æ˜æ™ºåœ°é€‰æ‹©äº†æœ€å°åŒ–ä¿®å¤ï¼ŒåŒæ—¶æŒ‡å‡ºäº†å¯èƒ½çš„æ”¹è¿›æ–¹å‘ã€‚<h2 id=ke-shi-hua-biao-shi>å¯è§†åŒ–è¡¨ç¤º</h2><pre class=language-mermaid data-lang=mermaid style=color:#61676c;background-color:#fafafa><code class=language-mermaid data-lang=mermaid><span>graph TD
</span><span>    A[Propagate&amplt;C&ampgt;] --> B[ä¼ æ’­ç³»ç»Ÿ]
</span><span>    B --> C[Inherited&amplt;C&ampgt;]
</span><span>    C --> D{å®ä½“æ£€æŸ¥}
</span><span>    
</span><span>    D -->|æœ‰ PropagateStop| E[è·å– Inherited&amplt;C&ampgt;]
</span><span>    D -->|æ—  PropagateStop| F[è·å– Inherited&amplt;C&ampgt; å¹¶ä¼ æ’­ç»™å­å®ä½“]
</span><span>    
</span><span>    E --> G[å®ä½“è·å¾— C ç»„ä»¶]
</span><span>    F --> H[å­å®ä½“è·å¾— Inherited&amplt;C&ampgt;]
</span><span>    
</span><span>    I[PropagateOver&amplt;C&ampgt;] --> J[è·³è¿‡åº”ç”¨ C ç»„ä»¶]
</span><span>    J --> K[ä»ä¼ æ’­ Inherited&amplt;C&ampgt; ç»™å­å®ä½“]
</span></code></pre><h2 id=guan-jian-wen-jian-geng-gai>å…³é”®æ–‡ä»¶æ›´æ”¹</h2><h3 id=crates-bevy-app-src-propagate-rs-383-123><code>crates/bevy_app/src/propagate.rs</code> (+383/-123)</h3><p><strong>å˜åŒ–æ¦‚è¿°</strong>ï¼š è¿™ä¸ªæ–‡ä»¶åŒ…å«äº†ç»„ä»¶ä¼ æ’­ç³»ç»Ÿçš„å®Œæ•´å®ç°ã€‚ä¸»è¦å˜åŒ–åŒ…æ‹¬ä¿®å¤ <code>PropagateStop</code> å’Œ <code>PropagateOver</code> çš„é€»è¾‘é”™è¯¯ï¼Œæ·»åŠ æ–°çš„ç³»ç»Ÿæ¥å¤„ç†è¾¹ç•Œæƒ…å†µï¼Œä»¥åŠå¤§å¹…æ‰©å±•æµ‹è¯•è¦†ç›–ã€‚<p><strong>å…³é”®ä»£ç ç‰‡æ®µ</strong>ï¼š<ol><li><strong><code>update_source</code> ç³»ç»Ÿé‡æ„</strong>ï¼š</ol><pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// ä¹‹å‰ï¼šç§»é™¤ Propagate æ—¶ç›´æ¥ç§»é™¤ Inherited å’Œ C
</span><span style=color:#fa6e32>for</span><span> removed </span><span style=color:#ed9366>in</span><span> removed</span><span style=color:#ed9366>.</span><span style=color:#f07171>read</span><span>() {
</span><span>    </span><span style=color:#fa6e32>if let </span><span style=color:#55b4d4;font-style:italic>Ok</span><span>(</span><span style=color:#fa6e32>mut</span><span> commands) </span><span style=color:#ed9366>=</span><span> commands</span><span style=color:#ed9366>.</span><span style=color:#f07171>get_entity</span><span>(removed) {
</span><span>        commands</span><span style=color:#ed9366>.</span><span>remove</span><span style=color:#ed9366>::</span><span><(Inherited&LTC>, C)>()</span><span style=color:#61676ccc>;
</span><span>    }
</span><span>}
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// ä¹‹åï¼šæ£€æŸ¥æ˜¯å¦æœ‰ç¥–å…ˆå¯ä»¥æä¾›ç»§æ‰¿å€¼
</span><span style=color:#fa6e32>for</span><span> removed </span><span style=color:#ed9366>in</span><span> removed</span><span style=color:#ed9366>.</span><span style=color:#f07171>read</span><span>() {
</span><span>    </span><span style=color:#fa6e32>if let </span><span style=color:#55b4d4;font-style:italic>Ok</span><span>(</span><span style=color:#fa6e32>mut</span><span> commands) </span><span style=color:#ed9366>=</span><span> commands</span><span style=color:#ed9366>.</span><span style=color:#f07171>get_entity</span><span>(removed) {
</span><span>        </span><span style=color:#fa6e32>if let </span><span style=color:#55b4d4;font-style:italic>Some</span><span>(inherited) </span><span style=color:#ed9366>=</span><span> relationship
</span><span>            </span><span style=color:#ed9366>.</span><span style=color:#f07171>get</span><span>(removed)
</span><span>            </span><span style=color:#ed9366>.</span><span style=color:#f07171>ok</span><span>()
</span><span>            </span><span style=color:#ed9366>.</span><span style=color:#f07171>and_then</span><span>(|</span><span style=color:#ff8f40>r</span><span>| relations</span><span style=color:#ed9366>.</span><span style=color:#f07171>get</span><span>(r</span><span style=color:#ed9366>.</span><span style=color:#f07171>get</span><span>())</span><span style=color:#ed9366>.</span><span style=color:#f07171>ok</span><span>())
</span><span>        {
</span><span>            commands</span><span style=color:#ed9366>.</span><span style=color:#f07171>insert</span><span>(inherited</span><span style=color:#ed9366>.</span><span style=color:#f07171>clone</span><span>())</span><span style=color:#61676ccc>;
</span><span>        } </span><span style=color:#fa6e32>else </span><span>{
</span><span>            commands</span><span style=color:#ed9366>.</span><span>remove</span><span style=color:#ed9366>::</span><span>&LTInherited&LTC>>()</span><span style=color:#61676ccc>;
</span><span>        }
</span><span>    }
</span><span>}
</span></code></pre><ol start=2><li><strong>æ–°å¢ <code>update_removed_limit</code> ç³»ç»Ÿ</strong>ï¼š</ol><pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#fa6e32>pub fn </span><span style=color:#f29718>update_removed_limit</span><span>&LTC</span><span style=color:#61676ccc>:</span><span> Component </span><span style=color:#ed9366>+ </span><span style=color:#55b4d4;font-style:italic>Clone </span><span style=color:#ed9366>+ </span><span style=color:#55b4d4;font-style:italic>PartialEq</span><span>, F</span><span style=color:#61676ccc>:</span><span> QueryFilter, R</span><span style=color:#61676ccc>:</span><span> Relationship>(
</span><span>    </span><span style=color:#fa6e32>mut </span><span style=color:#ff8f40>inherited</span><span style=color:#61676ccc>: </span><span>Query<</span><span style=color:#ed9366>&</span><span style=color:#fa6e32>mut </span><span>Inherited&LTC>>,
</span><span>    </span><span style=color:#fa6e32>mut </span><span style=color:#ff8f40>removed_skip</span><span style=color:#61676ccc>: </span><span>RemovedComponents&LTPropagateOver&LTC>>,
</span><span>    </span><span style=color:#fa6e32>mut </span><span style=color:#ff8f40>removed_stop</span><span style=color:#61676ccc>: </span><span>RemovedComponents&LTPropagateStop&LTC>>,
</span><span>) {
</span><span>    </span><span style=color:#fa6e32>for</span><span> entity </span><span style=color:#ed9366>in</span><span> removed_skip</span><span style=color:#ed9366>.</span><span style=color:#f07171>read</span><span>() {
</span><span>        </span><span style=color:#fa6e32>if let </span><span style=color:#55b4d4;font-style:italic>Ok</span><span>(</span><span style=color:#fa6e32>mut</span><span> inherited) </span><span style=color:#ed9366>=</span><span> inherited</span><span style=color:#ed9366>.</span><span style=color:#f07171>get_mut</span><span>(entity) {
</span><span>            inherited</span><span style=color:#ed9366>.</span><span style=color:#f07171>set_changed</span><span>()</span><span style=color:#61676ccc>;
</span><span>        }
</span><span>    }
</span><span>    </span><span style=color:#fa6e32>for</span><span> entity </span><span style=color:#ed9366>in</span><span> removed_stop</span><span style=color:#ed9366>.</span><span style=color:#f07171>read</span><span>() {
</span><span>        </span><span style=color:#fa6e32>if let </span><span style=color:#55b4d4;font-style:italic>Ok</span><span>(</span><span style=color:#fa6e32>mut</span><span> inherited) </span><span style=color:#ed9366>=</span><span> inherited</span><span style=color:#ed9366>.</span><span style=color:#f07171>get_mut</span><span>(entity) {
</span><span>            inherited</span><span style=color:#ed9366>.</span><span style=color:#f07171>set_changed</span><span>()</span><span style=color:#61676ccc>;
</span><span>        }
</span><span>    }
</span><span>}
</span></code></pre><ol start=3><li><strong><code>propagate_inherited</code> ä¸­çš„å…³é”®é€»è¾‘å˜åŒ–</strong>ï¼š</ol><pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// æ£€æŸ¥æ˜¯å¦åº”è¯¥ä¼ æ’­ç»™å­å®ä½“
</span><span style=color:#fa6e32>if</span><span> maybe_stop</span><span style=color:#ed9366>.</span><span style=color:#f07171>is_none</span><span>()
</span><span>    </span><span style=color:#ed9366>&& </span><span style=color:#fa6e32>let </span><span style=color:#55b4d4;font-style:italic>Some</span><span>(targets) </span><span style=color:#ed9366>=</span><span> maybe_targets
</span><span>{
</span><span>    to_process</span><span style=color:#ed9366>.</span><span style=color:#f07171>extend</span><span>(
</span><span>        targets
</span><span>            </span><span style=color:#ed9366>.</span><span style=color:#f07171>iter</span><span>()
</span><span>            </span><span style=color:#ed9366>.</span><span style=color:#f07171>map</span><span>(|</span><span style=color:#ff8f40>target</span><span>| (target</span><span style=color:#61676ccc>,</span><span> maybe_inherited</span><span style=color:#ed9366>.</span><span style=color:#f07171>clone</span><span>()))</span><span style=color:#61676ccc>,
</span><span>    )</span><span style=color:#61676ccc>;
</span><span>}
</span></code></pre><p><strong>è¿™äº›å˜åŒ–ä¸ PR ç›®çš„çš„å…³ç³»</strong>ï¼š<ul><li>ç¬¬ä¸€ä¸ªå˜åŒ–ç¡®ä¿å½“ <code>Propagate</code> ç»„ä»¶è¢«ç§»é™¤æ—¶ï¼Œå®ä½“èƒ½æ­£ç¡®åœ°ä»ç¥–å…ˆç»§æ‰¿å€¼ï¼ˆå¦‚æœå­˜åœ¨ï¼‰<li>ç¬¬äºŒä¸ªå˜åŒ–ç¡®ä¿å½“ <code>PropagateOver</code> æˆ– <code>PropagateStop</code> è¢«ç§»é™¤æ—¶ï¼Œç³»ç»Ÿä¼šé‡æ–°è®¡ç®—ä¼ æ’­<li>ç¬¬ä¸‰ä¸ªå˜åŒ–æ˜¯ä¿®å¤ <code>PropagateStop</code> çš„æ ¸å¿ƒï¼šå…è®¸å®ä½“ç»§æ‰¿ä½†é˜»æ­¢è¿›ä¸€æ­¥ä¼ æ’­</ul><h2 id=yan-shen-yue-du>å»¶ä¼¸é˜…è¯»</h2><ol><li><p><strong>Bevy ECS æ–‡æ¡£</strong>ï¼šäº†è§£ç»„ä»¶ã€ç³»ç»Ÿå’ŒæŸ¥è¯¢çš„åŸºæœ¬æ¦‚å¿µ</p> <ul><li>https://bevyengine.org/learn/book/ecs/</ul><li><p><strong>å˜æ›´æ£€æµ‹åœ¨ Bevy ä¸­çš„å·¥ä½œåŸç†</strong>ï¼š</p> <ul><li><code>DetectChangesMut</code> trait å’Œ <code>set_changed()</code> æ–¹æ³•çš„ä½¿ç”¨</ul><li><p><strong>å®ä½“å±‚æ¬¡ç»“æ„ä¼ æ’­æ¨¡å¼</strong>ï¼š</p> <ul><li>åœ¨å…¶ä»–æ¸¸æˆå¼•æ“ä¸­ç±»ä¼¼çš„ç»„ä»¶ç»§æ‰¿ç³»ç»Ÿ</ul><li><p><strong>ç³»ç»Ÿè°ƒåº¦å’Œæ‰§è¡Œé¡ºåº</strong>ï¼š</p> <ul><li>Bevy ä¸­ç³»ç»Ÿå¦‚ä½•æ’åºä»¥ç¡®ä¿æ­£ç¡®çš„æ•°æ®æµ</ul></ol></div><div data-is-md-page=true data-patch-exists=true data-patch-path=/pull_request/bevy/2025-12/pr_21622.patch id=patch-info style=display:none></div><div class=bottom-spacer></div></div></div>