<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://unknownue.github.io name=base><title>
         #21746 Upgrade to wgpu 27 and associated crates
        
    </title><meta content="#21746 Upgrade to wgpu 27 and associated crates" property=og:title><meta content="A personal blog built with Zola and Apollo theme" property=og:description><meta content="A personal blog built with Zola and Apollo theme" name=description><link href=/icons/favicon.png rel=icon type=image/png><link href=https://unknownue.github.io/fonts.css rel=stylesheet><script src=https://unknownue.github.io/js/codeblock.js></script><script src=https://unknownue.github.io/js/toc.js></script><script src=https://unknownue.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Unknownue's Blog" href=https://unknownue.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://unknownue.github.io/theme/light.css rel=stylesheet><link href=https://unknownue.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://unknownue.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://unknownue.github.io/main.css media=screen rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js></script><script>// Initialize mermaid once DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            mermaid.initialize({
                startOnLoad: false,
                theme: document.body && document.body.classList.contains('dark') ? 'dark' : 'default',
                securityLevel: 'loose',
                flowchart: {
                    useMaxWidth: true,
                    htmlLabels: true
                },
                sequence: {
                    diagramMarginX: 50,
                    diagramMarginY: 10,
                    actorMargin: 50,
                    width: 150,
                    height: 65
                }
            });
        });</script><script src=https://unknownue.github.io/js/main.js></script><script defer src=https://unknownue.github.io/js/label-colors.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/rust.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/typescript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/go.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/cpp.min.js></script><script>// Ensure highlight.js is properly configured
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof hljs !== 'undefined') {
                hljs.configure({
                    languages: ['rust', 'javascript', 'python', 'cpp', 'go', 'typescript'],
                    ignoreUnescapedHTML: true
                });
                console.log('Highlight.js configured in header');
            }
        });</script><link href=https://cdn.jsdelivr.net/npm/diff2html/bundles/css/diff2html.min.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/diff2html/bundles/js/diff2html-ui.min.js></script><script src=https://unknownue.github.io/js/syntax-highlight.js></script><script src=https://unknownue.github.io/js/diff-sidebar.js></script><script src="https://unknownue.github.io/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><div class=content><header><div class=main><a href=https://unknownue.github.io>Unknownue's Blog</a><div class=socials><a class=social href=https://github.com/unknownue rel=me> <img alt=github src=https://unknownue.github.io/icons/social/github.svg> </a><a class=social href=https://github.com/unknownue/unknownue.github.io rel=me> <img alt=github-io src=https://unknownue.github.io/icons/social/rss.svg> </a></div></div><nav><a href=https://unknownue.github.io/posts style=margin-left:.25em>/posts</a><a href=https://unknownue.github.io/projects style=margin-left:.25em>/projects</a><a href=https://unknownue.github.io/about style=margin-left:.25em>/about</a><a href=https://unknownue.github.io/tags style=margin-left:.25em>/tags</a><button title="$SHORTCUT to open search" class=search-button id=search-button><img alt=Search class=search-icon src=https://unknownue.github.io/icons/search.svg></button><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><div id=modal-content><h1 class=page-header id=modalTitle>Search</h1><div id=searchBar><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search... role=combobox spellcheck=false><button title="Clear search" class=clear-button id=clear-search><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></button></div><div id=results-container><div id=results-info><span id=zero_results style=display:none>No results</span><span id=one_result style=display:none>1 result</span><span id=many_results style=display:none>$NUMBER results</span></div><div id=results role=listbox></div></div></div></div><a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://unknownue.github.io/icons/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://unknownue.github.io/icons/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><div class=pull-request-page><article class=md-content-page style=display:none></article><div class=back-link><a href=/pull_request/bevy/2025-12/>← Back to Pull Requests</a></div><div class=pr-metadata><span class=pr-date>2025-12-10</span><div class=language-switcher><a class=lang-link data-lang=en href=/pull_request/bevy/2025-12/pr-21746-en-20251210>English</a> / <span class="lang-link active" data-lang=zh-cn>中文</span></div></div><div class=pr-content><h1 id=title>Title</h1><h2 id=basic-information>Basic Information</h2><ul><li><strong>Title</strong>: Upgrade to wgpu 27 and associated crates<li><strong>PR Link</strong>: https://github.com/bevyengine/bevy/pull/21746<li><strong>Author</strong>: JMS55<li><strong>Status</strong>: MERGED<li><strong>Labels</strong>: A-Rendering, C-Dependencies, S-Ready-For-Final-Review, X-Contentious<li><strong>Created</strong>: 2025-11-05T02:01:39Z<li><strong>Merged</strong>: 2025-12-10T07:51:33Z<li><strong>Merged By</strong>: mockersf</ul><h2 id=description-translation>Description Translation</h2><p>替代了之前的 PR https://github.com/bevyengine/bevy/pull/21725。<h2 id=the-story-of-this-pull-request>The Story of This Pull Request</h2><p>这次 PR 的核心任务是升级 Bevy 渲染引擎的基础依赖，从 wgpu 26 版本迁移到 27 版本。wgpu 是 WebGPU API 的 Rust 实现，为 Bevy 提供了跨平台的底层图形抽象。此类升级通常是为了获取新的 GPU 功能、性能改进、错误修复和 API 更新，但同时也需要代码库进行相应的适配。<p><strong>问题与背景</strong> Bevy 团队需要保持其依赖的 wgpu 生态系统处于最新状态。wgpu 27 版本带来了 API 的变更、新特性的引入以及一些原有特性的移除或重命名。如果不进行升级，Bevy 将无法利用最新的图形硬件功能，并且可能随着时间的推移，与上游库的兼容性会逐渐变差。升级的挑战在于需要系统地更新所有相关的依赖项，并仔细调整代码以适配 API 的变更，确保渲染管线的所有功能在升级后依然正常工作。<p><strong>解决方案与实现</strong> 开发者采用了直接升级依赖版本并修改适配代码的策略。这项工作涉及面较广，修改了 17 个 crate 的 <code>Cargo.toml</code> 文件，并调整了多个核心渲染模块的源代码。<p>主要的依赖版本变更如下：<ul><li><code>wgpu</code>、<code>naga</code>、<code>wgpu-types</code> 从 <code>26</code> 升级到 <code>27</code>。<li><code>naga_oil</code> 从 <code>0.19</code> 升级到 <code>0.20</code>。<li><code>dlss_wgpu</code> 从 <code>1</code> 升级到 <code>2</code>。</ul><p>这些版本升级是基础，但更重要的是随之而来的代码适配。例如，在 <code>renderer/mod.rs</code> 中，初始化 <code>wgpu::Device</code> 的配置发生了变化。在 wgpu 27 中，<code>DeviceDescriptor</code> 新增了一个 <code>experimental_features</code> 字段，PR 中通过一个 unsafe 调用 <code>wgpu::ExperimentalFeatures::enabled()</code> 来启用所有实验性特性，并添加了相关安全说明的 TODO 注释。<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// crates/bevy_render/src/renderer/mod.rs
</span><span style=color:#abb0b6;font-style:italic>// 在创建 DeviceDescriptor 时
</span><span>required_limits</span><span style=color:#61676ccc>:</span><span> limits</span><span style=color:#61676ccc>,
</span><span style=color:#abb0b6;font-style:italic>// SAFETY: TODO, see https://github.com/bevyengine/bevy/issues/22082
</span><span>experimental_features</span><span style=color:#61676ccc>: </span><span style=color:#fa6e32>unsafe </span><span>{ wgpu</span><span style=color:#ed9366>::</span><span>ExperimentalFeatures</span><span style=color:#ed9366>::</span><span>enabled() }</span><span style=color:#61676ccc>,
</span><span>memory_hints</span><span style=color:#61676ccc>:</span><span> options</span><span style=color:#ed9366>.</span><span>memory_hints</span><span style=color:#ed9366>.</span><span style=color:#f07171>clone</span><span>()</span><span style=color:#61676ccc>,
</span></code></pre><p>同时，为了支持新的图形特性（如网格着色器），代码中也添加了对更多 <code>Limits</code> 字段（例如 <code>max_task_workgroup_total_count</code>、<code>max_mesh_output_layers</code>）的适配。<p>另一个显著的 API 变更体现在着色器模块的创建上。在 <code>render_device.rs</code> 中，用于 SPIR-V 直通（passthrough）的特性名称从 <code>Features::SPIRV_SHADER_PASSTHROUGH</code> 变更为 <code>Features::EXPERIMENTAL_PASSTHROUGH_SHADERS</code>，并且创建着色器模块的调用方式也发生了变化。<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// crates/bevy_render/src/renderer/render_device.rs
</span><span style=color:#abb0b6;font-style:italic>// Before:
</span><span style=color:#fa6e32>unsafe </span><span>{
</span><span>    </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>device</span><span style=color:#ed9366>.</span><span style=color:#f07171>create_shader_module_passthrough</span><span>(
</span><span>        wgpu</span><span style=color:#ed9366>::</span><span>ShaderModuleDescriptorPassthrough</span><span style=color:#ed9366>::</span><span>SpirV(
</span><span>            wgpu</span><span style=color:#ed9366>::</span><span>ShaderModuleDescriptorSpirV {
</span><span>                label</span><span style=color:#61676ccc>:</span><span> desc</span><span style=color:#ed9366>.</span><span>label</span><span style=color:#61676ccc>,
</span><span>                source</span><span style=color:#61676ccc>:</span><span> source</span><span style=color:#ed9366>.</span><span style=color:#f07171>clone</span><span>()</span><span style=color:#61676ccc>,
</span><span>            }</span><span style=color:#61676ccc>,
</span><span>        )</span><span style=color:#61676ccc>,
</span><span>    )
</span><span>}
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After:
</span><span style=color:#fa6e32>unsafe </span><span>{
</span><span>    </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>device</span><span style=color:#ed9366>.</span><span style=color:#f07171>create_shader_module_passthrough</span><span>(
</span><span>        wgpu</span><span style=color:#ed9366>::</span><span>ShaderModuleDescriptorPassthrough {
</span><span>            label</span><span style=color:#61676ccc>:</span><span> desc</span><span style=color:#ed9366>.</span><span>label</span><span style=color:#61676ccc>,
</span><span>            spirv</span><span style=color:#61676ccc>: </span><span style=color:#55b4d4;font-style:italic>Some</span><span>(source</span><span style=color:#ed9366>.</span><span style=color:#f07171>clone</span><span>())</span><span style=color:#61676ccc>,
</span><span>            </span><span style=color:#ed9366>..</span><span style=color:#55b4d4;font-style:italic>Default</span><span style=color:#ed9366>::</span><span>default()
</span><span>        }</span><span style=color:#61676ccc>,
</span><span>    )
</span><span>}
</span></code></pre><p>这种从枚举变更为结构体并设置字段的模式，提供了更好的扩展性。<p>在 <code>uniform_buffer.rs</code> 中，<code>DynamicUniformBufferWriter</code> 的类型定义发生了改变，移除了其生命周期的参数。这是因为底层的 <code>wgpu::QueueWriteBufferView</code> 类型可能内部已经处理了生命周期，使得 <code>BufferMut</code> trait 的实现不再需要外部生命周期标注，从而简化了 API。<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// crates/bevy_render/src/render_resource/uniform_buffer.rs
</span><span style=color:#abb0b6;font-style:italic>// Before:
</span><span style=color:#fa6e32>pub struct </span><span style=color:#399ee6>DynamicUniformBufferWriter</span><span><</span><span style=color:#fa6e32>'a</span><span>, T> {
</span><span>    buffer</span><span style=color:#61676ccc>: </span><span>encase</span><span style=color:#ed9366>::</span><span>DynamicUniformBuffer&LTQueueWriteBufferViewWrapper<</span><span style=color:#fa6e32>'a</span><span>>>,
</span><span>    _marker</span><span style=color:#61676ccc>: </span><span>PhantomData<</span><span style=color:#fa6e32>fn</span><span>() </span><span style=color:#61676ccc>-></span><span> T>,
</span><span>}
</span><span style=color:#abb0b6;font-style:italic>// After:
</span><span style=color:#fa6e32>pub struct </span><span style=color:#399ee6>DynamicUniformBufferWriter</span><span>&LTT> {
</span><span>    buffer</span><span style=color:#61676ccc>: </span><span>encase</span><span style=color:#ed9366>::</span><span>DynamicUniformBuffer&LTQueueWriteBufferViewWrapper>,
</span><span>    _marker</span><span style=color:#61676ccc>: </span><span>PhantomData<</span><span style=color:#fa6e32>fn</span><span>() </span><span style=color:#61676ccc>-></span><span> T>,
</span><span>}
</span></code></pre><p>此外，PR 中还移除了一些对过时特性的检查（例如在 <code>gpu_preprocessing.rs</code> 中移除了对 <code>Features::MULTI_DRAW_INDIRECT</code> 的检查），并更新了调用 <code>device.poll</code> 的方法以匹配新的 API（使用 <code>PollType::wait_indefinitely()</code> 方法）。<p><strong>技术洞察与影响</strong> 这次升级是一次典型的依赖管理任务。它要求开发者对 wgpu 的更新日志有深入理解，并能够精确地定位和修改受影响的代码。升级带来了对最新图形 API 特性的潜在支持（例如通过启用实验性特性），但也引入了一些待解决的问题（如上面提到的安全 TODO）。<code>experimental_features</code> 的 unsafe 使用表明，开发团队正在积极地探索 wgpu 的前沿功能，但这部分代码的长期稳定性需要关注。<p>从工程角度看，这次 PR 展示了如何管理一个大型项目中深度依赖的底层库的升级。它不仅仅是一个版本号的修改，而是涉及到多个模块的协同变更。PR 成功地保持了 Bevy 渲染后端的现代性，为后续利用 WebGPU 新特性铺平了道路，同时也为社区进行类似的依赖升级提供了参考范例。<h2 id=visual-representation>Visual Representation</h2><pre class=language-mermaid data-lang=mermaid style=color:#61676c;background-color:#fafafa><code class=language-mermaid data-lang=mermaid><span>graph TD
</span><span>    A[bevy_render] --> B[wgpu 27]
</span><span>    A --> C[naga 27]
</span><span>    A --> D[wgpu-types 27]
</span><span>    
</span><span>    E[bevy_shader] --> D
</span><span>    E --> C
</span><span>    E --> F[naga_oil 0.20]
</span><span>    
</span><span>    G[bevy_anti_alias] --> H[dlss_wgpu 2]
</span><span>    
</span><span>    I[Other Crates&LTbr/>bevy_color, bevy_mesh, etc.] --> D
</span></code></pre><p>上图展示了本次升级中核心的依赖关系变更。<code>bevy_render</code> 作为渲染核心，其依赖的 <code>wgpu</code>、<code>naga</code> 和 <code>wgpu-types</code> 全部升级到 27 版本。<code>bevy_shader</code> 也相应更新了其 <code>naga</code> 和 <code>naga_oil</code> 的依赖。<code>bevy_anti_alias</code> 升级了 <code>dlss_wgpu</code>。此外，多个其他直接或间接使用 <code>wgpu-types</code> 的 crate 也同步更新了版本号以保持一致性。<h2 id=key-files-changed>Key Files Changed</h2><h3 id=1-crates-bevy-render-cargo-toml>1. <code>crates/bevy_render/Cargo.toml</code></h3><p><strong>变更描述</strong>：更新了核心渲染依赖 <code>wgpu</code> 和 <code>naga</code> 的主版本号。<pre class=language-toml data-lang=toml style=color:#61676c;background-color:#fafafa><code class=language-toml data-lang=toml><span style=color:#abb0b6;font-style:italic># 变更前:
</span><span style=color:#399ee6>wgpu </span><span>= { </span><span style=color:#399ee6>version </span><span>= </span><span style=color:#86b300>"26"</span><span style=color:#61676ccc>, </span><span style=color:#f51818>... }
</span><span style=color:#399ee6>naga </span><span>= { </span><span style=color:#399ee6>version </span><span>= </span><span style=color:#86b300>"26"</span><span style=color:#61676ccc>, </span><span style=color:#f51818>... }
</span><span>
</span><span style=color:#abb0b6;font-style:italic># 变更后:
</span><span style=color:#399ee6>wgpu </span><span>= { </span><span style=color:#399ee6>version </span><span>= </span><span style=color:#86b300>"27"</span><span style=color:#61676ccc>, </span><span style=color:#f51818>... }
</span><span style=color:#399ee6>naga </span><span>= { </span><span style=color:#399ee6>version </span><span>= </span><span style=color:#86b300>"27"</span><span style=color:#61676ccc>, </span><span style=color:#f51818>... }
</span></code></pre><p><strong>关联性</strong>：这是升级的基础，所有后续的代码适配都源于此版本变更。<h3 id=2-crates-bevy-render-src-renderer-mod-rs>2. <code>crates/bevy_render/src/renderer/mod.rs</code></h3><p><strong>变更描述</strong>：适配了 wgpu 27 中 <code>DeviceDescriptor</code> 的新字段，并添加了对新 Limits 字段的支持。<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// 新增了 experimental_features 字段
</span><span>experimental_features</span><span style=color:#61676ccc>: </span><span style=color:#fa6e32>unsafe </span><span>{ wgpu</span><span style=color:#ed9366>::</span><span>ExperimentalFeatures</span><span style=color:#ed9366>::</span><span>enabled() }</span><span style=color:#61676ccc>,
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// 新增了对多个新 Limits 字段的处理，例如：
</span><span>max_task_workgroup_total_count</span><span style=color:#61676ccc>:</span><span> limits
</span><span>    </span><span style=color:#ed9366>.</span><span>max_task_workgroup_total_count
</span><span>    </span><span style=color:#ed9366>.</span><span style=color:#f07171>min</span><span>(constrained_limits</span><span style=color:#ed9366>.</span><span>max_task_workgroup_total_count)</span><span style=color:#61676ccc>,
</span><span style=color:#abb0b6;font-style:italic>// ... 其他类似字段
</span></code></pre><p><strong>关联性</strong>：确保 Bevy 在初始化渲染设备时能够正确配置新版本的 wgpu，并启用可能需要的实验性功能。<h3 id=3-crates-bevy-render-src-renderer-render-device-rs>3. <code>crates/bevy_render/src/renderer/render_device.rs</code></h3><p><strong>变更描述</strong>：更新了 SPIR-V 直通着色器特性的名称和创建着色器模块的 API 调用方式。<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// 特性名称变更
</span><span style=color:#abb0b6;font-style:italic>// Before: wgpu::Features::SPIRV_SHADER_PASSTHROUGH
</span><span style=color:#abb0b6;font-style:italic>// After:  wgpu::Features::EXPERIMENTAL_PASSTHROUGH_SHADERS
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// API 调用方式变更（代码见上文“解决方案与实现”部分）
</span></code></pre><p><strong>关联性</strong>：反映了 wgpu API 的演变，确保使用 SPIR-V 着色器的路径在新版本下依然有效。<h3 id=4-crates-bevy-render-src-batching-gpu-preprocessing-rs>4. <code>crates/bevy_render/src/batching/gpu_preprocessing.rs</code></h3><p><strong>变更描述</strong>：简化了 GPU 预处理特性检查逻辑，移除了对 <code>MULTI_DRAW_INDIRECT</code> 特性的检查。<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// 变更前:
</span><span style=color:#fa6e32>let</span><span> culling_feature_support </span><span style=color:#ed9366>=</span><span> device</span><span style=color:#ed9366>.</span><span style=color:#f07171>features</span><span>()</span><span style=color:#ed9366>.</span><span style=color:#f07171>contains</span><span>(
</span><span>    Features</span><span style=color:#ed9366>::</span><span style=color:#ff8f40>INDIRECT_FIRST_INSTANCE
</span><span>        </span><span style=color:#ed9366>| </span><span>Features</span><span style=color:#ed9366>::</span><span style=color:#ff8f40>MULTI_DRAW_INDIRECT
</span><span>        </span><span style=color:#ed9366>| </span><span>Features</span><span style=color:#ed9366>::</span><span style=color:#ff8f40>PUSH_CONSTANTS</span><span style=color:#61676ccc>,
</span><span>)</span><span style=color:#61676ccc>;
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// 变更后:
</span><span style=color:#fa6e32>let</span><span> culling_feature_support </span><span style=color:#ed9366>=</span><span> device
</span><span>    </span><span style=color:#ed9366>.</span><span style=color:#f07171>features</span><span>()
</span><span>    </span><span style=color:#ed9366>.</span><span style=color:#f07171>contains</span><span>(Features</span><span style=color:#ed9366>::</span><span style=color:#ff8f40>INDIRECT_FIRST_INSTANCE </span><span style=color:#ed9366>| </span><span>Features</span><span style=color:#ed9366>::</span><span style=color:#ff8f40>PUSH_CONSTANTS</span><span>)</span><span style=color:#61676ccc>;
</span></code></pre><p><strong>关联性</strong>：可能表明 <code>MULTI_DRAW_INDIRECT</code> 特性在 wgpu 27 中已成为默认支持或不再需要显式检查，从而简化了条件判断逻辑。<h3 id=5-crates-bevy-render-src-render-resource-uniform-buffer-rs>5. <code>crates/bevy_render/src/render_resource/uniform_buffer.rs</code></h3><p><strong>变更描述</strong>：移除了 <code>DynamicUniformBufferWriter</code> 结构体的生命周期参数，简化了类型签名。<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// 变更前后类型定义对比（代码见上文“解决方案与实现”部分）
</span></code></pre><p><strong>关联性</strong>：利用 wgpu 27 中 <code>QueueWriteBufferView</code> 的改进，提供了更简洁的缓冲区写入接口。<h2 id=further-reading>Further Reading</h2><ul><li><strong>wgpu 发布说明</strong>: 了解 wgpu 26 到 27 版本的具体变更、新特性和 API 差异。<li><strong>WebGPU Specification</strong>: 深入理解 wgpu 所实现的底层 WebGPU 标准。<li><strong>Bevy 渲染架构文档</strong>: 学习 Bevy 如何在其 ECS 架构之上构建渲染系统，以及 wgpu 在其中扮演的角色。</ul></div><div data-is-md-page=true data-patch-exists=true data-patch-path=/pull_request/bevy/2025-12/pr_21746.patch id=patch-info style=display:none></div><div class=bottom-spacer></div></div></div>