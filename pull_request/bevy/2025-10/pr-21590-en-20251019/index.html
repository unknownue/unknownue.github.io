<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://unknownue.github.io name=base><title>
         #21590 Rewrite the reason for the `clippy::doc_markdown` expectation in the `bevy` main crate to be more accurate
        
    </title><meta content="#21590 Rewrite the reason for the `clippy::doc_markdown` expectation in the `bevy` main crate to be more accurate" property=og:title><meta content="A personal blog built with Zola and Apollo theme" property=og:description><meta content="A personal blog built with Zola and Apollo theme" name=description><link href=/icons/favicon.png rel=icon type=image/png><link href=https://unknownue.github.io/fonts.css rel=stylesheet><script src=https://unknownue.github.io/js/codeblock.js></script><script src=https://unknownue.github.io/js/toc.js></script><script src=https://unknownue.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Unknownue's Blog" href=https://unknownue.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://unknownue.github.io/theme/light.css rel=stylesheet><link href=https://unknownue.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://unknownue.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://unknownue.github.io/main.css media=screen rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js></script><script>// Initialize mermaid once DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            mermaid.initialize({
                startOnLoad: false,
                theme: document.body && document.body.classList.contains('dark') ? 'dark' : 'default',
                securityLevel: 'loose',
                flowchart: {
                    useMaxWidth: true,
                    htmlLabels: true
                },
                sequence: {
                    diagramMarginX: 50,
                    diagramMarginY: 10,
                    actorMargin: 50,
                    width: 150,
                    height: 65
                }
            });
        });</script><script src=https://unknownue.github.io/js/main.js></script><script defer src=https://unknownue.github.io/js/label-colors.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/rust.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/typescript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/go.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/cpp.min.js></script><script>// Ensure highlight.js is properly configured
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof hljs !== 'undefined') {
                hljs.configure({
                    languages: ['rust', 'javascript', 'python', 'cpp', 'go', 'typescript'],
                    ignoreUnescapedHTML: true
                });
                console.log('Highlight.js configured in header');
            }
        });</script><link href=https://cdn.jsdelivr.net/npm/diff2html/bundles/css/diff2html.min.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/diff2html/bundles/js/diff2html-ui.min.js></script><script src=https://unknownue.github.io/js/syntax-highlight.js></script><script src=https://unknownue.github.io/js/diff-sidebar.js></script><script src="https://unknownue.github.io/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><div class=content><header><div class=main><a href=https://unknownue.github.io>Unknownue's Blog</a><div class=socials><a class=social href=https://github.com/unknownue rel=me> <img alt=github src=https://unknownue.github.io/icons/social/github.svg> </a><a class=social href=https://github.com/unknownue/unknownue.github.io rel=me> <img alt=github-io src=https://unknownue.github.io/icons/social/rss.svg> </a></div></div><nav><a href=https://unknownue.github.io/posts style=margin-left:.25em>/posts</a><a href=https://unknownue.github.io/projects style=margin-left:.25em>/projects</a><a href=https://unknownue.github.io/about style=margin-left:.25em>/about</a><a href=https://unknownue.github.io/tags style=margin-left:.25em>/tags</a><button title="$SHORTCUT to open search" class=search-button id=search-button><img alt=Search class=search-icon src=https://unknownue.github.io/icons/search.svg></button><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><div id=modal-content><h1 class=page-header id=modalTitle>Search</h1><div id=searchBar><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search... role=combobox spellcheck=false><button title="Clear search" class=clear-button id=clear-search><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></button></div><div id=results-container><div id=results-info><span id=zero_results style=display:none>No results</span><span id=one_result style=display:none>1 result</span><span id=many_results style=display:none>$NUMBER results</span></div><div id=results role=listbox></div></div></div></div><a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://unknownue.github.io/icons/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://unknownue.github.io/icons/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><div class=pull-request-page><article class=md-content-page style=display:none></article><div class=back-link><a href=/pull_request/bevy/2025-10/>← Back to Pull Requests</a></div><div class=pr-metadata><span class=pr-date>2025-10-19</span><div class=language-switcher><span class="lang-link active" data-lang=en>English</span> / <a class=lang-link data-lang=zh-cn href=/pull_request/bevy/2025-10/pr-21590-zh-cn-20251019>中文</a></div></div><div class=pr-content><h1 id=title>Title</h1><h2 id=basic-information>Basic Information</h2><ul><li><strong>Title</strong>: Rewrite the reason for the <code>clippy::doc_markdown</code> expectation in the <code>bevy</code> main crate to be more accurate<li><strong>PR Link</strong>: https://github.com/bevyengine/bevy/pull/21590<li><strong>Author</strong>: LikeLakers2<li><strong>Status</strong>: MERGED<li><strong>Labels</strong>: A-Build-System, C-Code-Quality, S-Ready-For-Final-Review<li><strong>Created</strong>: 2025-10-18T15:45:07Z<li><strong>Merged</strong>: 2025-10-19T19:13:55Z<li><strong>Merged By</strong>: alice-i-cecile</ul><h2 id=description-translation>Description Translation</h2><h1 id=objective>Objective</h1><p>The <code>bevy</code> main crate’s <code>lib.rs</code> file contains an expectation for the <code>clippy::doc_markdown</code> lint. However, it only references one of the many times that <code>clippy::doc_markdown</code> lints on that file. Many of the other <code>clippy::doc_markdown</code> instances are within the cargo features list.<h2 id=solution>Solution</h2><p>Rewrite the reason for this expectation to be more clear. Additionally, mark <code>GameActivity</code> as an allowed doc ident for Clippy.<h2 id=testing>Testing</h2><p><code>cargo clippy</code> returned no errors.<h2 id=the-story-of-this-pull-request>The Story of This Pull Request</h2><p>This PR addresses a documentation quality issue in the Bevy engine’s main crate. The problem was centered around the <code>clippy::doc_markdown</code> lint, which flags un-backticked identifiers in documentation comments. The existing expectation in <code>src/lib.rs</code> had a misleading reason that only covered a specific case while ignoring the broader context where this lint was triggered.<p>The original expectation comment specifically mentioned “Android GameActivity does not need to be code-formatted,” but this was inaccurate because the lint was actually being triggered in multiple places throughout the file, particularly within the cargo features list where various feature names and platform identifiers appear. This narrow justification didn’t reflect the actual scope of why the lint expectation was needed.<p>The solution involved two key changes. First, the expectation reason was updated to accurately describe that the lint was being suppressed because Clippy was flagging identifiers within the cargo features list, where backticks aren’t appropriate. Second, <code>GameActivity</code> was added to the list of allowed documentation identifiers in <code>clippy.toml</code>, which tells Clippy that this specific identifier should not trigger the <code>doc_markdown</code> lint.<p>The technical approach here demonstrates good practice in managing Clippy configurations. By updating the <code>doc-valid-idents</code> list in <code>clippy.toml</code>, the team is explicitly telling the linter which identifiers are valid and shouldn’t require backticks in documentation. This is more maintainable than having scattered <code>allow</code> attributes throughout the codebase.<p>The implementation also shows attention to detail in code quality tooling. The PR author removed several identifiers (<code>macOS</code>, <code>sRGB</code>, <code>WebGL2</code>, <code>WebGPU</code>) from the allowed list, suggesting these were either no longer used in documentation or should properly be formatted with backticks. This cleanup indicates a thoughtful review of which identifiers truly need special treatment versus which should follow standard documentation formatting rules.<p>The testing approach was straightforward and effective - running <code>cargo clippy</code> to verify that the changes resolved the lint issues without introducing new warnings. This demonstrates the practical nature of the fix: it’s a configuration adjustment that directly addresses tooling behavior without affecting runtime functionality.<h2 id=visual-representation>Visual Representation</h2><pre class=language-mermaid data-lang=mermaid style=color:#61676c;background-color:#fafafa><code class=language-mermaid data-lang=mermaid><span>graph TD
</span><span>    A[clippy::doc_markdown lint] --> B{Where is lint triggered?}
</span><span>    B --> C[Cargo features list]
</span><span>    B --> D[Android GameActivity reference]
</span><span>    C --> E[Update expectation reason]
</span><span>    D --> F[Add GameActivity to allowed idents]
</span><span>    E --> G[Clean up unused allowed idents]
</span><span>    F --> G
</span><span>    G --> H[Verify with cargo clippy]
</span></code></pre><h2 id=key-files-changed>Key Files Changed</h2><h3 id=src-lib-rs-1-1><code>src/lib.rs</code> (+1/-1)</h3><p>This file contains the main crate documentation and feature definitions. The change updates the reason for expecting the <code>clippy::doc_markdown</code> lint to be more accurate.<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// File: src/lib.rs
</span><span style=color:#abb0b6;font-style:italic>// Before:
</span><span style=color:#61676ccc>#!</span><span>[</span><span style=color:#f29718>expect</span><span>(
</span><span>    clippy::doc_markdown</span><span style=color:#61676ccc>,
</span><span>    reason </span><span style=color:#ed9366>= </span><span style=color:#86b300>"Android GameActivity does not need to be code-formatted."
</span><span>)]
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After:
</span><span style=color:#61676ccc>#!</span><span>[</span><span style=color:#f29718>expect</span><span>(
</span><span>    clippy::doc_markdown</span><span style=color:#61676ccc>,
</span><span>    reason </span><span style=color:#ed9366>= </span><span style=color:#86b300>"Clippy lints for un-backticked identifiers within the cargo features list, which we don't want."
</span><span>)]
</span></code></pre><h3 id=clippy-toml-1-4><code>clippy.toml</code> (+1/-4)</h3><p>This configuration file controls Clippy’s behavior. The changes update the list of valid documentation identifiers that shouldn’t trigger the <code>doc_markdown</code> lint.<pre class=language-toml data-lang=toml style=color:#61676c;background-color:#fafafa><code class=language-toml data-lang=toml><span style=color:#f51818>// File: clippy.toml
</span><span style=color:#f51818>// Before:
</span><span style=color:#399ee6>doc-valid-idents </span><span>= [
</span><span>  </span><span style=color:#86b300>"GilRs"</span><span style=color:#61676ccc>,
</span><span>  </span><span style=color:#86b300>"glTF"</span><span style=color:#61676ccc>,
</span><span>  </span><span style=color:#86b300>"macOS"</span><span style=color:#61676ccc>,
</span><span>  </span><span style=color:#86b300>"NVidia"</span><span style=color:#61676ccc>,
</span><span>  </span><span style=color:#86b300>"OpenXR"</span><span style=color:#61676ccc>,
</span><span>  </span><span style=color:#86b300>"sRGB"</span><span style=color:#61676ccc>,
</span><span>  </span><span style=color:#86b300>"VSync"</span><span style=color:#61676ccc>,
</span><span>  </span><span style=color:#86b300>"WebGL2"</span><span style=color:#61676ccc>,
</span><span>  </span><span style=color:#86b300>"WebGPU"</span><span style=color:#61676ccc>,
</span><span>  </span><span style=color:#86b300>".."</span><span style=color:#61676ccc>,
</span><span>]
</span><span>
</span><span style=color:#f51818>// After:
</span><span style=color:#399ee6>doc-valid-idents </span><span>= [
</span><span>  </span><span style=color:#86b300>"GameActivity"</span><span style=color:#61676ccc>,
</span><span>  </span><span style=color:#86b300>"GilRs"</span><span style=color:#61676ccc>,
</span><span>  </span><span style=color:#86b300>"glTF"</span><span style=color:#61676ccc>,
</span><span>  </span><span style=color:#86b300>"NVidia"</span><span style=color:#61676ccc>,
</span><span>  </span><span style=color:#86b300>"OpenXR"</span><span style=color:#61676ccc>,
</span><span>  </span><span style=color:#86b300>"VSync"</span><span style=color:#61676ccc>,
</span><span>  </span><span style=color:#86b300>".."</span><span style=color:#61676ccc>,
</span><span>]
</span></code></pre><h2 id=further-reading>Further Reading</h2><ul><li><a rel="noopener nofollow noreferrer" href=https://rust-lang.github.io/rust-clippy/master/index.html#doc_markdown target=_blank>Clippy Documentation Lints</a> - Official documentation for Clippy’s documentation-related lints<li><a rel="noopener nofollow noreferrer" href=https://doc.rust-lang.org/rustdoc/how-to-write-documentation.html target=_blank>Rust Documentation Comments</a> - Guide to writing effective documentation in Rust<li><a rel="noopener nofollow noreferrer" href=https://doc.rust-lang.org/cargo/reference/features.html target=_blank>Cargo Features Documentation</a> - Understanding cargo features and how to document them<li><a rel="noopener nofollow noreferrer" href=https://github.com/bevyengine/bevy/blob/main/CONTRIBUTING.md#documentation-standards target=_blank>Bevy Engine Documentation Standards</a> - Bevy’s contribution guidelines for documentation</ul></div><div data-is-md-page=true data-patch-exists=true data-patch-path=/pull_request/bevy/2025-10/pr_21590.patch id=patch-info style=display:none></div><div class=bottom-spacer></div></div></div>