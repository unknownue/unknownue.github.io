<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://unknownue.github.io name=base><title>
         #21593 Rename `AnimationEventTrigger::animation_player` to `target` and fix misleading docs surrounding it
        
    </title><meta content="#21593 Rename `AnimationEventTrigger::animation_player` to `target` and fix misleading docs surrounding it" property=og:title><meta content="A personal blog built with Zola and Apollo theme" property=og:description><meta content="A personal blog built with Zola and Apollo theme" name=description><link href=/icons/favicon.png rel=icon type=image/png><link href=https://unknownue.github.io/fonts.css rel=stylesheet><script src=https://unknownue.github.io/js/codeblock.js></script><script src=https://unknownue.github.io/js/toc.js></script><script src=https://unknownue.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Unknownue's Blog" href=https://unknownue.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://unknownue.github.io/theme/light.css rel=stylesheet><link href=https://unknownue.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://unknownue.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://unknownue.github.io/main.css media=screen rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js></script><script>// Initialize mermaid once DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            mermaid.initialize({
                startOnLoad: false,
                theme: document.body && document.body.classList.contains('dark') ? 'dark' : 'default',
                securityLevel: 'loose',
                flowchart: {
                    useMaxWidth: true,
                    htmlLabels: true
                },
                sequence: {
                    diagramMarginX: 50,
                    diagramMarginY: 10,
                    actorMargin: 50,
                    width: 150,
                    height: 65
                }
            });
        });</script><script src=https://unknownue.github.io/js/main.js></script><script defer src=https://unknownue.github.io/js/label-colors.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/rust.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/typescript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/go.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/cpp.min.js></script><script>// Ensure highlight.js is properly configured
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof hljs !== 'undefined') {
                hljs.configure({
                    languages: ['rust', 'javascript', 'python', 'cpp', 'go', 'typescript'],
                    ignoreUnescapedHTML: true
                });
                console.log('Highlight.js configured in header');
            }
        });</script><link href=https://cdn.jsdelivr.net/npm/diff2html/bundles/css/diff2html.min.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/diff2html/bundles/js/diff2html-ui.min.js></script><script src=https://unknownue.github.io/js/syntax-highlight.js></script><script src=https://unknownue.github.io/js/diff-sidebar.js></script><script src="https://unknownue.github.io/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><div class=content><header><div class=main><a href=https://unknownue.github.io>Unknownue's Blog</a><div class=socials><a class=social href=https://github.com/unknownue rel=me> <img alt=github src=https://unknownue.github.io/icons/social/github.svg> </a><a class=social href=https://github.com/unknownue/unknownue.github.io rel=me> <img alt=github-io src=https://unknownue.github.io/icons/social/rss.svg> </a></div></div><nav><a href=https://unknownue.github.io/posts style=margin-left:.25em>/posts</a><a href=https://unknownue.github.io/projects style=margin-left:.25em>/projects</a><a href=https://unknownue.github.io/about style=margin-left:.25em>/about</a><a href=https://unknownue.github.io/tags style=margin-left:.25em>/tags</a><button title="$SHORTCUT to open search" class=search-button id=search-button><img alt=Search class=search-icon src=https://unknownue.github.io/icons/search.svg></button><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><div id=modal-content><h1 class=page-header id=modalTitle>Search</h1><div id=searchBar><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search... role=combobox spellcheck=false><button title="Clear search" class=clear-button id=clear-search><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></button></div><div id=results-container><div id=results-info><span id=zero_results style=display:none>No results</span><span id=one_result style=display:none>1 result</span><span id=many_results style=display:none>$NUMBER results</span></div><div id=results role=listbox></div></div></div></div><a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://unknownue.github.io/icons/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://unknownue.github.io/icons/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><div class=pull-request-page><article class=md-content-page style=display:none></article><div class=back-link><a href=/pull_request/bevy/2025-10/>← Back to Pull Requests</a></div><div class=pr-metadata><span class=pr-date>2025-10-19</span><div class=language-switcher><span class="lang-link active" data-lang=en>English</span> / <a class=lang-link data-lang=zh-cn href=/pull_request/bevy/2025-10/pr-21593-zh-cn-20251019>中文</a></div></div><div class=pr-content><h1 id=title>Title</h1><h2 id=basic-information>Basic Information</h2><ul><li><strong>Title</strong>: Rename <code>AnimationEventTrigger::animation_player</code> to <code>target</code> and fix misleading docs surrounding it<li><strong>PR Link</strong>: https://github.com/bevyengine/bevy/pull/21593<li><strong>Author</strong>: janhohenheim<li><strong>Status</strong>: MERGED<li><strong>Labels</strong>: C-Docs, S-Ready-For-Final-Review, A-Animation, M-Needs-Migration-Guide, D-Straightforward<li><strong>Created</strong>: 2025-10-18T18:30:10Z<li><strong>Merged</strong>: 2025-10-19T20:05:44Z<li><strong>Merged By</strong>: alice-i-cecile</ul><h2 id=description-translation>Description Translation</h2><h1 id=objective>Objective</h1><ul><li>The current name and docs tell you this is the animation player entity. But it’s not necessarily! When adding an event via <code>AnimationClip::add_event_to_target</code>, that entity actually points to the <code>AnimationTargetId</code>, not the animation player! <ul><li>This just caused some major confusion for me while debugging a system that was supposed to play a sound effect from a specific bone (namely a footstep from the foot).</ul></ul><h2 id=solution>Solution</h2><ul><li>Rename the field to <code>target</code><li>Change the docs to mention the nuance</ul><h2 id=testing>Testing</h2><ul><li>Verified behavior in a test scene</ul><h2 id=the-story-of-this-pull-request>The Story of This Pull Request</h2><p>This PR addresses a documentation and naming issue that caused real confusion during development. The author encountered a problem while debugging a footstep sound system where they expected an animation event to reference the animation player entity, but instead found it was referencing a different entity entirely.<p>The core issue was in the <code>AnimationEventTrigger</code> struct, which had a field named <code>animation_player</code> that suggested it always contained the animation player entity. However, this wasn’t accurate - when events were added using <code>AnimationClip::add_event_to_target</code>, the entity actually referred to the <code>AnimationTargetId</code> (like a specific bone), not the animation player itself.<p>The solution was straightforward but important for API clarity:<ol><li>Rename the field from <code>animation_player</code> to <code>target</code> to reflect its actual, more general purpose<li>Update documentation to clearly explain when the entity refers to the animation player versus when it refers to the animation target</ol><p>In the implementation, the changes were minimal but impactful. The field rename propagated through multiple files, and the documentation updates provided crucial context for developers. The example code was also updated to use the new field name, ensuring consistency across the codebase.<p>The migration guide was particularly thoughtful - it explicitly calls out the behavioral difference between <code>AnimationClip::add_event</code> and <code>AnimationClip::add_event_to_target</code>, which was the root cause of the original confusion.<h2 id=visual-representation>Visual Representation</h2><pre class=language-mermaid data-lang=mermaid style=color:#61676c;background-color:#fafafa><code class=language-mermaid data-lang=mermaid><span>graph LR
</span><span>    A[AnimationClip::add_event] --> B[AnimationEventTrigger.target = AnimationPlayer]
</span><span>    C[AnimationClip::add_event_to_target] --> D[AnimationEventTrigger.target = AnimationTargetId]
</span><span>    B --> E[Event Systems]
</span><span>    D --> E
</span></code></pre><h2 id=key-files-changed>Key Files Changed</h2><h3 id=crates-bevy-animation-src-animation-event-rs-12-8><code>crates/bevy_animation/src/animation_event.rs</code> (+12/-8)</h3><p>This file contained the core structural change and documentation improvements.<p><strong>Key changes:</strong><ul><li>Renamed <code>animation_player</code> field to <code>target</code> in <code>AnimationEventTrigger</code><li>Updated documentation to clarify when the entity refers to the animation player vs animation target<li>Added <code>#[derive(Debug)]</code> to <code>AnimationEventTrigger</code></ul><pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before:
</span><span style=color:#fa6e32>pub struct </span><span style=color:#399ee6>AnimationEventTrigger </span><span>{
</span><span>    </span><span style=color:#fa6e32>pub </span><span>animation_player</span><span style=color:#61676ccc>:</span><span> Entity,
</span><span>}
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After:
</span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>derive</span><span>(Debug)]
</span><span style=color:#fa6e32>pub struct </span><span style=color:#399ee6>AnimationEventTrigger </span><span>{
</span><span>    </span><span style=color:#fa6e32>pub </span><span>target</span><span style=color:#61676ccc>:</span><span> Entity,
</span><span>}
</span></code></pre><h3 id=crates-bevy-animation-src-lib-rs-4-14><code>crates/bevy_animation/src/lib.rs</code> (+4/-14)</h3><p>Updated the event creation methods to use the new field name and structure.<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before in add_event:
</span><span>commands</span><span style=color:#ed9366>.</span><span style=color:#f07171>trigger_with</span><span>(
</span><span>    event</span><span style=color:#ed9366>.</span><span style=color:#f07171>clone</span><span>()</span><span style=color:#61676ccc>,
</span><span>    AnimationEventTrigger {
</span><span>        animation_player</span><span style=color:#61676ccc>:</span><span> entity</span><span style=color:#61676ccc>,
</span><span>    }</span><span style=color:#61676ccc>,
</span><span>)</span><span style=color:#61676ccc>;
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After in add_event:
</span><span>commands</span><span style=color:#ed9366>.</span><span style=color:#f07171>trigger_with</span><span>(event</span><span style=color:#ed9366>.</span><span style=color:#f07171>clone</span><span>()</span><span style=color:#61676ccc>,</span><span> AnimationEventTrigger { target })</span><span style=color:#61676ccc>;
</span></code></pre><h3 id=examples-animation-animated-mesh-events-rs-1-3><code>examples/animation/animated_mesh_events.rs</code> (+1/-3)</h3><p>Updated the example code to use the new field name.<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before:
</span><span style=color:#fa6e32>let</span><span> translation </span><span style=color:#ed9366>=</span><span> transforms</span><span style=color:#ed9366>.</span><span style=color:#f07171>get</span><span>(step</span><span style=color:#ed9366>.</span><span style=color:#f07171>trigger</span><span>()</span><span style=color:#ed9366>.</span><span>animation_player)</span><span style=color:#ed9366>?.</span><span style=color:#f07171>translation</span><span>()</span><span style=color:#61676ccc>;
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After:
</span><span style=color:#fa6e32>let</span><span> translation </span><span style=color:#ed9366>=</span><span> transforms</span><span style=color:#ed9366>.</span><span style=color:#f07171>get</span><span>(step</span><span style=color:#ed9366>.</span><span style=color:#f07171>trigger</span><span>()</span><span style=color:#ed9366>.</span><span>target)</span><span style=color:#ed9366>?.</span><span style=color:#f07171>translation</span><span>()</span><span style=color:#61676ccc>;
</span></code></pre><h3 id=release-content-migration-guides-animation-event-trigger-rename-md-11-0><code>release-content/migration-guides/animation-event-trigger-rename.md</code> (+11/-0)</h3><p>Added a comprehensive migration guide explaining the change and the reasoning behind it.<h2 id=further-reading>Further Reading</h2><ul><li><a rel="noopener nofollow noreferrer" href=https://bevyengine.org/learn/books/introduction/features/animation/ target=_blank>Bevy Animation System Documentation</a><li><a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/Entity_component_system target=_blank>Entity Component System (ECS) Pattern</a><li><a rel="noopener nofollow noreferrer" href=https://rust-lang.github.io/api-guidelines/naming.html target=_blank>Rust API Guidelines on Naming</a></ul><h1 id=full-code-diff>Full Code Diff</h1><pre class=language-diff data-lang=diff style=color:#61676c;background-color:#fafafa><code class=language-diff data-lang=diff><span>diff --git a/crates/bevy_animation/src/animation_event.rs b/crates/bevy_animation/src/animation_event.rs
</span><span>index 55bf5655855a6..824defc83a85b 100644
</span><span style=color:#c594c5>--- a/crates/bevy_animation/src/animation_event.rs
</span><span style=color:#c594c5>+++ b/crates/bevy_animation/src/animation_event.rs
</span><span style=color:#c594c5>@@ -7,17 +7,21 @@ </span><span style=color:#399ee6>use bevy_ecs::{
</span><span>     world::DeferredWorld,
</span><span> };
</span><span> 
</span><span style=color:#f07171>-/// An [`Event`] that an [`AnimationPlayer`](crate::AnimationPlayer) can trigger when playing an [`AnimationClip`](crate::AnimationClip).
</span><span style=color:#f07171>-/// See [`AnimationClip::add_event`](crate::AnimationClip::add_event).
</span><span style=color:#86b300>+/// An [`Event`] that an [`AnimationPlayer`](crate::AnimationPlayer) or an [`AnimationTargetId`](crate::AnimationTargetId) can trigger when playing an [`AnimationClip`](crate::AnimationClip).
</span><span style=color:#86b300>+///
</span><span style=color:#86b300>+/// - If you used [`AnimationClip::add_event`](crate::AnimationClip::add_event), this will be triggered by the [`AnimationPlayer`](crate::AnimationPlayer).
</span><span style=color:#86b300>+/// - If you used [`AnimationClip::add_event_to_target`](crate::AnimationClip::add_event_to_target), this will be triggered by the [`AnimationTargetId`](crate::AnimationTargetId).
</span><span> ///
</span><span> /// This trait can be derived.
</span><span> pub trait AnimationEvent: Clone + for<'a> Event&LTTrigger<'a> = AnimationEventTrigger> {}
</span><span> 
</span><span style=color:#f07171>-/// The [`Trigger`] implementation for [`AnimationEvent`]. This passes in the [`AnimationPlayer`](crate::AnimationPlayer)
</span><span style=color:#f07171>-/// context, and uses that to run any observers that target that entity.
</span><span style=color:#86b300>+/// The [`Trigger`] implementation for [`AnimationEvent`]. This passes in either the [`AnimationPlayer`](crate::AnimationPlayer) or the [`AnimationTargetId`](crate::AnimationTargetId)
</span><span style=color:#86b300>+/// context, and uses that to run any observers that target that entity. See [`AnimationEvent`] for when which entity is used.
</span><span style=color:#86b300>+#[derive(Debug)]
</span><span> pub struct AnimationEventTrigger {
</span><span style=color:#f07171>-    /// The [`AnimationPlayer`](crate::AnimationPlayer) where this [`AnimationEvent`] occurred.
</span><span style=color:#f07171>-    pub animation_player: Entity,
</span><span style=color:#86b300>+    /// The [`AnimationPlayer`](crate::AnimationPlayer) or the [`AnimationTargetId`](crate::AnimationTargetId) where this [`AnimationEvent`] occurred.
</span><span style=color:#86b300>+    /// See [`AnimationEvent`] for when which entity is used.
</span><span style=color:#86b300>+    pub target: Entity,
</span><span> }
</span><span> 
</span><span> #[expect(
</span><span style=color:#c594c5>@@ -37,7 +41,7 @@ </span><span style=color:#399ee6>unsafe impl&LTE: AnimationEvent + for<'a> Event&LTTrigger<'a> = AnimationEventTrigge
</span><span>         trigger_context: &TriggerContext,
</span><span>         event: &mut E,
</span><span>     ) {
</span><span style=color:#f07171>-        let animation_player = self.animation_player;
</span><span style=color:#86b300>+        let target = self.target;
</span><span>         // SAFETY:
</span><span>         // - `observers` come from `world` and match the event type `E`, enforced by the call to `trigger`
</span><span>         // - the passed in event pointer comes from `event`, which is an `Event`
</span><span style=color:#c594c5>@@ -50,7 +54,7 @@ </span><span style=color:#399ee6>unsafe impl&LTE: AnimationEvent + for<'a> Event&LTTrigger<'a> = AnimationEventTrigge
</span><span>                 observers,
</span><span>                 event.into(),
</span><span>                 self.into(),
</span><span style=color:#f07171>-                animation_player,
</span><span style=color:#86b300>+                target,
</span><span>                 trigger_context,
</span><span>             );
</span><span>         }
</span><span>diff --git a/crates/bevy_animation/src/lib.rs b/crates/bevy_animation/src/lib.rs
</span><span>index fb81224637ac1..146ce09c36f9d 100644
</span><span style=color:#c594c5>--- a/crates/bevy_animation/src/lib.rs
</span><span style=color:#c594c5>+++ b/crates/bevy_animation/src/lib.rs
</span><span style=color:#c594c5>@@ -326,13 +326,8 @@ </span><span style=color:#399ee6>impl AnimationClip {
</span><span>     pub fn add_event(&mut self, time: f32, event: impl AnimationEvent) {
</span><span>         self.add_event_fn(
</span><span>             time,
</span><span style=color:#f07171>-            move |commands: &mut Commands, entity: Entity, _time: f32, _weight: f32| {
</span><span style=color:#f07171>-                commands.trigger_with(
</span><span style=color:#f07171>-                    event.clone(),
</span><span style=color:#f07171>-                    AnimationEventTrigger {
</span><span style=color:#f07171>-                        animation_player: entity,
</span><span style=color:#f07171>-                    },
</span><span style=color:#f07171>-                );
</span><span style=color:#86b300>+            move |commands: &mut Commands, target: Entity, _time: f32, _weight: f32| {
</span><span style=color:#86b300>+                commands.trigger_with(event.clone(), AnimationEventTrigger { target });
</span><span>             },
</span><span>         );
</span><span>     }
</span><span style=color:#c594c5>@@ -352,13 +347,8 @@ </span><span style=color:#399ee6>impl AnimationClip {
</span><span>         self.add_event_fn_to_target(
</span><span>             target_id,
</span><span>             time,
</span><span style=color:#f07171>-            move |commands: &mut Commands, entity: Entity, _time: f32, _weight: f32| {
</span><span style=color:#f07171>-                commands.trigger_with(
</span><span style=color:#f07171>-                    event.clone(),
</span><span style=color:#f07171>-                    AnimationEventTrigger {
</span><span style=color:#f07171>-                        animation_player: entity,
</span><span style=color:#f07171>-                    },
</span><span style=color:#f07171>-                );
</span><span style=color:#86b300>+            move |commands: &mut Commands, target: Entity, _time: f32, _weight: f32| {
</span><span style=color:#86b300>+                commands.trigger_with(event.clone(), AnimationEventTrigger { target });
</span><span>             },
</span><span>         );
</span><span>     }
</span><span>diff --git a/examples/animation/animated_mesh_events.rs b/examples/animation/animated_mesh_events.rs
</span><span>index 5898807cf45a3..5cb8f70ebdf3c 100644
</span><span style=color:#c594c5>--- a/examples/animation/animated_mesh_events.rs
</span><span style=color:#c594c5>+++ b/examples/animation/animated_mesh_events.rs
</span><span style=color:#c594c5>@@ -49,9 +49,7 @@ </span><span style=color:#399ee6>fn observe_on_step(
</span><span>     transforms: Query<&GlobalTransform>,
</span><span>     mut seeded_rng: ResMut&LTSeededRng>,
</span><span> ) -> Result {
</span><span style=color:#f07171>-    let translation = transforms
</span><span style=color:#f07171>-        .get(step.trigger().animation_player)?
</span><span style=color:#f07171>-        .translation();
</span><span style=color:#86b300>+    let translation = transforms.get(step.trigger().target)?.translation();
</span><span>     // Spawn a bunch of particles.
</span><span>     for _ in 0..14 {
</span><span>         let horizontal = seeded_rng.0.random::&LTDir2>() * seeded_rng.0.random_range(8.0..12.0);
</span><span>diff --git a/release-content/migration-guides/animation-event-trigger-rename.md b/release-content/migration-guides/animation-event-trigger-rename.md
</span><span>new file mode 100644
</span><span>index 0000000000000..743bfae5ee114
</span><span style=color:#c594c5>--- /dev/null
</span><span style=color:#c594c5>+++ b/release-content/migration-guides/animation-event-trigger-rename.md
</span><span style=color:#c594c5>@@ -0,0 +1,11 @@
</span><span style=color:#86b300>+---
</span><span style=color:#86b300>+title: "`AnimationEventTrigger::animation_player` has been renamed to `AnimationEventTrigger::target`"
</span><span style=color:#86b300>+pull_requests: [21593]
</span><span style=color:#86b300>+---
</span><span style=color:#86b300>+
</span><span style=color:#86b300>+This field and its docs strongly suggested that it would point to an entity holding an `AnimationPlayer`, but that actually depends on how the event was registered.
</span><span style=color:#86b300>+
</span><span style=color:#86b300>+- If you used `AnimationClip::add_event`, the field really did point to the `AnimationPlayer`
</span><span style=color:#86b300>+- But if you used `AnimationClip::add_event_to_target`, this field instead pointed to an `AnimationTargetId`
</span><span style=color:#86b300>+
</span><span style=color:#86b300>+To make this more clear, the field was renamed to `target` and the docs surrounding it improved.
</span></code></pre></div><div data-is-md-page=true data-patch-exists=true data-patch-path=/pull_request/bevy/2025-10/pr_21593.patch id=patch-info style=display:none></div><div class=bottom-spacer></div></div></div>