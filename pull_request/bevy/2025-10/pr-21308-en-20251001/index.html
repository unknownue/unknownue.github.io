<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://unknownue.github.io name=base><title>
         #21308 Exclude ICEing example from doc scrape
        
    </title><meta content="#21308 Exclude ICEing example from doc scrape" property=og:title><meta content="A personal blog built with Zola and Apollo theme" property=og:description><meta content="A personal blog built with Zola and Apollo theme" name=description><link href=/icons/favicon.png rel=icon type=image/png><link href=https://unknownue.github.io/fonts.css rel=stylesheet><script src=https://unknownue.github.io/js/codeblock.js></script><script src=https://unknownue.github.io/js/toc.js></script><script src=https://unknownue.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Unknownue's Blog" href=https://unknownue.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://unknownue.github.io/theme/light.css rel=stylesheet><link href=https://unknownue.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://unknownue.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://unknownue.github.io/main.css media=screen rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js></script><script>// Initialize mermaid once DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            mermaid.initialize({
                startOnLoad: false,
                theme: document.body && document.body.classList.contains('dark') ? 'dark' : 'default',
                securityLevel: 'loose',
                flowchart: {
                    useMaxWidth: true,
                    htmlLabels: true
                },
                sequence: {
                    diagramMarginX: 50,
                    diagramMarginY: 10,
                    actorMargin: 50,
                    width: 150,
                    height: 65
                }
            });
        });</script><script src=https://unknownue.github.io/js/main.js></script><script defer src=https://unknownue.github.io/js/label-colors.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/rust.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/typescript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/go.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/cpp.min.js></script><script>// Ensure highlight.js is properly configured
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof hljs !== 'undefined') {
                hljs.configure({
                    languages: ['rust', 'javascript', 'python', 'cpp', 'go', 'typescript'],
                    ignoreUnescapedHTML: true
                });
                console.log('Highlight.js configured in header');
            }
        });</script><link href=https://cdn.jsdelivr.net/npm/diff2html/bundles/css/diff2html.min.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/diff2html/bundles/js/diff2html-ui.min.js></script><script src=https://unknownue.github.io/js/syntax-highlight.js></script><script src=https://unknownue.github.io/js/diff-sidebar.js></script><script src="https://unknownue.github.io/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><div class=content><header><div class=main><a href=https://unknownue.github.io>Unknownue's Blog</a><div class=socials><a class=social href=https://github.com/unknownue rel=me> <img alt=github src=https://unknownue.github.io/icons/social/github.svg> </a><a class=social href=https://github.com/unknownue/unknownue.github.io rel=me> <img alt=github-io src=https://unknownue.github.io/icons/social/rss.svg> </a></div></div><nav><a href=https://unknownue.github.io/posts style=margin-left:.25em>/posts</a><a href=https://unknownue.github.io/projects style=margin-left:.25em>/projects</a><a href=https://unknownue.github.io/about style=margin-left:.25em>/about</a><a href=https://unknownue.github.io/tags style=margin-left:.25em>/tags</a><button title="$SHORTCUT to open search" class=search-button id=search-button><img alt=Search class=search-icon src=https://unknownue.github.io/icons/search.svg></button><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><div id=modal-content><h1 class=page-header id=modalTitle>Search</h1><div id=searchBar><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search... role=combobox spellcheck=false><button title="Clear search" class=clear-button id=clear-search><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></button></div><div id=results-container><div id=results-info><span id=zero_results style=display:none>No results</span><span id=one_result style=display:none>1 result</span><span id=many_results style=display:none>$NUMBER results</span></div><div id=results role=listbox></div></div></div></div><a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://unknownue.github.io/icons/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://unknownue.github.io/icons/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><div class=pull-request-page><article class=md-content-page style=display:none></article><div class=back-link><a href=/pull_request/bevy/2025-10/>← Back to Pull Requests</a></div><div class=pr-metadata><span class=pr-date>2025-10-01</span><div class=language-switcher><span class="lang-link active" data-lang=en>English</span> / <a class=lang-link data-lang=zh-cn href=/pull_request/bevy/2025-10/pr-21308-zh-cn-20251001>中文</a></div></div><div class=pr-content><h1 id=title-exclude-iceing-example-from-doc-scrape>Title: Exclude ICEing example from doc scrape</h1><h2 id=basic-information>Basic Information</h2><ul><li><strong>Title</strong>: Exclude ICEing example from doc scrape<li><strong>PR Link</strong>: https://github.com/bevyengine/bevy/pull/21308<li><strong>Author</strong>: janhohenheim<li><strong>Status</strong>: MERGED<li><strong>Labels</strong>: C-Docs, D-Trivial, C-Examples, S-Ready-For-Final-Review<li><strong>Created</strong>: 2025-09-30T23:47:55Z<li><strong>Merged</strong>: 2025-10-01T00:38:48Z<li><strong>Merged By</strong>: alice-i-cecile</ul><h2 id=description-translation>Description Translation</h2><p>This PR disables doc scraping for the <code>type_data</code> example because it causes an Internal Compiler Error (ICE) on docs.rs.<h2 id=the-story-of-this-pull-request>The Story of This Pull Request</h2><p>This PR addresses a specific build problem in the Bevy engine’s documentation pipeline. The issue was straightforward: the <code>type_data</code> example in the reflection system was causing an Internal Compiler Error (ICE) when docs.rs attempted to build and scrape documentation examples.<p>The problem occurred because docs.rs has specific build constraints and compiler configurations that differ from local development environments. When the documentation generation process attempted to scrape and compile the <code>type_data</code> example, it encountered a compiler crash. This type of issue is particularly problematic because it blocks the entire documentation build process.<p>The solution implemented here is a targeted workaround. Rather than modifying the example code itself, which might be complex and require deeper investigation into the root cause of the ICE, the approach was to simply exclude this specific example from the doc scraping process. This is achieved by setting <code>doc-scrape-examples = false</code> for the problematic example configuration in Cargo.toml.<p>From a technical perspective, this change uses Rust’s Cargo manifest configuration to control documentation behavior. The <code>doc-scrape-examples</code> flag determines whether an example should be included when generating documentation. By setting this to false, the example will still be available for manual testing and execution, but won’t be processed during documentation generation on docs.rs.<p>The implementation is minimal and surgical - a single configuration change with an explanatory comment. The comment “Causes an ICE on docs.rs” provides clear context for future maintainers about why this example is excluded from doc scraping. This approach balances immediate problem resolution with maintainability, as the comment documents the rationale without requiring complex code changes.<p>This type of fix is common in large Rust projects where different build environments (local development vs. CI/CD vs. docs.rs) can expose edge cases in compiler behavior. The solution demonstrates practical problem-solving: when faced with a blocking issue in a specific environment, sometimes the most efficient approach is to work around the problematic configuration rather than attempting to fix the underlying compiler issue.<h2 id=visual-representation>Visual Representation</h2><pre class=language-mermaid data-lang=mermaid style=color:#61676c;background-color:#fafafa><code class=language-mermaid data-lang=mermaid><span>graph TD
</span><span>    A[type_data example] --> B[doc-scrape-examples = true]
</span><span>    B --> C[ICE on docs.rs]
</span><span>    A --> D[doc-scrape-examples = false]
</span><span>    D --> E[Successful docs build]
</span></code></pre><h2 id=key-files-changed>Key Files Changed</h2><h3 id=cargo-toml-2-1><code>Cargo.toml</code> (+2/-1)</h3><p>This file contains the project configuration and example definitions for the Rust package. The change modifies the configuration for the <code>type_data</code> example to prevent it from being included in documentation scraping.<pre class=language-toml data-lang=toml style=color:#61676c;background-color:#fafafa><code class=language-toml data-lang=toml><span style=color:#abb0b6;font-style:italic># File: Cargo.toml
</span><span style=color:#abb0b6;font-style:italic># Before:
</span><span>[[</span><span style=color:#399ee6>example</span><span>]]
</span><span style=color:#399ee6>name </span><span>= </span><span style=color:#86b300>"type_data"
</span><span style=color:#399ee6>path </span><span>= </span><span style=color:#86b300>"examples/reflection/type_data.rs"
</span><span style=color:#399ee6>doc-scrape-examples </span><span>= </span><span style=color:#ff8f40>true
</span><span>
</span><span style=color:#abb0b6;font-style:italic># After:
</span><span>[[</span><span style=color:#399ee6>example</span><span>]]
</span><span style=color:#399ee6>name </span><span>= </span><span style=color:#86b300>"type_data"
</span><span style=color:#399ee6>path </span><span>= </span><span style=color:#86b300>"examples/reflection/type_data.rs"
</span><span style=color:#abb0b6;font-style:italic># Causes an ICE on docs.rs
</span><span style=color:#399ee6>doc-scrape-examples </span><span>= </span><span style=color:#ff8f40>false
</span></code></pre><p>The key changes are:<ol><li>Added a comment explaining why the configuration is being changed<li>Changed <code>doc-scrape-examples</code> from <code>true</code> to <code>false</code><li>This prevents the example from causing compiler errors during documentation generation on docs.rs</ol><h2 id=further-reading>Further Reading</h2><ul><li><a rel="noopener nofollow noreferrer" href=https://doc.rust-lang.org/nightly/rustc/bug-reporting.html target=_blank>Rust Internal Compiler Errors (ICE)</a><li><a rel="noopener nofollow noreferrer" href=https://doc.rust-lang.org/cargo/reference/cargo-targets.html#examples target=_blank>Cargo Configuration for Examples</a><li><a rel="noopener nofollow noreferrer" href=https://bevyengine.org/learn/ target=_blank>Bevy Engine Documentation</a><li><a rel="noopener nofollow noreferrer" href=https://docs.rs/about target=_blank>docs.rs Build Process</a></ul><h1 id=full-code-diff>Full Code Diff</h1><pre style=color:#61676c;background-color:#fafafa><code><span>diff --git a/Cargo.toml b/Cargo.toml
</span><span>index dbf0401117928..72c321d5717bd 100644
</span><span>--- a/Cargo.toml
</span><span>+++ b/Cargo.toml
</span><span>@@ -2715,7 +2715,8 @@ wasm = false
</span><span> [[example]]
</span><span> name = "type_data"
</span><span> path = "examples/reflection/type_data.rs"
</span><span>-doc-scrape-examples = true
</span><span>+# Causes an ICE on docs.rs
</span><span>+doc-scrape-examples = false
</span><span> 
</span><span> [package.metadata.example.type_data]
</span><span> name = "Type Data"
</span></code></pre></div><div data-is-md-page=true data-patch-exists=true data-patch-path=/pull_request/bevy/2025-10/pr_21308.patch id=patch-info style=display:none></div><div class=bottom-spacer></div></div></div>