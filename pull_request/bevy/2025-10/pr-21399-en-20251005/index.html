<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://unknownue.github.io name=base><title>
         #21399 Remove uses of `#[cfg(feature = "track_location")]` outside of the implementation of `MaybeLocation`
        
    </title><meta content='#21399 Remove uses of `#[cfg(feature = "track_location")]` outside of the implementation of `MaybeLocation`' property=og:title><meta content="A personal blog built with Zola and Apollo theme" property=og:description><meta content="A personal blog built with Zola and Apollo theme" name=description><link href=/icons/favicon.png rel=icon type=image/png><link href=https://unknownue.github.io/fonts.css rel=stylesheet><script src=https://unknownue.github.io/js/codeblock.js></script><script src=https://unknownue.github.io/js/toc.js></script><script src=https://unknownue.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Unknownue's Blog" href=https://unknownue.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://unknownue.github.io/theme/light.css rel=stylesheet><link href=https://unknownue.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://unknownue.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://unknownue.github.io/main.css media=screen rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js></script><script>// Initialize mermaid once DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            mermaid.initialize({
                startOnLoad: false,
                theme: document.body && document.body.classList.contains('dark') ? 'dark' : 'default',
                securityLevel: 'loose',
                flowchart: {
                    useMaxWidth: true,
                    htmlLabels: true
                },
                sequence: {
                    diagramMarginX: 50,
                    diagramMarginY: 10,
                    actorMargin: 50,
                    width: 150,
                    height: 65
                }
            });
        });</script><script src=https://unknownue.github.io/js/main.js></script><script defer src=https://unknownue.github.io/js/label-colors.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/rust.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/typescript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/go.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/cpp.min.js></script><script>// Ensure highlight.js is properly configured
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof hljs !== 'undefined') {
                hljs.configure({
                    languages: ['rust', 'javascript', 'python', 'cpp', 'go', 'typescript'],
                    ignoreUnescapedHTML: true
                });
                console.log('Highlight.js configured in header');
            }
        });</script><link href=https://cdn.jsdelivr.net/npm/diff2html/bundles/css/diff2html.min.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/diff2html/bundles/js/diff2html-ui.min.js></script><script src=https://unknownue.github.io/js/syntax-highlight.js></script><script src=https://unknownue.github.io/js/diff-sidebar.js></script><script src="https://unknownue.github.io/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><div class=content><header><div class=main><a href=https://unknownue.github.io>Unknownue's Blog</a><div class=socials><a class=social href=https://github.com/unknownue rel=me> <img alt=github src=https://unknownue.github.io/icons/social/github.svg> </a><a class=social href=https://github.com/unknownue/unknownue.github.io rel=me> <img alt=github-io src=https://unknownue.github.io/icons/social/rss.svg> </a></div></div><nav><a href=https://unknownue.github.io/posts style=margin-left:.25em>/posts</a><a href=https://unknownue.github.io/projects style=margin-left:.25em>/projects</a><a href=https://unknownue.github.io/about style=margin-left:.25em>/about</a><a href=https://unknownue.github.io/tags style=margin-left:.25em>/tags</a><button title="$SHORTCUT to open search" class=search-button id=search-button><img alt=Search class=search-icon src=https://unknownue.github.io/icons/search.svg></button><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><div id=modal-content><h1 class=page-header id=modalTitle>Search</h1><div id=searchBar><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search... role=combobox spellcheck=false><button title="Clear search" class=clear-button id=clear-search><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></button></div><div id=results-container><div id=results-info><span id=zero_results style=display:none>No results</span><span id=one_result style=display:none>1 result</span><span id=many_results style=display:none>$NUMBER results</span></div><div id=results role=listbox></div></div></div></div><a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://unknownue.github.io/icons/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://unknownue.github.io/icons/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><div class=pull-request-page><article class=md-content-page style=display:none></article><div class=back-link><a href=/pull_request/bevy/2025-10/>← Back to Pull Requests</a></div><div class=pr-metadata><span class=pr-date>2025-10-05</span><div class=language-switcher><span class="lang-link active" data-lang=en>English</span> / <a class=lang-link data-lang=zh-cn href=/pull_request/bevy/2025-10/pr-21399-zh-cn-20251005>中文</a></div></div><div class=pr-content><h1 id=title>Title</h1><h2 id=basic-information>Basic Information</h2><ul><li><strong>Title</strong>: Remove uses of <code>#[cfg(feature = "track_location")]</code> outside of the implementation of <code>MaybeLocation</code><li><strong>PR Link</strong>: https://github.com/bevyengine/bevy/pull/21399<li><strong>Author</strong>: chescock<li><strong>Status</strong>: MERGED<li><strong>Labels</strong>: A-ECS, C-Code-Quality, S-Ready-For-Final-Review, D-Straightforward<li><strong>Created</strong>: 2025-10-05T15:39:21Z<li><strong>Merged</strong>: 2025-10-05T20:30:40Z<li><strong>Merged By</strong>: alice-i-cecile</ul><h2 id=description-translation>Description Translation</h2><h1 id=objective>Objective</h1><p>Remove uses of <code>#[cfg(feature = "track_location")]</code> outside of the implementation of <code>MaybeLocation</code>.<p>Reducing the amount of conditional compilation makes the code less brittle, since compilation errors will be found regardless of whether the feature is enabled.<p>We also want to ensure that uses of <code>MaybeLocation</code> outside of <code>bevy_ecs</code> don’t need their <em>own</em> feature flags. Avoiding the flags even within <code>bevy_ecs</code> helps ensure that all use cases are covered, and makes it easier to move or copy implementations from <code>bevy_ecs</code> into other crates.<h2 id=solution>Solution</h2><p>Remove <code>#[cfg(feature = "track_location")]</code> annotations. Use <code>.into_option()</code> in the cases where we want the behavior to depend on whether the feature is enabled.<h2 id=the-story-of-this-pull-request>The Story of This Pull Request</h2><p>This PR addresses a code quality issue in Bevy’s ECS (Entity Component System) related to conditional compilation. The problem centered around the <code>track_location</code> feature flag, which was being used extensively throughout the codebase rather than being contained within the <code>MaybeLocation</code> type’s implementation.<p>The core issue was that conditional compilation with <code>#[cfg(feature = "track_location")]</code> was scattered across multiple files, making the code harder to maintain and test. When feature flags are used extensively, compilation errors might only surface when the feature is enabled or disabled, leading to brittle code that could break in different build configurations. Additionally, this approach created friction for developers wanting to use <code>MaybeLocation</code> outside of <code>bevy_ecs</code>, as they would need to manage their own feature flags.<p>The solution adopted a more disciplined approach to feature flag management. Instead of conditionally compiling entire sections of code based on the feature flag, the PR moves to using <code>MaybeLocation::into_option()</code> at the point of use. This method returns <code>Some(location)</code> when the feature is enabled and <code>None</code> when it’s disabled, allowing the same code to compile regardless of the feature flag state while maintaining the appropriate runtime behavior.<p>In <code>command_queue.rs</code>, the changes were structural. The <code>caller</code> field was made unconditional in the <code>CommandQueue</code> struct:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before:
</span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>cfg</span><span>(feature </span><span style=color:#ed9366>= </span><span style=color:#86b300>"track_location"</span><span>)]
</span><span style=color:#fa6e32>pub</span><span>(</span><span style=color:#fa6e32>crate</span><span>) caller</span><span style=color:#61676ccc>:</span><span> MaybeLocation</span><span style=color:#61676ccc>,
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After:
</span><span style=color:#fa6e32>pub</span><span>(</span><span style=color:#fa6e32>crate</span><span>) caller</span><span style=color:#61676ccc>:</span><span> MaybeLocation</span><span style=color:#61676ccc>,
</span></code></pre><p>Similarly, the <code>Default</code> implementation now always initializes the <code>caller</code> field:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before:
</span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>cfg</span><span>(feature </span><span style=color:#ed9366>= </span><span style=color:#86b300>"track_location"</span><span>)]
</span><span>caller</span><span style=color:#61676ccc>: </span><span>MaybeLocation</span><span style=color:#ed9366>::</span><span>caller()</span><span style=color:#61676ccc>,
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After:
</span><span>caller</span><span style=color:#61676ccc>: </span><span>MaybeLocation</span><span style=color:#ed9366>::</span><span>caller()</span><span style=color:#61676ccc>,
</span></code></pre><p>The <code>Debug</code> implementation was simplified by removing conditional field addition and instead relying on <code>MaybeLocation</code>’s own <code>Debug</code> implementation:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before:
</span><span style=color:#fa6e32>let mut</span><span> binding </span><span style=color:#ed9366>=</span><span> f</span><span style=color:#ed9366>.</span><span style=color:#f07171>debug_struct</span><span>(</span><span style=color:#86b300>"CommandQueue"</span><span>)</span><span style=color:#61676ccc>;
</span><span>binding</span><span style=color:#ed9366>.</span><span style=color:#f07171>field</span><span>(</span><span style=color:#86b300>"len_bytes"</span><span style=color:#61676ccc>, </span><span style=color:#ed9366>&</span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>bytes</span><span style=color:#ed9366>.</span><span style=color:#f07171>len</span><span>())</span><span style=color:#61676ccc>;
</span><span>
</span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>cfg</span><span>(feature </span><span style=color:#ed9366>= </span><span style=color:#86b300>"track_location"</span><span>)]
</span><span>binding</span><span style=color:#ed9366>.</span><span style=color:#f07171>field</span><span>(</span><span style=color:#86b300>"caller"</span><span style=color:#61676ccc>, </span><span style=color:#ed9366>&</span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>caller</span><span style=color:#ed9366>.</span><span style=color:#f07171>into_option</span><span>())</span><span style=color:#61676ccc>;
</span><span>
</span><span>binding</span><span style=color:#ed9366>.</span><span style=color:#f07171>finish_non_exhaustive</span><span>()
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After:
</span><span>f</span><span style=color:#ed9366>.</span><span style=color:#f07171>debug_struct</span><span>(</span><span style=color:#86b300>"CommandQueue"</span><span>)
</span><span>    </span><span style=color:#ed9366>.</span><span style=color:#f07171>field</span><span>(</span><span style=color:#86b300>"len_bytes"</span><span style=color:#61676ccc>, </span><span style=color:#ed9366>&</span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>bytes</span><span style=color:#ed9366>.</span><span style=color:#f07171>len</span><span>())
</span><span>    </span><span style=color:#ed9366>.</span><span style=color:#f07171>field</span><span>(</span><span style=color:#86b300>"caller"</span><span style=color:#61676ccc>, </span><span style=color:#ed9366>&</span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>caller)
</span><span>    </span><span style=color:#ed9366>.</span><span style=color:#f07171>finish_non_exhaustive</span><span>()
</span></code></pre><p>The <code>Drop</code> implementation demonstrates the key pattern of using <code>into_option()</code> for conditional behavior:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before:
</span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>cfg</span><span>(feature </span><span style=color:#ed9366>= </span><span style=color:#86b300>"track_location"</span><span>)]
</span><span style=color:#f07171>warn!</span><span>(</span><span style=color:#86b300>"CommandQueue has un-applied commands being dropped. Did you forget to call SystemState::apply? caller:{:?}"</span><span style=color:#61676ccc>,</span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>caller</span><span style=color:#ed9366>.</span><span style=color:#f07171>into_option</span><span>())</span><span style=color:#61676ccc>;
</span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>cfg</span><span>(</span><span style=color:#f29718>not</span><span>(feature </span><span style=color:#ed9366>= </span><span style=color:#86b300>"track_location"</span><span>))]
</span><span style=color:#f07171>warn!</span><span>(</span><span style=color:#86b300>"CommandQueue has un-applied commands being dropped. Did you forget to call SystemState::apply?"</span><span>)</span><span style=color:#61676ccc>;
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After:
</span><span style=color:#fa6e32>if let </span><span style=color:#55b4d4;font-style:italic>Some</span><span>(caller) </span><span style=color:#ed9366>= </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>caller</span><span style=color:#ed9366>.</span><span style=color:#f07171>into_option</span><span>() {
</span><span>    </span><span style=color:#f07171>warn!</span><span>(</span><span style=color:#86b300>"CommandQueue has un-applied commands being dropped. Did you forget to call SystemState::apply? caller:{caller:?}"</span><span>)</span><span style=color:#61676ccc>;
</span><span>} </span><span style=color:#fa6e32>else </span><span>{
</span><span>    </span><span style=color:#f07171>warn!</span><span>(</span><span style=color:#86b300>"CommandQueue has un-applied commands being dropped. Did you forget to call SystemState::apply?"</span><span>)</span><span style=color:#61676ccc>;
</span><span>}
</span></code></pre><p>In <code>entity_ref.rs</code>, the test code was updated to use the same pattern, making the tests compile unconditionally while only running location-specific assertions when the feature is enabled:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before:
</span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>cfg</span><span>(feature </span><span style=color:#ed9366>= </span><span style=color:#86b300>"track_location"</span><span>)]
</span><span style=color:#fa6e32>let</span><span> e1_spawned </span><span style=color:#ed9366>=</span><span> world</span><span style=color:#ed9366>.</span><span style=color:#f07171>entity</span><span>(id1)</span><span style=color:#ed9366>.</span><span style=color:#f07171>spawned_by</span><span>()</span><span style=color:#61676ccc>;
</span><span style=color:#abb0b6;font-style:italic>// ... more conditional code ...
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After:
</span><span style=color:#fa6e32>let</span><span> e1_spawned </span><span style=color:#ed9366>=</span><span> world</span><span style=color:#ed9366>.</span><span style=color:#f07171>entity</span><span>(id1)</span><span style=color:#ed9366>.</span><span style=color:#f07171>spawned_by</span><span>()</span><span style=color:#61676ccc>;
</span><span style=color:#abb0b6;font-style:italic>// ... unconditional code ...
</span><span style=color:#fa6e32>if let </span><span>(</span><span style=color:#55b4d4;font-style:italic>Some</span><span>(e1_spawned)</span><span style=color:#61676ccc>, </span><span style=color:#55b4d4;font-style:italic>Some</span><span>(e1_despawned)) </span><span style=color:#ed9366>= 
</span><span>    (e1_spawned</span><span style=color:#ed9366>.</span><span style=color:#f07171>into_option</span><span>()</span><span style=color:#61676ccc>,</span><span> e1_despawned</span><span style=color:#ed9366>.</span><span style=color:#f07171>into_option</span><span>()) 
</span><span>{
</span><span>    </span><span style=color:#f07171>assert!</span><span>(e1_despawned</span><span style=color:#ed9366>.</span><span style=color:#f07171>is_some</span><span>())</span><span style=color:#61676ccc>;
</span><span>    </span><span style=color:#f07171>assert_ne!</span><span>(</span><span style=color:#55b4d4;font-style:italic>Some</span><span>(e1_spawned)</span><span style=color:#61676ccc>,</span><span> e1_despawned)</span><span style=color:#61676ccc>;
</span><span>}
</span></code></pre><p>This approach provides several technical benefits. First, it ensures that all code paths are compiled regardless of feature flag settings, catching potential compilation errors early. Second, it reduces code duplication by eliminating the need for parallel implementations for feature-enabled and feature-disabled scenarios. Third, it makes the codebase more maintainable by localizing feature-specific behavior to the <code>MaybeLocation</code> type itself.<p>The architectural insight here is that feature flags should be treated as implementation details of specific types rather than as global compile-time switches that affect large portions of the codebase. By encapsulating the feature-dependent behavior within <code>MaybeLocation</code>, the rest of the code can interact with it through a stable interface that works consistently regardless of the feature flag state.<p>This change aligns with software engineering best practices for feature flag management, where the goal is to minimize the impact of feature flags on the overall code structure and maintain a clean separation between feature-dependent and feature-independent code.<h2 id=visual-representation>Visual Representation</h2><pre class=language-mermaid data-lang=mermaid style=color:#61676c;background-color:#fafafa><code class=language-mermaid data-lang=mermaid><span>graph TD
</span><span>    A[CommandQueue] --> B[MaybeLocation]
</span><span>    C[EntityRef Tests] --> B
</span><span>    B --> D[into_option method]
</span><span>    D --> E[Feature Enabled: Some Location]
</span><span>    D --> F[Feature Disabled: None]
</span><span>    
</span><span>    G[External Crates] --> B
</span><span>    H[bevy_ecs] --> B
</span></code></pre><h2 id=key-files-changed>Key Files Changed</h2><h3 id=crates-bevy-ecs-src-world-command-queue-rs-10-15><code>crates/bevy_ecs/src/world/command_queue.rs</code> (+10/-15)</h3><p>This file contains the core command execution system in Bevy’s ECS. The changes remove conditional compilation around location tracking and use <code>into_option()</code> for conditional behavior.<p><strong>Key changes:</strong><ul><li>Made <code>caller</code> field unconditional in <code>CommandQueue</code> struct<li>Simplified <code>Debug</code> implementation to always include caller field<li>Used <code>into_option()</code> in <code>Drop</code> implementation for conditional warning messages</ul><pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Key change in Drop implementation:
</span><span style=color:#fa6e32>if let </span><span style=color:#55b4d4;font-style:italic>Some</span><span>(caller) </span><span style=color:#ed9366>= </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>caller</span><span style=color:#ed9366>.</span><span style=color:#f07171>into_option</span><span>() {
</span><span>    </span><span style=color:#f07171>warn!</span><span>(</span><span style=color:#86b300>"CommandQueue has un-applied commands being dropped. Did you forget to call SystemState::apply? caller:{caller:?}"</span><span>)</span><span style=color:#61676ccc>;
</span><span>} </span><span style=color:#fa6e32>else </span><span>{
</span><span>    </span><span style=color:#f07171>warn!</span><span>(</span><span style=color:#86b300>"CommandQueue has un-applied commands being dropped. Did you forget to call SystemState::apply?"</span><span>)</span><span style=color:#61676ccc>;
</span><span>}
</span></code></pre><h3 id=crates-bevy-ecs-src-world-entity-ref-rs-8-4><code>crates/bevy_ecs/src/world/entity_ref.rs</code> (+8/-4)</h3><p>This file handles entity references and their operations. The changes update tests to use the new <code>into_option()</code> pattern.<p><strong>Key changes:</strong><ul><li>Removed conditional compilation from test code<li>Used <code>into_option()</code> to conditionally run location-specific assertions</ul><pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Key change in test assertions:
</span><span style=color:#fa6e32>if let </span><span>(</span><span style=color:#55b4d4;font-style:italic>Some</span><span>(e1_spawned)</span><span style=color:#61676ccc>, </span><span style=color:#55b4d4;font-style:italic>Some</span><span>(e1_despawned)) </span><span style=color:#ed9366>=
</span><span>    (e1_spawned</span><span style=color:#ed9366>.</span><span style=color:#f07171>into_option</span><span>()</span><span style=color:#61676ccc>,</span><span> e1_despawned</span><span style=color:#ed9366>.</span><span style=color:#f07171>into_option</span><span>())
</span><span>{
</span><span>    </span><span style=color:#f07171>assert!</span><span>(e1_despawned</span><span style=color:#ed9366>.</span><span style=color:#f07171>is_some</span><span>())</span><span style=color:#61676ccc>;
</span><span>    </span><span style=color:#f07171>assert_ne!</span><span>(</span><span style=color:#55b4d4;font-style:italic>Some</span><span>(e1_spawned)</span><span style=color:#61676ccc>,</span><span> e1_despawned)</span><span style=color:#61676ccc>;
</span><span>}
</span></code></pre><h2 id=further-reading>Further Reading</h2><ul><li><a rel="noopener nofollow noreferrer" href=https://doc.rust-lang.org/reference/conditional-compilation.html target=_blank>Rust Conditional Compilation</a> - Official Rust documentation on <code>#[cfg]</code> attributes<li><a rel="noopener nofollow noreferrer" href=https://martinfowler.com/articles/feature-toggles.html target=_blank>Feature Flag Best Practices</a> - Martin Fowler’s comprehensive guide to feature toggles<li><a rel="noopener nofollow noreferrer" href=https://bevyengine.org/learn/quick-start/ecs/ target=_blank>Bevy ECS Documentation</a> - Bevy’s Entity Component System overview<li><a rel="noopener nofollow noreferrer" href=https://doc.rust-lang.org/book/ch06-00-enums.html target=_blank>Rust Enum and Option Types</a> - Rust enums and the Option type pattern used in this PR</ul></div><div data-is-md-page=true data-patch-exists=true data-patch-path=/pull_request/bevy/2025-10/pr_21399.patch id=patch-info style=display:none></div><div class=bottom-spacer></div></div></div>