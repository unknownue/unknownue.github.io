<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://unknownue.github.io name=base><title>
         #21685 Improve tests using broad queries (`Query<Entity>`, `Query<()>`, etc)
        
    </title><meta content="#21685 Improve tests using broad queries (`Query<Entity>`, `Query<()>`, etc)" property=og:title><meta content="A personal blog built with Zola and Apollo theme" property=og:description><meta content="A personal blog built with Zola and Apollo theme" name=description><link href=/icons/favicon.png rel=icon type=image/png><link href=https://unknownue.github.io/fonts.css rel=stylesheet><script src=https://unknownue.github.io/js/codeblock.js></script><script src=https://unknownue.github.io/js/toc.js></script><script src=https://unknownue.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Unknownue's Blog" href=https://unknownue.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://unknownue.github.io/theme/light.css rel=stylesheet><link href=https://unknownue.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://unknownue.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://unknownue.github.io/main.css media=screen rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js></script><script>// Initialize mermaid once DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            mermaid.initialize({
                startOnLoad: false,
                theme: document.body && document.body.classList.contains('dark') ? 'dark' : 'default',
                securityLevel: 'loose',
                flowchart: {
                    useMaxWidth: true,
                    htmlLabels: true
                },
                sequence: {
                    diagramMarginX: 50,
                    diagramMarginY: 10,
                    actorMargin: 50,
                    width: 150,
                    height: 65
                }
            });
        });</script><script src=https://unknownue.github.io/js/main.js></script><script defer src=https://unknownue.github.io/js/label-colors.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/rust.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/typescript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/go.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/cpp.min.js></script><script>// Ensure highlight.js is properly configured
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof hljs !== 'undefined') {
                hljs.configure({
                    languages: ['rust', 'javascript', 'python', 'cpp', 'go', 'typescript'],
                    ignoreUnescapedHTML: true
                });
                console.log('Highlight.js configured in header');
            }
        });</script><link href=https://cdn.jsdelivr.net/npm/diff2html/bundles/css/diff2html.min.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/diff2html/bundles/js/diff2html-ui.min.js></script><script src=https://unknownue.github.io/js/syntax-highlight.js></script><script src=https://unknownue.github.io/js/diff-sidebar.js></script><script src="https://unknownue.github.io/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><div class=content><header><div class=main><a href=https://unknownue.github.io>Unknownue's Blog</a><div class=socials><a class=social href=https://github.com/unknownue rel=me> <img alt=github src=https://unknownue.github.io/icons/social/github.svg> </a><a class=social href=https://github.com/unknownue/unknownue.github.io rel=me> <img alt=github-io src=https://unknownue.github.io/icons/social/rss.svg> </a></div></div><nav><a href=https://unknownue.github.io/posts style=margin-left:.25em>/posts</a><a href=https://unknownue.github.io/projects style=margin-left:.25em>/projects</a><a href=https://unknownue.github.io/about style=margin-left:.25em>/about</a><a href=https://unknownue.github.io/tags style=margin-left:.25em>/tags</a><button title="$SHORTCUT to open search" class=search-button id=search-button><img alt=Search class=search-icon src=https://unknownue.github.io/icons/search.svg></button><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><div id=modal-content><h1 class=page-header id=modalTitle>Search</h1><div id=searchBar><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search... role=combobox spellcheck=false><button title="Clear search" class=clear-button id=clear-search><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></button></div><div id=results-container><div id=results-info><span id=zero_results style=display:none>No results</span><span id=one_result style=display:none>1 result</span><span id=many_results style=display:none>$NUMBER results</span></div><div id=results role=listbox></div></div></div></div><a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://unknownue.github.io/icons/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://unknownue.github.io/icons/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><div class=pull-request-page><article class=md-content-page style=display:none></article><div class=back-link><a href=/pull_request/bevy/2025-10/>← Back to Pull Requests</a></div><div class=pr-metadata><span class=pr-date>2025-10-29</span><div class=language-switcher><span class="lang-link active" data-lang=en>English</span> / <a class=lang-link data-lang=zh-cn href=/pull_request/bevy/2025-10/pr-21685-zh-cn-20251029>中文</a></div></div><div class=pr-content><h1 id=title>Title</h1><p>Improve tests using broad queries (<code>Query&LTEntity></code>, <code>Query<()></code>, etc)<h2 id=basic-information>Basic Information</h2><ul><li><strong>Title</strong>: Improve tests using broad queries (<code>Query&LTEntity></code>, <code>Query<()></code>, etc)<li><strong>PR Link</strong>: https://github.com/bevyengine/bevy/pull/21685<li><strong>Author</strong>: Trashtalk217<li><strong>Status</strong>: MERGED<li><strong>Labels</strong>: D-Trivial, A-ECS, S-Ready-For-Final-Review, C-Testing<li><strong>Created</strong>: 2025-10-29T02:08:27Z<li><strong>Merged</strong>: 2025-10-29T19:56:19Z<li><strong>Merged By</strong>: alice-i-cecile</ul><h2 id=description-translation>Description Translation</h2><h1 id=objective>Objective</h1><p>Tests should be more resilient to entities added on <code>World</code> creation. This is necessary for resources-as-components to work without relying on <code>DefaultQueryFilters</code>.<h2 id=solution>Solution</h2><p>I’ve added an empty entity during <code>World::bootstrap()</code> and ran the test suite (and CI). I’ve gone and fixed every test, except for the ones where it’s not possible / doesn’t make sense. Both <code>iter_entities</code> and <code>iter_entities_mut</code> and their tests have been removed as they were deprecated in 0.17.<h2 id=the-story-of-this-pull-request>The Story of This Pull Request</h2><p>This PR addresses a fundamental testing challenge in Bevy’s ECS system: making tests resilient to the presence of background entities that are automatically created during world initialization. The core issue emerged from the need to support resources-as-components without depending on <code>DefaultQueryFilters</code>, which would require tests to account for entities that exist outside of their explicit test setup.<p>The developer approached this problem systematically by first adding an empty entity during <code>World::bootstrap()</code> to simulate the real-world scenario where background entities might be present. This immediately revealed which tests were making assumptions about entity counts that would break in production environments. The solution wasn’t about changing the production code’s behavior, but rather making the test assertions more precise and robust.<p>The primary technical approach involved replacing broad queries like <code>Query&LTEntity></code> and <code>Query<()></code> with more specific queries that filter for test-specific entities using marker components. This pattern ensures tests only count entities they explicitly create, ignoring any background entities that might be present. For example:<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before - counts all entities including background ones
</span><span style=color:#fa6e32>let mut</span><span> query </span><span style=color:#ed9366>=</span><span> world</span><span style=color:#ed9366>.</span><span>query</span><span style=color:#ed9366>::</span><span>&LTEntity>()</span><span style=color:#61676ccc>;
</span><span style=color:#f07171>assert_eq!</span><span>(</span><span style=color:#ff8f40>1</span><span style=color:#61676ccc>,</span><span> query</span><span style=color:#ed9366>.</span><span style=color:#f07171>iter</span><span>(</span><span style=color:#ed9366>&</span><span>world)</span><span style=color:#ed9366>.</span><span style=color:#f07171>count</span><span>())</span><span style=color:#61676ccc>;
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After - only counts entities with the test marker
</span><span style=color:#fa6e32>let mut</span><span> query </span><span style=color:#ed9366>=</span><span> world</span><span style=color:#ed9366>.</span><span>query_filtered</span><span style=color:#ed9366>::</span><span>&LTEntity, With&LTMarker>>()</span><span style=color:#61676ccc>;
</span><span style=color:#f07171>assert_eq!</span><span>(</span><span style=color:#ff8f40>1</span><span style=color:#61676ccc>,</span><span> query</span><span style=color:#ed9366>.</span><span style=color:#f07171>iter</span><span>(</span><span style=color:#ed9366>&</span><span>world)</span><span style=color:#ed9366>.</span><span style=color:#f07171>count</span><span>())</span><span style=color:#61676ccc>;
</span></code></pre><p>A significant part of this PR involved cleaning up deprecated code. The <code>iter_entities</code> and <code>iter_entities_mut</code> methods had been deprecated since Bevy 0.17, and this PR removed them along with their associated tests. This cleanup reduces maintenance burden and encourages using the more flexible query system.<p>The implementation required careful analysis of each test’s intent. Some tests needed to verify they were working with exactly the entities they created, while others legitimately needed to consider all entities in the world. The developer made judgment calls about which approach was appropriate for each test case.<p>One notable technical insight from this work is the importance of test isolation. By using marker components, tests become self-contained and less likely to interfere with each other or be affected by framework changes. This pattern also makes test intentions clearer - when you see <code>With&LTDummy></code> in a test query, you immediately understand that this query is targeting test-specific entities.<p>The impact of these changes is significant for long-term test maintenance. Tests that rely on specific entity counts without proper filtering are brittle and can break when the framework evolves. By making tests more precise about which entities they care about, this PR reduces future maintenance burden and makes the test suite more reliable.<h2 id=visual-representation>Visual Representation</h2><pre class=language-mermaid data-lang=mermaid style=color:#61676c;background-color:#fafafa><code class=language-mermaid data-lang=mermaid><span>graph TD
</span><span>    A[World Bootstrap] --> B[Adds Empty Entity]
</span><span>    B --> C[Tests Break]
</span><span>    C --> D[Fix Tests with Marker Components]
</span><span>    D --> E[Use With&LTMarker> Filters]
</span><span>    E --> F[Remove Deprecated iter_entities Methods]
</span><span>    F --> G[Robust Test Suite]
</span><span>    
</span><span>    H[Test Entity 1] --> I[Marker Component]
</span><span>    J[Test Entity 2] --> I
</span><span>    K[Background Entity] --> L[No Marker]
</span><span>    
</span><span>    I --> M[Query with With&LTMarker>]
</span><span>    L --> N[Ignored by Filtered Query]
</span></code></pre><h2 id=key-files-changed>Key Files Changed</h2><h3 id=crates-bevy-ecs-src-world-mod-rs-2-172><code>crates/bevy_ecs/src/world/mod.rs</code> (+2/-172)</h3><p><strong>What changed</strong>: Removed deprecated <code>iter_entities</code> and <code>iter_entities_mut</code> methods and their associated tests. <strong>Why</strong>: These methods were deprecated in 0.17 and were using broad entity iteration patterns that this PR aims to replace.<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Removed deprecated methods:
</span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>deprecated</span><span>(since </span><span style=color:#ed9366>= </span><span style=color:#86b300>"0.17.0"</span><span style=color:#61676ccc>,</span><span> note </span><span style=color:#ed9366>= </span><span style=color:#86b300>"use world.query::&LTEntityRef>()` instead"</span><span>)]
</span><span style=color:#fa6e32>pub fn </span><span style=color:#f29718>iter_entities</span><span>(</span><span style=color:#ed9366>&</span><span style=color:#ff8f40>self</span><span>) </span><span style=color:#61676ccc>-></span><span> impl </span><span style=color:#55b4d4;font-style:italic>Iterator</span><span>&LTItem = EntityRef<'</span><span style=color:#ed9366>_</span><span>>> </span><span style=color:#ed9366>+ '_ </span><span>{ </span><span style=color:#ed9366>... </span><span>}
</span><span>
</span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>deprecated</span><span>(since </span><span style=color:#ed9366>= </span><span style=color:#86b300>"0.17.0"</span><span style=color:#61676ccc>,</span><span> note </span><span style=color:#ed9366>= </span><span style=color:#86b300>"use world.query::&LTEntityMut>()` instead"</span><span>)]
</span><span style=color:#fa6e32>pub fn </span><span style=color:#f29718>iter_entities_mut</span><span>(</span><span style=color:#ed9366>&</span><span style=color:#fa6e32>mut </span><span style=color:#ff8f40>self</span><span>) </span><span style=color:#61676ccc>-></span><span> impl </span><span style=color:#55b4d4;font-style:italic>Iterator</span><span>&LTItem = EntityMut<'</span><span style=color:#ed9366>_</span><span>>> </span><span style=color:#ed9366>+ '_ </span><span>{ </span><span style=color:#ed9366>... </span><span>}
</span></code></pre><h3 id=crates-bevy-ecs-src-query-builder-rs-32-23><code>crates/bevy_ecs/src/query/builder.rs</code> (+32/-23)</h3><p><strong>What changed</strong>: Added marker components and updated queries to use <code>With&LTD></code> filters. <strong>Why</strong>: To make tests resilient to background entities by only counting entities with test-specific markers.<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before:
</span><span>world</span><span style=color:#ed9366>.</span><span style=color:#f07171>spawn</span><span>((A(</span><span style=color:#ff8f40>0</span><span>)</span><span style=color:#61676ccc>,</span><span> B(</span><span style=color:#ff8f40>0</span><span>)))</span><span style=color:#61676ccc>;
</span><span style=color:#fa6e32>let mut</span><span> query_a </span><span style=color:#ed9366>= </span><span>QueryBuilder</span><span style=color:#ed9366>::</span><span>&LTEntity></span><span style=color:#ed9366>::</span><span>new(</span><span style=color:#ed9366>&</span><span style=color:#fa6e32>mut</span><span> world)
</span><span>    </span><span style=color:#ed9366>.</span><span style=color:#f07171>or</span><span>(|</span><span style=color:#ff8f40>builder</span><span>| {
</span><span>        builder</span><span style=color:#ed9366>.</span><span>with</span><span style=color:#ed9366>::</span><span>&LTA>()</span><span style=color:#61676ccc>;
</span><span>        builder</span><span style=color:#ed9366>.</span><span>with</span><span style=color:#ed9366>::</span><span>&LTB>()</span><span style=color:#61676ccc>;
</span><span>    })
</span><span>    </span><span style=color:#ed9366>.</span><span style=color:#f07171>build</span><span>()</span><span style=color:#61676ccc>;
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After:
</span><span>world</span><span style=color:#ed9366>.</span><span style=color:#f07171>spawn</span><span>((A(</span><span style=color:#ff8f40>0</span><span>)</span><span style=color:#61676ccc>,</span><span> B(</span><span style=color:#ff8f40>0</span><span>)</span><span style=color:#61676ccc>,</span><span> D))</span><span style=color:#61676ccc>;
</span><span style=color:#fa6e32>let mut</span><span> query_a </span><span style=color:#ed9366>= </span><span>QueryBuilder</span><span style=color:#ed9366>::</span><span><</span><span style=color:#ed9366>&</span><span>D></span><span style=color:#ed9366>::</span><span>new(</span><span style=color:#ed9366>&</span><span style=color:#fa6e32>mut</span><span> world)
</span><span>    </span><span style=color:#ed9366>.</span><span style=color:#f07171>or</span><span>(|</span><span style=color:#ff8f40>builder</span><span>| {
</span><span>        builder</span><span style=color:#ed9366>.</span><span>with</span><span style=color:#ed9366>::</span><span>&LTA>()</span><span style=color:#61676ccc>;
</span><span>        builder</span><span style=color:#ed9366>.</span><span>with</span><span style=color:#ed9366>::</span><span>&LTB>()</span><span style=color:#61676ccc>;
</span><span>    })
</span><span>    </span><span style=color:#ed9366>.</span><span style=color:#f07171>build</span><span>()</span><span style=color:#61676ccc>;
</span></code></pre><h3 id=crates-bevy-ecs-src-query-state-rs-22-16><code>crates/bevy_ecs/src/query/state.rs</code> (+22/-16)</h3><p><strong>What changed</strong>: Updated query state tests to use marker components and filtered queries. <strong>Why</strong>: To ensure tests only count entities they explicitly create, ignoring any background entities.<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before:
</span><span style=color:#fa6e32>let mut</span><span> query </span><span style=color:#ed9366>= </span><span>QueryState</span><span style=color:#ed9366>::</span><span><()></span><span style=color:#ed9366>::</span><span>new(</span><span style=color:#ed9366>&</span><span style=color:#fa6e32>mut</span><span> world)</span><span style=color:#61676ccc>;
</span><span style=color:#f07171>assert_eq!</span><span>(</span><span style=color:#ff8f40>3</span><span style=color:#61676ccc>,</span><span> query</span><span style=color:#ed9366>.</span><span style=color:#f07171>iter</span><span>(</span><span style=color:#ed9366>&</span><span>world)</span><span style=color:#ed9366>.</span><span style=color:#f07171>count</span><span>())</span><span style=color:#61676ccc>;
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After:
</span><span style=color:#fa6e32>let mut</span><span> query </span><span style=color:#ed9366>= </span><span>QueryState</span><span style=color:#ed9366>::</span><span><</span><span style=color:#ed9366>&</span><span>Dummy></span><span style=color:#ed9366>::</span><span>new(</span><span style=color:#ed9366>&</span><span style=color:#fa6e32>mut</span><span> world)</span><span style=color:#61676ccc>;
</span><span style=color:#f07171>assert_eq!</span><span>(</span><span style=color:#ff8f40>3</span><span style=color:#61676ccc>,</span><span> query</span><span style=color:#ed9366>.</span><span style=color:#f07171>iter</span><span>(</span><span style=color:#ed9366>&</span><span>world)</span><span style=color:#ed9366>.</span><span style=color:#f07171>count</span><span>())</span><span style=color:#61676ccc>;
</span></code></pre><h3 id=crates-bevy-ecs-src-entity-disabling-rs-17-14><code>crates/bevy_ecs/src/entity_disabling.rs</code> (+17/-14)</h3><p><strong>What changed</strong>: Added <code>Dummy</code> marker component and updated all queries to filter for it. <strong>Why</strong>: To make entity disabling tests resilient to background entities while maintaining test accuracy.<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Added marker component:
</span><span style=color:#61676ccc>#</span><span>[</span><span style=color:#f29718>derive</span><span>(Component)]
</span><span style=color:#fa6e32>struct </span><span style=color:#399ee6>Dummy</span><span style=color:#61676ccc>;
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// Updated spawn calls:
</span><span>world</span><span style=color:#ed9366>.</span><span style=color:#f07171>spawn</span><span>(Dummy)</span><span style=color:#61676ccc>;
</span><span>world</span><span style=color:#ed9366>.</span><span style=color:#f07171>spawn_batch</span><span>((</span><span style=color:#ff8f40>0</span><span style=color:#ed9366>..</span><span style=color:#ff8f40>2</span><span>)</span><span style=color:#ed9366>.</span><span style=color:#f07171>map</span><span>(|_| (Dummy</span><span style=color:#61676ccc>,</span><span> Disabled)))</span><span style=color:#61676ccc>;
</span></code></pre><h3 id=crates-bevy-ecs-src-world-entity-access-mod-rs-17-8><code>crates/bevy_ecs/src/world/entity_access/mod.rs</code> (+17/-8)</h3><p><strong>What changed</strong>: Added <code>Marker</code> component and updated entity access tests to use filtered queries. <strong>Why</strong>: To ensure entity access tests only operate on test-created entities.<pre class=language-rust data-lang=rust style=color:#61676c;background-color:#fafafa><code class=language-rust data-lang=rust><span style=color:#abb0b6;font-style:italic>// Before:
</span><span>world</span><span style=color:#ed9366>.</span><span style=color:#f07171>spawn</span><span>(TestComponent(</span><span style=color:#ff8f40>0</span><span>))</span><span style=color:#ed9366>.</span><span style=color:#f07171>insert</span><span>(TestComponent2(</span><span style=color:#ff8f40>0</span><span>))</span><span style=color:#61676ccc>;
</span><span style=color:#fa6e32>let mut</span><span> query </span><span style=color:#ed9366>=</span><span> world</span><span style=color:#ed9366>.</span><span>query</span><span style=color:#ed9366>::</span><span>&LTEntityRefExcept&LTTestComponent>>()</span><span style=color:#61676ccc>;
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// After:
</span><span>world</span><span style=color:#ed9366>.</span><span style=color:#f07171>spawn</span><span>((TestComponent(</span><span style=color:#ff8f40>0</span><span>)</span><span style=color:#61676ccc>,</span><span> TestComponent2(</span><span style=color:#ff8f40>0</span><span>)</span><span style=color:#61676ccc>,</span><span> Marker))</span><span style=color:#61676ccc>;
</span><span style=color:#fa6e32>let mut</span><span> query </span><span style=color:#ed9366>=</span><span> world</span><span style=color:#ed9366>.</span><span>query_filtered</span><span style=color:#ed9366>::</span><span>&LTEntityRefExcept&LTTestComponent>, With&LTMarker>>()</span><span style=color:#61676ccc>;
</span></code></pre><h2 id=further-reading>Further Reading</h2><ul><li><a rel="noopener nofollow noreferrer" href=https://docs.rs/bevy_ecs/latest/bevy_ecs/system/struct.Query.html target=_blank>Bevy ECS Query Documentation</a><li><a rel="noopener nofollow noreferrer" href=https://bevy-cheatbook.github.io/programming/queries.html target=_blank>Component Filtering in Bevy</a><li><a rel="noopener nofollow noreferrer" href=https://github.com/bevyengine/bevy/discussions target=_blank>Test Isolation Patterns in ECS Systems</a></ul><h1 id=full-code-diff>Full Code Diff</h1><p><em>(The full code diff is provided in the original request and has been used for the analysis above)</em></div><div data-is-md-page=true data-patch-exists=true data-patch-path=/pull_request/bevy/2025-10/pr_21685.patch id=patch-info style=display:none></div><div class=bottom-spacer></div></div></div>